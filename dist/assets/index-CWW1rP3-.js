const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CYkal4l0.js","assets/vendor-BM8aJrq5.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,R as n,g as A,b as r,c as i,d as o}from"./vendor-BM8aJrq5.js";function s(e,t){for(var n=0;n<t.length;n++){const A=t[n];if("string"!=typeof A&&!Array.isArray(A))for(const t in A)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(A,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>A[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var a={exports:{}},g={},l=e,c=Symbol.for("react.element"),I=Symbol.for("react.fragment"),C=Object.prototype.hasOwnProperty,u=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,n){var A,r={},i=null,o=null;for(A in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)C.call(t,A)&&!d.hasOwnProperty(A)&&(r[A]=t[A]);if(e&&e.defaultProps)for(A in t=e.defaultProps)void 0===r[A]&&(r[A]=t[A]);return{$$typeof:c,type:e,key:i,ref:o,props:r,_owner:u.current}}g.Fragment=I,g.jsx=h,g.jsxs=h,a.exports=g;var m,p,f=a.exports,b={},B=t;
/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var A in n)Object.prototype.hasOwnProperty.call(n,A)&&(e[A]=n[A])}return e},y.apply(this,arguments)}b.createRoot=B.createRoot,b.hydrateRoot=B.hydrateRoot,(p=m||(m={})).Pop="POP",p.Push="PUSH",p.Replace="REPLACE";const w="popstate";function Z(e){return void 0===e&&(e={}),function(e,t,n,A){void 0===A&&(A={});let{window:r=document.defaultView,v5Compat:i=!1}=A,o=r.history,s=m.Pop,a=null,g=l();null==g&&(g=0,o.replaceState(y({},o.state,{idx:g}),""));function l(){return(o.state||{idx:null}).idx}function c(){s=m.Pop;let e=l(),t=null==e?null:e-g;g=e,a&&a({action:s,location:d.location,delta:t})}function I(e,t){s=m.Push;let n=R(d.location,e,t);g=l()+1;let A=G(n,g),c=d.createHref(n);try{o.pushState(A,"",c)}catch(I){if(I instanceof DOMException&&"DataCloneError"===I.name)throw I;r.location.assign(c)}i&&a&&a({action:s,location:d.location,delta:1})}function C(e,t){s=m.Replace;let n=R(d.location,e,t);g=l();let A=G(n,g),r=d.createHref(n);o.replaceState(A,"",r),i&&a&&a({action:s,location:d.location,delta:0})}function u(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"==typeof e?e:V(e);return n=n.replace(/ $/,"%20"),S(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}let d={get action(){return s},get location(){return e(r,o)},listen(e){if(a)throw new Error("A history only accepts one active listener");return r.addEventListener(w,c),a=e,()=>{r.removeEventListener(w,c),a=null}},createHref:e=>t(r,e),createURL:u,encodeLocation(e){let t=u(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:I,replace:C,go:e=>o.go(e)};return d}((function(e,t){let{pathname:n,search:A,hash:r}=e.location;return R("",{pathname:n,search:A,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:V(t)}),0,e)}function S(e,t){if(!1===e||null==e)throw new Error(t)}function v(e,t){if(!e)try{throw new Error(t)}catch(Zf){}}function G(e,t){return{usr:e.state,key:e.key,idx:t}}function R(e,t,n,A){return void 0===n&&(n=null),y({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?N(t):t,{state:n,key:t&&t.key||A||Math.random().toString(36).substr(2,8)})}function V(e){let{pathname:t="/",search:n="",hash:A=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),A&&"#"!==A&&(t+="#"===A.charAt(0)?A:"#"+A),t}function N(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let A=e.indexOf("?");A>=0&&(t.search=e.substr(A),e=e.substr(0,A)),e&&(t.pathname=e)}return t}var k,W;function F(e,t,n){return void 0===n&&(n="/"),function(e,t,n){let A="string"==typeof t?N(t):t,r=z(A.pathname||"/",n);if(null==r)return null;let i=E(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let e=D(r);o=M(i[s],e)}return o}(e,t,n)}function E(e,t,n,A){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===A&&(A="");let r=(e,r,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};o.relativePath.startsWith("/")&&(S(o.relativePath.startsWith(A),'Absolute route path "'+o.relativePath+'" nested under path "'+A+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(A.length));let s=j([A,o.relativePath]),a=n.concat(o);e.children&&e.children.length>0&&(S(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),E(e.children,t,a,s)),(null!=e.path||e.index)&&t.push({path:s,score:K(s,e.index),routesMeta:a})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let A of X(e.path))r(e,t,A);else r(e,t)})),t}function X(e){let t=e.split("/");if(0===t.length)return[];let[n,...A]=t,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===A.length)return r?[i,""]:[i];let o=X(A.join("/")),s=[];return s.push(...o.map((e=>""===e?i:[i,e].join("/")))),r&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}(W=k||(k={})).data="data",W.deferred="deferred",W.redirect="redirect",W.error="error";const H=/^:[\w-]+$/,x=3,J=2,Y=1,U=10,L=-2,T=e=>"*"===e;function K(e,t){let n=e.split("/"),A=n.length;return n.some(T)&&(A+=L),t&&(A+=J),n.filter((e=>!T(e))).reduce(((e,t)=>e+(H.test(t)?x:""===t?Y:U)),A)}function M(e,t,n){let{routesMeta:A}=e,r={},i="/",o=[];for(let s=0;s<A.length;++s){let e=A[s],n=s===A.length-1,a="/"===i?t:t.slice(i.length)||"/",g=Q({path:e.relativePath,caseSensitive:e.caseSensitive,end:n},a),l=e.route;if(!g)return null;Object.assign(r,g.params),o.push({params:r,pathname:j([i,g.pathname]),pathnameBase:q(j([i,g.pathnameBase])),route:l}),"/"!==g.pathnameBase&&(i=j([i,g.pathnameBase]))}return o}function Q(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,A]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);v("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let A=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(A.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(A.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let i=new RegExp(r,t?void 0:"i");return[i,A]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),s=r.slice(1),a=A.reduce(((e,t,n)=>{let{paramName:A,isOptional:r}=t;if("*"===A){let e=s[n]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const a=s[n];return e[A]=r&&!a?void 0:(a||"").replace(/%2F/g,"/"),e}),{});return{params:a,pathname:i,pathnameBase:o,pattern:e}}function D(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return v(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,A=e.charAt(n);return A&&"/"!==A?null:e.slice(n)||"/"}function O(e,t,n,A){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(A)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function P(e,t){let n=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function _(e,t,n,A){let r;void 0===A&&(A=!1),"string"==typeof e?r=N(e):(r=y({},e),S(!r.pathname||!r.pathname.includes("?"),O("?","pathname","search",r)),S(!r.pathname||!r.pathname.includes("#"),O("#","pathname","hash",r)),S(!r.search||!r.search.includes("#"),O("#","search","hash",r)));let i,o=""===e||""===r.pathname,s=o?"/":r.pathname;if(null==s)i=n;else{let e=t.length-1;if(!A&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let a=function(e,t){void 0===t&&(t="/");let{pathname:n,search:A="",hash:r=""}="string"==typeof e?N(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:$(A),hash:ee(r)}}(r,i),g=s&&"/"!==s&&s.endsWith("/"),l=(o||"."===s)&&n.endsWith("/");return a.pathname.endsWith("/")||!g&&!l||(a.pathname+="/"),a}const j=e=>e.join("/").replace(/\/\/+/g,"/"),q=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),$=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",ee=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const te=["post","put","patch","delete"];new Set(te);const ne=["get",...te];
/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var A in n)Object.prototype.hasOwnProperty.call(n,A)&&(e[A]=n[A])}return e},Ae.apply(this,arguments)}new Set(ne);const re=e.createContext(null),ie=e.createContext(null),oe=e.createContext(null),se=e.createContext(null),ae=e.createContext({outlet:null,matches:[],isDataRoute:!1}),ge=e.createContext(null);function le(){return null!=e.useContext(se)}function ce(){return le()||S(!1),e.useContext(se).location}function Ie(t){e.useContext(oe).static||e.useLayoutEffect(t)}function Ce(){let{isDataRoute:t}=e.useContext(ae);return t?function(){let{router:t}=function(){let t=e.useContext(re);return t||S(!1),t}(Be.UseNavigateStable),n=we(ye.UseNavigateStable),A=e.useRef(!1);return Ie((()=>{A.current=!0})),e.useCallback((function(e,r){void 0===r&&(r={}),A.current&&("number"==typeof e?t.navigate(e):t.navigate(e,Ae({fromRouteId:n},r)))}),[t,n])}():function(){le()||S(!1);let t=e.useContext(re),{basename:n,future:A,navigator:r}=e.useContext(oe),{matches:i}=e.useContext(ae),{pathname:o}=ce(),s=JSON.stringify(P(i,A.v7_relativeSplatPath)),a=e.useRef(!1);return Ie((()=>{a.current=!0})),e.useCallback((function(e,A){if(void 0===A&&(A={}),!a.current)return;if("number"==typeof e)return void r.go(e);let i=_(e,JSON.parse(s),o,"path"===A.relative);null==t&&"/"!==n&&(i.pathname="/"===i.pathname?n:j([n,i.pathname])),(A.replace?r.replace:r.push)(i,A.state,A)}),[n,r,s,o,t])}()}function ue(){let{matches:t}=e.useContext(ae),n=t[t.length-1];return n?n.params:{}}function de(t,n){let{relative:A}=void 0===n?{}:n,{future:r}=e.useContext(oe),{matches:i}=e.useContext(ae),{pathname:o}=ce(),s=JSON.stringify(P(i,r.v7_relativeSplatPath));return e.useMemo((()=>_(t,JSON.parse(s),o,"path"===A)),[t,s,o,A])}function he(t,n){return function(t,n,A,r){le()||S(!1);let{navigator:i,static:o}=e.useContext(oe),{matches:s}=e.useContext(ae),a=s[s.length-1],g=a?a.params:{};!a||a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c,I=ce();if(n){var C;let e="string"==typeof n?N(n):n;"/"===l||(null==(C=e.pathname)?void 0:C.startsWith(l))||S(!1),c=e}else c=I;let u=c.pathname||"/",d=u;if("/"!==l){let e=l.replace(/^\//,"").split("/");d="/"+u.replace(/^\//,"").split("/").slice(e.length).join("/")}let h=F(t,{pathname:d}),p=function(t,n,A,r){var i;void 0===n&&(n=[]);void 0===A&&(A=null);void 0===r&&(r=null);if(null==t){var o;if(!A)return null;if(A.errors)t=A.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===n.length&&!A.initialized&&A.matches.length>0))return null;t=A.matches}}let s=t,a=null==(i=A)?void 0:i.errors;if(null!=a){let e=s.findIndex((e=>e.route.id&&void 0!==(null==a?void 0:a[e.route.id])));e>=0||S(!1),s=s.slice(0,Math.min(s.length,e+1))}let g=!1,l=-1;if(A&&r&&r.v7_partialHydration)for(let e=0;e<s.length;e++){let t=s[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:n}=A,r=t.route.loader&&void 0===e[t.route.id]&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){g=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight(((t,r,i)=>{let o,c=!1,I=null,C=null;A&&(o=a&&r.route.id?a[r.route.id]:void 0,I=r.route.errorElement||pe,g&&(l<0&&0===i?(!function(e){Ze[e]||(Ze[e]=!0)}("route-fallback"),c=!0,C=null):l===i&&(c=!0,C=r.route.hydrateFallbackElement||null)));let u=n.concat(s.slice(0,i+1)),d=()=>{let n;return n=o?I:c?C:r.route.Component?e.createElement(r.route.Component,null):r.route.element?r.route.element:t,e.createElement(be,{match:r,routeContext:{outlet:t,matches:u,isDataRoute:null!=A},children:n})};return A&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?e.createElement(fe,{location:A.location,revalidation:A.revalidation,component:I,error:o,children:d(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):d()}),null)}(h&&h.map((e=>Object.assign({},e,{params:Object.assign({},g,e.params),pathname:j([l,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:j([l,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,A,r);if(n&&p)return e.createElement(se.Provider,{value:{location:Ae({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:m.Pop}},p);return p}(t,n)}function me(){let t=function(){var t;let n=e.useContext(ge),A=function(){let t=e.useContext(ie);return t||S(!1),t}(),r=we();if(void 0!==n)return n;return null==(t=A.errors)?void 0:t[r]}(),n=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),A=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),A?e.createElement("pre",{style:r},A):null,null)}const pe=e.createElement(me,null);class fe extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?e.createElement(ae.Provider,{value:this.props.routeContext},e.createElement(ge.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function be(t){let{routeContext:n,match:A,children:r}=t,i=e.useContext(re);return i&&i.static&&i.staticContext&&(A.route.errorElement||A.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=A.route.id),e.createElement(ae.Provider,{value:n},r)}var Be=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Be||{}),ye=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ye||{});function we(t){let n=function(){let t=e.useContext(ae);return t||S(!1),t}(),A=n.matches[n.matches.length-1];return A.route.id||S(!1),A.route.id}const Ze={};function Se(t){let{to:n,replace:A,state:r,relative:i}=t;le()||S(!1);let{future:o,static:s}=e.useContext(oe),{matches:a}=e.useContext(ae),{pathname:g}=ce(),l=Ce(),c=_(n,P(a,o.v7_relativeSplatPath),g,"path"===i),I=JSON.stringify(c);return e.useEffect((()=>l(JSON.parse(I),{replace:A,state:r,relative:i})),[l,I,i,A,r]),null}function ve(e){S(!1)}function Ge(t){let{basename:n="/",children:A=null,location:r,navigationType:i=m.Pop,navigator:o,static:s=!1,future:a}=t;le()&&S(!1);let g=n.replace(/^\/*/,"/"),l=e.useMemo((()=>({basename:g,navigator:o,static:s,future:Ae({v7_relativeSplatPath:!1},a)})),[g,a,o,s]);"string"==typeof r&&(r=N(r));let{pathname:c="/",search:I="",hash:C="",state:u=null,key:d="default"}=r,h=e.useMemo((()=>{let e=z(c,g);return null==e?null:{location:{pathname:e,search:I,hash:C,state:u,key:d},navigationType:i}}),[g,c,I,C,u,d,i]);return null==h?null:e.createElement(oe.Provider,{value:l},e.createElement(se.Provider,{children:A,value:h}))}function Re(e){let{children:t,location:n}=e;return he(Ve(t),n)}function Ve(t,n){void 0===n&&(n=[]);let A=[];return e.Children.forEach(t,((t,r)=>{if(!e.isValidElement(t))return;let i=[...n,r];if(t.type===e.Fragment)return void A.push.apply(A,Ve(t.props.children,i));t.type!==ve&&S(!1),t.props.index&&t.props.children&&S(!1);let o={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=Ve(t.props.children,i)),A.push(o)})),A}
/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var A in n)Object.prototype.hasOwnProperty.call(n,A)&&(e[A]=n[A])}return e},Ne.apply(this,arguments)}new Promise((()=>{}));const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Zf){}const We=n.startTransition;function Fe(t){let{basename:n,children:A,future:r,window:i}=t,o=e.useRef();null==o.current&&(o.current=Z({window:i,v5Compat:!0}));let s=o.current,[a,g]=e.useState({action:s.action,location:s.location}),{v7_startTransition:l}=r||{},c=e.useCallback((e=>{l&&We?We((()=>g(e))):g(e)}),[g,l]);return e.useLayoutEffect((()=>s.listen(c)),[s,c]),e.useEffect((()=>{return null==(e=r)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e}),[r]),e.createElement(Ge,{basename:n,children:A,location:a.location,navigationType:a.action,navigator:s,future:r})}const Ee="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Xe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,He=e.forwardRef((function(t,n){let A,{onClick:r,relative:i,reloadDocument:o,replace:s,state:a,target:g,to:l,preventScrollReset:c,viewTransition:I}=t,C=function(e,t){if(null==e)return{};var n,A,r={},i=Object.keys(e);for(A=0;A<i.length;A++)n=i[A],t.indexOf(n)>=0||(r[n]=e[n]);return r}(t,ke),{basename:u}=e.useContext(oe),d=!1;if("string"==typeof l&&Xe.test(l)&&(A=l,Ee))try{let e=new URL(window.location.href),t=l.startsWith("//")?new URL(e.protocol+l):new URL(l),n=z(t.pathname,u);t.origin===e.origin&&null!=n?l=n+t.search+t.hash:d=!0}catch(Zf){}let h=function(t,n){let{relative:A}=void 0===n?{}:n;le()||S(!1);let{basename:r,navigator:i}=e.useContext(oe),{hash:o,pathname:s,search:a}=de(t,{relative:A}),g=s;return"/"!==r&&(g="/"===s?r:j([r,s])),i.createHref({pathname:g,search:a,hash:o})}(l,{relative:i}),m=function(t,n){let{target:A,replace:r,state:i,preventScrollReset:o,relative:s,viewTransition:a}=void 0===n?{}:n,g=Ce(),l=ce(),c=de(t,{relative:s});return e.useCallback((e=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(e,A)){e.preventDefault();let n=void 0!==r?r:V(l)===V(c);g(t,{replace:n,state:i,preventScrollReset:o,relative:s,viewTransition:a})}}),[l,g,c,r,i,A,t,o,s,a])}(l,{replace:s,state:a,target:g,preventScrollReset:c,relative:i,viewTransition:I});return e.createElement("a",Ne({},C,{href:A||h,onClick:d||o?r:function(e){r&&r(e),e.defaultPrevented||m(e)},ref:n,target:g}))}));var xe,Je,Ye,Ue;(Je=xe||(xe={})).UseScrollRestoration="useScrollRestoration",Je.UseSubmit="useSubmit",Je.UseSubmitFetcher="useSubmitFetcher",Je.UseFetcher="useFetcher",Je.useViewTransitionState="useViewTransitionState",(Ue=Ye||(Ye={})).UseFetcher="useFetcher",Ue.UseFetchers="useFetchers",Ue.UseScrollRestoration="useScrollRestoration";const Le={Shukrani:[{name:"institut kilanga",count:7,message:"Chers amis de l’Institut Kilanga, votre présence enrichira notre célébration ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"couple FAKI",count:2,message:"Famille Faki, c’est un honneur de vous compter parmi nous pour le grand jour ! Fiston Zaka et Vino Banza vous saluent chaleureusement."},{name:"EP SHINDANO",count:3,message:"Chers membres de l’EP Shindano, votre joie et votre bonne humeur sont essentielles ! À très vite pour célébrer Fiston Zaka et Vino Banza."}],Yvmie:[{name:"INSTITUT WILLIAM",count:5,message:"Institut William, préparez-vous à partager un moment inoubliable ! Fiston Zaka et Vino Banza vous attendent."},{name:"COUPLE MAKAMBU",count:2,message:"Couple Makambu, votre complicité sera notre plus beau cadeau ! Merci de célébrer ce jour spécial avec Fiston Zaka et Vino Banza."},{name:"COUPLE KIKWESE",count:2,message:"Famille Kikwese, votre présence illuminera la fête ! Fiston Zaka et Vino Banza vous accueillent à bras ouverts."},{name:"Vudwawu",count:1,message:"Cher Vudwawu, toute l’équipe de Fiston Zaka et Vino Banza est ravie de vous recevoir pour cette belle journée."}],Yvanna:[{name:"ÉCOLE CROUCROU",count:5,message:"École Croucrou, vos sourires et votre enthousiasme sont attendus ! Merci de venir fêter Fiston Zaka et Vino Banza."},{name:"COUPLE LUCIEN",count:2,message:"Couple Lucien, nous sommes impatients de partager ce moment magique avec vous ! À bientôt pour le mariage de Fiston Zaka et Vino Banza."},{name:"COUPLE MASIALA",count:2,message:"Famille Masiala, votre élégance animera notre journée ! Fiston Zaka et Vino Banza se réjouissent de vous voir."}],Aurore:[{name:"COUPLE FWAMBA EMMANUEL",count:2,message:"Couple Fwamba Emmanuel, préparez-vous à une fête mémorable ! Fiston Zaka et Vino Banza vous remercient de votre présence."},{name:"COUPLE MBUYU CLAUDE",count:2,message:"Famille Mbuyu Claude, votre joie de vivre sera le plus beau des cadeaux ! Merci d’être là pour Fiston Zaka et Vino Banza."},{name:"COUPLE KUMWIMBA PEGGY",count:2,message:"Couple Kumwimba Peggy, votre présence apportera chaleur et sourire ! Fiston Zaka et Vino Banza sont impatients de vous accueillir."},{name:"COUPLE MBUMBA FREDY",count:2,message:"Famille Mbumba Fredy, merci de participer à cette grande aventure ! Fiston Zaka et Vino Banza vous saluent avec gratitude."},{name:"ANGEL KYUNGU",count:1,message:"Cher Angel Kyungu, votre soutien est précieux ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"Mukalay Jean",count:1,message:"Cher Mukalay Jean, merci de joindre vos vœux à notre célébration ! À très vite pour fêter Fiston Zaka et Vino Banza."}],Beneth:[{name:"couple fwamba George",count:2,message:"Couple Fwamba George, votre présence embellira le jour J ! Fiston Zaka et Vino Banza vous attendent."},{name:"couple KYUNGU benjamin",count:2,message:"Famille Kyungu Benjamin, merci d’être à nos côtés pour ce moment unique ! À bientôt pour le mariage de Fiston Zaka et Vino Banza."},{name:"couple fwamba Franc",count:2,message:"Couple Fwamba Franc, votre complicité rendra la fête encore plus belle ! Fiston Zaka et Vino Banza vous accueillent."},{name:"Maman Nénette",count:1,message:"Chère Maman Nénette, votre présence maternelle sera notre plus grand réconfort ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"Maman KYUNGU",count:1,message:"Chère Maman Kyungu, merci de partager ce moment sacré avec nous ! Fiston Zaka et Vino Banza vous saluent chaleureusement."},{name:"Maman Costa",count:1,message:"Chère Maman Costa, votre bienveillance illuminera notre journée ! À très bientôt pour célébrer Fiston Zaka et Vino Banza."}],Amani:[{name:"couple kalumba Yvon",count:2,message:"Couple Kalumba Yvon, votre présence est un honneur ! Fiston Zaka et Vino Banza se réjouissent de vous voir."},{name:"couple kongolo Cédric",count:2,message:"Famille Kongolo Cédric, préparez-vous à une célébration mémorable ! Merci d’être avec Fiston Zaka et Vino Banza."},{name:"couple Binene Paulin",count:2,message:"Couple Binene Paulin, votre énergie positive rendra tout plus beau ! Fiston Zaka et Vino Banza vous attendent."},{name:"couple jibikilayi patient",count:2,message:"Famille Jibikilayi Patient, votre amitié nous touche au cœur ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"Jeanine nzolana",count:1,message:"Chère Jeanine Nzolana, merci de partager ce jour exceptionnel ! Fiston Zaka et Vino Banza sont ravis de vous compter parmi nous."},{name:"Nancy",count:1,message:"Chère Nancy, votre présence ajoutera une touche de bonheur ! À très bientôt pour célébrer Fiston Zaka et Vino Banza."}],Cheyenne:[{name:"pungwe falonne",count:1,message:"Cher Pungwe Falonne, votre sourire illuminera notre fête ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"Ngoy Marina",count:1,message:"Chère Ngoy Marina, votre présence rendra ce jour encore plus spécial ! Fiston Zaka et Vino Banza vous remercient."},{name:"Mukalay Christian",count:1,message:"Cher Mukalay Christian, préparez-vous à vivre un moment inoubliable ! Merci de célébrer Fiston Zaka et Vino Banza."},{name:"fwamba Gorcelain",count:1,message:"Cher Fwamba Gorcelain, votre joie nous est précieuse ! Fiston Zaka et Vino Banza se réjouissent de vous voir."},{name:"badibanga James",count:1,message:"Cher Badibanga James, votre présence est un bonheur ! À très vite pour le mariage de Fiston Zaka et Vino Banza."},{name:"Mukalay Michael",count:1,message:"Cher Mukalay Michael, votre soutien réchauffe nos cœurs ! Bienvenue à la célébration de Fiston Zaka et Vino Banza."},{name:"Gisèle et Lidia",count:2,message:"Chères Gisèle et Lidia, merci d’apporter votre douceur à notre cérémonie ! Fiston Zaka et Vino Banza vous saluent."},{name:"Arlette fwamba",count:1,message:"Chère Arlette Fwamba, votre présence embellira la journée ! Merci de célébrer Fiston Zaka et Vino Banza."},{name:"juve",count:1,message:"Cher Juve, votre bonne humeur est essentielle ! Fiston Zaka et Vino Banza sont heureux de vous accueillir."},{name:"Maris ntambwe",count:1,message:"Chère Maris Ntambwe, votre présence sera un vrai cadeau ! À très bientôt pour célébrer Fiston Zaka et Vino Banza."}],Christina:[{name:"couple Olivier",count:2,message:"Couple Olivier, votre élégance rendra notre journée inoubliable ! Fiston Zaka et Vino Banza vous attendent."},{name:"couple Didier",count:2,message:"Famille Didier, merci d’apporter votre joie à notre fête ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"couple Bob",count:2,message:"Couple Bob, votre complicité est notre plus beau cadeau ! Fiston Zaka et Vino Banza se réjouissent de vous recevoir."},{name:"couple COUPLE JIMMY",count:2,message:"Couple Jimmy, votre présence illuminera la cérémonie ! Merci d’être avec Fiston Zaka et Vino Banza."},{name:"MAMAN CHRISTINE ET PERFODIE",count:2,message:"Chères Mamans Christine et Perfodie, votre tendresse nous touche profondément ! Fiston Zaka et Vino Banza vous saluent chaleureusement."}],Claudeney:[{name:"Espérance",count:1,message:"Chère Espérance, votre optimisme est un rayon de soleil ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"Claude junior",count:1,message:"Cher Claude Junior, merci de partager notre bonheur ! Fiston Zaka et Vino Banza sont ravis de vous accueillir."},{name:"djodjo",count:1,message:"Cher Djodjo, votre bonne humeur est essentielle ! À très vite pour célébrer Fiston Zaka et Vino Banza."},{name:"Exaucé",count:1,message:"Cher Exaucé, votre soutien nous touche profondément ! Bienvenue à notre grande fête."},{name:"MELINA",count:1,message:"Chère Melina, votre élégance rendra la journée encore plus belle ! Fiston Zaka et Vino Banza vous attendent."},{name:"HÉLÈNE",count:1,message:"Chère Hélène, votre présence est un cadeau précieux ! Merci de célébrer avec Fiston Zaka et Vino Banza."}],Stone:[{name:"Destiné",count:1,message:"Chère Destiné, votre présence promet d’être magique ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"couple merveille",count:2,message:"Couple Merveille, votre amour nous inspire ! Fiston Zaka et Vino Banza se réjouissent de vous accueillir."},{name:"Jemima et Paola",count:2,message:"Chères Jemima et Paola, merci d’apporter votre complicité ! À très bientôt pour célébrer notre union."},{name:"couple shadrac",count:2,message:"Famille Shadrac, votre joie sera notre plus beau cadeau ! Fiston Zaka et Vino Banza vous saluent."},{name:"MA MARIE",count:1,message:"Chère Ma Marie, votre présence sera gravée dans nos cœurs ! Bienvenue au mariage de Fiston Zaka et Vino Banza."}],"Fréd":[{name:"Arlette dimonekene",count:1,message:"Chère Arlette Dimonekene, votre bienveillance illumine nos vies ! Fiston Zaka et Vino Banza vous remercient."},{name:"Couple Merveille",count:2,message:"Couple Merveille, votre complicité sera notre plus beau souvenir ! Bienvenue à notre fête."},{name:"Papy masini",count:1,message:"Cher Papy Masini, votre sagesse rendra ce jour unique ! Fiston Zaka et Vino Banza sont honorés de vous avoir."},{name:"Marie bikela",count:1,message:"Chère Marie Bikela, votre présence est un trésor ! Merci de célébrer avec nous."},{name:"Maman bijoux",count:1,message:"Chère Maman Bijoux, votre tendresse est précieuse ! Fiston Zaka et Vino Banza vous saluent."}],"Frémi":[{name:"Couple Papa bona",count:2,message:"Couple Papa Bona, votre amour est contagieux ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"couple KELLY",count:2,message:"Famille Kelly, votre présence nous touche au cœur ! Fiston Zaka et Vino Banza sont impatients de vous recevoir."},{name:"COUPLE CHRISTINE",count:2,message:"Couple Christine, votre complicité embellira la journée ! Merci de célébrer avec nous."},{name:"COUPLE LE KING- DOLA",count:2,message:"Famille Le King-Dola, votre présence royale sera inoubliable ! Fiston Zaka et Vino Banza vous attendent."},{name:"COUPLE NATACHA",count:2,message:"Couple Natacha, votre élégance nous inspire ! Bienvenue à notre célébration."}],Justine:[{name:"Alfred",count:1,message:"Cher Alfred, votre présence personnelle est un cadeau ! Fiston Zaka et Vino Banza vous remercient."},{name:"Fariam",count:1,message:"Cher Fariam, votre sourire rendra notre fête lumineuse ! Bienvenue au mariage."},{name:"COUPLE MAMAN ANNI",count:2,message:"Chers Couple Maman Anni, votre tendresse est essentielle ! Fiston Zaka et Vino Banza se réjouissent de vous avoir."},{name:"COUPLE ALAIN",count:2,message:"Famille Alain, préparez-vous à une journée inoubliable ! Merci d’être présents."},{name:"COUPLE TOTO",count:2,message:"Couple Toto, votre bonne humeur est contagieuse ! Bienvenue au mariage de Fiston Zaka et Vino Banza."},{name:"COUPLE MPEMA",count:2,message:"Famille Mpema, votre joie et vos rires seront nos meilleurs souvenirs ! À très vite."},{name:"COUPLE RICHARD",count:2,message:"Couple Richard, votre élégance embellira notre union ! Fiston Zaka et Vino Banza vous saluent."}],GABBY:[{name:"COUPLE LAURENT",count:2,message:"Famille Laurent, votre présence est un honneur ! Bienvenue à notre mariage."},{name:"COUPLE ÉRIC",count:2,message:"Couple Éric, votre complicité sera notre plus beau cadeau ! Fiston Zaka et Vino Banza vous attendent."},{name:"COUPLE BELLONE",count:2,message:"Famille Bellone, votre chaleur humaine nous émeut ! Merci d’être là."},{name:"COUPLE TSHAMALA",count:2,message:"Couple Tshamala, votre présence illuminera la fête ! Bienvenue au mariage."},{name:"COUPLE GABRIEL",count:2,message:"Famille Gabriel, votre soutien est précieux ! Fiston Zaka et Vino Banza se réjouissent de vous recevoir."}],"GAËTAN":[{name:"JOCELYNE",count:1,message:"Chère Jocelyne, votre joie de vivre est un rayon de soleil ! Bienvenue à notre grande fête."},{name:"Florence",count:1,message:"Chère Florence, votre élégance rendra ce jour mémorable ! Fiston Zaka et Vino Banza vous saluent."},{name:"Roger",count:1,message:"Cher Roger, votre présence est un vrai honneur ! Merci de célébrer avec nous."},{name:"SACRE",count:1,message:"Chère Sacre, votre soutien est inestimable ! Fiston Zaka et Vino Banza vous remercient."},{name:"COUPLE KELLY",count:2,message:"Famille Kelly, votre complicité rendra tout plus beau ! Bienvenue au mariage."},{name:"COUPLE MA MBELO",count:2,message:"Famille Ma Mbelo, c’est un plaisir de vous avoir parmi nous ! À très vite pour la cérémonie."},{name:"COUPLE LÉON",count:2,message:"Famille Léon, votre présence est un cadeau précieux ! Fiston Zaka et Vino Banza vous attendent."}],"Gaël":[{name:"COUPLE LOVE",count:2,message:"Couple Love, votre amour illumine notre journée ! Bienvenue au mariage."},{name:"FRÈRE DANNY",count:1,message:"Cher Frère Danny, votre soutien fraternel est essentiel ! Merci d’être là."},{name:"COUPLE CHRISTIAN",count:2,message:"Famille Christian, votre joie nous est précieuse ! Fiston Zaka et Vino Banza se réjouissent de vous recevoir."},{name:"COUPLE FREDDYNA",count:2,message:"Famille Freddy­na, votre complicité embellira la fête ! Bienvenue à notre union."},{name:"TA MWASI",count:1,message:"Chère Ta Mwasi, votre présence est un honneur ! Merci de célébrer avec nous."},{name:"COUPLE TATU",count:2,message:"Couple Tatu, votre bonne humeur est contagieuse ! Fiston Zaka et Vino Banza vous attendent."}],"GAËLLE":[{name:"PATRICK MUANDA",count:1,message:"Cher Patrick Muanda, votre présence illumine notre journée ! Bienvenue au mariage."},{name:"HUBERT NHEMA",count:1,message:"Cher Hubert Nhema, votre élégance rendra ce jour mémorable ! Fiston Zaka et Vino Banza vous saluent."},{name:"ANICET TUNDA",count:1,message:"Cher Anicet Tunda, votre présence est un honneur ! Merci de célébrer avec nous."}]},Te={couple:{groom:"Fiston Zaka",bride:"Vino Banza"},event:{date:"31 Mai 2025",time:"19h00",venue:"Salle de fête Néema",address:"Avenue INGA, N° 1",location:"Commune de Bandalungwa, Quartier Adoula",city:"Kinshasa",country:"Congo-Kinshasa",reference:"Banque du sang"},families:{groomFamily:"Famille Lisongo",brideFamily:"Famille Fwamba"},welcomeMessage:"Nous avons l'immense joie de vous convier à notre union. Votre présence serait pour nous un honneur et rendrait ce jour encore plus mémorable.",schedule:[{time:"19h00",title:"Accueil des invités",description:"Arrivée et installation des invités"},{time:"19h30",title:"Cérémonie",description:"Célébration de notre union"},{time:"20h30",title:"Cocktail",description:"Photos et rafraîchissements"},{time:"21h30",title:"Dîner",description:"Repas et festivités"},{time:"23h00",title:"Soirée dansante",description:"Célébration jusqu'au bout de la nuit"}],dressCode:"Tenue élégante",rsvp:{deadline:"15 Avril 2025",contactPhone:"+243 XX XXX XXXX",contactEmail:"fistonvino2025@gmail.com"},tables:[{name:"Shukrani",count:12,color:"#7209B7",invites:[{name:"Institut Kilanga",count:7},{name:"Couple FAKI",count:2},{name:"EP SHINDANO",count:3}]},{name:"Yvmie",count:10,color:"#0077B6",invites:[{name:"INSTITUT WILLIAM",count:5},{name:"COUPLE MAKAMBU",count:2},{name:"COUPLE KIKWESE",count:2},{name:"Vudwawu",count:1}]},{name:"Yvanna",count:9,color:"#00B4D8",invites:[{name:"ÉCOLE CROUCROU",count:5},{name:"COUPLE LUCIEN",count:2},{name:"COUPLE MASIALA",count:2}]},{name:"Aurore",count:10,color:"#FF5400",invites:[{name:"COUPLE FWAMBA EMMANUEL",count:2},{name:"COUPLE MBUYU CLAUDE",count:2},{name:"COUPLE KUMWIMBA PEGGY",count:2},{name:"COUPLE MBUMBA FREDY",count:2},{name:"ANGEL KYUNGU",count:1},{name:"Mukalay Jean",count:1}]},{name:"Beneth",count:9,color:"#D90429",invites:[{name:"Couple Fwamba George",count:2},{name:"Couple KYUNGU Benjamin",count:2},{name:"Couple Fwamba Franc",count:2},{name:"Maman Nénette",count:1},{name:"Maman KYUNGU",count:1},{name:"Maman Costa",count:1}]},{name:"Amani",count:10,color:"#38B000",invites:[{name:"Couple Kalumba Yvon",count:2},{name:"Couple Kongolo Cédric",count:2},{name:"Couple Binene Paulin",count:2},{name:"Couple Jibikilayi Patient",count:2},{name:"Jeanine Nzolana",count:1},{name:"Nancy",count:1}]},{name:"Cheyenne",count:12,color:"#9D4EDD",invites:[{name:"Pungwe Falonne",count:1},{name:"Ngoy Marina",count:1},{name:"Mukalay Christian",count:1},{name:"Fwamba Gorcelain",count:1},{name:"Badibanga James",count:1},{name:"Mukalay Michael",count:1},{name:"Gisèle et Lidia",count:2},{name:"Arlette Fwamba",count:1},{name:"Juve",count:1},{name:"Maris Ntambwe",count:1}]},{name:"Christina",count:10,color:"#FB8500",invites:[{name:"Couple Olivier",count:2},{name:"Couple Didier",count:2},{name:"Couple Bob",count:2},{name:"Couple JIMMY",count:2},{name:"MAMAN CHRISTINE ET PERFODIE",count:2}]},{name:"Claudeney",count:6,color:"#4895EF",invites:[{name:"Espérance",count:1},{name:"Claude Junior",count:1},{name:"Djodjo",count:1},{name:"Exaucé",count:1},{name:"MELINA",count:1},{name:"HÉLÈNE",count:1}]},{name:"Stone",count:8,color:"#F72585",invites:[{name:"Destiné",count:1},{name:"Couple Merveille",count:2},{name:"Jemima et Paola",count:2},{name:"Couple Shadrac",count:2},{name:"MA MARIE",count:1}]},{name:"Fréd",count:6,color:"#6A00F4",invites:[{name:"Arlette Dimonekene",count:1},{name:"Couple Merveille",count:2},{name:"Papy Masini",count:1},{name:"Marie Bikela",count:1},{name:"Maman Bijoux",count:1}]},{name:"Frémi",count:10,color:"#FFBE0B",invites:[{name:"Couple Papa Bona",count:2},{name:"Couple KELLY",count:2},{name:"COUPLE CHRISTINE",count:2},{name:"COUPLE LE KING-DOLA",count:2},{name:"COUPLE NATACHA",count:2}]},{name:"Justine",count:12,color:"#3A86FF",invites:[{name:"Alfred",count:1},{name:"Fariam",count:1},{name:"COUPLE MAMAN ANNI",count:2},{name:"COUPLE ALAIN",count:2},{name:"COUPLE TOTO",count:2},{name:"COUPLE MPEMA",count:2},{name:"COUPLE RICHARD",count:2}]},{name:"GABBY",count:10,color:"#FF006E",invites:[{name:"COUPLE LAURENT",count:2},{name:"COUPLE ÉRIC",count:2},{name:"COUPLE BELLONE",count:2},{name:"COUPLE TSHAMALA",count:2},{name:"COUPLE GABRIEL",count:2}]},{name:"GAËTAN",count:10,color:"#80B918",invites:[{name:"JOCELYNE",count:1},{name:"Florence",count:1},{name:"Roger",count:1},{name:"SACRE",count:1},{name:"COUPLE KELLY",count:2},{name:"COUPLE MA MBELO",count:2},{name:"COUPLE LÉON",count:2}]},{name:"Gaël",count:10,color:"#FF9E00",invites:[{name:"COUPLE LOVE",count:2},{name:"FRÈRE DANNY",count:1},{name:"COUPLE CHRISTIAN",count:2},{name:"COUPLE FREDDYNA",count:2},{name:"TA MWASI",count:1},{name:"COUPLE TATU",count:2}]},{name:"GAËLLE",count:3,color:"#C77DFF",invites:[{name:"PATRICK MUANDA",count:1},{name:"HUBERT NHEMA",count:1},{name:"ANICET TUNDA",count:1}]}]};var Ke={exports:{}};function Me(){}function Qe(){}Qe.resetWarningCache=Me;Ke.exports=function(){function e(e,t,n,A,r,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Qe,resetWarningCache:Me};return n.PropTypes=n,n}();const De=A(Ke.exports),ze=({threshold:t=.1,rootMargin:n="0px",triggerOnce:A=!0}={})=>{const[r,i]=e.useState(!1),o=e.useRef(null),s=e.useRef(null);return e.useEffect((()=>(o.current&&!s.current&&(s.current=new IntersectionObserver((([e])=>{const t=e.isIntersecting;i(t),t&&A&&s.current&&s.current.disconnect()}),{threshold:t,rootMargin:n}),s.current.observe(o.current)),()=>{s.current&&(s.current.disconnect(),s.current=null)})),[t,n,A]),[o,r]},Oe=({guestInfo:t=null,className:n="",animated:A=!0})=>{const[r,i]=e.useState(0),[o,s]=e.useState(1),[a,g]=ze({threshold:.3,triggerOnce:!0}),[l,c]=e.useState(null);e.useEffect((()=>{if(t&&t.group&&Te.tables){const e=Te.tables.find((e=>e.name.toLowerCase()===t.group.toLowerCase()));e&&c(e)}}),[t]),e.useEffect((()=>{if(!A)return;const e=()=>{const e=window.scrollY,t=Math.min(.2*e,150);i(t);const n=.6*window.innerHeight,A=1-Math.min(e/n,.6);s(A)};return window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)}),[A]);const I=e=>({animationDelay:100*e+"ms"});return f.jsxs(f.Fragment,{children:[f.jsxs("header",{className:`relative overflow-hidden min-h-[90vh] flex flex-col justify-center ${n}`,children:[f.jsx("div",{className:"absolute inset-0 bg-primary/5 bg-floral-pattern opacity-15 z-0 hardware-accelerated",style:{backgroundSize:"cover",transform:`scale(1.1) translateY(${r}px)`,backgroundPosition:"center",transition:"transform 0.05s linear"}}),f.jsxs("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[f.jsx("div",{className:"absolute top-1/4 left-1/2 -translate-x-1/2 w-96 h-96 rounded-full bg-gradient-radial from-accent/20 to-transparent blur-3xl animate-pulse-slow"}),f.jsx("div",{className:"absolute bottom-1/3 right-1/4 w-80 h-80 rounded-full bg-gradient-radial from-primary/10 to-transparent blur-3xl animate-pulse-slow",style:{animationDelay:"1.5s"}})]}),f.jsx("div",{className:"absolute inset-0 z-0 overflow-hidden",children:[...Array(15)].map(((e,t)=>f.jsx("div",{className:"absolute rounded-full "+(t%3==0?"bg-primary/5":t%3==1?"bg-accent/5":"bg-secondary/5"),style:{width:12*Math.random()+3+"px",height:12*Math.random()+3+"px",top:5+90*Math.random()+"%",left:100*Math.random()+"%",opacity:.4+.6*Math.random(),animation:`float-particle ${5+15*Math.random()}s infinite ease-in-out`,animationDelay:5*Math.random()+"s"}},t)))}),f.jsxs("div",{className:"relative z-10 px-6 py-14 sm:py-20 text-center",style:{opacity:o},children:[f.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-40 opacity-20 animate-float-slow",children:f.jsx("svg",{viewBox:"0 0 100 30",fill:"currentColor",className:"text-primary",children:f.jsx("path",{d:"M50 0C45 10 35 15 25 15C35 15 45 20 50 30C55 20 65 15 75 15C65 15 55 10 50 0Z"})})}),f.jsxs("div",{className:"mb-10",children:[f.jsxs("p",{className:"text-muted font-elegant text-sm sm:text-base tracking-wide reveal-on-scroll "+(A?"is-revealed":""),style:I(0),children:[Te.families.groomFamily," &"," ",Te.families.brideFamily]}),f.jsx("p",{className:"text-primary font-sans text-sm sm:text-base tracking-widest uppercase mt-2 reveal-on-scroll "+(A?"is-revealed":""),style:I(1),children:"VOUS INVITENT AU MARIAGE DE"})]}),f.jsxs("div",{className:"mb-12 relative backdrop-blur-sm bg-white/5 py-8 px-6 rounded-xl shadow-elegant transform transition-all duration-500 hover:shadow-xl",children:[f.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-xl",children:f.jsx("div",{className:"absolute -inset-x-1/4 -top-1/4 w-150 h-150 bg-gradient-conic from-primary/10 via-accent/5 to-primary/10 opacity-70 animate-slow-spin blur-3xl"})}),f.jsx("h1",{className:"font-cursive text-4xl sm:text-5xl md:text-6xl mb-4 select-none reveal-on-scroll "+(A?"is-revealed":""),style:I(2),children:f.jsxs("span",{className:"py-2 px-1 text-primary-dark relative",children:[Te.couple.groom,f.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-primary/50 to-transparent transform"})]})}),f.jsxs("div",{className:"flex items-center justify-center my-4 reveal-on-scroll "+(A?"is-revealed":""),style:I(3),children:[f.jsx("div",{className:"h-px w-16 bg-accent/50"}),f.jsxs("div",{className:"mx-4 text-accent relative",children:[f.jsx("svg",{className:"w-8 h-8 animate-pulse-slow transform hover:scale-110 transition-transform",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),f.jsx("div",{className:"absolute -inset-2 bg-accent/5 rounded-full blur-md animate-pulse-slow"})]}),f.jsx("div",{className:"h-px w-16 bg-accent/50"})]}),f.jsx("h1",{className:"font-cursive text-4xl sm:text-5xl md:text-6xl select-none reveal-on-scroll "+(A?"is-revealed":""),style:I(4),children:f.jsxs("span",{className:"py-2 px-1 text-primary-dark relative",children:[Te.couple.bride,f.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-primary/50 to-transparent transform"})]})})]}),f.jsxs("div",{className:"mb-8 py-5 px-6 mx-auto max-w-sm rounded-lg reveal-on-scroll backdrop-blur-sm bg-gradient-to-r from-white/10 via-white/20 to-white/10 shadow-elegant "+(A?"is-revealed":""),style:I(5),children:[f.jsxs("p",{className:"font-elegant text-xl sm:text-2xl text-primary-dark mb-1",children:["Le ",Te.event.date]}),f.jsxs("p",{className:"text-muted",children:["à ",Te.event.venue]})]}),t&&f.jsx("div",{ref:a,className:"mt-10 p-6 rounded-xl mx-auto max-w-md reveal-on-scroll backdrop-blur-md bg-gradient-to-br from-white/20 to-white/10 shadow-elegant border border-white/10 transform transition-all duration-500 hover:-translate-y-1 hover:shadow-xl "+(g?"is-revealed":""),style:I(6),children:f.jsxs("p",{className:"font-elegant text-sm sm:text-base text-primary-dark italic relative",children:[f.jsx("span",{className:"absolute -top-4 -left-2 text-accent opacity-30 text-3xl",children:"“"}),t.message,f.jsx("span",{className:"absolute -bottom-4 -right-2 text-accent opacity-30 text-3xl",children:"”"})]})}),f.jsx("div",{className:`absolute ${t?"bottom-4 sm:bottom-8":"bottom-8"} left-1/2 transform -translate-x-1/2 mt-12 z-10`,children:f.jsxs("button",{className:"group flex flex-col items-center justify-center text-primary opacity-70 hover:opacity-100 transition-all bg-white/30 backdrop-blur-sm p-2 rounded-full shadow-sm",onClick:()=>document.getElementById("details").scrollIntoView({behavior:"smooth"}),"aria-label":"Défiler vers le bas",children:[f.jsx("span",{className:"text-xs uppercase tracking-widest mb-1 group-hover:transform group-hover:translate-y-1 transition-transform hidden sm:block",children:"Découvrir"}),f.jsxs("div",{className:"relative",children:[f.jsx("svg",{className:"w-7 h-7 sm:w-10 sm:h-10 animate-bounce-slow",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),f.jsx("div",{className:"absolute inset-0 bg-primary/10 rounded-full blur-md opacity-0 group-hover:opacity-100 transition-opacity"})]})]})})]}),f.jsx("style",{children:"\n          .shadow-elegant {\n            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.05);\n          }\n          \n          .hardware-accelerated {\n            transform: translateZ(0);\n            will-change: transform;\n          }\n          \n          @keyframes float-particle {\n            0%, 100% {\n              transform: translateY(0) translateX(0);\n            }\n            50% {\n              transform: translateY(-20px) translateX(10px);\n            }\n          }\n          \n          .animate-float-slow {\n            animation: float 8s ease-in-out infinite;\n          }\n          \n          @keyframes float {\n            0%, 100% {\n              transform: translateY(0) translateX(-50%);\n            }\n            50% {\n              transform: translateY(-10px) translateX(-50%);\n            }\n          }\n          \n          .animate-pulse-slow {\n            animation: pulse 3s ease-in-out infinite;\n          }\n          \n          .animate-bounce-slow {\n            animation: bounce 2s ease-in-out infinite;\n          }\n          \n          .animate-slow-spin {\n            animation: spin 20s linear infinite;\n          }\n          \n          @keyframes pulse {\n            0%, 100% {\n              transform: scale(1);\n            }\n            50% {\n              transform: scale(1.1);\n            }\n          }\n          \n          @keyframes bounce {\n            0%, 100% {\n              transform: translateY(0);\n            }\n            50% {\n              transform: translateY(-10px);\n            }\n          }\n          \n          @keyframes spin {\n            from {\n              transform: rotate(0deg);\n            }\n            to {\n              transform: rotate(360deg);\n            }\n          }\n          \n          .reveal-on-scroll {\n            opacity: 0;\n            transform: translateY(20px);\n            transition: opacity 0.6s ease-out, transform 0.6s ease-out;\n          }\n          \n          .reveal-on-scroll.is-revealed {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        "})]}),l&&f.jsx("div",{className:"py-6 px-4",children:f.jsx("div",{className:"max-w-3xl mx-auto",children:f.jsxs("div",{className:"rounded-2xl shadow-elegant p-6 backdrop-blur-sm border border-white/30 transform transition-all duration-500 hover:shadow-lg",style:{background:`linear-gradient(135deg, ${l.color}15, ${l.color}30)`,borderLeft:`4px solid ${l.color}`},children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4",children:[f.jsxs("h3",{className:"font-elegant text-xl text-primary-dark mb-2 sm:mb-0 relative inline-block",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx("svg",{className:"w-6 h-6 mr-2",fill:"none",stroke:l.color,viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),f.jsxs("span",{style:{color:l.color},children:["Table ",l.name]})]}),f.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-primary/50 to-transparent transform scale-0 group-hover:scale-100 transition-transform duration-500"})]}),f.jsxs("span",{className:"text-sm font-medium px-3 py-1 rounded-full",style:{backgroundColor:`${l.color}20`,color:l.color},children:[l.count," invités"]})]}),f.jsxs("div",{className:"divide-y divide-primary/10",children:[t&&l.invites.map(((e,n)=>e.name.toLowerCase()===t.name.toLowerCase()?f.jsxs("div",{className:"py-3 flex justify-between items-center -mx-3 px-3 rounded-lg",style:{backgroundColor:`${l.color}15`},children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"w-2 h-2 rounded-full mr-3",style:{backgroundColor:l.color}}),f.jsx("span",{className:"text-primary-dark",children:e.name})]}),f.jsxs("span",{className:"text-sm px-2 py-1 rounded-full text-muted",style:{backgroundColor:`${l.color}15`},children:[e.count," ",e.count>1?"personnes":"personne"]})]},n):null)),f.jsx("div",{className:"py-4 text-center mt-3",children:f.jsx("p",{className:"text-muted text-sm italic",children:t?`Vous partagerez cette table avec ${l.count-(t.count||1)} autres invités`:"Informations des invités masquées pour préserver leur confidentialité"})})]})]})})})]})};Oe.propTypes={guestInfo:De.shape({name:De.string.isRequired,count:De.number.isRequired,message:De.string.isRequired,group:De.string}),className:De.string,animated:De.bool};const Pe=({className:t=""})=>{const[n,A]=e.useState("date");return f.jsxs("section",{id:"details",className:`py-16 px-4 ${t} relative overflow-hidden`,children:[f.jsx("div",{className:"absolute -top-40 -right-40 w-96 h-96 rounded-full bg-gradient-radial from-primary/10 to-transparent z-0 blur-3xl"}),f.jsx("div",{className:"absolute bottom-20 -left-20 w-80 h-80 rounded-full bg-gradient-radial from-accent/10 to-transparent z-0 blur-3xl"}),f.jsx("div",{className:"absolute top-1/2 left-1/3 w-60 h-60 rounded-full bg-gradient-radial from-secondary/5 to-transparent z-0 blur-3xl opacity-60"}),f.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[f.jsxs("div",{className:"text-center mb-16 relative",children:[f.jsxs("h2",{className:"font-elegant text-3xl sm:text-4xl text-primary mb-4 relative inline-block",children:["Détails",f.jsx("div",{className:"absolute bottom-0 left-1/2 w-3/4 transform -translate-x-1/2 h-0.5 bg-gradient-to-r from-transparent via-accent to-transparent"})]}),f.jsx("p",{className:"text-muted text-sm max-w-md mx-auto leading-relaxed",children:"Nous serions honorés de votre présence lors de notre célébration"}),f.jsx("div",{className:"flex justify-center mt-8 md:hidden",children:f.jsxs("div",{className:"bg-white rounded-full shadow-elegant p-1.5 inline-flex transform hover:translate-y-px transition-transform",children:[f.jsx("button",{className:"py-2 px-6 rounded-full text-sm font-medium transition-all duration-300 "+("date"===n?"bg-gradient-to-r from-primary to-primary-dark text-white shadow-md":"text-primary-dark/70 hover:bg-primary/5"),onClick:()=>A("date"),children:"Date"}),f.jsx("button",{className:"py-2 px-6 rounded-full text-sm font-medium transition-all duration-300 "+("lieu"===n?"bg-gradient-to-r from-primary to-primary-dark text-white shadow-md":"text-primary-dark/70 hover:bg-primary/5"),onClick:()=>A("lieu"),children:"Lieu"})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[f.jsx("div",{className:"group transform transition-all duration-500 hover:-translate-y-2 "+("lieu"===n?"hidden md:block":""),children:f.jsxs("div",{className:"relative p-6 rounded-2xl bg-gradient-to-b from-white/95 to-white/80 shadow-elegant backdrop-blur-sm border border-white/30 overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 overflow-hidden",children:f.jsx("div",{className:"bg-primary/10 rotate-45 transform origin-bottom-left w-32 h-32 -translate-y-12 translate-x-6"})}),f.jsx("div",{className:"absolute -bottom-16 -left-16 w-32 h-32 rounded-full bg-gradient-radial from-primary/5 to-transparent blur-xl group-hover:opacity-80 transition-opacity"}),f.jsxs("div",{className:"text-center relative z-10",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-18 h-18 rounded-full bg-gradient-to-br from-primary/20 to-primary/30 mb-5 shadow-inner group-hover:scale-110 transition-transform duration-500",children:f.jsx("svg",{className:"w-8 h-8 text-primary transform group-hover:rotate-12 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsxs("h3",{className:"font-elegant text-2xl text-primary-dark mb-4 relative inline-block",children:["Date & Heure",f.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 scale-0 group-hover:scale-100 bg-gradient-to-r from-transparent via-primary/50 to-transparent transition-transform duration-500"})]}),f.jsx("p",{className:"text-primary-dark font-semibold text-xl mb-2 bg-clip-text text-transparent bg-gradient-to-r from-primary to-accent inline-block",children:Te.event.date}),f.jsxs("p",{className:"text-muted",children:["à ",Te.event.time]}),f.jsxs("div",{className:"mt-8 space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/15 flex items-center justify-center",children:f.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f.jsxs("div",{className:"flex flex-col items-start",children:[f.jsx("span",{className:"font-medium text-primary-dark",children:"19h00"}),f.jsx("span",{className:"text-xs text-muted",children:"Accueil des invités"})]})]}),f.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/15 flex items-center justify-center",children:f.jsx("svg",{className:"w-5 h-5 text-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.701 2.701 0 00-1.5-.454M9 6v2m3-2v2m3-2v2M9 3h.01M12 3h.01M15 3h.01M21 21v-7a2 2 0 00-2-2H5a2 2 0 00-2 2v7h18zm-3-9v-2a2 2 0 00-2-2H8a2 2 0 00-2 2v2h12z"})})}),f.jsxs("div",{className:"flex flex-col items-start",children:[f.jsx("span",{className:"font-medium text-primary-dark",children:"19h30"}),f.jsx("span",{className:"text-xs text-muted",children:"Début de la cérémonie"})]})]})]}),f.jsx("div",{className:"mt-8 bg-primary/5 rounded-xl p-5 border-l-2 border-primary/40 text-left",children:f.jsxs("div",{className:"flex",children:[f.jsx("svg",{className:"w-5 h-5 text-primary/70 mr-2 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-primary-dark font-medium",children:"Arrivée recommandée à partir de 19h"}),f.jsx("p",{className:"text-xs text-muted mt-1",children:"Merci d'arriver à l'avance pour faciliter l'organisation"})]})]})})]})]})}),f.jsx("div",{className:"group transform transition-all duration-500 hover:-translate-y-2 "+("date"===n?"hidden md:block":""),children:f.jsxs("div",{className:"relative p-6 rounded-2xl bg-gradient-to-b from-white/95 to-white/80 shadow-elegant backdrop-blur-sm border border-white/30 overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 overflow-hidden",children:f.jsx("div",{className:"bg-primary/10 rotate-45 transform origin-bottom-left w-32 h-32 -translate-y-12 translate-x-6"})}),f.jsx("div",{className:"absolute -bottom-16 -left-16 w-32 h-32 rounded-full bg-gradient-radial from-accent/5 to-transparent blur-xl group-hover:opacity-80 transition-opacity"}),f.jsxs("div",{className:"text-center relative z-10",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-18 h-18 rounded-full bg-gradient-to-br from-primary/20 to-primary/30 mb-5 shadow-inner group-hover:scale-110 transition-transform duration-500",children:f.jsxs("svg",{className:"w-8 h-8 text-primary transform group-hover:rotate-12 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),f.jsxs("h3",{className:"font-elegant text-2xl text-primary-dark mb-4 relative inline-block",children:["Lieu",f.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 scale-0 group-hover:scale-100 bg-gradient-to-r from-transparent via-primary/50 to-transparent transition-transform duration-500"})]}),f.jsx("p",{className:"text-primary-dark font-semibold text-xl mb-2 bg-clip-text text-transparent bg-gradient-to-r from-primary to-accent inline-block",children:Te.event.venue}),f.jsx("p",{className:"text-muted mb-1",children:Te.event.address}),f.jsxs("p",{className:"text-sm text-muted",children:[Te.event.location,", ",Te.event.city]}),f.jsxs("div",{className:"flex justify-center gap-4 mt-5",children:[f.jsx("button",{className:"flex items-center justify-center w-11 h-11 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors transform hover:scale-110 transition-transform","aria-label":"Voir sur la carte",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),f.jsx("button",{className:"flex items-center justify-center w-11 h-11 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors transform hover:scale-110 transition-transform","aria-label":"Itinéraire Google Maps",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})})}),f.jsx("button",{className:"flex items-center justify-center w-11 h-11 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors transform hover:scale-110 transition-transform","aria-label":"Partager le lieu",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]}),f.jsx("div",{className:"mt-8 bg-primary/5 rounded-xl p-5 border-l-2 border-primary/40",children:f.jsxs("div",{className:"flex items-start",children:[f.jsx("svg",{className:"w-5 h-5 text-primary/70 mr-2 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),f.jsxs("div",{className:"text-left",children:[f.jsxs("p",{className:"text-sm text-primary-dark",children:[f.jsx("span",{className:"font-medium",children:"Référence :"})," ",Te.event.reference]}),f.jsx("p",{className:"text-xs text-muted mt-1",children:"Parking disponible sur place"})]})]})})]})]})})]}),f.jsxs("div",{className:"text-center mt-16 max-w-2xl mx-auto",children:[f.jsxs("div",{className:"p-8 rounded-2xl bg-gradient-to-br from-white/95 to-white/80 shadow-elegant backdrop-blur-sm border border-white/30 transform transition-all duration-500 hover:shadow-lg relative overflow-hidden",children:[f.jsx("div",{className:"absolute -inset-px bg-grid-pattern opacity-5"}),f.jsx("div",{className:"absolute top-0 right-0 -mt-8 -mr-8 w-32 h-32 rounded-full bg-gradient-radial from-primary/5 to-transparent blur-xl"}),f.jsx("div",{className:"absolute bottom-0 left-0 -mb-8 -ml-8 w-32 h-32 rounded-full bg-gradient-radial from-accent/5 to-transparent blur-xl"}),f.jsxs("div",{className:"relative",children:[f.jsx("svg",{className:"w-8 h-8 text-primary/40 mx-auto mb-4",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),f.jsx("p",{className:"text-primary-dark font-elegant text-xl italic leading-relaxed",children:Te.welcomeMessage})]})]}),f.jsx("div",{className:"mt-14 relative",children:f.jsxs("div",{className:"inline-block bg-gradient-to-b from-white/95 to-white/80 px-10 py-6 rounded-2xl shadow-elegant border border-white/30 transform transition-all duration-500 hover:shadow-lg backdrop-blur-sm",children:[f.jsx("div",{className:"absolute top-0 -mt-4 left-1/2 transform -translate-x-1/2 bg-primary/80 text-white text-xs uppercase tracking-widest py-1 px-4 rounded-full shadow-md",children:"Dress Code"}),f.jsx("p",{className:"text-primary-dark text-lg font-medium mt-3",children:Te.dressCode}),f.jsxs("div",{className:"flex justify-center gap-4 mt-5",children:[f.jsx("span",{className:"w-5 h-5 rounded-full bg-primary/40 transition-all duration-300 hover:scale-125 hover:bg-primary/60"}),f.jsx("span",{className:"w-5 h-5 rounded-full bg-accent/40 transition-all duration-300 hover:scale-125 hover:bg-accent/60"}),f.jsx("span",{className:"w-5 h-5 rounded-full bg-secondary/40 transition-all duration-300 hover:scale-125 hover:bg-secondary/60"})]})]})})]})]}),f.jsx("style",{children:"\n        .shadow-elegant {\n          box-shadow: 0 10px 40px -5px rgba(0, 0, 0, 0.08);\n        }\n        \n        .shadow-inner {\n          box-shadow: inset 0 2px 6px 0 rgba(0, 0, 0, 0.05);\n        }\n        \n        .bg-grid-pattern {\n          background-image: linear-gradient(to right, rgba(0,0,0,0.05) 1px, transparent 1px),\n                            linear-gradient(to bottom, rgba(0,0,0,0.05) 1px, transparent 1px);\n          background-size: 20px 20px;\n        }\n      "})]})};Pe.propTypes={className:De.string};const _e=({className:t=""})=>{const[n,A]=e.useState(null),[r,i]=e.useState(!1),o=e.useRef(null);return e.useEffect((()=>{Te&&Te.schedule&&Te.schedule.forEach(((e,t)=>{0===t&&A(e.time)}))}),[]),e.useEffect((()=>{const e=new IntersectionObserver((([e])=>{i(e.isIntersecting)}),{threshold:.2});return o.current&&e.observe(o.current),()=>{o.current&&e.unobserve(o.current)}}),[]),f.jsxs("section",{id:"programme",ref:o,className:`py-16 px-4 ${t} relative overflow-hidden`,children:[f.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-br from-white/90 to-white/95"}),f.jsx("div",{className:"absolute -top-40 -right-40 w-96 h-96 rounded-full bg-gradient-radial from-primary/10 to-transparent z-0 blur-3xl"}),f.jsx("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 rounded-full bg-gradient-radial from-accent/10 to-transparent z-0 blur-3xl"}),f.jsx("div",{className:"absolute top-1/3 right-1/4 w-64 h-64 rounded-full bg-gradient-radial from-secondary/5 to-transparent z-0 blur-3xl opacity-60"}),f.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-[0.03] z-0"}),f.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[f.jsxs("div",{className:"text-center mb-16 transition-all duration-1000 "+(r?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-10"),children:[f.jsxs("h2",{className:"font-elegant text-3xl sm:text-4xl text-primary mb-4 relative inline-block",children:["Programme",f.jsx("div",{className:"absolute bottom-0 left-1/2 w-3/4 transform -translate-x-1/2 h-0.5 bg-gradient-to-r from-transparent via-accent to-transparent"})]}),f.jsx("p",{className:"text-muted text-sm max-w-md mx-auto leading-relaxed",children:"Découvrez les moments clés de notre célébration"})]}),f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"block md:hidden w-full",children:f.jsxs("div",{className:"relative py-5 transition-all duration-1000 "+(r?"opacity-100":"opacity-0"),children:[f.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-primary/30 via-accent/40 to-primary/30 rounded-full"}),Te.schedule.map(((e,t)=>f.jsxs("div",{className:"relative mb-12 last:mb-0 transition-all duration-500 "+(n===e.time?"scale-100 opacity-100":"scale-95 opacity-70"),children:[f.jsxs("div",{className:"absolute left-4 w-8 h-8 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center cursor-pointer z-20",onClick:()=>A(e.time),children:[f.jsx("span",{className:"w-3 h-3 rounded-full "+(n===e.time?"bg-accent animate-pulse-ring":"bg-primary/40")}),f.jsx("span",{className:"absolute w-8 h-8 rounded-full "+(n===e.time?"border-2 border-accent/40":"border border-primary/20")})]}),f.jsxs("div",{className:"ml-12 p-5 rounded-xl backdrop-blur-sm border border-white/50 shadow-elegant transition-all duration-500 transform hover:-translate-y-1 hover:shadow-xl "+(n===e.time?"bg-gradient-to-br from-white/90 to-white/80 border-accent/20":"bg-white/70"),onClick:()=>A(e.time),children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"font-elegant text-xl text-primary-dark",children:e.time}),f.jsx("span",{className:"text-xs rounded-full px-3 py-1 "+(n===e.time?"bg-accent/10 text-accent":"bg-primary/5 text-primary/70"),children:0===t?"Début":t===Te.schedule.length-1?"Fin":`Étape ${t+1}`})]}),f.jsx("h3",{className:"font-medium text-lg text-primary-dark mb-2",children:e.title}),f.jsx("p",{className:"text-muted text-sm",children:e.description})]})]},e.time)))]})}),f.jsx("div",{className:"hidden md:block w-full",children:f.jsxs("div",{className:"relative transition-all duration-1000 "+(r?"opacity-100":"opacity-0"),children:[f.jsx("div",{className:"absolute top-12 left-0 right-0 h-1 bg-gradient-to-r from-primary/30 via-accent/40 to-primary/30 rounded-full"}),f.jsx("div",{className:"flex justify-between relative",children:Te.schedule.map(((e,t)=>f.jsxs("div",{className:`w-1/${Te.schedule.length} px-2 transition-all duration-500 ${n===e.time?"opacity-100":"opacity-70"}`,children:[f.jsxs("div",{className:"relative mx-auto w-8 h-8 flex items-center justify-center cursor-pointer z-20",onClick:()=>A(e.time),children:[f.jsx("span",{className:"w-3 h-3 rounded-full "+(n===e.time?"bg-accent animate-pulse-ring":"bg-primary/40")}),f.jsx("span",{className:"absolute w-8 h-8 rounded-full "+(n===e.time?"border-2 border-accent/40":"border border-primary/20")})]}),f.jsx("div",{className:"text-center mb-8 mt-2",onClick:()=>A(e.time),children:f.jsx("span",{className:"font-medium "+(n===e.time?"text-accent":"text-primary/70"),children:e.time})}),f.jsxs("div",{className:"p-5 rounded-xl backdrop-blur-sm transition-all duration-500 transform hover:-translate-y-1 hover:shadow-xl cursor-pointer border border-white/50 shadow-elegant "+(n===e.time?"bg-gradient-to-br from-white/90 to-white/80 border-accent/20":"bg-white/70"),onClick:()=>A(e.time),children:[f.jsx("span",{className:"text-xs rounded-full px-3 py-1 mb-3 inline-block "+(n===e.time?"bg-accent/10 text-accent":"bg-primary/5 text-primary/70"),children:0===t?"Début":t===Te.schedule.length-1?"Fin":`Étape ${t+1}`}),f.jsx("h3",{className:"font-medium text-lg text-primary-dark mb-2",children:e.title}),f.jsx("p",{className:"text-muted text-sm",children:e.description})]})]},e.time)))})]})}),f.jsx("div",{className:"mt-16 max-w-2xl mx-auto text-center transition-all duration-1000 delay-300 "+(r?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-10"),children:f.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-white/95 to-white/80 shadow-elegant backdrop-blur-sm border border-white/30 transform transition-all duration-500 hover:shadow-lg relative overflow-hidden",children:[f.jsx("div",{className:"absolute -inset-px bg-grid-pattern opacity-5"}),f.jsx("div",{className:"absolute top-0 right-0 -mt-8 -mr-8 w-32 h-32 rounded-full bg-gradient-radial from-primary/5 to-transparent blur-xl"}),f.jsx("div",{className:"absolute bottom-0 left-0 -mb-8 -ml-8 w-32 h-32 rounded-full bg-gradient-radial from-accent/5 to-transparent blur-xl"}),f.jsxs("div",{className:"relative",children:[f.jsx("svg",{className:"w-8 h-8 text-primary/40 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsx("p",{className:"text-primary-dark font-elegant text-xl italic leading-relaxed",children:"Nous vous invitons à respecter les horaires pour que cette journée soit aussi parfaite pour vous que pour nous."}),f.jsx("div",{className:"mt-6 flex justify-center",children:f.jsxs("a",{href:"#details",className:"inline-flex items-center px-5 py-2 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors group",children:[f.jsx("svg",{className:"w-4 h-4 mr-2 group-hover:animate-bounce",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Voir plus de détails"]})})]})]})})]})]}),f.jsx("style",{jsx:!0,children:"\n        .shadow-elegant {\n          box-shadow: 0 10px 40px -5px rgba(0, 0, 0, 0.08);\n        }\n\n        .bg-grid-pattern {\n          background-image: linear-gradient(\n              to right,\n              rgba(0, 0, 0, 0.05) 1px,\n              transparent 1px\n            ),\n            linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);\n          background-size: 20px 20px;\n        }\n\n        @keyframes pulse-ring {\n          0% {\n            box-shadow: 0 0 0 0 rgba(var(--color-accent-rgb), 0.7);\n          }\n          70% {\n            box-shadow: 0 0 0 6px rgba(var(--color-accent-rgb), 0);\n          }\n          100% {\n            box-shadow: 0 0 0 0 rgba(var(--color-accent-rgb), 0);\n          }\n        }\n\n        .animate-pulse-ring {\n          animation: pulse-ring 2s infinite;\n        }\n      "})]})};_e.propTypes={className:De.string};const je=({children:e,variant:t="primary",size:n="md",className:A="",onClick:r,disabled:i=!1,fullWidth:o=!1,type:s="button",icon:a=null,iconPosition:g="left"})=>{const l={primary:"bg-primary text-white hover:bg-primary-dark focus:ring-primary-light",secondary:"bg-secondary text-primary hover:bg-gray-100 focus:ring-secondary",outline:"border border-primary text-primary hover:bg-primary hover:bg-opacity-10 focus:ring-primary",text:"text-primary hover:bg-gray-100 hover:bg-opacity-20 focus:ring-primary",accent:"bg-accent text-white hover:bg-accent/90 focus:ring-accent/50",danger:"bg-danger text-white hover:bg-danger/90 focus:ring-danger/50",success:"bg-success text-white hover:bg-success/90 focus:ring-success/50"},c={sm:"text-xs py-2 px-3",md:"text-sm py-2.5 px-4",lg:"text-base py-3 px-5"},I=`\n    inline-flex items-center justify-center rounded-lg font-medium transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2\n    ${l[t]||l.primary}\n    ${c[n]||c.md}\n    ${i?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n    ${o?"w-full":""}\n    ${A}\n  `.trim();return f.jsxs("button",{type:s,className:I,onClick:r,disabled:i,children:[a&&"left"===g&&f.jsx("span",{className:"mr-2",children:a}),e,a&&"right"===g&&f.jsx("span",{className:"ml-2",children:a})]})};je.propTypes={children:De.node.isRequired,variant:De.oneOf(["primary","secondary","outline","text","accent","danger","success"]),size:De.oneOf(["sm","md","lg"]),className:De.string,onClick:De.func,disabled:De.bool,fullWidth:De.bool,type:De.oneOf(["button","submit","reset"]),icon:De.node,iconPosition:De.oneOf(["left","right"])};const qe=({children:e,animation:t="fade-up",threshold:n=.1,rootMargin:A="0px",once:r=!0,delay:i=0,className:o=""})=>{const[s,a]=ze({threshold:n,rootMargin:A,triggerOnce:r});return f.jsx("div",{ref:s,className:`transition-all duration-700 ease-out ${o} ${(()=>{switch(t){case"fade-up":return"opacity-0 translate-y-6";case"fade-down":return"opacity-0 -translate-y-6";case"fade-left":return"opacity-0 translate-x-6";case"fade-right":return"opacity-0 -translate-x-6";case"zoom-in":return"opacity-0 scale-95";case"zoom-out":return"opacity-0 scale-105";default:return"opacity-0"}})()}`,style:{transform:a?"translate(0, 0) scale(1)":void 0,opacity:a?1:0,transitionDelay:`${i}ms`},children:e})};qe.propTypes={children:De.node.isRequired,animation:De.oneOf(["fade-up","fade-down","fade-left","fade-right","zoom-in","zoom-out","fade"]),threshold:De.number,rootMargin:De.string,once:De.bool,delay:De.number,className:De.string};const $e=({src:t,title:n="Google Maps",className:A="",iframeClassName:r="",lazyLoad:i=!0,onLoad:o,onError:s})=>{const[a,g]=e.useState(!0),[l,c]=e.useState(!1),[I,C]=e.useState(!i),[u,d]=e.useState(0),h=e.useRef(null),m=`map-container-${n.replace(/\s+/g,"-").toLowerCase()}`;e.useEffect((()=>{if(!i)return;const e=new IntersectionObserver((t=>{t[0].isIntersecting&&(C(!0),e.disconnect())}),{threshold:.1,rootMargin:"300px"}),t=document.getElementById(m);return t&&e.observe(t),()=>{t&&e.disconnect()}}),[i,m]);return f.jsxs("div",{id:m,className:`relative ${A}`,ref:h,children:[I&&f.jsx("iframe",{src:t,title:n,className:`border-0 ${r}`,allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",onLoad:()=>{g(!1),o&&o()},onError:()=>{c(!0),g(!1),s&&s(),u<3&&(d((e=>e+1)),setTimeout((()=>{C(!0),g(!0),c(!1)}),2e3*(u+1)))}}),a&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:f.jsxs("div",{className:"flex flex-col items-center",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mb-3"}),f.jsx("p",{className:"text-sm text-primary-dark animate-pulse",children:"Chargement de la carte..."})]})}),l&&u>=3&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:f.jsxs("div",{className:"text-center p-4",children:[f.jsx("p",{className:"text-red-500 mb-2",children:"Impossible de charger la carte"}),f.jsx("button",{onClick:()=>{d(0),C(!0),g(!0),c(!1)},className:"text-primary hover:text-primary-dark underline",children:"Réessayer"})]})})]})};$e.propTypes={src:De.string.isRequired,title:De.string,className:De.string,iframeClassName:De.string,lazyLoad:De.bool,onLoad:De.func,onError:De.func};const et={lat:"-4.349492299999992",lng:"15.284177500000002",name:"Inga",city:"Kinshasa",country:"RD Congo"},tt="https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&q=Inga,Kinshasa&zoom=13&maptype=roadmap",nt=e=>{const t=encodeURIComponent(`${e.name} - ${e.address}`),{lat:n,lng:A}=et;return{googleMaps:`https://www.google.com/maps/dir/?api=1&destination=${n},${A}&travelmode=driving&dir_action=navigate`,yango:`https://yango.go.link/route?end-lat=${n}&end-lon=${A}&ref=weddingapp&adj_t=vokme8e_nd9s9z9&lang=fr&adj_deeplink_js=1&adj_fallback=https%3A%2F%2Fyango.com%2Ffr_int%2Forder%2F%3Fgto%3D${A}%2C${n}%26ref%3Dweddingapp`,appleMaps:`https://maps.apple.com/?daddr=${n},${A}&dirflg=d&t=m`,uber:`https://m.uber.com/ul/?action=setPickup&pickup=my_location&dropoff[latitude]=${n}&dropoff[longitude]=${A}&dropoff[nickname]=${t}`}},At=({className:t=""})=>{const[n,A]=e.useState(!1),r=nt(Te.event);return f.jsx("div",{className:`mt-6 ${t}`,children:f.jsxs(qe,{animation:"fade-up",delay:100,children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsx("h4",{className:"font-elegant text-xl text-primary-dark",children:"Options de navigation"}),f.jsx("button",{className:"text-primary text-sm underline",onClick:()=>A(!n),children:n?"Masquer les détails":"Plus d&apos;options"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[f.jsxs("a",{href:r.googleMaps,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-white p-3 rounded-lg shadow-soft text-primary-dark hover:bg-highlight transition-colors",children:[f.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/bd/Google_Maps_Logo_2020.svg/512px-Google_Maps_Logo_2020.svg.png",alt:"Google Maps",className:"h-5"}),f.jsx("span",{className:"font-medium text-sm",children:"Google Maps"})]}),f.jsxs("a",{href:r.yango,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-white p-3 rounded-lg shadow-soft text-primary-dark hover:bg-highlight transition-colors",children:[f.jsxs("svg",{className:"w-5 h-5 text-[#FF0033]",viewBox:"0 0 24 24",fill:"currentColor",children:[f.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),f.jsx("path",{d:"M11 7h2v7h-2zm-1 8h4v2h-4z"})]}),f.jsx("span",{className:"font-medium text-sm",children:"Yango"})]})]}),n&&f.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-soft space-y-4 animate-fade-in",children:[f.jsxs("div",{children:[f.jsx("h5",{className:"text-primary-dark font-medium text-sm mb-2",children:"Autres services"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("a",{href:r.appleMaps,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 rounded border border-primary/10 hover:bg-primary/5",children:[f.jsx("svg",{className:"w-4 h-4 text-primary",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12.2 0c.59 0 1.49.16 2.4.46 1.35.45 2.53 1.33 3.34 2.44.52.71.92 1.55 1.16 2.43 0 0-2.41.84-2.39 3.05 0 2.44 2.14 3.27 2.14 3.27-.14.46-.35.98-.63 1.5-.42.77-.96 1.57-1.67 1.57-.7 0-.94-.44-1.74-.44-.8 0-1.06.44-1.74.44-.7 0-1.24-.8-1.67-1.56-.73-1.33-1.27-3.32-1.27-5.27 0-3.07 2-4.67 3.83-4.67.95 0 1.69.44 2.24.44.55 0 1.32-.44 2.24-.44.35 0 .94.09 1.57.29-1.33.7-2.24 2.09-2.24 3.67 0 1.77.99 3.18 2.43 3.87-.43 1.27-1.09 2.5-1.9 3.39M8.37 24c1.2 0 1.71-1.88 3.11-1.88 1.4 0 2.8 1.88 3.05 1.88.1 0 .21-.02.21-.12 0-.11-.24-.67-.37-.9-.12-.23-.23-.37-.32-.62-.96-2.58-.56-3.12-.1-4.95.45-1.73 2.2-3.01 2.2-3.01 0-.02-.06-.04-.06-.04-.37.05-.76.14-1.08.27-.33.13-.7.3-1 .3-.33 0-.71-.17-1.13-.25-.42-.08-.86-.15-1.18-.15-2.69 0-4.5 2.88-4.5 5.83 0 1.17.22 2.13.49 2.79.26.67.67.85.68.85"})}),f.jsx("span",{className:"text-xs",children:"Apple Plans"})]}),f.jsxs("a",{href:r.uber,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 rounded border border-primary/10 hover:bg-primary/5",children:[f.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 0C5.37 0 0 5.37 0 12s5.37 12 12 12 12-5.37 12-12S18.63 0 12 0zm0 22c-5.52 0-10-4.48-10-10S6.48 2 12 2s10 4.48 10 10-4.48 10-10 10zm4.59-16H7.42c-.32 0-.59.26-.59.58v8.84c0 .32.26.58.58.58h9.17c.33 0 .59-.26.59-.58V6.58c0-.32-.26-.58-.58-.58zM11 14.8v-3.38c0-.28.24-.42.5-.28l2.92 1.7c.26.14.26.44.02.59l-2.92 1.7c-.28.14-.52-.02-.52-.33z"})}),f.jsx("span",{className:"text-xs",children:"Uber"})]})]})]}),f.jsxs("div",{children:[f.jsx("h5",{className:"text-primary-dark font-medium text-sm mb-2",children:"Transport public"}),f.jsx("p",{className:"text-muted text-xs",children:'Plusieurs lignes de bus desservent la zone. Descendez à l\'arrêt "Terrain Municipal" et marchez environ 5 minutes.'})]}),f.jsxs("div",{children:[f.jsx("h5",{className:"text-primary-dark font-medium text-sm mb-2",children:"Parking"}),f.jsx("p",{className:"text-muted text-xs",children:"Un parking gratuit est disponible sur place avec environ 50 places. Des parkings payants se trouvent également à proximité (environ 2000 FC pour la journée)."})]}),f.jsxs("div",{children:[f.jsx("h5",{className:"text-primary-dark font-medium text-sm mb-2",children:"Contact venue"}),f.jsx("a",{href:"tel:+243123456789",className:"text-primary text-xs underline",children:"+243 12 345 6789"})]}),f.jsx(je,{variant:"outline",size:"sm",onClick:()=>A(!1),className:"w-full mt-2",children:"Masquer les détails"})]})]})})};At.propTypes={className:De.string};const rt=({className:t=""})=>{const n=nt(Te.event),A=((e,t)=>{const{lat:n,lng:A,name:r,city:i,country:o}=et;return`https://wa.me/?text=${encodeURIComponent(`📍 Lieu du mariage de ${t.groom} et ${t.bride}:\n\n${r}, ${e.address}\n${i}, ${o}\n\n🗺️ Itinéraire: https://www.google.com/maps/dir/?api=1&destination=${n},${A}&travelmode=driving`)}`})(Te.event,Te.couple),r=e.useRef(null),[i,o]=e.useState(0),[s,a]=e.useState(!1),[g,l]=e.useState(null),[c,I]=e.useState(!1);e.useEffect((()=>{const e=()=>{if(!r.current)return;const{top:e}=r.current.getBoundingClientRect(),t=window.innerHeight,n=(t-e)/t;n>0&&n<1.5&&o(40*n)};return window.addEventListener("scroll",e,{passive:!0}),e(),()=>{window.removeEventListener("scroll",e)}}),[]);return f.jsxs("section",{id:"lieu",ref:r,className:`py-16 px-4 ${t} relative overflow-hidden`,children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/80 to-white/95 z-0"}),f.jsx("div",{className:"absolute -top-20 -right-20 w-80 h-80 rounded-full bg-gradient-radial from-primary/10 to-transparent blur-3xl z-0",style:{transform:`translate3d(${.8*i}px, ${-.5*i}px, 0)`,transition:"transform 0.2s ease-out",opacity:.7}}),f.jsx("div",{className:"absolute -bottom-40 -left-20 w-96 h-96 rounded-full bg-gradient-radial from-accent/10 to-transparent blur-3xl z-0",style:{transform:`translate3d(${-.6*i}px, ${.4*i}px, 0)`,transition:"transform 0.2s ease-out",opacity:.6}}),f.jsx("div",{className:"absolute top-1/3 left-1/4 w-32 h-32 rounded-full bg-gradient-radial from-secondary/10 to-transparent blur-2xl z-0",style:{transform:`translate3d(${1.2*i}px, ${.7*i}px, 0)`,transition:"transform 0.15s ease-out",opacity:.4}}),f.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-[0.03] z-0"}),f.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[f.jsx(qe,{animation:"fade-up",children:f.jsxs("div",{className:"text-center mb-14",children:[f.jsxs("h2",{className:"font-elegant text-3xl sm:text-4xl text-primary mb-4 relative inline-block",children:["Localisation",f.jsx("div",{className:"absolute bottom-0 left-1/2 w-3/4 transform -translate-x-1/2 h-0.5 bg-gradient-to-r from-transparent via-accent to-transparent"})]}),f.jsx("p",{className:"text-muted text-sm max-w-md mx-auto",children:"Retrouvez-nous facilement grâce à la carte interactive"})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-8",children:[f.jsxs(qe,{animation:"fade-right",className:"md:col-span-3 "+(c?"md:col-span-5":""),children:[f.jsxs("div",{className:`relative rounded-2xl overflow-hidden shadow-elegant transition-all duration-700 ${c?"h-[500px] z-50":"h-[300px] sm:h-[350px] md:h-[400px]"} ${s?"opacity-100":"opacity-80"}`,children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/5 to-transparent pointer-events-none z-10"}),f.jsx("div",{className:"absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-white/20 to-transparent pointer-events-none z-10"}),!s&&f.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/60 backdrop-blur-sm z-20",children:[f.jsxs("div",{className:"w-16 h-16 mb-4 relative",children:[f.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-primary/20"}),f.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-primary animate-spin"})]}),f.jsx("p",{className:"text-sm text-primary-dark animate-pulse",children:"Chargement de la carte..."})]}),f.jsx($e,{src:tt,title:"Carte du lieu de mariage",className:"w-full h-full",onLoad:()=>a(!0),onError:()=>{a(!0)},iframeClassName:"w-full h-full",lazyLoad:!0}),f.jsxs("button",{className:"absolute bottom-4 right-4 bg-white/90 hover:bg-white px-3 py-2 rounded-lg shadow-md text-primary-dark text-sm flex items-center transform transition-all duration-300 hover:scale-105 hover:shadow-lg backdrop-blur-sm z-20 group",onClick:()=>{I(!c)},children:[f.jsx("svg",{className:"w-4 h-4 mr-2 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{transform:c?"rotate(180deg)":"rotate(0deg)"},children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"})}),c?"Réduire":"Agrandir",f.jsx("span",{className:"absolute inset-0 rounded-lg bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]}),f.jsx("div",{className:"mt-5 block md:hidden "+(c?"hidden":""),children:f.jsx(At,{className:"rounded-xl bg-white/80 backdrop-blur-sm shadow-elegant p-4 border border-white/30"})})]}),f.jsx(qe,{animation:"fade-left",className:"md:col-span-2 "+(c?"hidden":""),children:f.jsxs("div",{className:"flex flex-col justify-between h-full bg-gradient-to-b from-white/95 to-white/80 p-6 rounded-2xl shadow-elegant backdrop-blur-sm border border-white/30",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-elegant text-2xl text-primary-dark mb-4 relative inline-block",children:[Te.event.venue,f.jsx("span",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-primary/50 to-transparent"})]}),f.jsx("p",{className:"text-primary-dark font-medium mb-2",children:Te.event.address}),f.jsxs("p",{className:"text-muted text-sm mb-6",children:[Te.event.location,", ",Te.event.city]}),f.jsxs("div",{className:"bg-primary/5 p-5 rounded-xl mb-6 border-l-2 border-primary/30",children:[f.jsxs("h4",{className:"font-medium text-primary-dark mb-4 flex items-center",children:[f.jsx("svg",{className:"w-5 h-5 mr-2 text-primary/70",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Informations pratiques"]}),f.jsxs("ul",{className:"text-muted text-sm space-y-3",children:[f.jsxs("li",{className:"flex items-start group cursor-default",children:[f.jsx("div",{className:"w-7 h-7 rounded-full bg-primary/10 flex items-center justify-center mr-3 flex-shrink-0 transform transition-all duration-300 group-hover:scale-110 group-hover:bg-primary/20",children:f.jsx("svg",{className:"w-4 h-4 text-primary transform transition-all duration-300 group-hover:rotate-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),f.jsx("span",{className:"transform transition-all duration-300 group-hover:translate-x-1",children:"Parking disponible à proximité"})]}),f.jsxs("li",{className:"flex items-start group cursor-default",children:[f.jsx("div",{className:"w-7 h-7 rounded-full bg-primary/10 flex items-center justify-center mr-3 flex-shrink-0 transform transition-all duration-300 group-hover:scale-110 group-hover:bg-primary/20",children:f.jsx("svg",{className:"w-4 h-4 text-primary transform transition-all duration-300 group-hover:rotate-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),f.jsxs("span",{className:"transform transition-all duration-300 group-hover:translate-x-1",children:["Référence: ",Te.event.reference]})]}),f.jsxs("li",{className:"flex items-start group cursor-default",children:[f.jsx("div",{className:"w-7 h-7 rounded-full bg-primary/10 flex items-center justify-center mr-3 flex-shrink-0 transform transition-all duration-300 group-hover:scale-110 group-hover:bg-primary/20",children:f.jsx("svg",{className:"w-4 h-4 text-primary transform transition-all duration-300 group-hover:rotate-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),f.jsx("span",{className:"transform transition-all duration-300 group-hover:translate-x-1",children:"Accessible aux personnes à mobilité réduite"})]})]})]}),f.jsx("div",{className:"hidden md:block",children:f.jsx(At,{className:"rounded-xl bg-gradient-to-r from-white/40 to-white/60 backdrop-blur-sm shadow-sm p-4"})})]}),f.jsxs("div",{className:"space-y-3 mt-6",children:[f.jsx(je,{variant:"primary",fullWidth:!0,icon:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),onClick:()=>{l("navigate"),window.open(n.googleMaps,"_blank"),setTimeout((()=>l(null)),2e3)},className:"transform transition-all duration-500 hover:-translate-y-1 hover:shadow-lg "+("navigate"===g?"pulse-once bg-primary-dark":""),children:"Obtenir l'itinéraire"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx(je,{variant:"outline",icon:f.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M17.498 14.382c-.301-.15-1.767-.867-2.04-.966-.273-.101-.473-.151-.673.15-.197.295-.771.964-.944 1.162-.175.195-.349.21-.646.075-.3-.15-1.263-.465-2.403-1.485-.888-.795-1.484-1.77-1.66-2.07-.174-.3-.019-.465.13-.615.136-.135.301-.345.451-.523.146-.181.194-.301.297-.496.1-.21.049-.375-.025-.524-.075-.15-.672-1.62-.922-2.206-.24-.584-.487-.51-.672-.51-.172-.015-.371-.015-.571-.015-.2 0-.523.074-.797.359-.273.3-1.045 1.02-1.045 2.475s1.07 2.865 1.219 3.075c.149.195 2.105 3.195 5.1 4.485.714.3 1.27.48 1.704.629.714.227 1.365.195 1.88.121.574-.091 1.767-.721 2.016-1.426.255-.705.255-1.29.18-1.425-.074-.135-.27-.21-.57-.345M12 21.594c-1.349 0-2.68-.213-3.934-.638l-.285-.135-2.91.776.791-2.891-.149-.294a10.856 10.856 0 01-.69-3.996c0-6.01 4.935-10.897 10.989-10.897 2.94 0 5.7 1.15 7.769 3.223a10.816 10.816 0 013.234 7.75c0 6.011-4.935 10.904-10.989 10.904M20.415 3.549a12.987 12.987 0 00-9.245-3.829C4.91-.27-.085 8.816-.085 19.201c0 2.146.42 4.246 1.235 6.204l-1.485 5.406 5.55-1.441c1.875.713 3.906 1.095 5.97 1.095 6.259 0 11.255-9.086 11.255-19.472 0-3.465-1.35-6.769-3.786-9.241"})}),onClick:()=>{l("share"),window.open(A,"_blank"),setTimeout((()=>l(null)),2e3)},className:"transform transition-all duration-500 hover:-translate-y-1 hover:shadow-lg "+("share"===g?"pulse-once text-green-600 border-green-300 bg-green-50":""),children:"Partager"}),f.jsx(je,{variant:"outline",icon:"copy"===g?f.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),onClick:()=>{l("copy");const e=`${Te.event.venue}, ${Te.event.address}, ${Te.event.city}`;navigator.clipboard.writeText(e).then((()=>{setTimeout((()=>l(null)),2e3)})).catch((e=>{setTimeout((()=>l(null)),2e3)}))},className:"transform transition-all duration-500 hover:-translate-y-1 hover:shadow-lg "+("copy"===g?"text-green-600 border-green-300 bg-green-50":""),children:"copy"===g?"Copié !":"Copier"})]})]})]})})]})]}),f.jsx("style",{children:"\n        .shadow-elegant {\n          box-shadow: 0 10px 40px -5px rgba(0, 0, 0, 0.08);\n        }\n        \n        .bg-grid-pattern {\n          background-image: linear-gradient(to right, rgba(0,0,0,0.05) 1px, transparent 1px),\n                            linear-gradient(to bottom, rgba(0,0,0,0.05) 1px, transparent 1px);\n          background-size: 20px 20px;\n        }\n        \n        @keyframes pulse-animation {\n          0% {\n            box-shadow: 0 0 0 0 rgba(var(--color-primary-rgb), 0.7);\n          }\n          70% {\n            box-shadow: 0 0 0 10px rgba(var(--color-primary-rgb), 0);\n          }\n          100% {\n            box-shadow: 0 0 0 0 rgba(var(--color-primary-rgb), 0);\n          }\n        }\n        \n        .pulse-once {\n          animation: pulse-animation 1s;\n        }\n      "})]})};rt.propTypes={className:De.string};const it=()=>{const{guestId:t}=ue(),n=Ce(),[A,r]=e.useState(null),[i,o]=e.useState(!0),[s,a]=e.useState(!1),[g,l]=e.useState("accueil"),[c,I]=e.useState(0);e.useEffect((()=>{const e=()=>{try{if(!t)return a(!0),void o(!1);const e=(e=>{const[t,...n]=e.split("_"),A=n.join("_");for(const r in Le)if(r.replace(/\s+/g,"-").toLowerCase()===t){const e=Le[r].find((e=>e.name.replace(/\s+/g,"-").toLowerCase()===A));if(e)return{...e,group:r}}return null})(t);if(!e)return a(!0),void o(!1);r(e),o(!1)}catch(e){a(!0),o(!1)}},n=setTimeout((()=>{e()}),1e3);return()=>clearTimeout(n)}),[t]),e.useEffect((()=>{const e=()=>{const e=window.scrollY,t=document.documentElement.scrollHeight-window.innerHeight;I(e/t);const n=["accueil","details","programme","lieu"];let A=g;for(const r of n){const e=document.getElementById(r);if(e){const t=e.getBoundingClientRect();if(t.top<=100&&t.bottom>=100){A=r;break}}}A!==g&&l(A)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[g]);if(i)return f.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/10",children:[f.jsxs("div",{className:"relative w-24 h-24 flex items-center justify-center mb-6",children:[f.jsx("svg",{className:"absolute w-24 h-24 text-primary/20",viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"4",children:f.jsx("circle",{cx:"50",cy:"50",r:"44"})}),f.jsx("svg",{className:"absolute w-24 h-24 text-primary animate-spin",viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeDasharray:"69 200",children:f.jsx("circle",{cx:"50",cy:"50",r:"44"})}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:f.jsx("svg",{className:"w-10 h-10 text-primary/70",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})})]}),f.jsx("p",{className:"text-primary-dark font-elegant text-2xl animate-pulse mb-2",children:"Un instant..."}),f.jsx("p",{className:"text-muted text-center max-w-md px-4",children:"Nous préparons votre invitation personnalisée"})]});if(s)return f.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-primary/5 to-secondary/10 px-4",children:[f.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-6 text-danger bg-danger/10 rounded-full",children:f.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),f.jsx("h1",{className:"text-primary-dark font-elegant text-3xl text-center mb-4",children:"Invitation non trouvée"}),f.jsx("p",{className:"text-muted text-center max-w-md mb-8",children:"Désolé, nous n'avons pas pu trouver votre invitation personnalisée. Veuillez vérifier l'URL ou contacter les mariés."}),f.jsx(je,{variant:"primary",onClick:()=>n("/"),className:"shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300",children:"Retour à l'accueil"})]});const C={accueil:f.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),details:f.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),programme:f.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),lieu:f.jsxs("svg",{className:"w-5 h-5 mb-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})};return f.jsxs("div",{className:"bg-gradient-to-br from-secondary/5 to-secondary/20 min-h-screen relative",children:[f.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 z-50",children:f.jsx("div",{className:"h-full bg-primary transition-all duration-300 ease-out",style:{width:100*c+"%"}})}),f.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg pb-safe-area-inset-bottom z-40 sm:top-0 sm:bottom-auto transition-transform duration-300",children:f.jsx("div",{className:"max-w-3xl mx-auto",children:f.jsx("div",{className:"flex items-center justify-between px-2 py-3",children:["accueil","details","programme","lieu"].map((e=>f.jsxs("button",{className:"flex flex-col items-center px-3 py-1.5 rounded-lg transition-all duration-300 "+(g===e?"text-primary bg-primary/10 transform scale-105":"text-muted hover:text-primary/70 hover:bg-primary/5"),onClick:()=>(e=>{l(e);const t=document.getElementById(e);t&&window.scrollTo({top:t.offsetTop-60,behavior:"smooth"})})(e),"aria-label":`Aller à la section ${e}`,"aria-current":g===e?"page":void 0,children:[C[e],f.jsx("span",{className:"text-xs font-medium capitalize",children:e})]},e)))})})}),f.jsxs("div",{className:"pt-0 pb-20 sm:pb-0 sm:pt-16 overflow-hidden",children:[f.jsx("div",{id:"accueil",className:"min-h-[90vh] flex items-center transition-opacity duration-700",style:{opacity:"accueil"===g?1:.8},children:f.jsx("div",{className:"w-full",children:f.jsx(Oe,{guestInfo:A})})}),f.jsx("div",{id:"details",className:"scroll-mt-16 transition-opacity duration-700",style:{opacity:"details"===g?1:.8},children:f.jsx(Pe,{})}),f.jsx("div",{id:"programme",className:"scroll-mt-16 transition-opacity duration-700",style:{opacity:"programme"===g?1:.8},children:f.jsx(_e,{})}),f.jsx("div",{id:"lieu",className:"scroll-mt-16 transition-opacity duration-700",style:{opacity:"lieu"===g?1:.8},children:f.jsx(rt,{})})]}),f.jsxs("footer",{className:"bg-primary text-white py-10 px-4 text-center relative overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 opacity-10",children:f.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[f.jsx("path",{d:"M0,0 L100,0 L100,100 L0,100 Z",fill:"none",stroke:"currentColor",strokeWidth:"2"}),f.jsx("path",{d:"M0,50 L100,50",stroke:"currentColor",strokeWidth:"1"}),f.jsx("path",{d:"M50,0 L50,100",stroke:"currentColor",strokeWidth:"1"})]})}),f.jsxs("div",{className:"relative z-10",children:[f.jsxs("p",{className:"font-elegant text-2xl mb-3",children:[Te.couple.groom," & ",Te.couple.bride]}),f.jsx("div",{className:"w-16 h-1 bg-white/30 mx-auto mb-4"}),f.jsx("p",{className:"text-sm text-white/80 max-w-md mx-auto leading-relaxed",children:"Nous nous réjouissons de célébrer ce jour spécial avec vous"}),f.jsx("div",{className:"flex justify-center gap-4 mt-6 mb-6",children:f.jsx("a",{href:"https://wa.me/243899895733",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-all duration-300","aria-label":"Contacter les mariés via WhatsApp",children:f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"})})})}),f.jsxs("div",{className:"text-xs text-white/50",children:[f.jsxs("p",{children:["© ",(new Date).getFullYear()," - Tous droits réservés"]}),f.jsxs("p",{className:"mt-1",children:["Développé par Criho James,"," ",f.jsx("a",{href:"https://www.criho.tech",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors duration-300",children:"@https://www.criho.tech"})]})]})]})]}),c>.3&&f.jsx("button",{className:"fixed bottom-20 right-4 sm:bottom-4 z-30 bg-primary/80 text-white w-10 h-10 rounded-full shadow-lg flex items-center justify-center transform hover:scale-110 transition-all duration-300 backdrop-blur-sm",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),"aria-label":"Retour en haut",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})})})]})};var ot,st,at=Object.defineProperty,gt=Object.getOwnPropertySymbols,lt=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable,It=(e,t,n)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ct=(e,t)=>{for(var n in t||(t={}))lt.call(t,n)&&It(e,n,t[n]);if(gt)for(var n of gt(t))ct.call(t,n)&&It(e,n,t[n]);return e},ut=(e,t)=>{var n={};for(var A in e)lt.call(e,A)&&t.indexOf(A)<0&&(n[A]=e[A]);if(null!=e&&gt)for(var A of gt(e))t.indexOf(A)<0&&ct.call(e,A)&&(n[A]=e[A]);return n};(e=>{const t=class{constructor(e,n,A,r){if(this.version=e,this.errorCorrectionLevel=n,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=4*e+17;let o=[];for(let t=0;t<this.size;t++)o.push(!1);for(let t=0;t<this.size;t++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const s=this.addEccAndInterleave(A);if(this.drawCodewords(s),-1==r){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const n=this.getPenaltyScore();n<e&&(r=t,e=n),this.applyMask(t)}}i(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(n,A){const r=e.QrSegment.makeSegments(n);return t.encodeSegments(r,A)}static encodeBinary(n,A){const r=e.QrSegment.makeBytes(n);return t.encodeSegments([r],A)}static encodeSegments(e,n,r=1,o=40,a=-1,g=!0){if(!(t.MIN_VERSION<=r&&r<=o&&o<=t.MAX_VERSION)||a<-1||a>7)throw new RangeError("Invalid value");let l,c;for(l=r;;l++){const A=8*t.getNumDataCodewords(l,n),r=s.getTotalBits(e,l);if(r<=A){c=r;break}if(l>=o)throw new RangeError("Data too long")}for(const A of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])g&&c<=8*t.getNumDataCodewords(l,A)&&(n=A);let I=[];for(const t of e){A(t.mode.modeBits,4,I),A(t.numChars,t.mode.numCharCountBits(l),I);for(const e of t.getData())I.push(e)}i(I.length==c);const C=8*t.getNumDataCodewords(l,n);i(I.length<=C),A(0,Math.min(4,C-I.length),I),A(0,(8-I.length%8)%8,I),i(I.length%8==0);for(let t=236;I.length<C;t^=253)A(t,8,I);let u=[];for(;8*u.length<I.length;)u.push(0);return I.forEach(((e,t)=>u[t>>>3]|=e<<7-(7&t))),new t(l,n,u,a)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2==0),this.setFunctionModule(n,6,n%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let n=0;n<t;n++)for(let A=0;A<t;A++)0==n&&0==A||0==n&&A==t-1||n==t-1&&0==A||this.drawAlignmentPattern(e[n],e[A]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let n=t;for(let r=0;r<10;r++)n=n<<1^1335*(n>>>9);const A=21522^(t<<10|n);i(A>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,r(A,i));this.setFunctionModule(8,7,r(A,6)),this.setFunctionModule(8,8,r(A,7)),this.setFunctionModule(7,8,r(A,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,r(A,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,r(A,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,r(A,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let n=0;n<12;n++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;i(t>>>18==0);for(let n=0;n<18;n++){const e=r(t,n),A=this.size-11+n%3,i=Math.floor(n/3);this.setFunctionModule(A,i,e),this.setFunctionModule(i,A,e)}}drawFinderPattern(e,t){for(let n=-4;n<=4;n++)for(let A=-4;A<=4;A++){const r=Math.max(Math.abs(A),Math.abs(n)),i=e+A,o=t+n;0<=i&&i<this.size&&0<=o&&o<this.size&&this.setFunctionModule(i,o,2!=r&&4!=r)}}drawAlignmentPattern(e,t){for(let n=-2;n<=2;n++)for(let A=-2;A<=2;A++)this.setFunctionModule(e+A,t+n,1!=Math.max(Math.abs(A),Math.abs(n)))}setFunctionModule(e,t,n){this.modules[t][e]=n,this.isFunction[t][e]=!0}addEccAndInterleave(e){const n=this.version,A=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(n,A))throw new RangeError("Invalid argument");const r=t.NUM_ERROR_CORRECTION_BLOCKS[A.ordinal][n],o=t.ECC_CODEWORDS_PER_BLOCK[A.ordinal][n],s=Math.floor(t.getNumRawDataModules(n)/8),a=r-s%r,g=Math.floor(s/r);let l=[];const c=t.reedSolomonComputeDivisor(o);for(let i=0,C=0;i<r;i++){let n=e.slice(C,C+g-o+(i<a?0:1));C+=n.length;const A=t.reedSolomonComputeRemainder(n,c);i<a&&n.push(0),l.push(n.concat(A))}let I=[];for(let t=0;t<l[0].length;t++)l.forEach(((e,n)=>{(t!=g-o||n>=a)&&I.push(e[t])}));return i(I.length==s),I}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let A=0;A<this.size;A++)for(let i=0;i<2;i++){const o=t-i,s=!(t+1&2)?this.size-1-A:A;!this.isFunction[s][o]&&n<8*e.length&&(this.modules[s][o]=r(e[n>>>3],7-(7&n)),n++)}}i(n==8*e.length)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let n=0;n<this.size;n++){let A;switch(e){case 0:A=(n+t)%2==0;break;case 1:A=t%2==0;break;case 2:A=n%3==0;break;case 3:A=(n+t)%3==0;break;case 4:A=(Math.floor(n/3)+Math.floor(t/2))%2==0;break;case 5:A=n*t%2+n*t%3==0;break;case 6:A=(n*t%2+n*t%3)%2==0;break;case 7:A=((n+t)%2+n*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][n]&&A&&(this.modules[t][n]=!this.modules[t][n])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let n=!1,A=0,r=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[i][o]==n?(A++,5==A?e+=t.PENALTY_N1:A>5&&e++):(this.finderPenaltyAddHistory(A,r),n||(e+=this.finderPenaltyCountPatterns(r)*t.PENALTY_N3),n=this.modules[i][o],A=1);e+=this.finderPenaltyTerminateAndCount(n,A,r)*t.PENALTY_N3}for(let i=0;i<this.size;i++){let n=!1,A=0,r=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[o][i]==n?(A++,5==A?e+=t.PENALTY_N1:A>5&&e++):(this.finderPenaltyAddHistory(A,r),n||(e+=this.finderPenaltyCountPatterns(r)*t.PENALTY_N3),n=this.modules[o][i],A=1);e+=this.finderPenaltyTerminateAndCount(n,A,r)*t.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let n=0;n<this.size-1;n++){const A=this.modules[i][n];A==this.modules[i][n+1]&&A==this.modules[i+1][n]&&A==this.modules[i+1][n+1]&&(e+=t.PENALTY_N2)}let n=0;for(const t of this.modules)n=t.reduce(((e,t)=>e+(t?1:0)),n);const A=this.size*this.size,r=Math.ceil(Math.abs(20*n-10*A)/A)-1;return i(0<=r&&r<=9),e+=r*t.PENALTY_N4,i(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{const e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2));let n=[6];for(let A=this.size-7;n.length<e;A-=t)n.splice(1,0,A);return n}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let n=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;n-=(25*t-10)*t-55,e>=7&&(n-=36)}return i(208<=n&&n<=29648),n}static getNumDataCodewords(e,n){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let n=[];for(let t=0;t<e-1;t++)n.push(0);n.push(1);let A=1;for(let r=0;r<e;r++){for(let e=0;e<n.length;e++)n[e]=t.reedSolomonMultiply(n[e],A),e+1<n.length&&(n[e]^=n[e+1]);A=t.reedSolomonMultiply(A,2)}return n}static reedSolomonComputeRemainder(e,n){let A=n.map((e=>0));for(const r of e){const e=r^A.shift();A.push(0),n.forEach(((n,r)=>A[r]^=t.reedSolomonMultiply(n,e)))}return A}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let n=0;for(let A=7;A>=0;A--)n=n<<1^285*(n>>>7),n^=(t>>>A&1)*e;return i(n>>>8==0),n}finderPenaltyCountPatterns(e){const t=e[1];i(t<=3*this.size);const n=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(n&&e[0]>=4*t&&e[6]>=t?1:0)+(n&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,n){return e&&(this.finderPenaltyAddHistory(t,n),t=0),t+=this.size,this.finderPenaltyAddHistory(t,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};let n=t;function A(e,t,n){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let A=t-1;A>=0;A--)n.push(e>>>A&1)}function r(e,t){return!!(e>>>t&1)}function i(e){if(!e)throw new Error("Assertion error")}n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;const o=class{constructor(e,t,n){if(this.mode=e,this.numChars=t,this.bitData=n,t<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}static makeBytes(e){let t=[];for(const n of e)A(n,8,t);return new o(o.Mode.BYTE,e.length,t)}static makeNumeric(e){if(!o.isNumeric(e))throw new RangeError("String contains non-numeric characters");let t=[];for(let n=0;n<e.length;){const r=Math.min(e.length-n,3);A(parseInt(e.substr(n,r),10),3*r+1,t),n+=r}return new o(o.Mode.NUMERIC,e.length,t)}static makeAlphanumeric(e){if(!o.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");let t,n=[];for(t=0;t+2<=e.length;t+=2){let r=45*o.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t));r+=o.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t+1)),A(r,11,n)}return t<e.length&&A(o.ALPHANUMERIC_CHARSET.indexOf(e.charAt(t)),6,n),new o(o.Mode.ALPHANUMERIC,e.length,n)}static makeSegments(e){return""==e?[]:o.isNumeric(e)?[o.makeNumeric(e)]:o.isAlphanumeric(e)?[o.makeAlphanumeric(e)]:[o.makeBytes(o.toUtf8ByteArray(e))]}static makeEci(e){let t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)A(e,8,t);else if(e<16384)A(2,2,t),A(e,14,t);else{if(!(e<1e6))throw new RangeError("ECI assignment value out of range");A(6,3,t),A(e,21,t)}return new o(o.Mode.ECI,0,t)}static isNumeric(e){return o.NUMERIC_REGEX.test(e)}static isAlphanumeric(e){return o.ALPHANUMERIC_REGEX.test(e)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let n=0;for(const A of e){const e=A.mode.numCharCountBits(t);if(A.numChars>=1<<e)return 1/0;n+=4+e+A.bitData.length}return n}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let n=0;n<e.length;n++)"%"!=e.charAt(n)?t.push(e.charCodeAt(n)):(t.push(parseInt(e.substr(n+1,2),16)),n+=2);return t}};let s=o;s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e.QrSegment=s})(ot||(ot={})),(e=>{const t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}};let n=t;n.LOW=new t(0,1),n.MEDIUM=new t(1,0),n.QUARTILE=new t(2,3),n.HIGH=new t(3,2),e.Ecc=n})((st=ot||(ot={})).QrCode||(st.QrCode={})),(e=>{(e=>{const t=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}};let n=t;n.NUMERIC=new t(1,[10,12,14]),n.ALPHANUMERIC=new t(2,[9,11,13]),n.BYTE=new t(4,[8,16,16]),n.KANJI=new t(8,[8,10,12]),n.ECI=new t(7,[0,0,0]),e.Mode=n})(e.QrSegment||(e.QrSegment={}))})(ot||(ot={}));var dt=ot,ht={L:dt.QrCode.Ecc.LOW,M:dt.QrCode.Ecc.MEDIUM,Q:dt.QrCode.Ecc.QUARTILE,H:dt.QrCode.Ecc.HIGH},mt=128,pt="L",ft="#FFFFFF",bt="#000000",Bt=!1;
/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */function yt(e,t=0){const n=[];return e.forEach((function(e,A){let r=null;e.forEach((function(i,o){if(!i&&null!==r)return n.push(`M${r+t} ${A+t}h${o-r}v1H${r+t}z`),void(r=null);if(o!==e.length-1)i&&null===r&&(r=o);else{if(!i)return;null===r?n.push(`M${o+t},${A+t} h1v1H${o+t}z`):n.push(`M${r+t},${A+t} h${o+1-r}v1H${r+t}z`)}}))})),n.join("")}function wt(e,t){return e.slice().map(((e,n)=>n<t.y||n>=t.y+t.h?e:e.map(((e,n)=>(n<t.x||n>=t.x+t.w)&&e))))}function Zt(e,t,n,A){if(null==A)return null;const r=n?4:0,i=e.length+2*r,o=Math.floor(.1*t),s=i/t,a=(A.width||o)*s,g=(A.height||o)*s,l=null==A.x?e.length/2-a/2:A.x*s,c=null==A.y?e.length/2-g/2:A.y*s;let I=null;if(A.excavate){let e=Math.floor(l),t=Math.floor(c);I={x:e,y:t,w:Math.ceil(a+l-e),h:Math.ceil(g+c-t)}}return{x:l,y:c,h:g,w:a,excavation:I}}var St=function(){try{(new Path2D).addPath(new Path2D)}catch(Zf){return!1}return!0}();function vt(e){const t=e,{value:n,size:A=mt,level:i=pt,bgColor:o=ft,fgColor:s=bt,includeMargin:a=Bt,style:g,imageSettings:l}=t,c=ut(t,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),I=null==l?void 0:l.src,C=r.useRef(null),u=r.useRef(null),[d,h]=r.useState(!1);r.useEffect((()=>{if(null!=C.current){const e=C.current,t=e.getContext("2d");if(!t)return;let r=dt.QrCode.encodeText(n,ht[i]).getModules();const g=a?4:0,c=r.length+2*g,I=Zt(r,A,a,l),d=u.current,h=null!=I&&null!==d&&d.complete&&0!==d.naturalHeight&&0!==d.naturalWidth;h&&null!=I.excavation&&(r=wt(r,I.excavation));const m=window.devicePixelRatio||1;e.height=e.width=A*m;const p=A/c*m;t.scale(p,p),t.fillStyle=o,t.fillRect(0,0,c,c),t.fillStyle=s,St?t.fill(new Path2D(yt(r,g))):r.forEach((function(e,n){e.forEach((function(e,A){e&&t.fillRect(A+g,n+g,1,1)}))})),h&&t.drawImage(d,I.x+g,I.y+g,I.w,I.h)}})),r.useEffect((()=>{h(!1)}),[I]);const m=Ct({height:A,width:A},g);let p=null;return null!=I&&(p=r.createElement("img",{src:I,key:I,style:{display:"none"},onLoad:()=>{h(!0)},ref:u})),r.createElement(r.Fragment,null,r.createElement("canvas",Ct({style:m,height:A,width:A,ref:C},c)),p)}function Gt(e){const t=e,{value:n,size:A=mt,level:i=pt,bgColor:o=ft,fgColor:s=bt,includeMargin:a=Bt,imageSettings:g}=t,l=ut(t,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let c=dt.QrCode.encodeText(n,ht[i]).getModules();const I=a?4:0,C=c.length+2*I,u=Zt(c,A,a,g);let d=null;null!=g&&null!=u&&(null!=u.excavation&&(c=wt(c,u.excavation)),d=r.createElement("image",{xlinkHref:g.src,height:u.h,width:u.w,x:u.x+I,y:u.y+I,preserveAspectRatio:"none"}));const h=yt(c,I);return r.createElement("svg",Ct({height:A,width:A,viewBox:`0 0 ${C} ${C}`},l),r.createElement("path",{fill:o,d:`M0,0 h${C}v${C}H0z`,shapeRendering:"crispEdges"}),r.createElement("path",{fill:s,d:h,shapeRendering:"crispEdges"}),d)}var Rt=e=>{const t=e,{renderAs:n}=t,A=ut(t,["renderAs"]);return"svg"===n?r.createElement(Gt,Ct({},A)):r.createElement(vt,Ct({},A))};const Vt=({value:t,size:n=200,bgColor:A="#ffffff",fgColor:r="#8B5D33",level:i="H",includeMargin:o=!0,className:s="",logoSrc:a="",logoSize:g=50,title:l="",caption:c="",tableColor:I="",id:C=""})=>{const[u,d]=e.useState(null),h=e.useRef(null),m=I||r;return e.useEffect((()=>{if(u&&a){const e=u.getContext("2d"),t=new Image;t.src=a,t.onload=()=>{const r=n/2-g/2,i=n/2-g/2;e.beginPath(),e.arc(n/2,n/2,g/1.8,0,2*Math.PI),e.fillStyle=A,e.fill(),e.drawImage(t,r,i,g,g)}}}),[u,a,g,n,A]),f.jsxs("div",{className:`flex flex-col items-center ${s}`,ref:h,children:[l&&f.jsx("h3",{className:"text-center font-elegant font-semibold text-lg mb-3",style:{color:m},children:l}),f.jsx("div",{className:"bg-white p-3 rounded-xl shadow-elegant",style:{borderColor:m,borderWidth:"2px",borderStyle:"solid"},children:f.jsx(Rt,{id:C,value:t,size:n,bgColor:A,fgColor:m,level:i,includeMargin:o,renderAs:"canvas",ref:e=>{e&&d(e.firstChild)}})}),f.jsxs("div",{className:"flex items-center mt-3 gap-2",children:[c&&f.jsx("p",{className:"text-center text-sm text-muted",children:c}),f.jsxs("button",{onClick:()=>{if(u)try{const e=3,t=document.createElement("canvas"),A=30*e,r=l?60*e:0;t.width=n*e+2*A,t.height=n*e+2*A+r;const i=t.getContext("2d");i.fillStyle="#ffffff",i.fillRect(0,0,t.width,t.height);const o=8*e;i.strokeStyle=m,i.lineWidth=o,i.strokeRect(o/2,o/2,t.width-o,t.height-o),l&&(i.fillStyle=m,i.font=`bold ${24*e}px Arial`,i.textAlign="center",i.fillText(l,t.width/2,35*e),i.font=14*e+"px Arial",i.fillText("Invitation au mariage de Fiston & Vino",t.width/2,52*e));const s=e;i.drawImage(u,A,r+A,n*s,n*s),i.fillStyle=`${m}50`;const a=t.width/2,g=t.height-20*e,c=12*e;for(let n=0;n<5;n++){const e=n/5*Math.PI*2,t=a+Math.cos(e)*c*3,A=g+Math.sin(e)*c*2;i.beginPath(),i.arc(t,A,c,0,2*Math.PI),i.fill()}const I=t.toDataURL("image/png",1),C=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(C){const e=window.open();e&&(e.document.write(`\n            <html>\n              <head>\n                <title>QR Code - ${l||"Invitation"}</title>\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <style>\n                  body { text-align: center; font-family: Arial; padding: 20px; }\n                  img { max-width: 100%; height: auto; margin-bottom: 20px; }\n                  p { color: #666; margin-bottom: 20px; }\n                </style>\n              </head>\n              <body>\n                <h2>QR Code - ${l||"Invitation"}</h2>\n                <img src="${I}" alt="QR Code">\n                <p>Appuyez longuement sur l'image et sélectionnez "Enregistrer l'image" pour télécharger</p>\n              </body>\n            </html>\n          `),e.document.close())}else{const e=document.createElement("a");e.href=I,e.download=`invitation-${l.replace(/\s+/g,"-")||"qrcode"}.png`,e.click()}const d=document.createElement("div");d.style.position="fixed",d.style.top="20px",d.style.left="50%",d.style.transform="translateX(-50%)",d.style.padding="10px 20px",d.style.background="#4CAF50",d.style.color="white",d.style.borderRadius="4px",d.style.zIndex="9999",d.style.opacity="0",d.style.transition="opacity 0.3s ease",d.textContent=C?"QR Code ouvert dans un nouvel onglet":"QR Code téléchargé",document.body.appendChild(d),setTimeout((()=>{d.style.opacity="1"}),100),setTimeout((()=>{d.style.opacity="0",setTimeout((()=>{document.body.removeChild(d)}),300)}),3e3)}catch(e){alert("Une erreur est survenue lors du téléchargement. Veuillez réessayer.")}},className:"text-xs flex items-center gap-1 px-2 py-1 rounded-md bg-primary/10 text-primary hover:bg-primary/20 transition-colors",style:{color:m,backgroundColor:`${m}15`},children:[f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Télécharger"]})]})]})};Vt.propTypes={value:De.string.isRequired,size:De.number,bgColor:De.string,fgColor:De.string,level:De.oneOf(["L","M","Q","H"]),includeMargin:De.bool,className:De.string,logoSrc:De.string,logoSize:De.number,title:De.string,caption:De.string,tableColor:De.string,id:De.string};const Nt=({children:e,className:t="",variant:n="default",hover:A=!1,onClick:r=null,fullWidth:i=!1})=>{const o={default:"bg-white shadow-card rounded-xl",elegant:"bg-white shadow-elegant rounded-2xl border border-primary/10",flat:"bg-secondary rounded-lg",outline:"border border-primary/20 rounded-xl"},s=null!==r,a=`\n    overflow-hidden transition-all duration-300\n    ${o[n]||o.default}\n    ${A?"hover:shadow-medium cursor-pointer transform hover:-translate-y-1":""}\n    ${i?"w-full":""}\n    ${s?"cursor-pointer":""}\n    ${t}\n  `.trim();return s?f.jsx("div",{className:a,onClick:r,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||r(e)},children:e}):f.jsx("div",{className:a,children:e})};Nt.Header=({children:e,className:t=""})=>f.jsx("div",{className:`p-4 border-b border-gray-100 ${t}`,children:e}),Nt.Body=({children:e,className:t=""})=>f.jsx("div",{className:`p-4 ${t}`,children:e}),Nt.Footer=({children:e,className:t=""})=>f.jsx("div",{className:`p-4 border-t border-gray-100 ${t}`,children:e}),Nt.propTypes={children:De.node.isRequired,className:De.string,variant:De.oneOf(["default","elegant","flat","outline"]),hover:De.bool,onClick:De.func,fullWidth:De.bool},Nt.Header.propTypes={children:De.node.isRequired,className:De.string},Nt.Body.propTypes={children:De.node.isRequired,className:De.string},Nt.Footer.propTypes={children:De.node.isRequired,className:De.string};const kt=({guest:t,group:n,onShare:A=()=>{},onEdit:r=()=>{},onDelete:i=()=>{},baseUrl:o=window.location.origin})=>{const[s,a]=e.useState(!1),[g,l]=e.useState(!1),c=((e,t)=>`${e.replace(/\s+/g,"-").toLowerCase()}_${t.replace(/\s+/g,"-").toLowerCase()}`)(n,t.name),I=`${o}/invitation/${c}`,C=(()=>{if(!n)return"#8B5D33";const e=Te.tables.find((e=>e.name.toLowerCase()===n.toLowerCase()));return e?e.color:"#8B5D33"})(),u=t.scanned||!1,d=t.scanCount||0,h=t.lastScan?((e,t=!0)=>{if(!e)return"N/A";let n;if(e.toDate&&"function"==typeof e.toDate)n=e.toDate();else{if(!(e instanceof Date))return"Format de date inconnu";n=e}const A={day:"2-digit",month:"2-digit",year:"numeric"};return t&&(A.hour="2-digit",A.minute="2-digit",A.second="2-digit"),new Intl.DateTimeFormat("fr-FR",A).format(n)})(t.lastScan):null;return f.jsx(Nt,{variant:"elegant",className:"overflow-visible w-full transition-all duration-300 hover:shadow-lg",children:f.jsxs(Nt.Body,{className:"p-3 sm:p-4",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3 md:gap-4",children:[f.jsxs("div",{className:"flex-grow w-full lg:w-auto",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[f.jsxs("h3",{className:"font-elegant text-lg text-primary-dark break-words flex flex-wrap items-center",children:[f.jsx("span",{className:"mr-2",children:t.name}),u&&f.jsxs("span",{className:"mt-1 sm:mt-0 text-xs font-normal px-2 py-1 rounded-full text-white whitespace-nowrap",style:{backgroundColor:C},children:["Scanné ",d>1?`${d} fois`:""]})]}),f.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-primary-light/20 text-primary-dark sm:hidden",children:[t.count," ",t.count>1?"personnes":"personne"]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[f.jsxs("span",{className:"flex items-center text-muted text-sm",children:[f.jsx("span",{className:"mr-1",children:"Table:"}),f.jsx("span",{className:"px-2 py-0.5 rounded-full text-white font-medium text-xs",style:{backgroundColor:C},children:n})]}),f.jsx("span",{className:"hidden sm:inline mx-2 text-primary/20",children:"•"}),f.jsx("span",{className:"text-muted text-sm hidden sm:inline",children:t.count>1?`${t.count} personnes`:"1 personne"}),u&&h&&f.jsxs("span",{className:"text-xs bg-success/20 text-success py-0.5 px-2 rounded-full flex items-center ml-0 sm:ml-2 mt-1 sm:mt-0",children:[f.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),f.jsxs("span",{className:"whitespace-nowrap",children:["Dernier scan: ",h]})]})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3 lg:mt-0",children:[s?f.jsx(je,{variant:"outline",size:"sm",className:"flex-grow xs:flex-grow-0",onClick:()=>a(!1),icon:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),children:"Masquer"}):f.jsx(je,{variant:"outline",size:"sm",className:"flex-grow xs:flex-grow-0",onClick:()=>{l(!0),setTimeout((()=>{l(!1),a(!0)}),800)},disabled:g,icon:g?f.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),children:f.jsx("span",{className:"truncate",children:g?"Génération...":"QR Code"})}),f.jsx(je,{variant:"primary",size:"sm",className:"flex-grow xs:flex-grow-0",onClick:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`Invitation pour *${t.name}* au mariage de Fiston Zaka et Vino Banza.\nVoici votre invitation personnalisée: ${I}`)}`,"_blank"),A(t,n)},icon:f.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M17.498 14.382c-.301-.15-1.767-.867-2.04-.966-.273-.101-.473-.151-.673.15-.197.295-.771.964-.944 1.162-.175.195-.349.21-.646.075-.3-.15-1.263-.465-2.403-1.485-.888-.795-1.484-1.77-1.66-2.07-.174-.3-.019-.465.13-.615.136-.135.301-.345.451-.523.146-.181.194-.301.297-.496.1-.21.049-.375-.025-.524-.075-.15-.672-1.62-.922-2.206-.24-.584-.487-.51-.672-.51-.172-.015-.371-.015-.571-.015-.2 0-.523.074-.797.359-.273.3-1.045 1.02-1.045 2.475s1.07 2.865 1.219 3.075c.149.195 2.105 3.195 5.1 4.485.714.3 1.27.48 1.704.629.714.227 1.365.195 1.88.121.574-.091 1.767-.721 2.016-1.426.255-.705.255-1.29.18-1.425-.074-.135-.27-.21-.57-.345"})}),children:f.jsx("span",{className:"truncate",children:"Partager"})}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full xs:w-auto",children:[f.jsx(je,{variant:"outline",size:"sm",className:"flex-grow xs:flex-grow-0",onClick:()=>r(t),icon:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),children:f.jsx("span",{className:"truncate",children:"Modifier"})}),f.jsx(je,{variant:"outline",size:"sm",className:"text-danger hover:bg-danger/10 flex-grow xs:flex-grow-0",onClick:()=>{window.confirm(`Voulez-vous vraiment supprimer l'invité "${t.name}" ?`)&&i(t)},icon:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),children:f.jsx("span",{className:"truncate",children:"Supprimer"})})]})]})]}),s&&f.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[f.jsx("div",{className:"flex-shrink-0 mx-auto sm:mx-0",children:f.jsx(Vt,{id:`qr-${c}`,value:I,size:160,logoSrc:"/src/assets/images/wedding-logo.png",logoSize:40,title:t.name,tableColor:C,caption:`Table ${n}`})}),f.jsxs("div",{className:"flex-grow space-y-4 w-full",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-sans text-sm font-medium text-primary-dark",children:"Lien d'invitation"}),f.jsx("p",{className:"text-xs text-muted break-all mt-1",children:I})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(je,{variant:"outline",size:"sm",icon:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),onClick:()=>{navigator.clipboard.writeText(I)},children:"Copier le lien"}),f.jsx(je,{variant:"outline",size:"sm",icon:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),onClick:()=>{const e=document.getElementById(`qr-${c}`);if(e){const n=document.createElement("a");n.download=`invitation-${t.name.replace(/\s+/g,"-")}.png`,n.href=e.toDataURL("image/png"),n.click()}},children:"Télécharger QR"})]})]})]})})]})})};kt.propTypes={guest:De.shape({name:De.string.isRequired,count:De.number.isRequired,message:De.string,scanned:De.bool,scanCount:De.number,lastScan:De.object}).isRequired,group:De.string.isRequired,onShare:De.func,onEdit:De.func,onDelete:De.func,baseUrl:De.string};const Wt=({guest:t,groups:n,onSubmit:A,onCancel:r})=>{const[i,o]=e.useState({name:"",group:n[0]||"",count:1,message:"",...t});e.useEffect((()=>{t&&o({name:t.name||"",group:t.group||n[0]||"",count:t.count||1,message:t.message||"",...t})}),[t,n]);const s=e=>{const{name:t,value:n}=e.target;o((e=>({...e,[t]:"count"===t?parseInt(n,10):n})))};return f.jsx(Nt,{variant:"default",className:"overflow-hidden",children:f.jsxs("form",{onSubmit:e=>{e.preventDefault(),A(i)},children:[f.jsxs(Nt.Body,{className:"p-6",children:[f.jsx("h3",{className:"text-xl font-elegant text-primary-dark mb-4",children:t?"Modifier l'invité":"Ajouter un invité"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-primary-dark mb-1",children:"Nom de l'invité"}),f.jsx("input",{id:"name",name:"name",type:"text",required:!0,className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",value:i.name,onChange:s,placeholder:"Nom de l'invité ou du groupe"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"group",className:"block text-sm font-medium text-primary-dark mb-1",children:"Groupe"}),f.jsx("select",{id:"group",name:"group",required:!0,className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",value:i.group,onChange:s,children:n.map((e=>f.jsx("option",{value:e,children:e},e)))})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"count",className:"block text-sm font-medium text-primary-dark mb-1",children:"Nombre de personnes"}),f.jsx("input",{id:"count",name:"count",type:"number",min:"1",required:!0,className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",value:i.count,onChange:s})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-primary-dark mb-1",children:"Message personnalisé"}),f.jsx("textarea",{id:"message",name:"message",rows:"3",className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",value:i.message,onChange:s,placeholder:"Message personnalisé pour cet invité"})]})]})]}),f.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end space-x-3",children:[f.jsx(je,{type:"button",variant:"outline",onClick:r,children:"Annuler"}),f.jsx(je,{type:"submit",variant:"primary",children:t?"Mettre à jour":"Ajouter"})]})]})})};var Ft={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et=function(e){const t=[];let n=0;for(let A=0;A<e.length;A++){let r=e.charCodeAt(A);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&A+1<e.length&&56320==(64512&e.charCodeAt(A+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++A)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},Xt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,A=[];for(let r=0;r<e.length;r+=3){const t=e[r],i=r+1<e.length,o=i?e[r+1]:0,s=r+2<e.length,a=s?e[r+2]:0,g=t>>2,l=(3&t)<<4|o>>4;let c=(15&o)<<2|a>>6,I=63&a;s||(I=64,i||(c=64)),A.push(n[g],n[l],n[c],n[I])}return A.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Et(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,A=0;for(;n<e.length;){const r=e[n++];if(r<128)t[A++]=String.fromCharCode(r);else if(r>191&&r<224){const i=e[n++];t[A++]=String.fromCharCode((31&r)<<6|63&i)}else if(r>239&&r<365){const i=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[A++]=String.fromCharCode(55296+(i>>10)),t[A++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[A++]=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,A=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],i=r<e.length?n[e.charAt(r)]:0;++r;const o=r<e.length?n[e.charAt(r)]:64;++r;const s=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==i||null==o||null==s)throw new Ht;const a=t<<2|i>>4;if(A.push(a),64!==o){const e=i<<4&240|o>>2;if(A.push(e),64!==s){const e=o<<6&192|s;A.push(e)}}}return A},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ht extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xt=function(e){return function(e){const t=Et(e);return Xt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Jt=function(e){try{return Xt.decodeString(e,!0)}catch(Zf){}return null};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Yt(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut=()=>{try{return Yt().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process)return;const e=Ft.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Zf){return}const t=e&&Jt(e[1]);return t&&JSON.parse(t)})()}catch(Zf){return}},Lt=()=>{var e;return null===(e=Ut())||void 0===e?void 0:e.config},Tt=e=>{var t;return null===(t=Ut())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Kt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(e){return e.endsWith(".cloudworkstations.dev")}async function Qt(e){return(await fetch(e,{credentials:"include"})).ok}const Dt={};let zt=!1;function Ot(e,t){if("undefined"==typeof window||"undefined"==typeof document||!Mt(window.location.host)||Dt[e]===t||Dt[e]||zt)return;function n(e){return`__firebase__banner__${e}`}Dt[e]=t;const A="__firebase__banner",r=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Dt))Dt[t]?e.emulator.push(t):e.prod.push(t);return e}(),i=r.prod.length>0;function o(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{zt=!0,function(){const e=document.getElementById(A);e&&e.remove()}()},e}function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(A),t=n("text"),r=document.getElementById(t)||document.createElement("span"),s=n("learnmore"),a=document.getElementById(s)||document.createElement("a"),g=n("preprendIcon"),l=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(a,s);const n=o();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(l,g),t.append(l,r,a,n),document.body.appendChild(t)}i?(r.innerText="Preview backend disconnected.",l.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(l.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',r.innerText="Preview backend running in this workspace."),r.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _t(){var e;const t=null===(e=Ut())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(Zf){return!1}}function jt(){return!_t()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qt(){return!_t()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function $t(){try{return"object"==typeof indexedDB}catch(Zf){return!1}}class en extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,en.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tn.prototype.create)}}class tn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},A=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(nn,((e,n)=>{const A=t[n];return null!=A?String(A):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${i} (${A}).`;return new en(A,o,n)}}const nn=/\{\$([^}]+)}/g;function An(e,t){if(e===t)return!0;const n=Object.keys(e),A=Object.keys(t);for(const r of n){if(!A.includes(r))return!1;const n=e[r],i=t[r];if(rn(n)&&rn(i)){if(!An(n,i))return!1}else if(n!==i)return!1}for(const r of A)if(!n.includes(r))return!1;return!0}function rn(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(e){const t=[];for(const[n,A]of Object.entries(e))Array.isArray(A)?A.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(A));return t.length?"&"+t.join("&"):""}class sn{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let A;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");A=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===A.next&&(A.next=an),void 0===A.error&&(A.error=an),void 0===A.complete&&(A.complete=an);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?A.error(this.finalError):A.complete()}catch(Zf){}})),this.observers.push(A),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Zf){"undefined"!=typeof console&&console.error}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function an(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(e){return e&&e._delegate?e._delegate:e}class ln{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Kt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Zf){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),A=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(A)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Zf){if(A)return null;throw Zf}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:cn})}catch(Zf){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Zf){}}}}clearInstance(e=cn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=cn){return this.instances.has(e)}getOptions(e=cn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const A=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&i.resolve(A)}return A}onInit(e,t){var n;const A=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(A))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(A,r);const i=this.instances.get(A);return i&&e(i,A),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(A){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(A=e,A===cn?void 0:A),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(r){}var A;return n||null}normalizeInstanceIdentifier(e=cn){return this.component?this.component.multipleInstances?e:cn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Cn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new In(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var un,dn;(dn=un||(un={}))[dn.DEBUG=0]="DEBUG",dn[dn.VERBOSE=1]="VERBOSE",dn[dn.INFO=2]="INFO",dn[dn.WARN=3]="WARN",dn[dn.ERROR=4]="ERROR",dn[dn.SILENT=5]="SILENT";const hn={debug:un.DEBUG,verbose:un.VERBOSE,info:un.INFO,warn:un.WARN,error:un.ERROR,silent:un.SILENT},mn=un.INFO,pn={[un.DEBUG]:"log",[un.VERBOSE]:"log",[un.INFO]:"info",[un.WARN]:"warn",[un.ERROR]:"error"},fn=(e,t,...n)=>{if(t<e.logLevel)return;(new Date).toISOString();if(!pn[t])throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};let bn=class{constructor(e){this.name=e,this._logLevel=mn,this._logHandler=fn,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in un))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?hn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,un.DEBUG,...e),this._logHandler(this,un.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,un.VERBOSE,...e),this._logHandler(this,un.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,un.INFO,...e),this._logHandler(this,un.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,un.WARN,...e),this._logHandler(this,un.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,un.ERROR,...e),this._logHandler(this,un.ERROR,...e)}};let Bn,yn;const wn=new WeakMap,Zn=new WeakMap,Sn=new WeakMap,vn=new WeakMap,Gn=new WeakMap;let Rn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Zn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Sn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Vn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yn||(yn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Wn(this),t),kn(wn.get(this))}:function(...t){return kn(e.apply(Wn(this),t))}:function(t,...n){const A=e.call(Wn(this),t,...n);return Sn.set(A,t.sort?t.sort():[t]),kn(A)}}function Nn(e){return"function"==typeof e?Vn(e):(e instanceof IDBTransaction&&function(e){if(Zn.has(e))return;const t=new Promise(((t,n)=>{const A=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=()=>{t(),A()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),A()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)}));Zn.set(e,t)}(e),t=e,(Bn||(Bn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Rn):e);var t}function kn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const A=()=>{e.removeEventListener("success",r),e.removeEventListener("error",i)},r=()=>{t(kn(e.result)),A()},i=()=>{n(e.error),A()};e.addEventListener("success",r),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&wn.set(t,e)})).catch((()=>{})),Gn.set(t,e),t}(e);if(vn.has(e))return vn.get(e);const t=Nn(e);return t!==e&&(vn.set(e,t),Gn.set(t,e)),t}const Wn=e=>Gn.get(e);const Fn=["get","getKey","getAll","getAllKeys","count"],En=["put","add","delete","clear"],Xn=new Map;function Hn(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Xn.get(t))return Xn.get(t);const n=t.replace(/FromIndex$/,""),A=t!==n,r=En.includes(n);if(!(n in(A?IDBIndex:IDBObjectStore).prototype)||!r&&!Fn.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,r?"readwrite":"readonly");let o=i.store;return A&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&i.done]))[0]};return Xn.set(t,i),i}Rn=(e=>({...e,get:(t,n,A)=>Hn(t,n)||e.get(t,n,A),has:(t,n)=>!!Hn(t,n)||e.has(t,n)}))(Rn);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Jn="@firebase/app",Yn="0.13.0",Un=new bn("@firebase/app"),Ln="@firebase/app-compat",Tn="@firebase/analytics-compat",Kn="@firebase/analytics",Mn="@firebase/app-check-compat",Qn="@firebase/app-check",Dn="@firebase/auth",zn="@firebase/auth-compat",On="@firebase/database",Pn="@firebase/data-connect",_n="@firebase/database-compat",jn="@firebase/functions",qn="@firebase/functions-compat",$n="@firebase/installations",eA="@firebase/installations-compat",tA="@firebase/messaging",nA="@firebase/messaging-compat",AA="@firebase/performance",rA="@firebase/performance-compat",iA="@firebase/remote-config",oA="@firebase/remote-config-compat",sA="@firebase/storage",aA="@firebase/storage-compat",gA="@firebase/firestore",lA="@firebase/ai",cA="@firebase/firestore-compat",IA="firebase",CA="[DEFAULT]",uA={[Jn]:"fire-core",[Ln]:"fire-core-compat",[Kn]:"fire-analytics",[Tn]:"fire-analytics-compat",[Qn]:"fire-app-check",[Mn]:"fire-app-check-compat",[Dn]:"fire-auth",[zn]:"fire-auth-compat",[On]:"fire-rtdb",[Pn]:"fire-data-connect",[_n]:"fire-rtdb-compat",[jn]:"fire-fn",[qn]:"fire-fn-compat",[$n]:"fire-iid",[eA]:"fire-iid-compat",[tA]:"fire-fcm",[nA]:"fire-fcm-compat",[AA]:"fire-perf",[rA]:"fire-perf-compat",[iA]:"fire-rc",[oA]:"fire-rc-compat",[sA]:"fire-gcs",[aA]:"fire-gcs-compat",[gA]:"fire-fst",[cA]:"fire-fst-compat",[lA]:"fire-vertex","fire-js":"fire-js",[IA]:"fire-js-all"},dA=new Map,hA=new Map,mA=new Map;function pA(e,t){try{e.container.addComponent(t)}catch(Zf){Un.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,Zf)}}function fA(e){const t=e.name;if(mA.has(t))return Un.debug(`There were multiple attempts to register component ${t}.`),!1;mA.set(t,e);for(const n of dA.values())pA(n,e);for(const n of hA.values())pA(n,e);return!0}function bA(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function BA(e){return null!=e&&void 0!==e.settings}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=new tn("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class wA{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ln("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yA.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA="11.8.0";function SA(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const A=Object.assign({name:CA,automaticDataCollectionEnabled:!0},t),r=A.name;if("string"!=typeof r||!r)throw yA.create("bad-app-name",{appName:String(r)});if(n||(n=Lt()),!n)throw yA.create("no-options");const i=dA.get(r);if(i){if(An(n,i.options)&&An(A,i.config))return i;throw yA.create("duplicate-app",{appName:r})}const o=new Cn(r);for(const a of mA.values())o.addComponent(a);const s=new wA(n,A,o);return dA.set(r,s),s}function vA(e,t,n){var A;let r=null!==(A=uA[e])&&void 0!==A?A:e;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=[`Unable to register library "${r}" with version "${t}":`];return i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Un.warn(e.join(" "))}fA(new ln(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="firebase-heartbeat-store";let RA=null;function VA(){return RA||(RA=function(e,t,{blocked:n,upgrade:A,blocking:r,terminated:i}={}){const o=indexedDB.open(e,t),s=kn(o);return A&&o.addEventListener("upgradeneeded",(e=>{A(kn(o.result),e.oldVersion,e.newVersion,kn(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),s.then((e=>{i&&e.addEventListener("close",(()=>i())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),s}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(GA)}catch(Zf){}}}).catch((e=>{throw yA.create("idb-open",{originalErrorMessage:e.message})}))),RA}async function NA(e,t){try{const n=(await VA()).transaction(GA,"readwrite"),A=n.objectStore(GA);await A.put(t,kA(e)),await n.done}catch(Zf){if(Zf instanceof en)Un.warn(Zf.message);else{const t=yA.create("idb-set",{originalErrorMessage:null==Zf?void 0:Zf.message});Un.warn(t.message)}}}function kA(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EA(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),A=FA();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===A||this._heartbeatsCache.heartbeats.some((e=>e.date===A)))return;if(this._heartbeatsCache.heartbeats.push({date:A,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let A=1;A<e.length;A++)e[A].date<n&&(n=e[A].date,t=A);return t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(Zf){Un.warn(Zf)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=FA(),{heartbeatsToSend:n,unsentEntries:A}=function(e,t=1024){const n=[];let A=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),XA(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),XA(n)>t){n.pop();break}A=A.slice(1)}return{heartbeatsToSend:n,unsentEntries:A}}(this._heartbeatsCache.heartbeats),r=xt(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,A.length>0?(this._heartbeatsCache.heartbeats=A,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(Zf){return Un.warn(Zf),""}}}function FA(){return(new Date).toISOString().substring(0,10)}class EA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!$t()&&new Promise(((e,t)=>{try{let n=!0;const A="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(A);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(A),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await VA()).transaction(GA),n=await t.objectStore(GA).get(kA(e));return await t.done,n}catch(Zf){if(Zf instanceof en)Un.warn(Zf.message);else{const t=yA.create("idb-get",{originalErrorMessage:null==Zf?void 0:Zf.message});Un.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return NA(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return NA(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function XA(e){return xt(JSON.stringify({version:2,heartbeats:e})).length}var HA;HA="",fA(new ln("platform-logger",(e=>new xn(e)),"PRIVATE")),fA(new ln("heartbeat",(e=>new WA(e)),"PRIVATE")),vA(Jn,Yn,HA),vA(Jn,Yn,"esm2017"),vA("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
vA("firebase","11.8.1","app");var xA,JA,YA="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e;
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var A=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)A[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)A[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var i=e.g[3],o=t+(i^n&(r^i))+A[0]+3614090360&4294967295;o=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=(n=(r=(i=(t=n+(o<<7&4294967295|o>>>25))+((o=i+(r^t&(n^r))+A[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^i&(t^n))+A[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(i^t))+A[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(r^i))+A[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(r^t&(n^r))+A[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^i&(t^n))+A[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(i^t))+A[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(r^i))+A[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(r^t&(n^r))+A[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^i&(t^n))+A[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(i^t))+A[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(r^i))+A[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(r^t&(n^r))+A[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^i&(t^n))+A[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(i^t))+A[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^i&(n^r))+A[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^r&(t^n))+A[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(i^t))+A[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(r^i))+A[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^i&(n^r))+A[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^r&(t^n))+A[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(i^t))+A[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(r^i))+A[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^i&(n^r))+A[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^r&(t^n))+A[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(i^t))+A[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(r^i))+A[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^i&(n^r))+A[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^r&(t^n))+A[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(i^t))+A[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(r^i))+A[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^i)+A[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^r)+A[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(i^t^n)+A[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^i^t)+A[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^i)+A[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^r)+A[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(i^t^n)+A[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^i^t)+A[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^i)+A[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^r)+A[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(i^t^n)+A[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^i^t)+A[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^i)+A[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^r)+A[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(i^t^n)+A[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^i^t)+A[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~i))+A[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~r))+A[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(i|~n))+A[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(r|~t))+A[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~i))+A[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~r))+A[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(i|~n))+A[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(r|~t))+A[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~i))+A[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~r))+A[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(i|~n))+A[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(r|~t))+A[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=n+((o=t+(r^(n|~i))+A[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~r))+A[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=i+((o=r+(t^(i|~n))+A[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+A[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+i&4294967295}function A(e,t){this.h=t;for(var n=[],A=!0,r=e.length-1;0<=r;r--){var i=0|e[r];A&&i==t||(n[r]=i,A=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,A){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return t.prototype[n].apply(e,r)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var A=t-this.blockSize,r=this.B,i=this.h,o=0;o<t;){if(0==i)for(;o<=A;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(r[i++]=e.charCodeAt(o++),i==this.blockSize){n(this,r),i=0;break}}else for(;o<t;)if(r[i++]=e[o++],i==this.blockSize){n(this,r),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var A=0;32>A;A+=8)e[n++]=this.g[t]>>>A&255;return e};var r={};function i(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new A([0|e],0>e?-1:0)})):new A([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return s;if(0>e)return I(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new A(t,0)}var s=i(0),a=i(1),g=i(16777216);function l(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function c(e){return-1==e.h}function I(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new A(n,~e.h).add(a)}function C(e,t){return e.add(I(t))}function u(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function d(e,t){this.g=e,this.h=t}function h(e,t){if(l(t))throw Error("division by zero");if(l(e))return new d(s,s);if(c(e))return t=h(I(e),t),new d(I(t.g),I(t.h));if(c(t))return t=h(e,I(t)),new d(I(t.g),t.h);if(30<e.g.length){if(c(e)||c(t))throw Error("slowDivide_ only works with positive integers.");for(var n=a,A=t;0>=A.l(e);)n=m(n),A=m(A);var r=p(n,1),i=p(A,1);for(A=p(A,2),n=p(n,2);!l(A);){var g=i.add(A);0>=g.l(e)&&(r=r.add(n),i=g),A=p(A,1),n=p(n,1)}return t=C(e,r.j(t)),new d(r,t)}for(r=s;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),A=48>=(A=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,A-48),g=(i=o(n)).j(t);c(g)||0<g.l(e);)g=(i=o(n-=A)).j(t);l(i)&&(i=a),r=r.add(i),e=C(e,g)}return new d(r,e)}function m(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new A(n,e.h)}function p(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],o=0;o<r;o++)i[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new A(i,e.h)}(e=A.prototype).m=function(){if(c(this))return-I(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var A=this.i(n);e+=(0<=A?A:4294967296+A)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(l(this))return"0";if(c(this))return"-"+I(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,A="";;){var r=h(n,t).g,i=((0<(n=C(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(l(n=r))return i+A;for(;6>i.length;)i="0"+i;A=i+A}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return c(e=C(this,e))?-1:l(e)?0:1},e.abs=function(){return c(this)?I(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var o=r+(65535&this.i(i))+(65535&e.i(i)),s=(o>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=s>>>16,o&=65535,s&=65535,n[i]=s<<16|o}return new A(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(l(this)||l(e))return s;if(c(this))return c(e)?I(this).j(I(e)):I(I(this).j(e));if(c(e))return I(this.j(I(e)));if(0>this.l(g)&&0>e.l(g))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.i(r)>>>16,C=65535&this.i(r),d=e.i(i)>>>16,h=65535&e.i(i);n[2*r+2*i]+=C*h,u(n,2*r+2*i),n[2*r+2*i+1]+=a*h,u(n,2*r+2*i+1),n[2*r+2*i+1]+=C*d,u(n,2*r+2*i+1),n[2*r+2*i+2]+=a*d,u(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new A(n,0)},e.A=function(e){return h(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new A(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new A(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new A(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,JA=t,A.prototype.add=A.prototype.add,A.prototype.multiply=A.prototype.j,A.prototype.modulo=A.prototype.A,A.prototype.compare=A.prototype.l,A.prototype.toNumber=A.prototype.m,A.prototype.toString=A.prototype.toString,A.prototype.getBits=A.prototype.i,A.fromNumber=o,A.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return I(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=o(Math.pow(n,8)),r=s,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),g=parseInt(t.substring(i,i+a),n);8>a?(a=o(Math.pow(n,a)),r=r.j(a).add(o(g))):r=(r=r.j(A)).add(o(g))}return r},xA=A}).apply(void 0!==YA?YA:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var UA,LA,TA,KA,MA,QA,DA,zA,OA="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof OA&&OA];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,A){if(A)e:{var r=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in r))break e;r=r[o]}(A=A(i=r[e=e[e.length-1]]))!=i&&null!=A&&t(r,e,{configurable:!0,writable:!0,value:A})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,A=!1,r={next:function(){if(!A&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return A=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e,t){return t}))}}));
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */
var A=A||{},r=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function a(e,t,n){if(!e)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,A),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function g(e,t,n){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:a).apply(null,arguments)}function l(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function c(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,A){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return t.prototype[n].apply(e,r)}}function I(e){const t=e.length;if(0<t){const n=Array(t);for(let A=0;A<t;A++)n[A]=e[A];return n}return[]}function C(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,A=t.length||0;e.length=n+A;for(let r=0;r<A;r++)e[n+r]=t[r]}else e.push(t)}}function u(e){return/^[\s\xa0]*$/.test(e)}function d(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function h(e){return h[" "](e),e}h[" "]=function(){};var m=!(-1==d().indexOf("Gecko")||-1!=d().toLowerCase().indexOf("webkit")&&-1==d().indexOf("Edge")||-1!=d().indexOf("Trident")||-1!=d().indexOf("MSIE")||-1!=d().indexOf("Edge"));function p(e,t,n){for(const A in e)t.call(n,e[A],A,e)}function f(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(e,t){let n,A;for(let r=1;r<arguments.length;r++){for(n in A=arguments[r],A)e[n]=A[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(A,n)&&(e[n]=A[n])}}function y(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function w(e){r.setTimeout((()=>{throw e}),0)}function Z(){var e=V;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new v),(e=>e.reset()));class v{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let G,R=!1,V=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=r.Promise.resolve(void 0);G=()=>{e.then(k)}};var k=()=>{for(var e;e=Z();){try{e.h.call(e.g)}catch(n){w(n)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}R=!1};function W(){this.s=this.s,this.C=this.C}function F(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},F.prototype.h=function(){this.defaultPrevented=!0};var E=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function X(e,t){if(F.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,A=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(m){e:{try{h(t.nodeName);var r=!0;break e}catch(i){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,A?(this.clientX=void 0!==A.clientX?A.clientX:A.pageX,this.clientY=void 0!==A.clientY?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:H[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&X.aa.h.call(this)}}c(X,F);var H={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var x="closure_listenable_"+(1e6*Math.random()|0),J=0;function Y(e,t,n,A,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!A,this.ha=r,this.key=++J,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function L(e){this.src=e,this.g={},this.h=0}function T(e,t){var n=t.type;if(n in e.g){var A,r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0);(A=0<=i)&&Array.prototype.splice.call(r,i,1),A&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function K(e,t,n,A){for(var r=0;r<e.length;++r){var i=e[r];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==A)return r}return-1}L.prototype.add=function(e,t,n,A,r){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=K(e,t,A,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new Y(t,this.src,i,!!A,r)).fa=n,e.push(t)),t};var M="closure_lm_"+(1e6*Math.random()|0),Q={};function D(e,t,n,A,r){if(Array.isArray(t)){for(var i=0;i<t.length;i++)D(e,t[i],n,A,r);return null}return n=$(n),e&&e[x]?e.K(t,n,!!o(A)&&!!A.capture,r):function(e,t,n,A,r,i){if(!t)throw Error("Invalid event type");var s=o(r)?!!r.capture:!!r,a=j(e);if(a||(e[M]=a=new L(e)),n=a.add(t,n,A,s,i),n.proxy)return n;if(A=function(){function e(n){return t.call(e.src,e.listener,n)}const t=_;return e}(),n.proxy=A,A.src=e,A.listener=n,e.addEventListener)E||(r=s),void 0===r&&(r=!1),e.addEventListener(t.toString(),A,r);else if(e.attachEvent)e.attachEvent(P(t.toString()),A);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(A)}return n}(e,t,n,!1,A,r)}function z(e,t,n,A,r){if(Array.isArray(t))for(var i=0;i<t.length;i++)z(e,t[i],n,A,r);else A=o(A)?!!A.capture:!!A,n=$(n),e&&e[x]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=K(i=e.g[t],n,A,r))&&(U(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=j(e))&&(t=e.g[t.toString()],e=-1,t&&(e=K(t,n,A,r)),(n=-1<e?t[e]:null)&&O(n))}function O(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[x])T(t.i,e);else{var n=e.type,A=e.proxy;t.removeEventListener?t.removeEventListener(n,A,e.capture):t.detachEvent?t.detachEvent(P(n),A):t.addListener&&t.removeListener&&t.removeListener(A),(n=j(t))?(T(n,e),0==n.h&&(n.src=null,t[M]=null)):U(e)}}}function P(e){return e in Q?Q[e]:Q[e]="on"+e}function _(e,t){if(e.da)e=!0;else{t=new X(t,this);var n=e.listener,A=e.ha||e.src;e.fa&&O(e),e=n.call(A,t)}return e}function j(e){return(e=e[M])instanceof L?e:null}var q="__closure_events_fn_"+(1e9*Math.random()>>>0);function $(e){return"function"==typeof e?e:(e[q]||(e[q]=function(t){return e.handleEvent(t)}),e[q])}function ee(){W.call(this),this.i=new L(this),this.M=this,this.F=null}function te(e,t){var n,A=e.F;if(A)for(n=[];A;A=A.F)n.push(A);if(e=e.M,A=t.type||t,"string"==typeof t)t=new F(t,e);else if(t instanceof F)t.target=t.target||e;else{var r=t;B(t=new F(A,e),r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];r=ne(o,A,!0,t)&&r}if(r=ne(o=t.g=e,A,!0,t)&&r,r=ne(o,A,!1,t)&&r,n)for(i=0;i<n.length;i++)r=ne(o=t.g=n[i],A,!1,t)&&r}function ne(e,t,n,A){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.da&&o.capture==n){var s=o.listener,a=o.ha||o.src;o.fa&&T(e.i,o),r=!1!==s.call(a,A)&&r}}return r&&!A.defaultPrevented}function Ae(e,t,n){if("function"==typeof e)n&&(e=g(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=g(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function re(e){e.g=Ae((()=>{e.g=null,e.i&&(e.i=!1,re(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}c(ee,W),ee.prototype[x]=!0,ee.prototype.removeEventListener=function(e,t,n,A){z(this,e,t,n,A)},ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],A=0;A<n.length;A++)U(n[A]);delete t.g[e],t.h--}}this.F=null},ee.prototype.K=function(e,t,n,A){return this.i.add(String(e),t,!1,n,A)},ee.prototype.L=function(e,t,n,A){return this.i.add(String(e),t,!0,n,A)};class ie extends W{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:re(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oe(e){W.call(this),this.h=e,this.g={}}c(oe,W);var se=[];function ae(e){p(e.g,(function(e,t){this.g.hasOwnProperty(t)&&O(e)}),e),e.g={}}oe.prototype.N=function(){oe.aa.N.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ge=r.JSON.stringify,le=r.JSON.parse,ce=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function Ie(){}function Ce(e){return e.h||(e.h=e.i())}function ue(){}Ie.prototype.h=null;var de={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function he(){F.call(this,"d")}function me(){F.call(this,"c")}c(he,F),c(me,F);var pe={},fe=null;function be(){return fe=fe||new ee}function Be(e){F.call(this,pe.La,e)}function ye(e){const t=be();te(t,new Be(t))}function we(e,t){F.call(this,pe.STAT_EVENT,e),this.stat=t}function Ze(e){const t=be();te(t,new we(t,e))}function Se(e,t){F.call(this,pe.Ma,e),this.size=t}function ve(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout((function(){e()}),t)}function Ge(){this.g=!0}function Re(e,t,n,A){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var A=n[e];if(!(2>A.length)){var r=A[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<r.length;o++)r[o]=""}}}return ge(n)}catch(s){return t}}(e,n)+(A?" "+A:"")}))}pe.La="serverreachability",c(Be,F),pe.STAT_EVENT="statevent",c(we,F),pe.Ma="timingevent",c(Se,F),Ge.prototype.xa=function(){this.g=!1},Ge.prototype.info=function(){};var Ve,Ne={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ke={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function We(){}function Fe(e,t,n,A){this.j=e,this.i=t,this.l=n,this.R=A||1,this.U=new oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ee}function Ee(){this.i=null,this.g="",this.h=!1}c(We,Ie),We.prototype.g=function(){return new XMLHttpRequest},We.prototype.i=function(){return{}},Ve=new We;var Xe={},He={};function xe(e,t,n){e.L=1,e.v=gt(rt(t)),e.m=n,e.P=!0,Je(e,null)}function Je(e,t){e.F=Date.now(),Le(e),e.A=rt(e.v);var n=e.A,A=e.R;Array.isArray(A)||(A=[String(A)]),yt(n.i,"t",A),e.C=0,n=e.j.J,e.h=new Ee,e.g=ln(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ie(g(e.Y,e,e.g),e.O)),t=e.U,n=e.g,A=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(se[0]=r.toString()),r=se);for(var i=0;i<r.length;i++){var o=D(n,r[i],A||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?f(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ye(),function(e,t,n,A,r,i){e.info((function(){if(e.g)if(i)for(var o="",s=i.split("&"),a=0;a<s.length;a++){var g=s[a].split("=");if(1<g.length){var l=g[0];g=g[1];var c=l.split("_");o=2<=c.length&&"type"==c[1]?o+(l+"=")+g+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+A+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ye(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ue(e,t){var n=e.C,A=t.indexOf("\n",n);return-1==A?He:(n=Number(t.substring(n,A)),isNaN(n)?Xe:(A+=1)+n>t.length?He:(t=t.slice(A,A+n),e.C=A+n,t))}function Le(e){e.S=Date.now()+e.I,Te(e,e.I)}function Te(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ve(g(e.ba,e),t)}function Ke(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function Me(e){0==e.j.G||e.J||rn(e.j,e)}function Qe(e){Ke(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ae(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function De(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||je(n.h,e)))if(!e.K&&je(n.h,e)&&3==n.G){try{var A=n.Da.g.parse(t)}catch(l){A=null}if(Array.isArray(A)&&3==A.length){var r=A;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;An(n),zt(n)}en(n),Ze(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=ve(g(n.Za,n),6e3));if(1>=_e(n.h)&&n.ca){try{n.ca()}catch(l){}n.ca=void 0}}else sn(n,11)}else if((e.K||n.g==e)&&An(n),!u(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let g=r[t];if(n.T=g[0],g=g[1],2==n.G)if("c"==g[0]){n.K=g[1],n.ia=g[2];const t=g[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=g[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const l=g[5];null!=l&&"number"==typeof l&&0<l&&(A=1.5*l,n.L=A,n.j.info("backChannelRequestTimeoutMs_="+A)),A=n;const c=e.g;if(c){const e=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=A.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(qe(i,i.h),i.h=null))}if(A.D){const e=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(A.ya=e,at(A.I,A.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((A=n).qa=gn(A,A.J?A.ia:null,A.W),o.K){$e(A.h,o);var s=o,a=A.L;a&&(s.I=a),s.B&&(Ke(s),Le(s)),A.g=o}else $t(A);0<n.i.length&&Pt(n)}else"stop"!=g[0]&&"close"!=g[0]||sn(n,7);else 3==n.G&&("stop"==g[0]||"close"==g[0]?"stop"==g[0]?sn(n,7):Dt(n):"noop"!=g[0]&&n.l&&n.l.ta(g),n.v=0)}ye()}catch(l){}}Fe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Tt(e)?t.j():this.Y(e)},Fe.prototype.Y=function(e){try{if(e==this.g)e:{const I=Tt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>I)&&(3!=I||this.g&&(this.h.h||this.g.oa()||Kt(this.g)))){this.J||4!=I||7==t||ye(),Ke(this);var n=this.g.Z();this.X=n;t:if(Ye(this)){var A=Kt(this.g);e="";var i=A.length,o=4==Tt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Qe(this),Me(this);var s="";break t}this.h.i=new r.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(A[t],{stream:!(o&&t==i-1)});A.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(e,t,n,A,r,i,o){e.info((function(){return"XMLHTTP RESP ("+A+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.i,this.u,this.A,this.l,this.R,I,n),this.o){if(this.T&&!this.K){t:{if(this.g){var a,g=this.g;if((a=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!u(a)){var l=a;break t}}l=null}if(!(n=l)){this.o=!1,this.s=3,Ze(12),Qe(this),Me(this);break e}Re(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,De(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;){if(e=Ue(this,s),e==He){4==I&&(this.s=4,Ze(14),n=!1),Re(this.i,this.l,null,"[Incomplete Response]");break}if(e==Xe){this.s=4,Ze(15),Re(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}Re(this.i,this.l,e,null),De(this,e)}if(Ye(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=I||0!=s.length||this.h.h||(this.s=1,Ze(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var c=this.j;c.g==this&&c.ba&&!c.M&&(c.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),tn(c),c.M=!0,Ze(11))}}else Re(this.i,this.l,s,"[Invalid Chunked Response]"),Qe(this),Me(this)}else Re(this.i,this.l,s,null),De(this,s);4==I&&Qe(this),this.o&&!this.J&&(4==I?rn(this.j,this):(this.o=!1,Le(this)))}else(function(e){const t={};e=(e.g&&2<=Tt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let A=0;A<e.length;A++){if(u(e[A]))continue;var n=y(e[A]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[r]||[];t[r]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,Ze(12)):(this.s=0,Ze(13)),Qe(this),Me(this)}}}catch(I){}},Fe.prototype.cancel=function(){this.J=!0,Qe(this)},Fe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(ye(),Ze(17)),Qe(this),this.s=2,Me(this)):Te(this,this.S-e)};var ze=class{constructor(e,t){this.g=e,this.map=t}};function Oe(e){this.l=e||10,r.PerformanceNavigationTiming?e=0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Pe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function _e(e){return e.h?1:e.g?e.g.size:0}function je(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function qe(e,t){e.g?e.g.add(t):e.h=t}function $e(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function et(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return I(e.i)}function tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(i(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const A in e)t[n++]=A;return t}}}(e),A=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,A=0;A<n;A++)t.push(e[A]);return t}for(A in t=[],n=0,e)t[n++]=e[A];return t}(e),r=A.length,o=0;o<r;o++)t.call(void 0,A[o],n&&n[o],e)}Oe.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function At(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof At){this.h=e.h,it(this,e.j),this.o=e.o,this.g=e.g,ot(this,e.s),this.l=e.l;var t=e.i,n=new pt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),st(this,n),this.m=e.m}else e&&(t=String(e).match(nt))?(this.h=!1,it(this,t[1]||"",!0),this.o=lt(t[2]||""),this.g=lt(t[3]||"",!0),ot(this,t[4]),this.l=lt(t[5]||"",!0),st(this,t[6]||"",!0),this.m=lt(t[7]||"")):(this.h=!1,this.i=new pt(null,this.h))}function rt(e){return new At(e)}function it(e,t,n){e.j=n?lt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ot(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function st(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(ft(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(bt(this,t),yt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ct(t,ht)),e.i=new pt(t,e.h))}function at(e,t,n){e.i.set(t,n)}function gt(e){return at(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function lt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ct(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,It),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function It(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}At.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ct(t,Ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ct(t,Ct,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ct(n,"/"==n.charAt(0)?dt:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ct(n,mt)),e.join("")};var Ct=/[#\/\?@]/g,ut=/[#\?:]/g,dt=/[#\?]/g,ht=/[#\?@]/g,mt=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ft(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var A=e[n].indexOf("="),r=null;if(0<=A){var i=e[n].substring(0,A);r=e[n].substring(A+1)}else i=e[n];t(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function bt(e,t){ft(e),t=wt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Bt(e,t){return ft(e),t=wt(e,t),e.g.has(t)}function yt(e,t,n){bt(e,t),0<n.length&&(e.i=null,e.g.set(wt(e,t),I(n)),e.h+=n.length)}function wt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Zt(e,t,n,A,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),A(n)}catch(i){}}function St(){this.g=new ce}function vt(e,t,n){const A=n||"";try{tt(e,(function(e,n){let r=e;o(e)&&(r=ge(e)),t.push(A+n+"="+encodeURIComponent(r))}))}catch(Zf){throw t.push(A+"type="+encodeURIComponent("_badmap")),Zf}}function Gt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Rt(e,t){ee.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Vt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Nt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,kt(e)}function kt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Wt(e){let t="";return p(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ft(e,t,n){e:{for(A in n){var A=!1;break e}A=!0}A||(n=Wt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):at(e,t,n))}function Et(e){ee.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=pt.prototype).add=function(e,t){ft(this),this.i=null,e=wt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){ft(this),this.g.forEach((function(n,A){n.forEach((function(n){e.call(t,n,A,this)}),this)}),this)},e.na=function(){ft(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let A=0;A<t.length;A++){const r=e[A];for(let e=0;e<r.length;e++)n.push(t[A])}return n},e.V=function(e){ft(this);let t=[];if("string"==typeof e)Bt(this,e)&&(t=t.concat(this.g.get(wt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return ft(this),this.i=null,Bt(this,e=wt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var A=t[n];const i=encodeURIComponent(String(A)),o=this.V(A);for(A=0;A<o.length;A++){var r=i;""!==o[A]&&(r+="="+encodeURIComponent(String(o[A]))),e.push(r)}}return this.i=e.join("&")},c(Gt,Ie),Gt.prototype.g=function(){return new Rt(this.l,this.j)},Gt.prototype.i=function(e){return function(){return e}}({}),c(Rt,ee),(e=Rt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,kt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Nt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,kt(this)),this.g&&(this.readyState=3,kt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Nt(this):kt(this),3==this.readyState&&Vt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Nt(this))},e.Qa=function(e){this.g&&(this.response=e,Nt(this))},e.ga=function(){this.g&&Nt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Rt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),c(Et,ee);var Xt=/^https?$/i,Ht=["POST","PUT"];function xt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),Ut(e)}function Jt(e){e.A||(e.A=!0,te(e,"complete"),te(e,"error"))}function Yt(e){if(e.h&&void 0!==A&&(!e.v[1]||4!=Tt(e)||2!=e.Z()))if(e.u&&4==Tt(e))Ae(e.Ea,0,e);else if(te(e,"readystatechange"),4==Tt(e)){e.h=!1;try{const A=e.Z();e:switch(A){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===A){var o=String(e.D).match(nt)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),i=!Xt.test(o?o.toLowerCase():"")}n=i}if(n)te(e,"complete"),te(e,"success");else{e.m=6;try{var s=2<Tt(e)?e.g.statusText:""}catch(a){s=""}e.l=s+" ["+e.Z()+"]",Jt(e)}}finally{Ut(e)}}}function Ut(e,t){if(e.g){Lt(e);const n=e.g,A=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||te(e,"ready");try{n.onreadystatechange=A}catch(Zf){}}}function Lt(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function Tt(e){return e.g?e.g.readyState:0}function Kt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Mt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Qt(e){this.Aa=0,this.i=[],this.j=new Ge,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mt("baseRetryDelayMs",5e3,e),this.cb=Mt("retryDelaySeedMs",1e4,e),this.Wa=Mt("forwardChannelMaxRetries",2,e),this.wa=Mt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Oe(e&&e.concurrentRequestLimit),this.Da=new St,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Dt(e){if(Ot(e),3==e.G){var t=e.U++,n=rt(e.I);if(at(n,"SID",e.K),at(n,"RID",t),at(n,"TYPE","terminate"),jt(e,n),(t=new Fe(e,e.j,t)).L=2,t.v=gt(rt(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(A){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=ln(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Le(t)}an(e)}function zt(e){e.g&&(tn(e),e.g.cancel(),e.g=null)}function Ot(e){zt(e),e.u&&(r.clearTimeout(e.u),e.u=null),An(e),e.h.cancel(),e.s&&("number"==typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Pt(e){if(!Pe(e.h)&&!e.s){e.s=!0;var t=e.Ga;G||N(),R||(G(),R=!0),V.add(t,e),e.B=0}}function _t(e,t){var n;n=t?t.l:e.U++;const A=rt(e.I);at(A,"SID",e.K),at(A,"RID",n),at(A,"AID",e.T),jt(e,A),e.m&&e.o&&Ft(A,e.m,e.o),n=new Fe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=qt(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),qe(e.h,n),xe(n,A,t)}function jt(e,t){e.H&&p(e.H,(function(e,n){at(t,n,e)})),e.l&&tt({},(function(e,n){at(t,n,e)}))}function qt(e,t,n){n=Math.min(e.i.length,n);var A=e.l?g(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=r[s].g;const a=r[s].map;if(n-=t,0>n)t=Math.max(0,r[s].g-100),o=!1;else try{vt(a,e,"req"+n+"_")}catch(i){A&&A(a)}}if(o){A=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,A}function $t(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;G||N(),R||(G(),R=!0),V.add(t,e),e.v=0}}function en(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=ve(g(e.Fa,e),on(e,e.v)),e.v++,!0)}function tn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function nn(e){e.g=new Fe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=rt(e.qa);at(t,"RID","rpc"),at(t,"SID",e.K),at(t,"AID",e.T),at(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&at(t,"TO",e.ja),at(t,"TYPE","xmlhttp"),jt(e,t),e.m&&e.o&&Ft(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=gt(rt(t)),n.m=null,n.P=!0,Je(n,e)}function An(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function rn(e,t){var n=null;if(e.g==t){An(e),tn(e),e.g=null;var A=2}else{if(!je(e.h,t))return;n=t.D,$e(e.h,t),A=1}if(0!=e.G)if(t.o)if(1==A){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;te(A=be(),new Se(A,n)),Pt(e)}else $t(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==A&&function(e,t){return!(_e(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=ve(g(e.Ga,e,t),on(e,e.B)),e.B++,0)))}(e,t)||2==A&&en(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:sn(e,5);break;case 4:sn(e,10);break;case 3:sn(e,6);break;default:sn(e,2)}}function on(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function sn(e,t){if(e.j.info("Error code "+t),2==t){var n=g(e.fb,e),A=e.Xa;const t=!A;A=new At(A||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||it(A,"https"),gt(A),t?function(e,t){const n=new Ge;if(r.Image){const A=new Image;A.onload=l(Zt,n,"TestLoadImage: loaded",!0,t,A),A.onerror=l(Zt,n,"TestLoadImage: error",!1,t,A),A.onabort=l(Zt,n,"TestLoadImage: abort",!1,t,A),A.ontimeout=l(Zt,n,"TestLoadImage: timeout",!1,t,A),r.setTimeout((function(){A.ontimeout&&A.ontimeout()}),1e4),A.src=e}else t(!1)}(A.toString(),n):function(e,t){new Ge;const n=new AbortController,A=setTimeout((()=>{n.abort(),Zt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(A),e.ok?Zt(0,0,!0,t):Zt(0,0,!1,t)})).catch((()=>{clearTimeout(A),Zt(0,0,!1,t)}))}(A.toString(),n)}else Ze(2);e.G=0,e.l&&e.l.sa(t),an(e),Ot(e)}function an(e){if(e.G=0,e.ka=[],e.l){const t=et(e.h);0==t.length&&0==e.i.length||(C(e.ka,t),C(e.ka,e.i),e.h.i.length=0,I(e.i),e.i.length=0),e.l.ra()}}function gn(e,t,n){var A=n instanceof At?rt(n):new At(n);if(""!=A.g)t&&(A.g=t+"."+A.g),ot(A,A.s);else{var i=r.location;A=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var o=new At(null);A&&it(o,A),t&&(o.g=t),i&&ot(o,i),n&&(o.l=n),A=o}return n=e.D,t=e.ya,n&&t&&at(A,n,t),at(A,"VER",e.la),jt(e,A),A}function ln(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Et(new Gt({eb:n})):new Et(e.pa)).Ha(e.J),t}function cn(){}function In(){}function Cn(e,t){ee.call(this),this.g=new Qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!u(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!u(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new hn(this)}function un(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function dn(){me.call(this),this.status=1}function hn(e){this.g=e}(e=Et.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ve.g(),this.v=this.o?Ce(this.o):Ce(Ve),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void xt(this,o)}if(e=n||"",n=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var i in A)n.set(i,A[i]);else{if("function"!=typeof A.keys||"function"!=typeof A.get)throw Error("Unknown input type for opt_headers: "+String(A));for(const e of A.keys())n.set(e,A.get(e))}A=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Ht,t,void 0))||A||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,s]of n)this.g.setRequestHeader(r,s);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Lt(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){xt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,te(this,"complete"),te(this,"abort"),Ut(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ut(this,!0)),Et.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Yt(this):this.bb())},e.bb=function(){Yt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Tt(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),le(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Qt.prototype).la=8,e.G=1,e.connect=function(e,t,n,A){Ze(0),this.W=e,this.H=t||{},n&&void 0!==A&&(this.H.OSID=n,this.H.OAID=A),this.F=this.X,this.I=gn(this,null,this.W),Pt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new Fe(this,this.j,e);let i=this.o;if(this.S&&(i?(i=f(i),B(i,this.S)):i=this.S),null!==this.m||this.O||(r.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var A=this.i[n];if(void 0===(A="__data__"in A.map&&"string"==typeof(A=A.map.__data__)?A.length:void 0))break;if(4096<(t+=A)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=qt(this,r,t),at(n=rt(this.I),"RID",e),at(n,"CVER",22),this.D&&at(n,"X-HTTP-Session-Id",this.D),jt(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Wt(i)))+"&"+t:this.m&&Ft(n,this.m,i)),qe(this.h,r),this.Ua&&at(n,"TYPE","init"),this.P?(at(n,"$req",t),at(n,"SID","null"),r.T=!0,xe(r,n,null)):xe(r,n,t),this.G=2}}else 3==this.G&&(e?_t(this,e):0==this.i.length||Pe(this.h)||_t(this))},e.Fa=function(){if(this.u=null,nn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ve(g(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ze(10),zt(this),nn(this))},e.Za=function(){null!=this.C&&(this.C=null,zt(this),en(this),Ze(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=cn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},In.prototype.g=function(e,t){return new Cn(e,t)},c(Cn,ee),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){Dt(this.g)},Cn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ge(e),e=n);t.i.push(new ze(t.Ya++,e)),3==t.G&&Pt(t)},Cn.prototype.N=function(){this.g.l=null,delete this.j,Dt(this.g),delete this.g,Cn.aa.N.call(this)},c(un,he),c(dn,me),c(hn,cn),hn.prototype.ua=function(){te(this.g,"a")},hn.prototype.ta=function(e){te(this.g,new un(e))},hn.prototype.sa=function(e){te(this.g,new dn)},hn.prototype.ra=function(){te(this.g,"b")},In.prototype.createWebChannel=In.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,zA=function(){return new In},DA=function(){return be()},QA=pe,MA={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,KA=Ne,ke.COMPLETE="complete",TA=ke,ue.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",ee.prototype.listen=ee.prototype.K,LA=ue,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,UA=Et}).apply(void 0!==OA?OA:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const PA="@firebase/firestore",_A="4.7.16";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jA.UNAUTHENTICATED=new jA(null),jA.GOOGLE_CREDENTIALS=new jA("google-credentials-uid"),jA.FIRST_PARTY=new jA("first-party-uid"),jA.MOCK_USER=new jA("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let qA="11.8.1";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=new bn("@firebase/firestore");function er(){return $A.logLevel}function tr(e,...t){if($A.logLevel<=un.DEBUG){const n=t.map(rr);$A.debug(`Firestore (${qA}): ${e}`,...n)}}function nr(e,...t){if($A.logLevel<=un.ERROR){const n=t.map(rr);$A.error(`Firestore (${qA}): ${e}`,...n)}}function Ar(e,...t){if($A.logLevel<=un.WARN){const n=t.map(rr);$A.warn(`Firestore (${qA}): ${e}`,...n)}}function rr(e){if("string"==typeof e)return e;try{
/**
    * @license
    * Copyright 2020 Google LLC
    *
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    *   http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    */
return t=e,JSON.stringify(t)}catch(sy){return e}var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(e,t,n){let A="Unexpected state";"string"==typeof t?A=t:n=t,or(e,A,n)}function or(e,t,n){let A=`FIRESTORE (${qA}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{A+=" CONTEXT: "+JSON.stringify(n)}catch(r){A+=" CONTEXT: "+n}throw nr(A),new Error(A)}function sr(e,t,n,A){let r="Unexpected state";"string"==typeof n?r=n:A=n,e||or(t,r,A)}function ar(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lr extends en{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Cr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(jA.UNAUTHENTICATED)))}shutdown(){}}class ur{constructor(e){this.t=e,this.currentUser=jA.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){sr(void 0===this.o,42304);let n=this.i;const A=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new cr,e.enqueueRetryable((()=>A(this.currentUser)))};const i=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await A(this.currentUser)}))},o=e=>{tr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(tr("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new cr)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(tr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(sr("string"==typeof t.accessToken,31837,{l:t}),new Ir(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return sr(null===e||"string"==typeof e,2055,{h:e}),new jA(e)}}class dr{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=jA.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hr{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new dr(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(jA.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mr{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pr{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,BA(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){sr(void 0===this.o,3512);const n=e=>{null!=e.error&&tr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,tr("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const A=e=>{tr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>A(e))),setTimeout((()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?A(e):tr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mr(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(sr("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new mr(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let A=0;A<e;A++)n[A]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(){return new TextEncoder}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=fr(40);for(let A=0;A<n.length;++A)t.length<20&&n[A]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[A]%62))}return t}}function yr(e,t){return e<t?-1:e>t?1:0}function wr(e,t){let n=0;for(;n<e.length&&n<t.length;){const A=e.codePointAt(n),r=t.codePointAt(n);if(A!==r){if(A<128&&r<128)return yr(A,r);{const i=br(),o=Sr(i.encode(Zr(e,n)),i.encode(Zr(t,n)));return 0!==o?o:yr(A,r)}}n+=A>65535?2:1}return yr(e.length,t.length)}function Zr(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Sr(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return yr(e[n],t[n]);return yr(e.length,t.length)}function vr(e,t,n){return e.length===t.length&&e.every(((e,A)=>n(e,t[A])))}function Gr(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=-62135596800,Vr=1e6;class Nr{static now(){return Nr.fromMillis(Date.now())}static fromDate(e){return Nr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Vr);return new Nr(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new lr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new lr(gr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Rr)throw new lr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new lr(gr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Vr}_compareTo(e){return this.seconds===e.seconds?yr(this.nanoseconds,e.nanoseconds):yr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Rr;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{static fromTimestamp(e){return new kr(e)}static min(){return new kr(new Nr(0,0))}static max(){return new kr(new Nr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="__name__";class Fr{constructor(e,t,n){void 0===t?t=0:t>e.length&&ir(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&ir(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Fr.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fr?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let A=0;A<n;A++){const n=Fr.compareSegments(e.get(A),t.get(A));if(0!==n)return n}return yr(e.length,t.length)}static compareSegments(e,t){const n=Fr.isNumericId(e),A=Fr.isNumericId(t);return n&&!A?-1:!n&&A?1:n&&A?Fr.extractNumericId(e).compare(Fr.extractNumericId(t)):wr(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return xA.fromString(e.substring(4,e.length-2))}}class Er extends Fr{construct(e,t,n){return new Er(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new lr(gr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Er(t)}static emptyPath(){return new Er([])}}const Xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hr extends Fr{construct(e,t,n){return new Hr(e,t,n)}static isValidIdentifier(e){return Xr.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Wr}static keyField(){return new Hr([Wr])}static fromServerFormat(e){const t=[];let n="",A=0;const r=()=>{if(0===n.length)throw new lr(gr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;A<e.length;){const t=e[A];if("\\"===t){if(A+1===e.length)throw new lr(gr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[A+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new lr(gr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,A+=2}else"`"===t?(i=!i,A++):"."!==t||i?(n+=t,A++):(r(),A++)}if(r(),i)throw new lr(gr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hr(t)}static emptyPath(){return new Hr([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.path=e}static fromPath(e){return new xr(Er.fromString(e))}static fromName(e){return new xr(Er.fromString(e).popFirst(5))}static empty(){return new xr(Er.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Er.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Er.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xr(new Er(e.slice()))}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=-1;class Yr{constructor(e,t,n,A){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=A}}function Ur(e){return e.fields.find((e=>2===e.kind))}function Lr(e){return e.fields.filter((e=>2!==e.kind))}Yr.UNKNOWN_ID=-1;class Tr{constructor(e,t){this.fieldPath=e,this.kind=t}}class Kr{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Kr(0,Dr.min())}}function Mr(e,t){const n=e.toTimestamp().seconds,A=e.toTimestamp().nanoseconds+1,r=kr.fromTimestamp(1e9===A?new Nr(n+1,0):new Nr(n,A));return new Dr(r,xr.empty(),t)}function Qr(e){return new Dr(e.readTime,e.key,Jr)}class Dr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Dr(kr.min(),xr.empty(),Jr)}static max(){return new Dr(kr.max(),xr.empty(),Jr)}}function zr(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=xr.comparator(e.documentKey,t.documentKey),0!==n?n:yr(e.largestBatchId,t.largestBatchId)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}const Or="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Pr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(e){if(e.code!==gr.FAILED_PRECONDITION||e.message!==Or)throw e;tr("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ir(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new jr(((n,A)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,A)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,A)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof jr?t:jr.resolve(t)}catch(t){return jr.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):jr.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):jr.reject(t)}static resolve(e){return new jr(((t,n)=>{t(e)}))}static reject(e){return new jr(((t,n)=>{n(e)}))}static waitFor(e){return new jr(((t,n)=>{let A=0,r=0,i=!1;e.forEach((e=>{++A,e.next((()=>{++r,i&&r===A&&t()}),(e=>n(e)))})),i=!0,r===A&&t()}))}static or(e){let t=jr.resolve(!1);for(const n of e)t=t.next((e=>e?jr.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,A)=>{n.push(t.call(this,e,A))})),this.waitFor(n)}static mapArray(e,t){return new jr(((n,A)=>{const r=e.length,i=new Array(r);let o=0;for(let s=0;s<r;s++){const a=s;t(e[a]).next((e=>{i[a]=e,++o,o===r&&n(i)}),(e=>A(e)))}}))}static doWhile(e,t){return new jr(((n,A)=>{const r=()=>{!0===e()?t().next((()=>{r()}),A):n()};r()}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr="SimpleDb";class $r{static open(e,t,n,A){try{return new $r(t,e.transaction(A,n))}catch(r){throw new Ai(t,r)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Ai(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=ai(t.target.error);this.S.reject(new Ai(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(tr(qr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ii(t)}}class ei{static delete(e){return tr(qr,"Removing database:",e),oi(Yt().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!$t())return!1;if(ei.F())return!0;const e=Pt(),t=ei.M(e),n=0<t&&t<10,A=ti(e),r=0<A&&A<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||r)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.O)}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,12.2===ei.M(Pt())&&nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(tr(qr,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const A=indexedDB.open(this.name,this.version);A.onsuccess=e=>{const n=e.target.result;t(n)},A.onblocked=()=>{n(new Ai(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},A.onerror=t=>{const A=t.target.error;"VersionError"===A.name?n(new lr(gr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===A.name?n(new lr(gr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+A)):n(new Ai(e,A))},A.onupgradeneeded=e=>{tr(qr,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${t.version}`);this.B.q(t,A.transaction,e.oldVersion,this.version).next((()=>{tr(qr,"Database upgrade to version "+this.version+" complete")}))}})),this.db.addEventListener("close",(e=>{const t=e.target;this.L=t.version}),{passive:!0})),this.$&&(this.db.onversionchange=e=>this.$(e)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,A){const r="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.k(e);const t=$r.open(this.db,e,r?"readonly":"readwrite",n),i=A(t).next((e=>(t.v(),e))).catch((e=>(t.abort(e),jr.reject(e)))).toPromise();return i.catch((()=>{})),await t.D,i}catch(o){const e=o,t="FirebaseError"!==e.name&&i<3;if(tr(qr,"Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function ti(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ni{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return oi(this.K.delete())}}class Ai extends lr{constructor(e,t){super(gr.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ri(e){return"IndexedDbTransactionError"===e.name}class ii{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(tr(qr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(tr(qr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),oi(n)}add(e){return tr(qr,"ADD",this.store.name,e,e),oi(this.store.add(e))}get(e){return oi(this.store.get(e)).next((t=>(void 0===t&&(t=null),tr(qr,"GET",this.store.name,e,t),t)))}delete(e){return tr(qr,"DELETE",this.store.name,e),oi(this.store.delete(e))}count(){return tr(qr,"COUNT",this.store.name),oi(this.store.count())}J(e,t){const n=this.options(e,t),A=n.index?this.store.index(n.index):this.store;if("function"==typeof A.getAll){const e=A.getAll(n.range);return new jr(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.Y(e,((e,n)=>{t.push(n)})).next((()=>t))}}Z(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new jr(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}X(e,t){tr(qr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.ee=!1;const A=this.cursor(n);return this.Y(A,((e,t,n)=>n.delete()))}te(e,t){let n;t?n=e:(n={},t=e);const A=this.cursor(n);return this.Y(A,t)}ne(e){const t=this.cursor({});return new jr(((n,A)=>{t.onerror=e=>{const t=ai(e.target.error);A(t)},t.onsuccess=t=>{const A=t.target.result;A?e(A.primaryKey,A.value).next((e=>{e?A.continue():n()})):n()}}))}Y(e,t){const n=[];return new jr(((A,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{const r=e.target.result;if(!r)return void A();const i=new ni(r),o=t(r.primaryKey,r.value,i);if(o instanceof jr){const e=o.catch((e=>(i.done(),jr.reject(e))));n.push(e)}i.isDone?A():null===i.j?r.continue():r.continue(i.j)}})).next((()=>jr.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.ee?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function oi(e){return new jr(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=ai(e.target.error);n(t)}}))}let si=!1;function ai(e){const t=ei.M(Pt());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new lr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return si||(si=!0,setTimeout((()=>{throw e}),0)),e}}return e}const gi="IndexBackfiller";class li{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ie(e){tr(gi,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const e=await this.re.se();tr(gi,`Documents written: ${e}`)}catch(e){ri(e)?tr(gi,"Ignoring IndexedDB error during index backfill: ",e):await _r(e)}await this.ie(6e4)}))}}class ci{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.oe(t,e)))}oe(e,t){const n=new Set;let A=t,r=!0;return jr.doWhile((()=>!0===r&&A>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return tr(gi,`Processing collection: ${t}`),this._e(e,t,A).next((e=>{A-=e,n.add(t)}));r=!1})))).next((()=>t-A))}_e(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((A=>this.localStore.localDocuments.getNextDocuments(e,t,A,n).next((n=>{const r=n.changes;return this.localStore.indexManager.updateIndexEntries(e,r).next((()=>this.ae(A,n))).next((n=>(tr(gi,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>r.size))}))))}ae(e,t){let n=e;return t.changes.forEach(((e,t)=>{const A=Qr(t);zr(A,n)>0&&(n=A)})),new Dr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ue(e),this.ce=e=>t.writeSequenceNumber(e))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Ii.le=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ci=-1;function ui(e){return null==e}function di(e){return 0===e&&1/e==-1/0}function hi(e){return"number"==typeof e&&Number.isInteger(e)&&!di(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi="";function pi(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=bi(t)),t=fi(e.get(n),t);return bi(t)}function fi(e,t){let n=t;const A=e.length;for(let r=0;r<A;r++){const t=e.charAt(r);switch(t){case"\0":n+="";break;case mi:n+="";break;default:n+=t}}return n}function bi(e){return e+mi+""}function Bi(e){const t=e.length;if(sr(t>=2,64408,{path:e}),2===t)return sr(e.charAt(0)===mi&&""===e.charAt(1),56145,{path:e}),Er.emptyPath();const n=t-2,A=[];let r="";for(let i=0;i<t;){const t=e.indexOf(mi,i);switch((t<0||t>n)&&ir(50515,{path:e}),e.charAt(t+1)){case"":const n=e.substring(i,t);let o;0===r.length?o=n:(r+=n,o=r,r=""),A.push(o);break;case"":r+=e.substring(i,t),r+="\0";break;case"":r+=e.substring(i,t+1);break;default:ir(61167,{path:e})}i=t+2}return new Er(A)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="remoteDocuments",wi="owner",Zi="owner",Si="mutationQueues",vi="mutations",Gi="batchId",Ri="userMutationsIndex",Vi=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ni(e,t){return[e,pi(t)]}function ki(e,t,n){return[e,pi(t),n]}const Wi={},Fi="documentMutations",Ei="remoteDocumentsV14",Xi=["prefixPath","collectionGroup","readTime","documentId"],Hi="documentKeyIndex",xi=["prefixPath","collectionGroup","documentId"],Ji="collectionGroupIndex",Yi=["collectionGroup","readTime","prefixPath","documentId"],Ui="remoteDocumentGlobal",Li="remoteDocumentGlobalKey",Ti="targets",Ki="queryTargetsIndex",Mi=["canonicalId","targetId"],Qi="targetDocuments",Di=["targetId","path"],zi="documentTargetsIndex",Oi=["path","targetId"],Pi="targetGlobalKey",_i="targetGlobal",ji="collectionParents",qi=["collectionId","parent"],$i="clientMetadata",eo="bundles",to="namedQueries",no="indexConfiguration",Ao="collectionGroupIndex",ro="indexState",io=["indexId","uid"],oo="sequenceNumberIndex",so=["uid","sequenceNumber"],ao="indexEntries",go=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],lo="documentKeyIndex",co=["indexId","uid","orderedDocumentKey"],Io="documentOverlays",Co=["userId","collectionPath","documentId"],uo="collectionPathOverlayIndex",ho=["userId","collectionPath","largestBatchId"],mo="collectionGroupOverlayIndex",po=["userId","collectionGroup","largestBatchId"],fo="globals",bo=[Si,vi,Fi,yi,Ti,wi,_i,Qi,$i,Ui,ji,eo,to],Bo=[...bo,Io],yo=[Si,vi,Fi,Ei,Ti,wi,_i,Qi,$i,Ui,ji,eo,to,Io],wo=yo,Zo=[...wo,no,ro,ao],So=Zo,vo=[...Zo,fo],Go=vo;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends Pr{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function Vo(e,t){const n=ar(e);return ei.N(n.he,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ko(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Wo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,t){this.comparator=e,this.root=t||Xo.EMPTY}insert(e,t){return new Fo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xo.BLACK,null,null))}remove(e){return new Fo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const A=this.comparator(e,n.key);if(0===A)return t+n.left.size;A<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Eo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Eo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Eo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Eo(this.root,e,this.comparator,!0)}}class Eo{constructor(e,t,n,A){this.isReverse=A,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&A&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xo{constructor(e,t,n,A,r){this.key=e,this.value=t,this.color=null!=n?n:Xo.RED,this.left=null!=A?A:Xo.EMPTY,this.right=null!=r?r:Xo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,A,r){return new Xo(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=A?A:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let A=this;const r=n(e,A.key);return A=r<0?A.copy(null,null,null,A.left.insert(e,t,n),null):0===r?A.copy(null,t,null,null,null):A.copy(null,null,null,null,A.right.insert(e,t,n)),A.fixUp()}removeMin(){if(this.left.isEmpty())return Xo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,A=this;if(t(e,A.key)<0)A.left.isEmpty()||A.left.isRed()||A.left.left.isRed()||(A=A.moveRedLeft()),A=A.copy(null,null,null,A.left.remove(e,t),null);else{if(A.left.isRed()&&(A=A.rotateRight()),A.right.isEmpty()||A.right.isRed()||A.right.left.isRed()||(A=A.moveRedRight()),0===t(e,A.key)){if(A.right.isEmpty())return Xo.EMPTY;n=A.right.min(),A=A.copy(n.key,n.value,null,null,A.right.removeMin())}A=A.copy(null,null,null,null,A.right.remove(e,t))}return A.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ir(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ir(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ir(27949);return e+(this.isRed()?0:1)}}Xo.EMPTY=null,Xo.RED=!0,Xo.BLACK=!1,Xo.EMPTY=new class{constructor(){this.size=0}get key(){throw ir(57766)}get value(){throw ir(16141)}get color(){throw ir(16727)}get left(){throw ir(29726)}get right(){throw ir(36894)}copy(e,t,n,A,r){return this}insert(e,t,n){return new Xo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ho{constructor(e){this.comparator=e,this.data=new Fo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const A=n.getNext();if(this.comparator(A.key,e[1])>=0)return;t(A.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xo(this.data.getIterator())}getIteratorFrom(e){return new xo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Ho))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,A=n.getNext().key;if(0!==this.comparator(e,A))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ho(this.comparator);return t.data=e,t}}class xo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jo(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e){this.fields=e,e.sort(Hr.comparator)}static empty(){return new Yo([])}unionWith(e){let t=new Ho(Hr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Yo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vr(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Uo("Invalid base64 string: "+t):t}}(e);return new Lo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Lo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return yr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lo.EMPTY_BYTE_STRING=new Lo("");const To=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ko(e){if(sr(!!e,39018),"string"==typeof e){let t=0;const n=To.exec(e);if(sr(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const A=new Date(e);return{seconds:Math.floor(A.getTime()/1e3),nanos:t}}return{seconds:Mo(e.seconds),nanos:Mo(e.nanos)}}function Mo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Qo(e){return"string"==typeof e?Lo.fromBase64String(e):Lo.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="server_timestamp",zo="__type__",Oo="__previous_value__",Po="__local_write_time__";function _o(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[zo])||void 0===n?void 0:n.stringValue)===Do}function jo(e){const t=e.mapValue.fields[Oo];return _o(t)?jo(t):t}function qo(e){const t=Ko(e.mapValue.fields[Po].timestampValue);return new Nr(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,t,n,A,r,i,o,s,a,g){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=A,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=a,this.isUsingEmulator=g}}const es="(default)";class ts{constructor(e,t){this.projectId=e,this.database=t||es}static empty(){return new ts("","")}get isDefaultDatabase(){return this.database===es}isEqual(e){return e instanceof ts&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="__type__",As="__max__",rs={mapValue:{fields:{__type__:{stringValue:As}}}},is="__vector__",os="value",ss={nullValue:"NULL_VALUE"};function as(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?_o(e)?4:Ss(e)?9007199254740991:ws(e)?10:11:ir(28295,{value:e})}function gs(e,t){if(e===t)return!0;const n=as(e);if(n!==as(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return qo(e).isEqual(qo(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Ko(e.timestampValue),A=Ko(t.timestampValue);return n.seconds===A.seconds&&n.nanos===A.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return A=t,Qo(e.bytesValue).isEqual(Qo(A.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Mo(e.geoPointValue.latitude)===Mo(t.geoPointValue.latitude)&&Mo(e.geoPointValue.longitude)===Mo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Mo(e.integerValue)===Mo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Mo(e.doubleValue),A=Mo(t.doubleValue);return n===A?di(n)===di(A):isNaN(n)&&isNaN(A)}return!1}(e,t);case 9:return vr(e.arrayValue.values||[],t.arrayValue.values||[],gs);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},A=t.mapValue.fields||{};if(No(n)!==No(A))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===A[r]||!gs(n[r],A[r])))return!1;return!0}(e,t);default:return ir(52216,{left:e})}var A}function ls(e,t){return void 0!==(e.values||[]).find((e=>gs(e,t)))}function cs(e,t){if(e===t)return 0;const n=as(e),A=as(t);if(n!==A)return yr(n,A);switch(n){case 0:case 9007199254740991:return 0;case 1:return yr(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Mo(e.integerValue||e.doubleValue),A=Mo(t.integerValue||t.doubleValue);return n<A?-1:n>A?1:n===A?0:isNaN(n)?isNaN(A)?0:-1:1}(e,t);case 3:return Is(e.timestampValue,t.timestampValue);case 4:return Is(qo(e),qo(t));case 5:return wr(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Qo(e),A=Qo(t);return n.compareTo(A)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),A=t.split("/");for(let r=0;r<n.length&&r<A.length;r++){const e=yr(n[r],A[r]);if(0!==e)return e}return yr(n.length,A.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=yr(Mo(e.latitude),Mo(t.latitude));return 0!==n?n:yr(Mo(e.longitude),Mo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Cs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,A,r,i;const o=e.fields||{},s=t.fields||{},a=null===(n=o[os])||void 0===n?void 0:n.arrayValue,g=null===(A=s[os])||void 0===A?void 0:A.arrayValue,l=yr((null===(r=null==a?void 0:a.values)||void 0===r?void 0:r.length)||0,(null===(i=null==g?void 0:g.values)||void 0===i?void 0:i.length)||0);return 0!==l?l:Cs(a,g)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===rs.mapValue&&t===rs.mapValue)return 0;if(e===rs.mapValue)return 1;if(t===rs.mapValue)return-1;const n=e.fields||{},A=Object.keys(n),r=t.fields||{},i=Object.keys(r);A.sort(),i.sort();for(let o=0;o<A.length&&o<i.length;++o){const e=wr(A[o],i[o]);if(0!==e)return e;const t=cs(n[A[o]],r[i[o]]);if(0!==t)return t}return yr(A.length,i.length)}(e.mapValue,t.mapValue);default:throw ir(23264,{Pe:n})}}function Is(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return yr(e,t);const n=Ko(e),A=Ko(t),r=yr(n.seconds,A.seconds);return 0!==r?r:yr(n.nanos,A.nanos)}function Cs(e,t){const n=e.values||[],A=t.values||[];for(let r=0;r<n.length&&r<A.length;++r){const e=cs(n[r],A[r]);if(e)return e}return yr(n.length,A.length)}function us(e){return ds(e)}function ds(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Ko(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Qo(e.bytesValue).toBase64():"referenceValue"in e?function(e){return xr.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const A of e.values||[])n?n=!1:t+=",",t+=ds(A);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",A=!0;for(const r of t)A?A=!1:n+=",",n+=`${r}:${ds(e.fields[r])}`;return n+"}"}(e.mapValue):ir(61005,{value:e})}function hs(e){switch(as(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=jo(e);return t?16+hs(t):16;case 5:return 2*e.stringValue.length;case 6:return Qo(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce(((e,t)=>e+hs(t)),0);case 10:case 11:return function(e){let t=0;return ko(e.fields,((e,n)=>{t+=e.length+hs(n)})),t}(e.mapValue);default:throw ir(13486,{value:e})}}function ms(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function ps(e){return!!e&&"integerValue"in e}function fs(e){return!!e&&"arrayValue"in e}function bs(e){return!!e&&"nullValue"in e}function Bs(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ys(e){return!!e&&"mapValue"in e}function ws(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[ns])||void 0===n?void 0:n.stringValue)===is}function Zs(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ko(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Zs(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Zs(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ss(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===As}const vs={mapValue:{fields:{[ns]:{stringValue:is},[os]:{arrayValue:{}}}}};function Gs(e){return"nullValue"in e?ss:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?ms(ts.empty(),xr.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?ws(e)?vs:{mapValue:{}}:ir(35942,{value:e})}function Rs(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?ms(ts.empty(),xr.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?vs:"mapValue"in e?ws(e)?{mapValue:{}}:rs:ir(61959,{value:e})}function Vs(e,t){const n=cs(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Ns(e,t){const n=cs(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this.value=e}static empty(){return new ks({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ys(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zs(t)}setAll(e){let t=Hr.emptyPath(),n={},A=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,A),n={},A=[],t=r.popLast()}e?n[r.lastSegment()]=Zs(e):A.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,A)}delete(e){const t=this.field(e.popLast());ys(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let A=t.mapValue.fields[e.get(n)];ys(A)&&A.mapValue.fields||(A={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=A),t=A}return t.mapValue.fields}applyChanges(e,t,n){ko(t,((t,n)=>e[t]=n));for(const A of n)delete e[A]}clone(){return new ks(Zs(this.value))}}function Ws(e){const t=[];return ko(e.fields,((e,n)=>{const A=new Hr([e]);if(ys(n)){const e=Ws(n.mapValue).fields;if(0===e.length)t.push(A);else for(const n of e)t.push(A.child(n))}else t.push(A)})),new Yo(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Fs{constructor(e,t,n,A,r,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=A,this.createTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Fs(e,0,kr.min(),kr.min(),kr.min(),ks.empty(),0)}static newFoundDocument(e,t,n,A){return new Fs(e,1,t,kr.min(),n,A,0)}static newNoDocument(e,t){return new Fs(e,2,t,kr.min(),kr.min(),ks.empty(),0)}static newUnknownDocument(e,t){return new Fs(e,3,t,kr.min(),kr.min(),ks.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(kr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ks.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ks.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=kr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Fs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t){this.position=e,this.inclusive=t}}function Xs(e,t,n){let A=0;for(let r=0;r<e.position.length;r++){const i=t[r],o=e.position[r];if(A=i.field.isKeyField()?xr.comparator(xr.fromName(o.referenceValue),n.key):cs(o,n.data.field(i.field)),"desc"===i.dir&&(A*=-1),0!==A)break}return A}function Hs(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!gs(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t="asc"){this.field=e,this.dir=t}}function Js(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{}class Us extends Ys{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new _s(e,t,n):"array-contains"===t?new ea(e,n):"in"===t?new ta(e,n):"not-in"===t?new na(e,n):"array-contains-any"===t?new Aa(e,n):new Us(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new js(e,n):new qs(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(cs(t,this.value)):null!==t&&as(this.value)===as(t)&&this.matchesComparison(cs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ir(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ls extends Ys{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ls(e,t)}matches(e){return Ts(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ts(e){return"and"===e.op}function Ks(e){return"or"===e.op}function Ms(e){return Qs(e)&&Ts(e)}function Qs(e){for(const t of e.filters)if(t instanceof Ls)return!1;return!0}function Ds(e){if(e instanceof Us)return e.field.canonicalString()+e.op.toString()+us(e.value);if(Ms(e))return e.filters.map((e=>Ds(e))).join(",");{const t=e.filters.map((e=>Ds(e))).join(",");return`${e.op}(${t})`}}function zs(e,t){return e instanceof Us?(n=e,(A=t)instanceof Us&&n.op===A.op&&n.field.isEqual(A.field)&&gs(n.value,A.value)):e instanceof Ls?function(e,t){return t instanceof Ls&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,A)=>e&&zs(n,t.filters[A])),!0)}(e,t):void ir(19439);var n,A}function Os(e,t){const n=e.filters.concat(t);return Ls.create(n,e.op)}function Ps(e){return e instanceof Us?`${(t=e).field.canonicalString()} ${t.op} ${us(t.value)}`:e instanceof Ls?function(e){return e.op.toString()+" {"+e.getFilters().map(Ps).join(" ,")+"}"}(e):"Filter";var t}class _s extends Us{constructor(e,t,n){super(e,t,n),this.key=xr.fromName(n.referenceValue)}matches(e){const t=xr.comparator(e.key,this.key);return this.matchesComparison(t)}}class js extends Us{constructor(e,t){super(e,"in",t),this.keys=$s("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qs extends Us{constructor(e,t){super(e,"not-in",t),this.keys=$s("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $s(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>xr.fromName(e.referenceValue)))}class ea extends Us{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return fs(t)&&ls(t.arrayValue,this.value)}}class ta extends Us{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ls(this.value.arrayValue,t)}}class na extends Us{constructor(e,t){super(e,"not-in",t)}matches(e){if(ls(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!ls(this.value.arrayValue,t)}}class Aa extends Us{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!fs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>ls(this.value.arrayValue,e)))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,t=null,n=[],A=[],r=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=A,this.limit=r,this.startAt=i,this.endAt=o,this.Ie=null}}function ia(e,t=null,n=[],A=[],r=null,i=null,o=null){return new ra(e,t,n,A,r,i,o)}function oa(e){const t=ar(e);if(null===t.Ie){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Ds(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>{return(t=e).field.canonicalString()+t.dir;var t})).join(","),ui(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>us(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>us(e))).join(",")),t.Ie=e}return t.Ie}function sa(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Js(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!zs(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Hs(e.startAt,t.startAt)&&Hs(e.endAt,t.endAt)}function aa(e){return xr.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function ga(e,t){return e.filters.filter((e=>e instanceof Us&&e.field.isEqual(t)))}function la(e,t,n){let A=ss,r=!0;for(const i of ga(e,t)){let e=ss,t=!0;switch(i.op){case"<":case"<=":e=Gs(i.value);break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=ss}Vs({value:A,inclusive:r},{value:e,inclusive:t})<0&&(A=e,r=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];Vs({value:A,inclusive:r},{value:e,inclusive:n.inclusive})<0&&(A=e,r=n.inclusive);break}return{value:A,inclusive:r}}function ca(e,t,n){let A=rs,r=!0;for(const i of ga(e,t)){let e=rs,t=!0;switch(i.op){case">=":case">":e=Rs(i.value),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=rs}Ns({value:A,inclusive:r},{value:e,inclusive:t})>0&&(A=e,r=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];Ns({value:A,inclusive:r},{value:e,inclusive:n.inclusive})>0&&(A=e,r=n.inclusive);break}return{value:A,inclusive:r}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,t=null,n=[],A=[],r=null,i="F",o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=A,this.limit=r,this.limitType=i,this.startAt=o,this.endAt=s,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Ca(e,t,n,A,r,i,o,s){return new Ia(e,t,n,A,r,i,o,s)}function ua(e){return new Ia(e)}function da(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ha(e){return null!==e.collectionGroup}function ma(e){const t=ar(e);if(null===t.Ee){t.Ee=[];const e=new Set;for(const A of t.explicitOrderBy)t.Ee.push(A),e.add(A.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new Ho(Hr.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((A=>{e.has(A.canonicalString())||A.isKeyField()||t.Ee.push(new xs(A,n))})),e.has(Hr.keyField().canonicalString())||t.Ee.push(new xs(Hr.keyField(),n))}return t.Ee}function pa(e){const t=ar(e);return t.de||(t.de=function(e,t){if("F"===e.limitType)return ia(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new xs(e.field,t)}));const n=e.endAt?new Es(e.endAt.position,e.endAt.inclusive):null,A=e.startAt?new Es(e.startAt.position,e.startAt.inclusive):null;return ia(e.path,e.collectionGroup,t,e.filters,e.limit,n,A)}}(t,ma(e))),t.de}function fa(e,t){const n=e.filters.concat([t]);return new Ia(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function ba(e,t,n){return new Ia(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ba(e,t){return sa(pa(e),pa(t))&&e.limitType===t.limitType}function ya(e){return`${oa(pa(e))}|lt:${e.limitType}`}function wa(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Ps(e))).join(", ")}]`),ui(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t})).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>us(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>us(e))).join(",")),`Target(${t})`}(pa(e))}; limitType=${e.limitType})`}function Za(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):xr.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ma(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(A=t,!((n=e).startAt&&!function(e,t,n){const A=Xs(e,t,n);return e.inclusive?A<=0:A<0}(n.startAt,ma(n),A)||n.endAt&&!function(e,t,n){const A=Xs(e,t,n);return e.inclusive?A>=0:A>0}(n.endAt,ma(n),A)));var n,A}function Sa(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function va(e){return(t,n)=>{let A=!1;for(const r of ma(e)){const e=Ga(r,t,n);if(0!==e)return e;A=A||r.field.isKeyField()}return 0}}function Ga(e,t,n){const A=e.field.isKeyField()?xr.comparator(t.key,n.key):function(e,t,n){const A=t.data.field(e),r=n.data.field(e);return null!==A&&null!==r?cs(A,r):ir(42886)}(e.field,t,n);switch(e.dir){case"asc":return A;case"desc":return-1*A;default:return ir(19790,{direction:e.dir})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[A,r]of n)if(this.equalsFn(A,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),A=this.inner[n];if(void 0===A)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<A.length;r++)if(this.equalsFn(A[r][0],e))return void(A[r]=[e,t]);A.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let A=0;A<n.length;A++)if(this.equalsFn(n[A][0],e))return 1===n.length?delete this.inner[t]:n.splice(A,1),this.innerSize--,!0;return!1}forEach(e){ko(this.inner,((t,n)=>{for(const[A,r]of n)e(A,r)}))}isEmpty(){return Wo(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new Fo(xr.comparator);function Na(){return Va}const ka=new Fo(xr.comparator);function Wa(...e){let t=ka;for(const n of e)t=t.insert(n.key,n);return t}function Fa(e){let t=ka;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Ea(){return Ha()}function Xa(){return Ha()}function Ha(){return new Ra((e=>e.toString()),((e,t)=>e.isEqual(t)))}const xa=new Fo(xr.comparator),Ja=new Ho(xr.comparator);function Ya(...e){let t=Ja;for(const n of e)t=t.add(n);return t}const Ua=new Ho(yr);function La(){return Ua}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ta(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:di(t)?"-0":t}}function Ka(e){return{integerValue:""+e}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ma{constructor(){this._=void 0}}function Qa(e,t,n){return e instanceof Oa?function(e,t){const n={fields:{[zo]:{stringValue:Do},[Po]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&_o(t)&&(t=jo(t)),t&&(n.fields[Oo]=t),{mapValue:n}}(n,t):e instanceof Pa?_a(e,t):e instanceof ja?qa(e,t):function(e,t){const n=za(e,t),A=eg(n)+eg(e.Re);return ps(n)&&ps(e.Re)?Ka(A):Ta(e.serializer,A)}(e,t)}function Da(e,t,n){return e instanceof Pa?_a(e,t):e instanceof ja?qa(e,t):n}function za(e,t){return e instanceof $a?ps(n=t)||(A=n)&&"doubleValue"in A?t:{integerValue:0}:null;var n,A}class Oa extends Ma{}class Pa extends Ma{constructor(e){super(),this.elements=e}}function _a(e,t){const n=tg(t);for(const A of e.elements)n.some((e=>gs(e,A)))||n.push(A);return{arrayValue:{values:n}}}class ja extends Ma{constructor(e){super(),this.elements=e}}function qa(e,t){let n=tg(t);for(const A of e.elements)n=n.filter((e=>!gs(e,A)));return{arrayValue:{values:n}}}class $a extends Ma{constructor(e,t){super(),this.serializer=e,this.Re=t}}function eg(e){return Mo(e.integerValue||e.doubleValue)}function tg(e){return fs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t){this.field=e,this.transform=t}}class Ag{constructor(e,t){this.version=e,this.transformResults=t}}class rg{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rg}static exists(e){return new rg(void 0,e)}static updateTime(e){return new rg(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ig(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class og{}function sg(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new mg(e.key,rg.none()):new Ig(e.key,e.data,rg.none());{const n=e.data,A=ks.empty();let r=new Ho(Hr.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?A.delete(e):A.set(e,t),r=r.add(e)}return new Cg(e.key,A,new Yo(r.toArray()),rg.none())}}function ag(e,t,n){var A;e instanceof Ig?function(e,t,n){const A=e.value.clone(),r=dg(e.fieldTransforms,t,n.transformResults);A.setAll(r),t.convertToFoundDocument(n.version,A).setHasCommittedMutations()}(e,t,n):e instanceof Cg?function(e,t,n){if(!ig(e.precondition,t))return void t.convertToUnknownDocument(n.version);const A=dg(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(ug(e)),r.setAll(A),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):(A=n,t.convertToNoDocument(A.version).setHasCommittedMutations())}function gg(e,t,n,A){return e instanceof Ig?function(e,t,n,A){if(!ig(e.precondition,t))return n;const r=e.value.clone(),i=hg(e.fieldTransforms,A,t);return r.setAll(i),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,A):e instanceof Cg?function(e,t,n,A){if(!ig(e.precondition,t))return n;const r=hg(e.fieldTransforms,A,t),i=t.data;return i.setAll(ug(e)),i.setAll(r),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,A):(r=t,i=n,ig(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):i);var r,i}function lg(e,t){let n=null;for(const A of e.fieldTransforms){const e=t.data.field(A.field),r=za(A.transform,e||null);null!=r&&(null===n&&(n=ks.empty()),n.set(A.field,r))}return n||null}function cg(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,A=t.fieldTransforms,!!(void 0===n&&void 0===A||n&&A&&vr(n,A,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,A=t.transform,n instanceof Pa&&A instanceof Pa||n instanceof ja&&A instanceof ja?vr(n.elements,A.elements,gs):n instanceof $a&&A instanceof $a?gs(n.Re,A.Re):n instanceof Oa&&A instanceof Oa);var n,A}(e,t))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,A}class Ig extends og{constructor(e,t,n,A=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=A,this.type=0}getFieldMask(){return null}}class Cg extends og{constructor(e,t,n,A,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=A,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function ug(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const A=e.data.field(n);t.set(n,A)}})),t}function dg(e,t,n){const A=new Map;sr(e.length===n.length,32656,{Ve:n.length,me:e.length});for(let r=0;r<n.length;r++){const i=e[r],o=i.transform,s=t.data.field(i.field);A.set(i.field,Da(o,s,n[r]))}return A}function hg(e,t,n){const A=new Map;for(const r of e){const e=r.transform,i=n.data.field(r.field);A.set(r.field,Qa(e,i,t))}return A}class mg extends og{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pg extends og{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(e,t,n,A){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=A}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let A=0;A<this.mutations.length;A++){const t=this.mutations[A];t.key.isEqual(e.key)&&ag(t,e,n[A])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=gg(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=gg(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Xa();return this.mutations.forEach((A=>{const r=e.get(A.key),i=r.overlayedDocument;let o=this.applyToLocalView(i,r.mutatedFields);o=t.has(A.key)?null:o;const s=sg(i,o);null!==s&&n.set(A.key,s),i.isValidDocument()||i.convertToNoDocument(kr.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ya())}isEqual(e){return this.batchId===e.batchId&&vr(this.mutations,e.mutations,((e,t)=>cg(e,t)))&&vr(this.baseMutations,e.baseMutations,((e,t)=>cg(e,t)))}}class bg{constructor(e,t,n,A){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=A}static from(e,t,n){sr(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let A=function(){return xa}();const r=e.mutations;for(let i=0;i<r.length;i++)A=A.insert(r[i].key,n[i].version);return new bg(e,t,n,A)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wg,Zg;function Sg(e){if(void 0===e)return nr("GRPC error has no .code"),gr.UNKNOWN;switch(e){case wg.OK:return gr.OK;case wg.CANCELLED:return gr.CANCELLED;case wg.UNKNOWN:return gr.UNKNOWN;case wg.DEADLINE_EXCEEDED:return gr.DEADLINE_EXCEEDED;case wg.RESOURCE_EXHAUSTED:return gr.RESOURCE_EXHAUSTED;case wg.INTERNAL:return gr.INTERNAL;case wg.UNAVAILABLE:return gr.UNAVAILABLE;case wg.UNAUTHENTICATED:return gr.UNAUTHENTICATED;case wg.INVALID_ARGUMENT:return gr.INVALID_ARGUMENT;case wg.NOT_FOUND:return gr.NOT_FOUND;case wg.ALREADY_EXISTS:return gr.ALREADY_EXISTS;case wg.PERMISSION_DENIED:return gr.PERMISSION_DENIED;case wg.FAILED_PRECONDITION:return gr.FAILED_PRECONDITION;case wg.ABORTED:return gr.ABORTED;case wg.OUT_OF_RANGE:return gr.OUT_OF_RANGE;case wg.UNIMPLEMENTED:return gr.UNIMPLEMENTED;case wg.DATA_LOSS:return gr.DATA_LOSS;default:return ir(39323,{code:e})}}(Zg=wg||(wg={}))[Zg.OK=0]="OK",Zg[Zg.CANCELLED=1]="CANCELLED",Zg[Zg.UNKNOWN=2]="UNKNOWN",Zg[Zg.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zg[Zg.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zg[Zg.NOT_FOUND=5]="NOT_FOUND",Zg[Zg.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zg[Zg.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zg[Zg.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zg[Zg.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zg[Zg.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zg[Zg.ABORTED=10]="ABORTED",Zg[Zg.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zg[Zg.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zg[Zg.INTERNAL=13]="INTERNAL",Zg[Zg.UNAVAILABLE=14]="UNAVAILABLE",Zg[Zg.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const vg=new xA([4294967295,4294967295],0);function Gg(e){const t=br().encode(e),n=new JA;return n.update(t),new Uint8Array(n.digest())}function Rg(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),A=t.getUint32(4,!0),r=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new xA([n,A],0),new xA([r,i],0)]}class Vg{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ng(`Invalid padding: ${t}`);if(n<0)throw new Ng(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Ng(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Ng(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=xA.fromNumber(this.pe)}we(e,t,n){let A=e.add(t.multiply(xA.fromNumber(n)));return 1===A.compare(vg)&&(A=new xA([A.getBits(0),A.getBits(1)],0)),A.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.pe)return!1;const t=Gg(e),[n,A]=Rg(t);for(let r=0;r<this.hashCount;r++){const e=this.we(n,A,r);if(!this.Se(e))return!1}return!0}static create(e,t,n){const A=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),i=new Vg(r,A,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.pe)return;const t=Gg(e),[n,A]=Rg(t);for(let r=0;r<this.hashCount;r++){const e=this.we(n,A,r);this.be(e)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ng extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,t,n,A,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=A,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const A=new Map;return A.set(e,Wg.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new kg(kr.min(),A,new Fo(yr),Na(),Ya())}}class Wg{constructor(e,t,n,A,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=A,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Wg(n,t,Ya(),Ya(),Ya())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,t,n,A){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=A}}class Eg{constructor(e,t){this.targetId=e,this.Ce=t}}class Xg{constructor(e,t,n=Lo.EMPTY_BYTE_STRING,A=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=A}}class Hg{constructor(){this.Fe=0,this.Me=Yg(),this.xe=Lo.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ya(),t=Ya(),n=Ya();return this.Me.forEach(((A,r)=>{switch(r){case 0:e=e.add(A);break;case 2:t=t.add(A);break;case 1:n=n.add(A);break;default:ir(38017,{changeType:r})}})),new Wg(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=Yg()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,sr(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class xg{constructor(e){this.ze=e,this.je=new Map,this.He=Na(),this.Je=Jg(),this.Ye=Jg(),this.Ze=new Fo(yr)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,(t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:ir(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach(((e,n)=>{this.it(n)&&t(n)}))}ot(e){const t=e.targetId,n=e.Ce.count,A=this._t(t);if(A){const r=A.target;if(aa(r))if(0===n){const e=new xr(r.path);this.tt(t,e,Fs.newNoDocument(e,kr.min()))}else sr(1===n,20013,{expectedCount:n});else{const A=this.ut(t);if(A!==n){const n=this.ct(e),r=n?this.lt(n,e,A):1;if(0!==r){this.st(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,e)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:A=0},hashCount:r=0}=t;let i,o;try{i=Qo(n).toUint8Array()}catch(s){if(s instanceof Uo)return Ar("Decoding the base64 bloom filter in existence filter failed ("+s.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw s}try{o=new Vg(i,A,r)}catch(s){return Ar(s instanceof Ng?"BloomFilter error: ":"Applying bloom filter failed: ",s),null}return 0===o.pe?null:o}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let A=0;return n.forEach((n=>{const r=this.ze.Pt(),i=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.tt(t,n,null),A++)})),A}It(e){const t=new Map;this.je.forEach(((n,A)=>{const r=this._t(A);if(r){if(n.current&&aa(r.target)){const t=new xr(r.target.path);this.Et(t).has(A)||this.dt(A,t)||this.tt(A,t,Fs.newNoDocument(t,e))}n.Le&&(t.set(A,n.qe()),n.Qe())}}));let n=Ya();this.Ye.forEach(((e,t)=>{let A=!0;t.forEachWhile((e=>{const t=this._t(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(A=!1,!1)})),A&&(n=n.add(e))})),this.He.forEach(((t,n)=>n.setReadTime(e)));const A=new kg(e,t,this.Ze,this.He,n);return this.He=Na(),this.Je=Jg(),this.Ye=Jg(),this.Ze=new Fo(yr),A}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const A=this.rt(e);this.dt(e,t)?A.$e(t,1):A.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Hg,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ho(yr),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ho(yr),this.Je=this.Je.insert(e,t)),t}it(e){const t=null!==this._t(e);return t||tr("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Hg),this.ze.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Jg(){return new Fo(xr.comparator)}function Yg(){return new Fo(xr.comparator)}const Ug=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Lg=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Tg=(()=>({and:"AND",or:"OR"}))();class Kg{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mg(e,t){return e.useProto3Json||ui(t)?t:{value:t}}function Qg(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Dg(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function zg(e,t){return Qg(e,t.toTimestamp())}function Og(e){return sr(!!e,49232),kr.fromTimestamp(function(e){const t=Ko(e);return new Nr(t.seconds,t.nanos)}(e))}function Pg(e,t){return _g(e,t).canonicalString()}function _g(e,t){const n=(A=e,new Er(["projects",A.projectId,"databases",A.database])).child("documents");var A;return void 0===t?n:n.child(t)}function jg(e){const t=Er.fromString(e);return sr(pl(t),10190,{key:t.toString()}),t}function qg(e,t){return Pg(e.databaseId,t.path)}function $g(e,t){const n=jg(t);if(n.get(1)!==e.databaseId.projectId)throw new lr(gr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new lr(gr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new xr(Al(n))}function el(e,t){return Pg(e.databaseId,t)}function tl(e){const t=jg(e);return 4===t.length?Er.emptyPath():Al(t)}function nl(e){return new Er(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Al(e){return sr(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function rl(e,t,n){return{name:qg(e,t),fields:n.value.mapValue.fields}}function il(e,t){let n;if(t instanceof Ig)n={update:rl(e,t.key,t.value)};else if(t instanceof mg)n={delete:qg(e,t.key)};else if(t instanceof Cg)n={update:rl(e,t.key,t.data),updateMask:ml(t.fieldMask)};else{if(!(t instanceof pg))return ir(16599,{ft:t.type});n={verify:qg(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Oa)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Pa)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ja)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof $a)return{fieldPath:t.field.canonicalString(),increment:n.Re};throw ir(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=(A=e,void 0!==(r=t.precondition).updateTime?{updateTime:zg(A,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:ir(27497))),n;var A,r}function ol(e,t){const n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?rg.updateTime(Og(r.updateTime)):void 0!==r.exists?rg.exists(r.exists):rg.none():rg.none(),A=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)sr("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new Oa;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Pa(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new ja(e)}else"increment"in t?n=new $a(e,t.increment):ir(16584,{proto:t});const A=Hr.fromServerFormat(t.fieldPath);return new ng(A,n)}(e,t))):[];var r;if(t.update){t.update.name;const r=$g(e,t.update.name),i=new ks({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Yo(t.map((e=>Hr.fromServerFormat(e))))}(t.updateMask);return new Cg(r,i,e,n,A)}return new Ig(r,i,n,A)}if(t.delete){const A=$g(e,t.delete);return new mg(A,n)}if(t.verify){const A=$g(e,t.verify);return new pg(A,n)}return ir(1463,{proto:t})}function sl(e,t){return{documents:[el(e,t.path)]}}function al(e,t){const n={structuredQuery:{}},A=t.path;let r;null!==t.collectionGroup?(r=A,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=A.popLast(),n.structuredQuery.from=[{collectionId:A.lastSegment()}]),n.parent=el(e,r);const i=function(e){if(0!==e.length)return hl(Ls.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(e){if(0!==e.length)return e.map((e=>{return{field:ul((t=e).field),direction:cl(t.dir)};var t}))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const s=Mg(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{gt:n,parent:r};var a}function gl(e){let t=tl(e.parent);const n=e.structuredQuery,A=n.from?n.from.length:0;let r=null;if(A>0){sr(1===A,65062);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=ll(e);return t instanceof Ls&&Ms(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>{return new xs(dl((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,ui(t)?null:t}(n.limit));let a=null;n.startAt&&(a=function(e){const t=!!e.before,n=e.values||[];return new Es(n,t)}(n.startAt));let g=null;return n.endAt&&(g=function(e){const t=!e.before,n=e.values||[];return new Es(n,t)}(n.endAt)),Ca(t,r,o,i,s,"F",a,g)}function ll(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=dl(e.unaryFilter.field);return Us.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=dl(e.unaryFilter.field);return Us.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const A=dl(e.unaryFilter.field);return Us.create(A,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=dl(e.unaryFilter.field);return Us.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ir(61313);default:return ir(60726)}}(e):void 0!==e.fieldFilter?(t=e,Us.create(dl(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ir(58110);default:return ir(50506)}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return Ls.create(e.compositeFilter.filters.map((e=>ll(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ir(1026)}}(e.compositeFilter.op))}(e):ir(30097,{filter:e});var t}function cl(e){return Ug[e]}function Il(e){return Lg[e]}function Cl(e){return Tg[e]}function ul(e){return{fieldPath:e.canonicalString()}}function dl(e){return Hr.fromServerFormat(e.fieldPath)}function hl(e){return e instanceof Us?function(e){if("=="===e.op){if(Bs(e.value))return{unaryFilter:{field:ul(e.field),op:"IS_NAN"}};if(bs(e.value))return{unaryFilter:{field:ul(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Bs(e.value))return{unaryFilter:{field:ul(e.field),op:"IS_NOT_NAN"}};if(bs(e.value))return{unaryFilter:{field:ul(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ul(e.field),op:Il(e.op),value:e.value}}}(e):e instanceof Ls?function(e){const t=e.getFilters().map((e=>hl(e)));return 1===t.length?t[0]:{compositeFilter:{op:Cl(e.op),filters:t}}}(e):ir(54877,{filter:e})}function ml(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function pl(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t,n,A,r=kr.min(),i=kr.min(),o=Lo.EMPTY_BYTE_STRING,s=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=A,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(e){return new fl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new fl(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this.wt=e}}function Bl(e,t){let n;if(t.document)n=function(e,t,n){const A=$g(e,t.name),r=Og(t.updateTime),i=t.createTime?Og(t.createTime):kr.min(),o=new ks({mapValue:{fields:t.fields}}),s=Fs.newFoundDocument(A,r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(e.wt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=xr.fromSegments(t.noDocument.path),A=Sl(t.noDocument.readTime);n=Fs.newNoDocument(e,A),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return ir(56709);{const e=xr.fromSegments(t.unknownDocument.path),A=Sl(t.unknownDocument.version);n=Fs.newUnknownDocument(e,A)}}return t.readTime&&n.setReadTime(function(e){const t=new Nr(e[0],e[1]);return kr.fromTimestamp(t)}(t.readTime)),n}function yl(e,t){const n=t.key,A={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:wl(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())A.document={name:qg(r=e.wt,(i=t).key),fields:i.data.value.mapValue.fields,updateTime:Qg(r,i.version.toTimestamp()),createTime:Qg(r,i.createTime.toTimestamp())};else if(t.isNoDocument())A.noDocument={path:n.path.toArray(),readTime:Zl(t.version)};else{if(!t.isUnknownDocument())return ir(57904,{document:t});A.unknownDocument={path:n.path.toArray(),version:Zl(t.version)}}var r,i;return A}function wl(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Zl(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Sl(e){const t=new Nr(e.seconds,e.nanoseconds);return kr.fromTimestamp(t)}function vl(e,t){const n=(t.baseMutations||[]).map((t=>ol(e.wt,t)));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const A=t.mutations.map((t=>ol(e.wt,t))),r=Nr.fromMillis(t.localWriteTimeMs);return new fg(t.batchId,r,n,A)}function Gl(e){const t=Sl(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Sl(e.lastLimboFreeSnapshotVersion):kr.min();let A;return A=void 0!==e.query.documents?function(e){const t=e.documents.length;return sr(1===t,1966,{count:t}),pa(ua(tl(e.documents[0])))}(e.query):function(e){return pa(gl(e))}(e.query),new fl(A,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Lo.fromBase64String(e.resumeToken))}function Rl(e,t){const n=Zl(t.snapshotVersion),A=Zl(t.lastLimboFreeSnapshotVersion);let r;r=aa(t.target)?sl(e.wt,t.target):al(e.wt,t.target).gt;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:oa(t.target),readTime:n,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:A,query:r}}function Vl(e){const t=gl({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ba(t,t.limit,"L"):t}function Nl(e,t){return new Bg(t.largestBatchId,ol(e.wt,t.overlayMutation))}function kl(e,t){const n=t.path.lastSegment();return[e,pi(t.path.popLast()),n]}function Wl(e,t,n,A){return{indexId:e,uid:t,sequenceNumber:n,readTime:Zl(A.readTime),documentKey:pi(A.documentKey.path),largestBatchId:A.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{getBundleMetadata(e,t){return El(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:Sl(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return El(e).put({bundleId:(n=t).id,createTime:Zl(Og(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Xl(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:Vl(t.bundledQuery),readTime:Sl(t.readTime)};var t}))}saveNamedQuery(e,t){return Xl(e).put({name:(n=t).name,readTime:Zl(Og(n.readTime)),bundledQuery:n.bundledQuery});var n}}function El(e){return Vo(e,eo)}function Xl(e){return Vo(e,to)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,t){this.serializer=e,this.userId=t}static St(e,t){const n=t.uid||"";return new Hl(e,n)}getOverlay(e,t){return xl(e).get(kl(this.userId,t)).next((e=>e?Nl(this.serializer,e):null))}getOverlays(e,t){const n=Ea();return jr.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const A=[];return n.forEach(((n,r)=>{const i=new Bg(t,r);A.push(this.bt(e,i))})),jr.waitFor(A)}removeOverlaysForBatchId(e,t,n){const A=new Set;t.forEach((e=>A.add(pi(e.getCollectionPath()))));const r=[];return A.forEach((t=>{const A=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);r.push(xl(e).X(uo,A))})),jr.waitFor(r)}getOverlaysForCollection(e,t,n){const A=Ea(),r=pi(t),i=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return xl(e).J(uo,i).next((e=>{for(const t of e){const e=Nl(this.serializer,t);A.set(e.getKey(),e)}return A}))}getOverlaysForCollectionGroup(e,t,n,A){const r=Ea();let i;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xl(e).te({index:mo,range:o},((e,t,n)=>{const o=Nl(this.serializer,t);r.size()<A||o.largestBatchId===i?(r.set(o.getKey(),o),i=o.largestBatchId):n.done()})).next((()=>r))}bt(e,t){return xl(e).put(function(e,t,n){const[A,r,i]=kl(t,n.mutation.key);return{userId:t,collectionPath:r,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:il(e.wt,n.mutation)}}(this.serializer,this.userId,t))}}function xl(e){return Vo(e,Io)}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{Dt(e){return Vo(e,fo)}getSessionToken(e){return this.Dt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?Lo.fromUint8Array(t):Lo.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Mo(e.integerValue));else if("doubleValue"in e){const n=Mo(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),di(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),"string"==typeof n&&(n=Ko(n)),t.Ot(`${n.seconds||""}`),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Qo(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?Ss(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):ws(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):ir(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const A of Object.keys(n))this.Nt(A,t),this.Ct(n[A],t)}qt(e,t){var n,A;const r=e.fields||{};this.Mt(t,53);const i=os,o=(null===(A=null===(n=r[i].arrayValue)||void 0===n?void 0:n.values)||void 0===A?void 0:A.length)||0;this.Mt(t,15),t.xt(Mo(o)),this.Nt(i,t),this.Ct(r[i],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const A of n)this.Ct(A,t)}kt(e,t){this.Mt(t,37),xr.fromName(e).path.forEach((e=>{this.Mt(t,60),this.Kt(e,t)}))}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Yl.Wt=new Yl;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ul=255;function Ll(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function Tl(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const A=Ll(255&e[n]);if(t+=A,8!==A)break}return t}(e);return Math.ceil(t/8)}class Kl{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.zt(n.value),n=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Yt()}Zt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.zt(e);else if(e<2048)this.zt(960|e>>>6),this.zt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.zt(480|e>>>12),this.zt(128|63&e>>>6),this.zt(128|63&e);else{const e=t.codePointAt(0);this.zt(240|e>>>18),this.zt(128|63&e>>>12),this.zt(128|63&e>>>6),this.zt(128|63&e)}}this.jt()}Xt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Jt(e);else if(e<2048)this.Jt(960|e>>>6),this.Jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Jt(480|e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e);else{const e=t.codePointAt(0);this.Jt(240|e>>>18),this.Jt(128|63&e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e)}}this.Yt()}en(e){const t=this.tn(e),n=Tl(t);this.nn(1+n),this.buffer[this.position++]=255&n;for(let A=t.length-n;A<t.length;++A)this.buffer[this.position++]=255&t[A]}rn(e){const t=this.tn(e),n=Tl(t);this.nn(1+n),this.buffer[this.position++]=~(255&n);for(let A=t.length-n;A<t.length;++A)this.buffer[this.position++]=~(255&t[A])}sn(){this._n(Ul),this._n(255)}an(){this.un(Ul),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let A=1;A<t.length;++A)t[A]^=n?255:0;return t}zt(e){const t=255&e;0===t?(this._n(0),this._n(255)):t===Ul?(this._n(Ul),this._n(0)):this._n(t)}Jt(e){const t=255&e;0===t?(this.un(0),this.un(255)):t===Ul?(this.un(Ul),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const A=new Uint8Array(n);A.set(this.buffer),this.buffer=A}}class Ml{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Ql{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class Dl{constructor(){this.ln=new Kl,this.hn=new Ml(this.ln),this.Pn=new Ql(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return 0===e?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,t,n,A){this.In=e,this.En=t,this.dn=n,this.An=A}Rn(){const e=this.An.length,t=0===e||255===this.An[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.An,0),t!==e?n.set([0],this.An.length):++n[n.length-1],new zl(this.In,this.En,this.dn,n)}Vn(e,t,n){return{indexId:this.In,uid:e,arrayValue:_l(this.dn),directionalValue:_l(this.An),orderedDocumentKey:_l(t),documentKey:n.path.toArray()}}mn(e,t,n){const A=this.Vn(e,t,n);return[A.indexId,A.uid,A.arrayValue,A.directionalValue,A.orderedDocumentKey,A.documentKey]}}function Ol(e,t){let n=e.In-t.In;return 0!==n?n:(n=Pl(e.dn,t.dn),0!==n?n:(n=Pl(e.An,t.An),0!==n?n:xr.comparator(e.En,t.En)))}function Pl(e,t){for(let n=0;n<e.length&&n<t.length;++n){const A=e[n]-t[n];if(0!==A)return A}return e.length-t.length}function _l(e){return qt()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function jl(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class ql{constructor(e){this.fn=new Ho(((e,t)=>Hr.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const e=t;e.isInequality()?this.fn=this.fn.add(e):this.pn.push(e)}}get yn(){return this.fn.size>1}wn(e){if(sr(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=Ur(e);if(void 0!==t&&!this.Sn(t))return!1;const n=Lr(e);let A=new Set,r=0,i=0;for(;r<n.length&&this.Sn(n[r]);++r)A=A.add(n[r].fieldPath.canonicalString());if(r===n.length)return!0;if(this.fn.size>0){const e=this.fn.getIterator().getNext();if(!A.has(e.field.canonicalString())){const t=n[r];if(!this.bn(e,t)||!this.Dn(this.gn[i++],t))return!1}++r}for(;r<n.length;++r){const e=n[r];if(i>=this.gn.length||!this.Dn(this.gn[i++],e))return!1}return!0}vn(){if(this.yn)return null;let e=new Ho(Hr.comparator);const t=[];for(const n of this.pn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new Tr(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Tr(n.field,0))}for(const n of this.gn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Tr(n.field,"asc"===n.dir?0:1)));return new Yr(Yr.UNKNOWN_ID,this.collectionId,t,Kr.empty())}Sn(e){for(const t of this.pn)if(this.bn(t,e))return!0;return!1}bn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(e){var t,n;if(sr(e instanceof Us||e instanceof Ls,20012),e instanceof Us){if(e instanceof ta){const A=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Us.create(e.field,"==",t))))||[];return Ls.create(A,"or")}return e}const A=e.filters.map((e=>$l(e)));return Ls.create(A,e.op)}function ec(e){if(0===e.getFilters().length)return[];const t=rc($l(e));return sr(Ac(t),7391),tc(t)||nc(t)?[t]:t.getFilters()}function tc(e){return e instanceof Us}function nc(e){return e instanceof Ls&&Ms(e)}function Ac(e){return tc(e)||nc(e)||function(e){if(e instanceof Ls&&Ks(e)){for(const t of e.getFilters())if(!tc(t)&&!nc(t))return!1;return!0}return!1}(e)}function rc(e){if(sr(e instanceof Us||e instanceof Ls,34018),e instanceof Us)return e;if(1===e.filters.length)return rc(e.filters[0]);const t=e.filters.map((e=>rc(e)));let n=Ls.create(t,e.op);return n=sc(n),Ac(n)?n:(sr(n instanceof Ls,64498),sr(Ts(n),40251),sr(n.filters.length>1,57927),n.filters.reduce(((e,t)=>ic(e,t))))}function ic(e,t){let n;return sr(e instanceof Us||e instanceof Ls,38388),sr(t instanceof Us||t instanceof Ls,25473),n=e instanceof Us?t instanceof Us?(A=e,r=t,Ls.create([A,r],"and")):oc(e,t):t instanceof Us?oc(t,e):function(e,t){if(sr(e.filters.length>0&&t.filters.length>0,48005),Ts(e)&&Ts(t))return Os(e,t.getFilters());const n=Ks(e)?e:t,A=Ks(e)?t:e,r=n.filters.map((e=>ic(e,A)));return Ls.create(r,"or")}(e,t),sc(n);var A,r}function oc(e,t){if(Ts(t))return Os(t,e.getFilters());{const n=t.filters.map((t=>ic(e,t)));return Ls.create(n,"or")}}function sc(e){if(sr(e instanceof Us||e instanceof Ls,11850),e instanceof Us)return e;const t=e.getFilters();if(1===t.length)return sc(t[0]);if(Qs(e))return e;const n=t.map((e=>sc(e))),A=[];return n.forEach((t=>{t instanceof Us?A.push(t):t instanceof Ls&&(t.op===e.op?A.push(...t.filters):A.push(t))})),1===A.length?A[0]:Ls.create(A,e.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class ac{constructor(){this.Cn=new gc}addToCollectionParentIndex(e,t){return this.Cn.add(t),jr.resolve()}getCollectionParents(e,t){return jr.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return jr.resolve()}deleteFieldIndex(e,t){return jr.resolve()}deleteAllFieldIndexes(e){return jr.resolve()}createTargetIndexes(e,t){return jr.resolve()}getDocumentsMatchingTarget(e,t){return jr.resolve(null)}getIndexType(e,t){return jr.resolve(0)}getFieldIndexes(e,t){return jr.resolve([])}getNextCollectionGroupToUpdate(e){return jr.resolve(null)}getMinOffset(e,t){return jr.resolve(Dr.min())}getMinOffsetFromCollectionGroup(e,t){return jr.resolve(Dr.min())}updateCollectionGroup(e,t,n){return jr.resolve()}updateIndexEntries(e,t){return jr.resolve()}}class gc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),A=this.index[t]||new Ho(Er.comparator),r=!A.has(n);return this.index[t]=A.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),A=this.index[t];return A&&A.has(n)}getEntries(e){return(this.index[e]||new Ho(Er.comparator)).toArray()}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc="IndexedDbIndexManager",cc=new Uint8Array(0);class Ic{constructor(e,t){this.databaseId=t,this.Fn=new gc,this.Mn=new Ra((e=>oa(e)),((e,t)=>sa(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const n=t.lastSegment(),A=t.popLast();e.addOnCommittedListener((()=>{this.Fn.add(t)}));const r={collectionId:n,parent:pi(A)};return Cc(e).put(r)}return jr.resolve()}getCollectionParents(e,t){const n=[],A=IDBKeyRange.bound([t,""],[Gr(t),""],!1,!0);return Cc(e).J(A).next((e=>{for(const A of e){if(A.collectionId!==t)break;n.push(Bi(A.parent))}return n}))}addFieldIndex(e,t){const n=dc(e),A={indexId:(r=t).indexId,collectionGroup:r.collectionGroup,fields:r.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))};var r;delete A.indexId;const i=n.add(A);if(t.indexState){const n=hc(e);return i.next((e=>{n.put(Wl(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=dc(e),A=hc(e),r=uc(e);return n.delete(t.indexId).next((()=>A.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=dc(e),n=uc(e),A=hc(e);return t.X().next((()=>n.X())).next((()=>A.X()))}createTargetIndexes(e,t){return jr.forEach(this.xn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new ql(t).vn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=uc(e);let A=!0;const r=new Map;return jr.forEach(this.xn(t),(t=>this.On(e,t).next((e=>{A&&(A=!!e),r.set(t,e)})))).next((()=>{if(A){let e=Ya();const A=[];return jr.forEach(r,((r,i)=>{var o;tr(lc,`Using index ${o=r,`id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`} to execute ${oa(t)}`);const s=function(e,t){const n=Ur(t);if(void 0===n)return null;for(const A of ga(e,n.fieldPath))switch(A.op){case"array-contains-any":return A.value.arrayValue.values||[];case"array-contains":return[A.value]}return null}(i,r),a=function(e,t){const n=new Map;for(const A of Lr(t))for(const t of ga(e,A.fieldPath))switch(t.op){case"==":case"in":n.set(A.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(A.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(i,r),g=function(e,t){const n=[];let A=!0;for(const r of Lr(t)){const t=0===r.kind?la(e,r.fieldPath,e.startAt):ca(e,r.fieldPath,e.startAt);n.push(t.value),A&&(A=t.inclusive)}return new Es(n,A)}(i,r),l=function(e,t){const n=[];let A=!0;for(const r of Lr(t)){const t=0===r.kind?ca(e,r.fieldPath,e.endAt):la(e,r.fieldPath,e.endAt);n.push(t.value),A&&(A=t.inclusive)}return new Es(n,A)}(i,r),c=this.Nn(r,i,g),I=this.Nn(r,i,l),C=this.Bn(r,i,a),u=this.Ln(r.indexId,s,c,g.inclusive,I,l.inclusive,C);return jr.forEach(u,(r=>n.Z(r,t.limit).next((t=>{t.forEach((t=>{const n=xr.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),A.push(n))}))}))))})).next((()=>A))}return jr.resolve(null)}))}xn(e){let t=this.Mn.get(e);return t||(t=0===e.filters.length?[e]:ec(Ls.create(e.filters,"and")).map((t=>ia(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.Mn.set(e,t),t)}Ln(e,t,n,A,r,i,o){const s=(null!=t?t.length:1)*Math.max(n.length,r.length),a=s/(null!=t?t.length:1),g=[];for(let l=0;l<s;++l){const s=t?this.kn(t[l/a]):cc,c=this.qn(e,s,n[l%a],A),I=this.Qn(e,s,r[l%a],i),C=o.map((t=>this.qn(e,s,t,!0)));g.push(...this.createRange(c,I,C))}return g}qn(e,t,n,A){const r=new zl(e,xr.empty(),t,n);return A?r:r.Rn()}Qn(e,t,n,A){const r=new zl(e,xr.empty(),t,n);return A?r.Rn():r}On(e,t){const n=new ql(t),A=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,A).next((e=>{let t=null;for(const A of e)n.wn(A)&&(!t||A.fields.length>t.fields.length)&&(t=A);return t}))}getIndexType(e,t){let n=2;const A=this.xn(t);return jr.forEach(A,(t=>this.On(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Ho(Hr.comparator),n=!1;for(const A of e.filters)for(const e of A.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const A of e.orderBy)A.field.isKeyField()||(t=t.add(A.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>null!==t.limit&&A.length>1&&2===n?1:n))}$n(e,t){const n=new Dl;for(const A of Lr(e)){const e=t.data.field(A.fieldPath);if(null==e)return null;const r=n.Tn(A.kind);Yl.Wt.vt(e,r)}return n.cn()}kn(e){const t=new Dl;return Yl.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const n=new Dl;return Yl.Wt.vt(ms(this.databaseId,t),n.Tn(function(e){const t=Lr(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.cn()}Bn(e,t,n){if(null===n)return[];let A=[];A.push(new Dl);let r=0;for(const i of Lr(e)){const e=n[r++];for(const n of A)if(this.Kn(t,i.fieldPath)&&fs(e))A=this.Wn(A,i,e);else{const t=n.Tn(i.kind);Yl.Wt.vt(e,t)}}return this.Gn(A)}Nn(e,t,n){return this.Bn(e,t,n.position)}Gn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].cn();return t}Wn(e,t,n){const A=[...e],r=[];for(const i of n.arrayValue.values||[])for(const e of A){const n=new Dl;n.seed(e.cn()),Yl.Wt.vt(i,n.Tn(t.kind)),r.push(n)}return r}Kn(e,t){return!!e.filters.find((e=>e instanceof Us&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=dc(e),A=hc(e);return(t?n.J(Ao,IDBKeyRange.bound(t,t)):n.J()).next((e=>{const t=[];return jr.forEach(e,(e=>A.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Kr(t.sequenceNumber,new Dr(Sl(t.readTime),new xr(Bi(t.documentKey)),t.largestBatchId)):Kr.empty(),A=e.fields.map((([e,t])=>new Tr(Hr.fromServerFormat(e),t)));return new Yr(e.indexId,e.collectionGroup,A,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:yr(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const A=dc(e),r=hc(e);return this.zn(e).next((e=>A.J(Ao,IDBKeyRange.bound(t,t)).next((t=>jr.forEach(t,(t=>r.put(Wl(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return jr.forEach(t,((t,A)=>{const r=n.get(t.collectionGroup);return(r?jr.resolve(r):this.getFieldIndexes(e,t.collectionGroup)).next((r=>(n.set(t.collectionGroup,r),jr.forEach(r,(n=>this.jn(e,t,n).next((t=>{const r=this.Hn(A,n);return t.isEqual(r)?jr.resolve():this.Jn(e,A,n,t,r)})))))))}))}Yn(e,t,n,A){return uc(e).put(A.Vn(this.uid,this.Un(n,t.key),t.key))}Zn(e,t,n,A){return uc(e).delete(A.mn(this.uid,this.Un(n,t.key),t.key))}jn(e,t,n){const A=uc(e);let r=new Ho(Ol);return A.te({index:lo,range:IDBKeyRange.only([n.indexId,this.uid,_l(this.Un(n,t))])},((e,A)=>{r=r.add(new zl(n.indexId,t,jl(A.arrayValue),jl(A.directionalValue)))})).next((()=>r))}Hn(e,t){let n=new Ho(Ol);const A=this.$n(t,e);if(null==A)return n;const r=Ur(t);if(null!=r){const i=e.data.field(r.fieldPath);if(fs(i))for(const r of i.arrayValue.values||[])n=n.add(new zl(t.indexId,e.key,this.kn(r),A))}else n=n.add(new zl(t.indexId,e.key,cc,A));return n}Jn(e,t,n,A,r){tr(lc,"Updating index entries for document '%s'",t.key);const i=[];return function(e,t,n,A,r){const i=e.getIterator(),o=t.getIterator();let s=Jo(i),a=Jo(o);for(;s||a;){let e=!1,t=!1;if(s&&a){const A=n(s,a);A<0?t=!0:A>0&&(e=!0)}else null!=s?t=!0:e=!0;e?(A(a),a=Jo(o)):t?(r(s),s=Jo(i)):(s=Jo(i),a=Jo(o))}}(A,r,Ol,(A=>{i.push(this.Yn(e,t,n,A))}),(A=>{i.push(this.Zn(e,t,n,A))})),jr.waitFor(i)}zn(e){let t=1;return hc(e).te({index:oo,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,A)=>{A.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Ol(e,t))).filter(((e,t,n)=>!t||0!==Ol(e,n[t-1])));const A=[];A.push(e);for(const i of n){const n=Ol(i,e),r=Ol(i,t);if(0===n)A[0]=e.Rn();else if(n>0&&r<0)A.push(i),A.push(i.Rn());else if(r>0)break}A.push(t);const r=[];for(let i=0;i<A.length;i+=2){if(this.Xn(A[i],A[i+1]))return[];const e=A[i].mn(this.uid,cc,xr.empty()),t=A[i+1].mn(this.uid,cc,xr.empty());r.push(IDBKeyRange.bound(e,t))}return r}Xn(e,t){return Ol(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(mc)}getMinOffset(e,t){return jr.mapArray(this.xn(t),(t=>this.On(e,t).next((e=>e||ir(44426))))).next(mc)}}function Cc(e){return Vo(e,ji)}function uc(e){return Vo(e,ao)}function dc(e){return Vo(e,no)}function hc(e){return Vo(e,ro)}function mc(e){sr(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let A=1;A<e.length;A++){const r=e[A].indexState.offset;zr(r,t)<0&&(t=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Dr(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},fc=41943040;class bc{static withCacheSize(e){return new bc(e,bc.DEFAULT_COLLECTION_PERCENTILE,bc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(e,t,n){const A=e.store(vi),r=e.store(Fi),i=[],o=IDBKeyRange.only(n.batchId);let s=0;const a=A.te({range:o},((e,t,n)=>(s++,n.delete())));i.push(a.next((()=>{sr(1===s,47070,{batchId:n.batchId})})));const g=[];for(const l of n.mutations){const e=ki(t,l.key.path,n.batchId);i.push(r.delete(e)),g.push(l.key)}return jr.waitFor(i).next((()=>g))}function yc(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ir(14731);t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bc.DEFAULT_COLLECTION_PERCENTILE=10,bc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bc.DEFAULT=new bc(fc,bc.DEFAULT_COLLECTION_PERCENTILE,bc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bc.DISABLED=new bc(-1,0,0);class wc{constructor(e,t,n,A){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=A,this.er={}}static St(e,t,n,A){sr(""!==e.uid,64387);const r=e.isAuthenticated()?e.uid:"";return new wc(r,t,n,A)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Sc(e).te({index:Ri,range:n},((e,n,A)=>{t=!1,A.done()})).next((()=>t))}addMutationBatch(e,t,n,A){const r=vc(e),i=Sc(e);return i.add({}).next((o=>{sr("number"==typeof o,49019);const s=new fg(o,t,n,A),a=function(e,t,n){const A=n.baseMutations.map((t=>il(e.wt,t))),r=n.mutations.map((t=>il(e.wt,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:A,mutations:r}}(this.serializer,this.userId,s),g=[];let l=new Ho(((e,t)=>yr(e.canonicalString(),t.canonicalString())));for(const e of A){const t=ki(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),g.push(i.put(a)),g.push(r.put(t,Wi))}return l.forEach((t=>{g.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.er[o]=s.keys()})),jr.waitFor(g).next((()=>s))}))}lookupMutationBatch(e,t){return Sc(e).get(t).next((e=>e?(sr(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),vl(this.serializer,e)):null))}tr(e,t){return this.er[t]?jr.resolve(this.er[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.er[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,A=IDBKeyRange.lowerBound([this.userId,n]);let r=null;return Sc(e).te({index:Ri,range:A},((e,t,A)=>{t.userId===this.userId&&(sr(t.batchId>=n,47524,{nr:n}),r=vl(this.serializer,t)),A.done()})).next((()=>r))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ci;return Sc(e).te({index:Ri,range:t,reverse:!0},((e,t,A)=>{n=t.batchId,A.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ci],[this.userId,Number.POSITIVE_INFINITY]);return Sc(e).J(Ri,t).next((e=>e.map((e=>vl(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Ni(this.userId,t.path),A=IDBKeyRange.lowerBound(n),r=[];return vc(e).te({range:A},((n,A,i)=>{const[o,s,a]=n,g=Bi(s);if(o===this.userId&&t.path.isEqual(g))return Sc(e).get(a).next((e=>{if(!e)throw ir(61480,{rr:n,batchId:a});sr(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:a}),r.push(vl(this.serializer,e))}));i.done()})).next((()=>r))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ho(yr);const A=[];return t.forEach((t=>{const r=Ni(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=vc(e).te({range:i},((e,A,r)=>{const[i,o,s]=e,a=Bi(o);i===this.userId&&t.path.isEqual(a)?n=n.add(s):r.done()}));A.push(o)})),jr.waitFor(A).next((()=>this.ir(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,A=n.length+1,r=Ni(this.userId,n),i=IDBKeyRange.lowerBound(r);let o=new Ho(yr);return vc(e).te({range:i},((e,t,r)=>{const[i,s,a]=e,g=Bi(s);i===this.userId&&n.isPrefixOf(g)?g.length===A&&(o=o.add(a)):r.done()})).next((()=>this.ir(e,o)))}ir(e,t){const n=[],A=[];return t.forEach((t=>{A.push(Sc(e).get(t).next((e=>{if(null===e)throw ir(35274,{batchId:t});sr(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(vl(this.serializer,e))})))})),jr.waitFor(A).next((()=>n))}removeMutationBatch(e,t){return Bc(e.he,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.sr(t.batchId)})),jr.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return jr.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),A=[];return vc(e).te({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Bi(e[1]);A.push(t)}else n.done()})).next((()=>{sr(0===A.length,56720,{_r:A.map((e=>e.canonicalString()))})}))}))}containsKey(e,t){return Zc(e,this.userId,t)}ar(e){return Gc(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ci,lastStreamToken:""}))}}function Zc(e,t,n){const A=Ni(t,n.path),r=A[1],i=IDBKeyRange.lowerBound(A);let o=!1;return vc(e).te({range:i,ee:!0},((e,n,A)=>{const[i,s,a]=e;i===t&&s===r&&(o=!0),A.done()})).next((()=>o))}function Sc(e){return Vo(e,vi)}function vc(e){return Vo(e,Fi)}function Gc(e){return Vo(e,Si)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Rc(0)}static lr(){return new Rc(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next((t=>{const n=new Rc(t.highestTargetId);return t.highestTargetId=n.next(),this.Pr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.hr(e).next((e=>kr.fromTimestamp(new Nr(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.hr(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.hr(e).next((A=>(A.highestListenSequenceNumber=t,n&&(A.lastRemoteSnapshotVersion=n.toTimestamp()),t>A.highestListenSequenceNumber&&(A.highestListenSequenceNumber=t),this.Pr(e,A))))}addTargetData(e,t){return this.Tr(e,t).next((()=>this.hr(e).next((n=>(n.targetCount+=1,this.Ir(t,n),this.Pr(e,n))))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nc(e).delete(t.targetId))).next((()=>this.hr(e))).next((t=>(sr(t.targetCount>0,8065),t.targetCount-=1,this.Pr(e,t))))}removeTargets(e,t,n){let A=0;const r=[];return Nc(e).te(((i,o)=>{const s=Gl(o);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(A++,r.push(this.removeTargetData(e,s)))})).next((()=>jr.waitFor(r))).next((()=>A))}forEachTarget(e,t){return Nc(e).te(((e,n)=>{const A=Gl(n);t(A)}))}hr(e){return kc(e).get(Pi).next((e=>(sr(null!==e,2888),e)))}Pr(e,t){return kc(e).put(Pi,t)}Tr(e,t){return Nc(e).put(Rl(this.serializer,t))}Ir(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.hr(e).next((e=>e.targetCount))}getTargetData(e,t){const n=oa(t),A=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let r=null;return Nc(e).te({range:A,index:Ki},((e,n,A)=>{const i=Gl(n);sa(t,i.target)&&(r=i,A.done())})).next((()=>r))}addMatchingKeys(e,t,n){const A=[],r=Wc(e);return t.forEach((t=>{const i=pi(t.path);A.push(r.put({targetId:n,path:i})),A.push(this.referenceDelegate.addReference(e,n,t))})),jr.waitFor(A)}removeMatchingKeys(e,t,n){const A=Wc(e);return jr.forEach(t,(t=>{const r=pi(t.path);return jr.waitFor([A.delete([n,r]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Wc(e),A=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(A)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),A=Wc(e);let r=Ya();return A.te({range:n,ee:!0},((e,t,n)=>{const A=Bi(e[1]),i=new xr(A);r=r.add(i)})).next((()=>r))}containsKey(e,t){const n=pi(t.path),A=IDBKeyRange.bound([n],[Gr(n)],!1,!0);let r=0;return Wc(e).te({index:zi,ee:!0,range:A},(([e,t],n,A)=>{0!==e&&(r++,A.done())})).next((()=>r>0))}Rt(e,t){return Nc(e).get(t).next((e=>e?Gl(e):null))}}function Nc(e){return Vo(e,Ti)}function kc(e){return Vo(e,_i)}function Wc(e){return Vo(e,Qi)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc="LruGarbageCollector",Ec=1048576;function Xc([e,t],[n,A]){const r=yr(e,n);return 0===r?yr(t,A):r}class Hc{constructor(e){this.Er=e,this.buffer=new Ho(Xc),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Xc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return null!==this.Vr}mr(e){tr(Fc,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ri(e)?tr(Fc,"Ignoring IndexedDB error during garbage collection: ",e):await _r(e)}await this.mr(3e5)}))}}class Jc{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return jr.resolve(Ii.le);const n=new Hc(t);return this.gr.forEachTarget(e,(e=>n.Rr(e.sequenceNumber))).next((()=>this.gr.yr(e,(e=>n.Rr(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(tr("LruGarbageCollector","Garbage collection skipped; disabled"),jr.resolve(pc)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(tr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pc):this.wr(e,t)))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,A,r,i,o,s,a;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(tr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),A=this.params.maximumSequenceNumbersToCollect):A=t,i=Date.now(),this.nthSequenceNumber(e,A)))).next((A=>(n=A,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(r=t,s=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(a=Date.now(),er()<=un.DEBUG&&tr("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-g}ms\n\tDetermined least recently used ${A} in `+(o-i)+`ms\n\tRemoved ${r} targets in `+(s-o)+`ms\n\tRemoved ${e} documents in `+(a-s)+`ms\nTotal Duration: ${a-g}ms`),jr.resolve({didRun:!0,sequenceNumbersCollected:A,targetsRemoved:r,documentsRemoved:e}))))}}function Yc(e,t){return new Jc(e,t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,t){this.db=e,this.garbageCollector=Yc(this,t)}pr(e){const t=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Sr(e){let t=0;return this.yr(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.br(e,((e,n)=>t(n)))}addReference(e,t,n){return Lc(e,n)}removeReference(e,t,n){return Lc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Lc(e,t)}Dr(e,t){return function(e,t){let n=!1;return Gc(e).ne((A=>Zc(e,A,t).next((e=>(e&&(n=!0),jr.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),A=[];let r=0;return this.br(e,((i,o)=>{if(o<=t){const t=this.Dr(e,i).next((t=>{if(!t)return r++,n.getEntry(e,i).next((()=>(n.removeEntry(i,kr.min()),Wc(e).delete([0,pi(i.path)]))))}));A.push(t)}})).next((()=>jr.waitFor(A))).next((()=>n.apply(e))).next((()=>r))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Lc(e,t)}br(e,t){const n=Wc(e);let A,r=Ii.le;return n.te({index:zi},(([e,n],{path:i,sequenceNumber:o})=>{0===e?(r!==Ii.le&&t(new xr(Bi(A)),r),r=o,A=i):r=Ii.le})).next((()=>{r!==Ii.le&&t(new xr(Bi(A)),r)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lc(e,t){return Wc(e).put((n=t,A=e.currentSequenceNumber,{targetId:0,path:pi(n.path),sequenceNumber:A}));var n,A}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(){this.changes=new Ra((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Fs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?jr.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return zc(e).put(n)}removeEntry(e,t,n){return zc(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],wl(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.vr(e,n))))}getEntry(e,t){let n=Fs.newInvalidDocument(t);return zc(e).te({index:Hi,range:IDBKeyRange.only(Oc(t))},((e,A)=>{n=this.Cr(t,A)})).next((()=>n))}Fr(e,t){let n={size:0,document:Fs.newInvalidDocument(t)};return zc(e).te({index:Hi,range:IDBKeyRange.only(Oc(t))},((e,A)=>{n={document:this.Cr(t,A),size:yc(A)}})).next((()=>n))}getEntries(e,t){let n=Na();return this.Mr(e,t,((e,t)=>{const A=this.Cr(e,t);n=n.insert(e,A)})).next((()=>n))}Or(e,t){let n=Na(),A=new Fo(xr.comparator);return this.Mr(e,t,((e,t)=>{const r=this.Cr(e,t);n=n.insert(e,r),A=A.insert(e,yc(t))})).next((()=>({documents:n,Nr:A})))}Mr(e,t,n){if(t.isEmpty())return jr.resolve();let A=new Ho(_c);t.forEach((e=>A=A.add(e)));const r=IDBKeyRange.bound(Oc(A.first()),Oc(A.last())),i=A.getIterator();let o=i.getNext();return zc(e).te({index:Hi,range:r},((e,t,A)=>{const r=xr.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&_c(o,r)<0;)n(o,null),o=i.getNext();o&&o.isEqual(r)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?A.H(Oc(o)):A.done()})).next((()=>{for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n,A,r){const i=t.path,o=[i.popLast().toArray(),i.lastSegment(),wl(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zc(e).J(IDBKeyRange.bound(o,s,!0)).next((e=>{null==r||r.incrementDocumentReadCount(e.length);let n=Na();for(const r of e){const e=this.Cr(xr.fromSegments(r.prefixPath.concat(r.collectionGroup,r.documentId)),r);e.isFoundDocument()&&(Za(t,e)||A.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,A){let r=Na();const i=Pc(t,n),o=Pc(t,Dr.max());return zc(e).te({index:Ji,range:IDBKeyRange.bound(i,o,!0)},((e,t,n)=>{const i=this.Cr(xr.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);r=r.insert(i.key,i),r.size===A&&n.done()})).next((()=>r))}newChangeBuffer(e){return new Qc(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Dc(e).get(Li).next((e=>(sr(!!e,20021),e)))}vr(e,t){return Dc(e).put(Li,t)}Cr(e,t){if(t){const e=Bl(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(kr.min()))return e}return Fs.newInvalidDocument(e)}}function Mc(e){return new Kc(e)}class Qc extends Tc{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Ra((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,A=new Ho(((e,t)=>yr(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((r,i)=>{const o=this.Lr.get(r);if(t.push(this.Br.removeEntry(e,r,o.readTime)),i.isValidDocument()){const s=yl(this.Br.serializer,i);A=A.add(r.path.popLast());const a=yc(s);n+=a-o.size,t.push(this.Br.addEntry(e,r,s))}else if(n-=o.size,this.trackRemovals){const n=yl(this.Br.serializer,i.convertToNoDocument(kr.min()));t.push(this.Br.addEntry(e,r,n))}})),A.forEach((n=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.Br.updateMetadata(e,n)),jr.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next((e=>(this.Lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.Br.Or(e,t).next((({documents:e,Nr:t})=>(t.forEach(((t,n)=>{this.Lr.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Dc(e){return Vo(e,Ui)}function zc(e){return Vo(e,Ei)}function Oc(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Pc(e,t){const n=t.documentKey.path.toArray();return[e,wl(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function _c(e,t){const n=e.path.toArray(),A=t.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<A.length-2;++i)if(r=yr(n[i],A[i]),r)return r;return r=yr(n.length,A.length),r||(r=yr(n[n.length-2],A[A.length-2]),r||yr(n[n.length-1],A[A.length-1])
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}class jc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,t,n,A){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=A}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((A=>(n=A,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&gg(n.mutation,e,Yo.empty(),Nr.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Ya()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Ya()){const A=Ea();return this.populateOverlays(e,A,t).next((()=>this.computeViews(e,t,A,n).next((e=>{let t=Wa();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Ea();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Ya())))}populateOverlays(e,t,n){const A=[];return n.forEach((e=>{t.has(e)||A.push(e)})),this.documentOverlayCache.getOverlays(e,A).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,A){let r=Na();const i=Ha(),o=Ha();return t.forEach(((e,t)=>{const o=n.get(t.key);A.has(t.key)&&(void 0===o||o.mutation instanceof Cg)?r=r.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),gg(o.mutation,t,o.mutation.getFieldMask(),Nr.now())):i.set(t.key,Yo.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new jc(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Ha();let A=new Fo(((e,t)=>e-t)),r=Ya();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||Yo.empty();o=r.applyToLocalView(i,o),n.set(e,o);const s=(A.get(r.batchId)||Ya()).add(e);A=A.insert(r.batchId,s)}))})).next((()=>{const i=[],o=A.getReverseIterator();for(;o.hasNext();){const A=o.getNext(),s=A.key,a=A.value,g=Xa();a.forEach((e=>{if(!r.has(e)){const A=sg(t.get(e),n.get(e));null!==A&&g.set(e,A),r=r.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,s,g))}return jr.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,A){return r=t,xr.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):ha(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,A):this.getDocumentsMatchingCollectionQuery(e,t,n,A);var r}getNextDocuments(e,t,n,A){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,A).next((r=>{const i=A-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,A-r.size):jr.resolve(Ea());let o=Jr,s=r;return i.next((t=>jr.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?jr.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,s,t,Ya()))).next((e=>({batchId:o,changes:Fa(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xr(t)).next((e=>{let t=Wa();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,A){const r=t.collectionGroup;let i=Wa();return this.indexManager.getCollectionParents(e,r).next((o=>jr.forEach(o,(o=>{const s=(a=t,g=o.child(r),new Ia(g,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,g;return this.getDocumentsMatchingCollectionQuery(e,s,n,A).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,A){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,A)))).next((e=>{r.forEach(((t,n)=>{const A=n.getKey();null===e.get(A)&&(e=e.insert(A,Fs.newInvalidDocument(A)))}));let n=Wa();return e.forEach(((e,A)=>{const i=r.get(e);void 0!==i&&gg(i.mutation,A,Yo.empty(),Nr.now()),Za(t,A)&&(n=n.insert(e,A))})),n}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return jr.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,{id:(n=t).id,version:n.version,createTime:Og(n.createTime)}),jr.resolve();var n}getNamedQuery(e,t){return jr.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,{name:(n=t).name,query:Vl(n.bundledQuery),readTime:Og(n.readTime)}),jr.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(){this.overlays=new Fo(xr.comparator),this.Qr=new Map}getOverlay(e,t){return jr.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ea();return jr.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,A)=>{this.bt(e,t,A)})),jr.resolve()}removeOverlaysForBatchId(e,t,n){const A=this.Qr.get(n);return void 0!==A&&(A.forEach((e=>this.overlays=this.overlays.remove(e))),this.Qr.delete(n)),jr.resolve()}getOverlaysForCollection(e,t,n){const A=Ea(),r=t.length+1,i=new xr(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===r&&e.largestBatchId>n&&A.set(e.getKey(),e)}return jr.resolve(A)}getOverlaysForCollectionGroup(e,t,n,A){let r=new Fo(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=Ea(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ea(),s=r.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=A)););return jr.resolve(o)}bt(e,t,n){const A=this.overlays.get(n.key);if(null!==A){const e=this.Qr.get(A.largestBatchId).delete(n.key);this.Qr.set(A.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Bg(t,n));let r=this.Qr.get(t);void 0===r&&(r=Ya(),this.Qr.set(t,r)),this.Qr.set(t,r.add(n.key))}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(){this.sessionToken=Lo.EMPTY_BYTE_STRING}getSessionToken(e){return jr.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,jr.resolve()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(){this.$r=new Ho(AI.Ur),this.Kr=new Ho(AI.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new AI(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.zr(new AI(e,t))}jr(e,t){e.forEach((e=>this.removeReference(e,t)))}Hr(e){const t=new xr(new Er([])),n=new AI(t,e),A=new AI(t,e+1),r=[];return this.Kr.forEachInRange([n,A],(e=>{this.zr(e),r.push(e.key)})),r}Jr(){this.$r.forEach((e=>this.zr(e)))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new xr(new Er([])),n=new AI(t,e),A=new AI(t,e+1);let r=Ya();return this.Kr.forEachInRange([n,A],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new AI(e,0),n=this.$r.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class AI{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return xr.comparator(e.key,t.key)||yr(e.Zr,t.Zr)}static Wr(e,t){return yr(e.Zr,t.Zr)||xr.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ho(AI.Ur)}checkEmpty(e){return jr.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,A){const r=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new fg(r,t,n,A);this.mutationQueue.push(i);for(const o of A)this.Xr=this.Xr.add(new AI(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return jr.resolve(i)}lookupMutationBatch(e,t){return jr.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,A=this.ti(n),r=A<0?0:A;return jr.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return jr.resolve(0===this.mutationQueue.length?Ci:this.nr-1)}getAllMutationBatches(e){return jr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new AI(t,0),A=new AI(t,Number.POSITIVE_INFINITY),r=[];return this.Xr.forEachInRange([n,A],(e=>{const t=this.ei(e.Zr);r.push(t)})),jr.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ho(yr);return t.forEach((e=>{const t=new AI(e,0),A=new AI(e,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([t,A],(e=>{n=n.add(e.Zr)}))})),jr.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,A=n.length+1;let r=n;xr.isDocumentKey(r)||(r=r.child(""));const i=new AI(new xr(r),0);let o=new Ho(yr);return this.Xr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===A&&(o=o.add(e.Zr)),!0)}),i),jr.resolve(this.ni(o))}ni(e){const t=[];return e.forEach((e=>{const n=this.ei(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){sr(0===this.ri(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Xr;return jr.forEach(t.mutations,(A=>{const r=new AI(A.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,A.key)})).next((()=>{this.Xr=n}))}sr(e){}containsKey(e,t){const n=new AI(t,0),A=this.Xr.firstAfterOrEqual(n);return jr.resolve(t.isEqual(A&&A.key))}performConsistencyCheck(e){return this.mutationQueue.length,jr.resolve()}ri(e,t){return this.ti(e)}ti(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e){this.ii=e,this.docs=new Fo(xr.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,A=this.docs.get(n),r=A?A.size:0,i=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return jr.resolve(n?n.document.mutableCopy():Fs.newInvalidDocument(t))}getEntries(e,t){let n=Na();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Fs.newInvalidDocument(e))})),jr.resolve(n)}getDocumentsMatchingQuery(e,t,n,A){let r=Na();const i=t.path,o=new xr(i.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){const{key:e,value:{document:o}}=s.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||zr(Qr(o),n)<=0||(A.has(o.key)||Za(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return jr.resolve(r)}getAllFromCollectionGroup(e,t,n,A){ir(9500)}si(e,t){return jr.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new oI(this)}getSize(e){return jr.resolve(this.size)}}class oI extends Tc{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach(((n,A)=>{A.isValidDocument()?t.push(this.Br.addEntry(e,A)):this.Br.removeEntry(n)})),jr.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e){this.persistence=e,this.oi=new Ra((e=>oa(e)),sa),this.lastRemoteSnapshotVersion=kr.min(),this.highestTargetId=0,this._i=0,this.ai=new nI,this.targetCount=0,this.ui=Rc.cr()}forEachTarget(e,t){return this.oi.forEach(((e,n)=>t(n))),jr.resolve()}getLastRemoteSnapshotVersion(e){return jr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return jr.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),jr.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),jr.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Rc(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,jr.resolve()}updateTargetData(e,t){return this.Tr(t),jr.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,jr.resolve()}removeTargets(e,t,n){let A=0;const r=[];return this.oi.forEach(((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.oi.delete(i),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),A++)})),jr.waitFor(r).next((()=>A))}getTargetCount(e){return jr.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return jr.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),jr.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const A=this.persistence.referenceDelegate,r=[];return A&&t.forEach((t=>{r.push(A.markPotentiallyOrphaned(e,t))})),jr.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),jr.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return jr.resolve(n)}containsKey(e,t){return jr.resolve(this.ai.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,t){this.ci={},this.overlays={},this.li=new Ii(0),this.hi=!1,this.hi=!0,this.Pi=new tI,this.referenceDelegate=e(this),this.Ti=new sI(this),this.indexManager=new ac,this.remoteDocumentCache=new iI((e=>this.referenceDelegate.Ii(e))),this.serializer=new bl(t),this.Ei=new $c(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new eI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new rI(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){tr("MemoryPersistence","Starting transaction:",e);const A=new gI(this.li.next());return this.referenceDelegate.di(),n(A).next((e=>this.referenceDelegate.Ai(A).next((()=>e)))).toPromise().then((e=>(A.raiseOnCommittedEvent(),e)))}Ri(e,t){return jr.or(Object.values(this.ci).map((n=>()=>n.containsKey(e,t))))}}class gI extends Pr{constructor(e){super(),this.currentSequenceNumber=e}}class lI{constructor(e){this.persistence=e,this.Vi=new nI,this.mi=null}static fi(e){return new lI(e)}get gi(){if(this.mi)return this.mi;throw ir(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),jr.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),jr.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),jr.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach((e=>this.gi.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.gi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return jr.forEach(this.gi,(n=>{const A=xr.fromPath(n);return this.pi(e,A).next((e=>{e||t.removeEntry(A,kr.min())}))})).next((()=>(this.mi=null,t.apply(e))))}updateLimboDocument(e,t){return this.pi(e,t).next((e=>{e?this.gi.delete(t.toString()):this.gi.add(t.toString())}))}Ii(e){return 0}pi(e,t){return jr.or([()=>jr.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class cI{constructor(e,t){this.persistence=e,this.yi=new Ra((e=>pi(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Yc(this,t)}static fi(e,t){return new cI(e,t)}di(){}Ai(e){return jr.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Sr(e){let t=0;return this.yr(e,(e=>{t++})).next((()=>t))}yr(e,t){return jr.forEach(this.yi,((n,A)=>this.Dr(e,n,A).next((e=>e?jr.resolve():t(A)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const A=this.persistence.getRemoteDocumentCache(),r=A.newChangeBuffer();return A.si(e,(A=>this.Dr(e,A,t).next((e=>{e||(n++,r.removeEntry(A,kr.min()))})))).next((()=>r.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),jr.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),jr.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),jr.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),jr.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hs(e.data.value)),t}Dr(e,t,n){return jr.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.yi.get(t);return jr.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.serializer=e}q(e,t,n,A){const r=new $r("createOrUpgrade",t);n<1&&A>=1&&(e.createObjectStore(wi),function(e){e.createObjectStore(Si,{keyPath:"userId"});e.createObjectStore(vi,{keyPath:Gi,autoIncrement:!0}).createIndex(Ri,Vi,{unique:!0}),e.createObjectStore(Fi)}(e),CI(e),function(e){e.createObjectStore(yi)}(e));let i=jr.resolve();return n<3&&A>=3&&(0!==n&&(function(e){e.deleteObjectStore(Qi),e.deleteObjectStore(Ti),e.deleteObjectStore(_i)}(e),CI(e)),i=i.next((()=>function(e){const t=e.store(_i),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:kr.min().toTimestamp(),targetCount:0};return t.put(Pi,n)}(r)))),n<4&&A>=4&&(0!==n&&(i=i.next((()=>function(e,t){return t.store(vi).J().next((n=>{e.deleteObjectStore(vi),e.createObjectStore(vi,{keyPath:Gi,autoIncrement:!0}).createIndex(Ri,Vi,{unique:!0});const A=t.store(vi),r=n.map((e=>A.put(e)));return jr.waitFor(r)}))}(e,r)))),i=i.next((()=>{!function(e){e.createObjectStore($i,{keyPath:"clientId"})}(e)}))),n<5&&A>=5&&(i=i.next((()=>this.wi(r)))),n<6&&A>=6&&(i=i.next((()=>(function(e){e.createObjectStore(Ui)}(e),this.Si(r))))),n<7&&A>=7&&(i=i.next((()=>this.bi(r)))),n<8&&A>=8&&(i=i.next((()=>this.Di(e,r)))),n<9&&A>=9&&(i=i.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&A>=10&&(i=i.next((()=>this.Ci(r)))),n<11&&A>=11&&(i=i.next((()=>{!function(e){e.createObjectStore(eo,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(to,{keyPath:"name"})}(e)}))),n<12&&A>=12&&(i=i.next((()=>{!function(e){const t=e.createObjectStore(Io,{keyPath:Co});t.createIndex(uo,ho,{unique:!1}),t.createIndex(mo,po,{unique:!1})}(e)}))),n<13&&A>=13&&(i=i.next((()=>function(e){const t=e.createObjectStore(Ei,{keyPath:Xi});t.createIndex(Hi,xi),t.createIndex(Ji,Yi)}(e))).next((()=>this.Fi(e,r))).next((()=>e.deleteObjectStore(yi)))),n<14&&A>=14&&(i=i.next((()=>this.Mi(e,r)))),n<15&&A>=15&&(i=i.next((()=>function(e){e.createObjectStore(no,{keyPath:"indexId",autoIncrement:!0}).createIndex(Ao,"collectionGroup",{unique:!1});e.createObjectStore(ro,{keyPath:io}).createIndex(oo,so,{unique:!1});e.createObjectStore(ao,{keyPath:go}).createIndex(lo,co,{unique:!1})}(e)))),n<16&&A>=16&&(i=i.next((()=>{t.objectStore(ro).clear()})).next((()=>{t.objectStore(ao).clear()}))),n<17&&A>=17&&(i=i.next((()=>{!function(e){e.createObjectStore(fo,{keyPath:"name"})}(e)}))),n<18&&A>=18&&qt()&&(i=i.next((()=>{t.objectStore(ro).clear()})).next((()=>{t.objectStore(ao).clear()}))),i}Si(e){let t=0;return e.store(yi).te(((e,n)=>{t+=yc(n)})).next((()=>{const n={byteSize:t};return e.store(Ui).put(Li,n)}))}wi(e){const t=e.store(Si),n=e.store(vi);return t.J().next((t=>jr.forEach(t,(t=>{const A=IDBKeyRange.bound([t.userId,Ci],[t.userId,t.lastAcknowledgedBatchId]);return n.J(Ri,A).next((n=>jr.forEach(n,(n=>{sr(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const A=vl(this.serializer,n);return Bc(e,t.userId,A).next((()=>{}))}))))}))))}bi(e){const t=e.store(Qi),n=e.store(yi);return e.store(_i).get(Pi).next((e=>{const A=[];return n.te(((n,r)=>{const i=new Er(n),o=[0,pi(i)];A.push(t.get(o).next((n=>{return n?jr.resolve():(A=i,t.put({targetId:0,path:pi(A),sequenceNumber:e.highestListenSequenceNumber}));var A})))})).next((()=>jr.waitFor(A)))}))}Di(e,t){e.createObjectStore(ji,{keyPath:qi});const n=t.store(ji),A=new gc,r=e=>{if(A.add(e)){const t=e.lastSegment(),A=e.popLast();return n.put({collectionId:t,parent:pi(A)})}};return t.store(yi).te({ee:!0},((e,t)=>{const n=new Er(e);return r(n.popLast())})).next((()=>t.store(Fi).te({ee:!0},(([e,t,n],A)=>{const i=Bi(t);return r(i.popLast())}))))}Ci(e){const t=e.store(Ti);return t.te(((e,n)=>{const A=Gl(n),r=Rl(this.serializer,A);return t.put(r)}))}Fi(e,t){const n=t.store(yi),A=[];return n.te(((e,n)=>{const r=t.store(Ei),i=(s=n,s.document?new xr(Er.fromString(s.document.name).popFirst(5)):s.noDocument?xr.fromSegments(s.noDocument.path):s.unknownDocument?xr.fromSegments(s.unknownDocument.path):ir(36783)).path.toArray(),o={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};var s;A.push(r.put(o))})).next((()=>jr.waitFor(A)))}Mi(e,t){const n=t.store(vi),A=Mc(this.serializer),r=new aI(lI.fi,this.serializer.wt);return n.J().next((e=>{const n=new Map;return e.forEach((e=>{var t;let A=null!==(t=n.get(e.userId))&&void 0!==t?t:Ya();vl(this.serializer,e).keys().forEach((e=>A=A.add(e))),n.set(e.userId,A)})),jr.forEach(n,((e,n)=>{const i=new jA(n),o=Hl.St(this.serializer,i),s=r.getIndexManager(i),a=wc.St(i,this.serializer,s,r.referenceDelegate);return new qc(A,a,o,s).recalculateAndSaveOverlaysForDocumentKeys(new Ro(t,Ii.le),e).next()}))}))}}function CI(e){e.createObjectStore(Qi,{keyPath:Di}).createIndex(zi,Oi,{unique:!0}),e.createObjectStore(Ti,{keyPath:"targetId"}).createIndex(Ki,Mi,{unique:!0}),e.createObjectStore(_i)}const uI="IndexedDbPersistence",dI=18e5,hI=5e3,mI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class pI{constructor(e,t,n,A,r,i,o,s,a,g,l=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.xi=r,this.window=i,this.document=o,this.Oi=a,this.Ni=g,this.Bi=l,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=e=>Promise.resolve(),!pI.C())throw new lr(gr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Uc(this,A),this.Ui=t+"main",this.serializer=new bl(s),this.Ki=new ei(this.Ui,this.Bi,new II(this.serializer)),this.Pi=new Jl,this.Ti=new Vc(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Mc(this.serializer),this.Ei=new Fl,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,!1===g&&nr(uI,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lr(gr.FAILED_PRECONDITION,mI);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ti.getHighestSequenceNumber(e)))})).then((e=>{this.li=new Ii(e,this.Oi)})).then((()=>{this.hi=!0})).catch((e=>(this.Ki&&this.Ki.close(),Promise.reject(e))))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget((async()=>{this.started&&await this.Gi()})))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>bI(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Yi(e).next((e=>{e||(this.isPrimary=!1,this.xi.enqueueRetryable((()=>this.$i(!1))))}))})).next((()=>this.Zi(e))).next((t=>this.isPrimary&&!t?this.Xi(e).next((()=>!1)):!!t&&this.es(e).next((()=>!0)))))).catch((e=>{if(ri(e))return tr(uI,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return tr(uI,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.xi.enqueueRetryable((()=>this.$i(e))),this.isPrimary=e}))}Yi(e){return fI(e).get(Zi).next((e=>jr.resolve(this.ts(e))))}ns(e){return bI(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,dI)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Vo(e,$i);return t.J().next((e=>{const n=this._s(e,dI),A=e.filter((e=>-1===n.indexOf(e)));return jr.forEach(A,(e=>t.delete(e.clientId))).next((()=>A))}))})).catch((()=>[]));if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Gi().then((()=>this.rs())).then((()=>this.Hi()))))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?jr.resolve(!0):fI(e).get(Zi).next((t=>{if(null!==t&&this.ss(t.leaseTimestampMs,hI)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new lr(gr.FAILED_PRECONDITION,mI);return!1}}return!(!this.networkEnabled||!this.inForeground)||bI(e).J().next((e=>void 0===this._s(e,hI).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,A=this.networkEnabled===e.networkEnabled;if(t||n&&A)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&tr(uI,`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[wi,$i],(e=>{const t=new Ro(e,Ii.le);return this.Xi(t).next((()=>this.ns(t)))})),this.Ki.close(),this.Ts()}_s(e,t){return e.filter((e=>this.ss(e.updateTimeMs,t)&&!this.cs(e.clientId)))}Is(){return this.runTransaction("getActiveClients","readonly",(e=>bI(e).J().next((e=>this._s(e,dI).map((e=>e.clientId))))))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return wc.St(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ic(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Hl.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,n){tr(uI,"Starting transaction:",e);const A="readonly"===t?"readonly":"readwrite",r=18===(i=this.Bi)?Go:17===i?vo:16===i?So:15===i?Zo:14===i?wo:13===i?yo:12===i?Bo:11===i?bo:void ir(60245);var i;let o;return this.Ki.runTransaction(e,A,r,(A=>(o=new Ro(A,this.li?this.li.next():Ii.le),"readwrite-primary"===t?this.Yi(o).next((e=>!!e||this.Zi(o))).next((t=>{if(!t)throw nr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable((()=>this.$i(!1))),new lr(gr.FAILED_PRECONDITION,Or);return n(o)})).next((e=>this.es(o).next((()=>e)))):this.Es(o).next((()=>n(o)))))).then((e=>(o.raiseOnCommittedEvent(),e)))}Es(e){return fI(e).get(Zi).next((e=>{if(null!==e&&this.ss(e.leaseTimestampMs,hI)&&!this.cs(e.ownerId)&&!this.ts(e)&&!(this.Ni||this.allowTabSynchronization&&e.allowTabSynchronization))throw new lr(gr.FAILED_PRECONDITION,mI)}))}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fI(e).put(Zi,t)}static C(){return ei.C()}Xi(e){const t=fI(e);return t.get(Zi).next((e=>this.ts(e)?(tr(uI,"Releasing primary lease."),t.delete(Zi)):jr.resolve()))}ss(e,t){const n=Date.now();return!(e<n-t||e>n&&(nr(`Detected an update time that is in the future: ${e} > ${n}`),1))}zi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ki=()=>{this.xi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Gi())))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground="visible"===this.document.visibilityState)}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Li=()=>{this.ls();const e=/(?:Version|Mobile)\/1[456]/;jt()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const n=null!==(null===(t=this.Wi)||void 0===t?void 0:t.getItem(this.us(e)));return tr(uI,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return nr(uI,"Failed to get zombied client id.",n),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(Zf){nr("Failed to set zombie client id.",Zf)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch(Zf){}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fI(e){return Vo(e,wi)}function bI(e){return Vo(e,$i)}function BI(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class yI{constructor(e,t,n,A){this.targetId=e,this.fromCache=t,this.ds=n,this.As=A}static Rs(e,t){let n=Ya(),A=Ya();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:A=A.add(r.doc.key)}return new yI(e,t.fromCache,n,A)}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=jt()?8:ti(Pt())>0?6:4}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,A){const r={result:null};return this.ws(e,t).next((e=>{r.result=e})).next((()=>{if(!r.result)return this.Ss(e,t,A,n).next((e=>{r.result=e}))})).next((()=>{if(r.result)return;const n=new wI;return this.bs(e,t,n).next((A=>{if(r.result=A,this.fs)return this.Ds(e,t,n,A.size)}))})).next((()=>r.result))}Ds(e,t,n,A){return n.documentReadCount<this.gs?(er()<=un.DEBUG&&tr("QueryEngine","SDK will not create cache indexes for query:",wa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),jr.resolve()):(er()<=un.DEBUG&&tr("QueryEngine","Query:",wa(t),"scans",n.documentReadCount,"local documents and returns",A,"documents as results."),n.documentReadCount>this.ps*A?(er()<=un.DEBUG&&tr("QueryEngine","The SDK decides to create cache indexes for query:",wa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pa(t))):jr.resolve())}ws(e,t){if(da(t))return jr.resolve(null);let n=pa(t);return this.indexManager.getIndexType(e,n).next((A=>0===A?null:(null!==t.limit&&1===A&&(t=ba(t,null,"F"),n=pa(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((A=>{const r=Ya(...A);return this.ys.getDocuments(e,r).next((A=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.vs(t,A);return this.Cs(t,i,r,n.readTime)?this.ws(e,ba(t,null,"F")):this.Fs(e,i,t,n)}))))})))))}Ss(e,t,n,A){return da(t)||A.isEqual(kr.min())?jr.resolve(null):this.ys.getDocuments(e,n).next((r=>{const i=this.vs(t,r);return this.Cs(t,i,n,A)?jr.resolve(null):(er()<=un.DEBUG&&tr("QueryEngine","Re-using previous result from %s to execute query: %s",A.toString(),wa(t)),this.Fs(e,i,t,Mr(A,Jr)).next((e=>e)))}))}vs(e,t){let n=new Ho(va(e));return t.forEach(((t,A)=>{Za(e,A)&&(n=n.add(A))})),n}Cs(e,t,n,A){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(A)>0)}bs(e,t,n){return er()<=un.DEBUG&&tr("QueryEngine","Using full collection scan to execute query:",wa(t)),this.ys.getDocumentsMatchingQuery(e,t,Dr.min(),n)}Fs(e,t,n,A){return this.ys.getDocumentsMatchingQuery(e,n,A).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="LocalStore";class vI{constructor(e,t,n,A){this.persistence=e,this.Ms=t,this.serializer=A,this.xs=new Fo(yr),this.Os=new Ra((e=>oa(e)),sa),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qc(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.xs)))}}function GI(e,t,n,A){return new vI(e,t,n,A)}async function RI(e,t){const n=ar(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let A;return n.mutationQueue.getAllMutationBatches(e).next((r=>(A=r,n.Ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],i=[];let o=Ya();for(const e of A){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ks:e,removedBatchIds:r,addedBatchIds:i})))}))}))}function VI(e){const t=ar(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ti.getLastRemoteSnapshotVersion(e)))}function NI(e,t){const n=ar(e),A=t.snapshotVersion;let r=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.Bs.newChangeBuffer({trackRemovals:!0});r=n.xs;const o=[];t.targetChanges.forEach(((i,s)=>{const a=r.get(s);if(!a)return;o.push(n.Ti.removeMatchingKeys(e,i.removedDocuments,s).next((()=>n.Ti.addMatchingKeys(e,i.addedDocuments,s))));let g=a.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?g=g.withResumeToken(Lo.EMPTY_BYTE_STRING,kr.min()).withLastLimboFreeSnapshotVersion(kr.min()):i.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(i.resumeToken,A)),r=r.insert(s,g),function(e,t,n){if(0===e.resumeToken.approximateByteSize())return!0;if(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8)return!0;return n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,g,i)&&o.push(n.Ti.updateTargetData(e,g))}));let s=Na(),a=Ya();if(t.documentUpdates.forEach((A=>{t.resolvedLimboDocuments.has(A)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,A))})),o.push(function(e,t,n){let A=Ya(),r=Ya();return n.forEach((e=>A=A.add(e))),t.getEntries(e,A).next((e=>{let A=Na();return n.forEach(((n,i)=>{const o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),i.isNoDocument()&&i.version.isEqual(kr.min())?(t.removeEntry(n,i.readTime),A=A.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),A=A.insert(n,i)):tr(SI,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{qs:A,Qs:r}}))}(e,i,t.documentUpdates).next((e=>{s=e.qs,a=e.Qs}))),!A.isEqual(kr.min())){const t=n.Ti.getLastRemoteSnapshotVersion(e).next((t=>n.Ti.setTargetsMetadata(e,e.currentSequenceNumber,A)));o.push(t)}return jr.waitFor(o).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,s,a))).next((()=>s))})).then((e=>(n.xs=r,e)))}function kI(e,t){const n=ar(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Ci),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function WI(e,t){const n=ar(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let A;return n.Ti.getTargetData(e,t).next((r=>r?(A=r,jr.resolve(A)):n.Ti.allocateTargetId(e).next((r=>(A=new fl(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Ti.addTargetData(e,A).next((()=>A)))))))})).then((e=>{const A=n.xs.get(e.targetId);return(null===A||e.snapshotVersion.compareTo(A.snapshotVersion)>0)&&(n.xs=n.xs.insert(e.targetId,e),n.Os.set(t,e.targetId)),e}))}async function FI(e,t,n){const A=ar(e),r=A.xs.get(t),i=n?"readwrite":"readwrite-primary";try{n||await A.persistence.runTransaction("Release target",i,(e=>A.persistence.referenceDelegate.removeTarget(e,r)))}catch(o){if(!ri(o))throw o;tr(SI,`Failed to update sequence numbers for target ${t}: ${o}`)}A.xs=A.xs.remove(t),A.Os.delete(r.target)}function EI(e,t,n){const A=ar(e);let r=kr.min(),i=Ya();return A.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const A=ar(e),r=A.Os.get(n);return void 0!==r?jr.resolve(A.xs.get(r)):A.Ti.getTargetData(t,n)}(A,e,pa(t)).next((t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,A.Ti.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>A.Ms.getDocumentsMatchingQuery(e,t,n?r:kr.min(),n?i:Ya()))).next((e=>(xI(A,Sa(t),e),{documents:e,$s:i})))))}function XI(e,t){const n=ar(e),A=ar(n.Ti),r=n.xs.get(t);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",(e=>A.Rt(e,t).next((e=>e?e.target:null))))}function HI(e,t){const n=ar(e),A=n.Ns.get(t)||kr.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.Bs.getAllFromCollectionGroup(e,t,Mr(A,Jr),Number.MAX_SAFE_INTEGER))).then((e=>(xI(n,t,e),e)))}function xI(e,t,n){let A=e.Ns.get(t)||kr.min();n.forEach(((e,t)=>{t.readTime.compareTo(A)>0&&(A=t.readTime)})),e.Ns.set(t,A)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI="firestore_clients";function YI(e,t){return`${JI}_${e}_${t}`}const UI="firestore_mutations";function LI(e,t,n){let A=`${UI}_${e}_${n}`;return t.isAuthenticated()&&(A+=`_${t.uid}`),A}const TI="firestore_targets";function KI(e,t){return`${TI}_${e}_${t}`}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI="SharedClientState";class QI{constructor(e,t,n,A){this.user=e,this.batchId=t,this.state=n,this.error=A}static Gs(e,t,n){const A=JSON.parse(n);let r,i="object"==typeof A&&-1!==["pending","acknowledged","rejected"].indexOf(A.state)&&(void 0===A.error||"object"==typeof A.error);return i&&A.error&&(i="string"==typeof A.error.message&&"string"==typeof A.error.code,i&&(r=new lr(A.error.code,A.error.message))),i?new QI(e,t,A.state,r):(nr(MI,`Failed to parse mutation state for ID '${t}': ${n}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class DI{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Gs(e,t){const n=JSON.parse(t);let A,r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code,r&&(A=new lr(n.error.code,n.error.message))),r?new DI(e,n.state,A):(nr(MI,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zI{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const n=JSON.parse(t);let A="object"==typeof n&&n.activeTargetIds instanceof Array,r=La();for(let i=0;A&&i<n.activeTargetIds.length;++i)A=hi(n.activeTargetIds[i]),r=r.add(n.activeTargetIds[i]);return A?new zI(e,r):(nr(MI,`Failed to parse client data for instance '${e}': ${t}`),null)}}class OI{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new OI(t.clientId,t.onlineState):(nr(MI,`Failed to parse online state: ${e}`),null)}}class PI{constructor(){this.activeTargetIds=La()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _I{constructor(e,t,n,A,r){this.window=e,this.xi=t,this.persistenceKey=n,this.Js=A,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new Fo(yr),this.started=!1,this.eo=[];const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.no=YI(this.persistenceKey,this.Js),this.ro=`firestore_sequence_number_${this.persistenceKey}`,this.Xs=this.Xs.insert(this.Js,new PI),this.io=new RegExp(`^${JI}_${i}_([^_]*)$`),this.so=new RegExp(`^${UI}_${i}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${TI}_${i}_(\\d+)$`),this._o=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.ao=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const n of e){if(n===this.Js)continue;const e=this.getItem(YI(this.persistenceKey,n));if(e){const t=zI.Gs(n,e);t&&(this.Xs=this.Xs.insert(t.clientId,t))}}this.uo();const t=this.storage.getItem(this._o);if(t){const e=this.co(t);e&&this.lo(e)}for(const n of this.eo)this.Zs(n);this.eo=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach(((n,A)=>{A.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,n){this.Po(e,t,n),this.To(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(KI(this.persistenceKey,e));if(t){const A=DI.Gs(e,t);A&&(n=A.state)}}return t&&this.Io.js(e),this.uo(),n}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(KI(this.persistenceKey,e))}updateQueryState(e,t,n){this.Eo(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.To(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return tr(MI,"READ",e,t),t}setItem(e,t){tr(MI,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){tr(MI,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(tr(MI,"EVENT",t.key,t.newValue),t.key===this.no)return void nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.io.test(t.key)){if(null==t.newValue){const e=this.Vo(t.key);return this.mo(e,null)}{const e=this.fo(t.key,t.newValue);if(e)return this.mo(e.clientId,e)}}else if(this.so.test(t.key)){if(null!==t.newValue){const e=this.po(t.key,t.newValue);if(e)return this.yo(e)}}else if(this.oo.test(t.key)){if(null!==t.newValue){const e=this.wo(t.key,t.newValue);if(e)return this.So(e)}}else if(t.key===this._o){if(null!==t.newValue){const e=this.co(t.newValue);if(e)return this.lo(e)}}else if(t.key===this.ro){const e=function(e){let t=Ii.le;if(null!=e)try{const n=JSON.parse(e);sr("number"==typeof n,30636,{bo:e}),t=n}catch(n){nr(MI,"Failed to read sequence number from WebStorage",n)}return t}(t.newValue);e!==Ii.le&&this.sequenceNumberHandler(e)}else if(t.key===this.ao){const e=this.Do(t.newValue);await Promise.all(e.map((e=>this.syncEngine.vo(e))))}}else this.eo.push(t)}))}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,n){const A=new QI(this.currentUser,e,t,n),r=LI(this.persistenceKey,this.currentUser,e);this.setItem(r,A.zs())}To(e){const t=LI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,n){const A=KI(this.persistenceKey,e),r=new DI(e,t,n);this.setItem(A,r.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const n=this.Vo(e);return zI.Gs(n,t)}po(e,t){const n=this.so.exec(e),A=Number(n[1]),r=void 0!==n[2]?n[2]:null;return QI.Gs(new jA(r),A,t)}wo(e,t){const n=this.oo.exec(e),A=Number(n[1]);return DI.Gs(A,t)}co(e){return OI.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);tr(MI,`Ignoring mutation for non-active user ${e.user.uid}`)}So(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const n=t?this.Xs.insert(e,t):this.Xs.remove(e),A=this.ho(this.Xs),r=this.ho(n),i=[],o=[];return r.forEach((e=>{A.has(e)||i.push(e)})),A.forEach((e=>{r.has(e)||o.push(e)})),this.syncEngine.Mo(i,o).then((()=>{this.Xs=n}))}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=La();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class jI{constructor(){this.xo=new PI,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new PI,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{No(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="ConnectivityMonitor";class eC{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){tr($I,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){tr($I,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tC=null;function nC(){return null===tC?tC=268435456+Math.round(2147483648*Math.random()):tC++,"0x"+tC.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const AC="RestConnection",rC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iC{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),A=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${A}`,this.Go=this.databaseId.database===es?`project_id=${n}`:`project_id=${n}&database_id=${A}`}zo(e,t,n,A,r){const i=nC(),o=this.jo(e,t.toUriEncodedString());tr(AC,`Sending RPC '${e}' ${i}:`,o,n);const s={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(s,A,r);const{host:a}=new URL(o),g=Mt(a);return this.Jo(e,o,s,n,g).then((t=>(tr(AC,`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Ar(AC,`RPC '${e}' ${i} failed with error: `,t,"url: ",o,"request:",n),t}))}Yo(e,t,n,A,r,i){return this.zo(e,t,n,A,r)}Ho(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+qA,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}jo(e,t){const n=rC[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="WebChannelConnection";class aC extends iC{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,A,r){const i=nC();return new Promise(((r,o)=>{const s=new UA;s.setWithCredentials(!0),s.listenOnce(TA.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case KA.NO_ERROR:const t=s.getResponseJson();tr(sC,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),r(t);break;case KA.TIMEOUT:tr(sC,`RPC '${e}' ${i} timed out`),o(new lr(gr.DEADLINE_EXCEEDED,"Request time out"));break;case KA.HTTP_ERROR:const n=s.getStatus();if(tr(sC,`RPC '${e}' ${i} failed with status:`,n,"response text:",s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(gr).indexOf(t)>=0?t:gr.UNKNOWN}(t.status);o(new lr(e,t.message))}else o(new lr(gr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new lr(gr.UNAVAILABLE,"Connection failed."));break;default:ir(9055,{l_:e,streamId:i,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{tr(sC,`RPC '${e}' ${i} completed.`)}}));const a=JSON.stringify(A);tr(sC,`RPC '${e}' ${i} sending request:`,A),s.send(t,"POST",a,n,15)}))}T_(e,t,n){const A=nC(),r=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=zA(),o=DA(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},a=this.longPollingOptions.timeoutSeconds;void 0!==a&&(s.longPollingTimeout=Math.round(1e3*a)),this.useFetchStreams&&(s.useFetchStreams=!0),this.Ho(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const g=r.join("");tr(sC,`Creating RPC '${e}' stream ${A}: ${g}`,s);const l=i.createWebChannel(g,s);let c=!1,I=!1;const C=new oC({Zo:t=>{I?tr(sC,`Not sending because RPC '${e}' stream ${A} is closed:`,t):(c||(tr(sC,`Opening RPC '${e}' stream ${A} transport.`),l.open(),c=!0),tr(sC,`RPC '${e}' stream ${A} sending:`,t),l.send(t))},Xo:()=>l.close()}),u=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(t){setTimeout((()=>{throw t}),0)}}))};return u(l,LA.EventType.OPEN,(()=>{I||(tr(sC,`RPC '${e}' stream ${A} transport opened.`),C.__())})),u(l,LA.EventType.CLOSE,(()=>{I||(I=!0,tr(sC,`RPC '${e}' stream ${A} transport closed`),C.u_())})),u(l,LA.EventType.ERROR,(t=>{I||(I=!0,Ar(sC,`RPC '${e}' stream ${A} transport errored. Name:`,t.name,"Message:",t.message),C.u_(new lr(gr.UNAVAILABLE,"The operation could not be completed")))})),u(l,LA.EventType.MESSAGE,(t=>{var n;if(!I){const r=t.data[0];sr(!!r,16349);const i=r,o=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){tr(sC,`RPC '${e}' stream ${A} received error:`,o);const t=o.status;let n=function(e){const t=wg[e];if(void 0!==t)return Sg(t)}(t),r=o.message;void 0===n&&(n=gr.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),I=!0,C.u_(new lr(n,r)),l.close()}else tr(sC,`RPC '${e}' stream ${A} received:`,r),C.c_(r)}})),u(o,QA.STAT_EVENT,(t=>{t.stat===MA.PROXY?tr(sC,`RPC '${e}' stream ${A} detected buffering proxy`):t.stat===MA.NOPROXY&&tr(sC,`RPC '${e}' stream ${A} detected no buffering proxy`)})),setTimeout((()=>{C.a_()}),0),C}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(){return"undefined"!=typeof window?window:null}function lC(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(e){return new Kg(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,t,n=1e3,A=1.5,r=6e4){this.xi=e,this.timerId=t,this.I_=n,this.E_=A,this.d_=r,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const t=Math.floor(this.A_+this.g_()),n=Math.max(0,Date.now()-this.V_),A=Math.max(0,t-n);A>0&&tr("ExponentialBackoff",`Backing off for ${A} ms (base delay: ${this.A_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,A,(()=>(this.V_=Date.now(),e()))),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){null!==this.R_&&(this.R_.skipDelay(),this.R_=null)}cancel(){null!==this.R_&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC="PersistentStream";class uC{constructor(e,t,n,A,r,i,o,s){this.xi=e,this.y_=n,this.w_=A,this.connection=r,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new IC(e,t)}F_(){return 1===this.state||5===this.state||this.M_()}M_(){return 2===this.state||3===this.state}start(){this.v_=0,4!==this.state?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&null===this.b_&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,(()=>this.B_())))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,t){this.k_(),this.q_(),this.C_.cancel(),this.S_++,4!==e?this.C_.reset():t&&t.code===gr.RESOURCE_EXHAUSTED?(nr(t.toString()),nr("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):t&&t.code===gr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),t=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.S_===t&&this.K_(e,n)}),(t=>{e((()=>{const e=new lr(gr.UNKNOWN,"Fetching auth token failed: "+t.message);return this.W_(e)}))}))}K_(e,t){const n=this.U_(this.S_);this.stream=this.G_(e,t),this.stream.e_((()=>{n((()=>this.listener.e_()))})),this.stream.n_((()=>{n((()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,(()=>(this.M_()&&(this.state=3),Promise.resolve()))),this.listener.n_())))})),this.stream.i_((e=>{n((()=>this.W_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.v_?this.z_(e):this.onNext(e)))}))}x_(){this.state=5,this.C_.f_((async()=>{this.state=0,this.start()}))}W_(e){return tr(CC,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return t=>{this.xi.enqueueAndForget((()=>this.S_===e?t():(tr(CC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dC extends uC{constructor(e,t,n,A,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,A,i),this.serializer=r}G_(e,t){return this.connection.T_("Listen",e,t)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r="NO_CHANGE"===(A=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===A?1:"REMOVE"===A?2:"CURRENT"===A?3:"RESET"===A?4:ir(39313,{state:A}),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(sr(void 0===t||"string"==typeof t,58123),Lo.fromBase64String(t||"")):(sr(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Lo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?gr.UNKNOWN:Sg(e.code);return new lr(t,e.message||"")}(s);n=new Xg(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const A=t.documentChange;A.document,A.document.name,A.document.updateTime;const r=$g(e,A.document.name),i=Og(A.document.updateTime),o=A.document.createTime?Og(A.document.createTime):kr.min(),s=new ks({mapValue:{fields:A.document.fields}}),a=Fs.newFoundDocument(r,i,o,s),g=A.targetIds||[],l=A.removedTargetIds||[];n=new Fg(g,l,a.key,a)}else if("documentDelete"in t){t.documentDelete;const A=t.documentDelete;A.document;const r=$g(e,A.document),i=A.readTime?Og(A.readTime):kr.min(),o=Fs.newNoDocument(r,i),s=A.removedTargetIds||[];n=new Fg([],s,o.key,o)}else if("documentRemove"in t){t.documentRemove;const A=t.documentRemove;A.document;const r=$g(e,A.document),i=A.removedTargetIds||[];n=new Fg([],i,r,null)}else{if(!("filter"in t))return ir(11601,{Vt:t});{t.filter;const e=t.filter;e.targetId;const{count:A=0,unchangedNames:r}=e,i=new yg(A,r),o=e.targetId;n=new Eg(o,i)}}var A;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return kr.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?kr.min():t.readTime?Og(t.readTime):kr.min()}(e);return this.listener.j_(t,n)}H_(e){const t={};t.database=nl(this.serializer),t.addTarget=function(e,t){let n;const A=t.target;if(n=aa(A)?{documents:sl(e,A)}:{query:al(e,A).gt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Dg(e,t.resumeToken);const A=Mg(e,t.expectedCount);null!==A&&(n.expectedCount=A)}else if(t.snapshotVersion.compareTo(kr.min())>0){n.readTime=Qg(e,t.snapshotVersion.toTimestamp());const A=Mg(e,t.expectedCount);null!==A&&(n.expectedCount=A)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ir(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.L_(t)}J_(e){const t={};t.database=nl(this.serializer),t.removeTarget=e,this.L_(t)}}class hC extends uC{constructor(e,t,n,A,r,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,A,i),this.serializer=r}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,t){return this.connection.T_("Write",e,t)}z_(e){return sr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,sr(!e.writeResults||0===e.writeResults.length,55816),this.listener.X_()}onNext(e){sr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const t=function(e,t){return e&&e.length>0?(sr(void 0!==t,14353),e.map((e=>function(e,t){let n=e.updateTime?Og(e.updateTime):Og(t);return n.isEqual(kr.min())&&(n=Og(t)),new Ag(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Og(e.commitTime);return this.listener.ea(n,t)}ta(){const e={};e.database=nl(this.serializer),this.L_(e)}Z_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>il(this.serializer,e)))};this.L_(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{}class pC extends mC{constructor(e,t,n,A){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=A,this.na=!1}ra(){if(this.na)throw new lr(gr.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,A){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.zo(e,_g(t,n),A,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===gr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new lr(gr.UNKNOWN,e.toString())}))}Yo(e,t,n,A,r){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Yo(e,_g(t,n),A,i,o,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===gr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new lr(gr.UNKNOWN,e.toString())}))}terminate(){this.na=!0,this.connection.terminate()}}class fC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){0===this.ia&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve()))))}ca(e){"Online"===this.state?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,"Online"===e&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(nr(t),this.oa=!1):tr("OnlineStateTracker",t)}la(){null!==this.sa&&(this.sa.cancel(),this.sa=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="RemoteStore";class BC{constructor(e,t,n,A,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=r,this.Ea.No((e=>{n.enqueueAndForget((async()=>{NC(this)&&(tr(bC,"Restarting streams for network reachability change."),await async function(e){const t=ar(e);t.Ta.add(4),await wC(t),t.da.set("Unknown"),t.Ta.delete(4),await yC(t)}(this))}))})),this.da=new fC(n,A)}}async function yC(e){if(NC(e))for(const t of e.Ia)await t(!0)}async function wC(e){for(const t of e.Ia)await t(!1)}function ZC(e,t){const n=ar(e);n.Pa.has(t.targetId)||(n.Pa.set(t.targetId,t),VC(n)?RC(n):PC(n).M_()&&vC(n,t))}function SC(e,t){const n=ar(e),A=PC(n);n.Pa.delete(t),A.M_()&&GC(n,t),0===n.Pa.size&&(A.M_()?A.N_():NC(n)&&n.da.set("Unknown"))}function vC(e,t){if(e.Aa.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(kr.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}PC(e).H_(t)}function GC(e,t){e.Aa.Ke(t),PC(e).J_(t)}function RC(e){e.Aa=new xg({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>e.Pa.get(t)||null,Pt:()=>e.datastore.serializer.databaseId}),PC(e).start(),e.da._a()}function VC(e){return NC(e)&&!PC(e).F_()&&e.Pa.size>0}function NC(e){return 0===ar(e).Ta.size}function kC(e){e.Aa=void 0}async function WC(e){e.da.set("Online")}async function FC(e){e.Pa.forEach(((t,n)=>{vC(e,t)}))}async function EC(e,t){kC(e),VC(e)?(e.da.ca(t),RC(e)):e.da.set("Unknown")}async function XC(e,t,n){if(e.da.set("Online"),t instanceof Xg&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const A of t.targetIds)e.Pa.has(A)&&(await e.remoteSyncer.rejectListen(A,n),e.Pa.delete(A),e.Aa.removeTarget(A))}(e,t)}catch(A){tr(bC,"Failed to remove targets %s: %s ",t.targetIds.join(","),A),await HC(e,A)}else if(t instanceof Fg?e.Aa.Xe(t):t instanceof Eg?e.Aa.ot(t):e.Aa.nt(t),!n.isEqual(kr.min()))try{const t=await VI(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Aa.It(t);return n.targetChanges.forEach(((n,A)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Pa.get(A);r&&e.Pa.set(A,r.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const A=e.Pa.get(t);if(!A)return;e.Pa.set(t,A.withResumeToken(Lo.EMPTY_BYTE_STRING,A.snapshotVersion)),GC(e,t);const r=new fl(A.target,t,n,A.sequenceNumber);vC(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(r){tr(bC,"Failed to raise snapshot:",r),await HC(e,r)}}async function HC(e,t,n){if(!ri(t))throw t;e.Ta.add(1),await wC(e),e.da.set("Offline"),n||(n=()=>VI(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{tr(bC,"Retrying IndexedDB access"),await n(),e.Ta.delete(1),await yC(e)}))}function xC(e,t){return t().catch((n=>HC(e,n,t)))}async function JC(e){const t=ar(e),n=_C(t);let A=t.ha.length>0?t.ha[t.ha.length-1].batchId:Ci;for(;YC(t);)try{const e=await kI(t.localStore,A);if(null===e){0===t.ha.length&&n.N_();break}A=e.batchId,UC(t,e)}catch(r){await HC(t,r)}LC(t)&&TC(t)}function YC(e){return NC(e)&&e.ha.length<10}function UC(e,t){e.ha.push(t);const n=_C(e);n.M_()&&n.Y_&&n.Z_(t.mutations)}function LC(e){return NC(e)&&!_C(e).F_()&&e.ha.length>0}function TC(e){_C(e).start()}async function KC(e){_C(e).ta()}async function MC(e){const t=_C(e);for(const n of e.ha)t.Z_(n.mutations)}async function QC(e,t,n){const A=e.ha.shift(),r=bg.from(A,t,n);await xC(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await JC(e)}async function DC(e,t){t&&_C(e).Y_&&await async function(e,t){if(function(e){switch(e){case gr.OK:return ir(64938);case gr.CANCELLED:case gr.UNKNOWN:case gr.DEADLINE_EXCEEDED:case gr.RESOURCE_EXHAUSTED:case gr.INTERNAL:case gr.UNAVAILABLE:case gr.UNAUTHENTICATED:return!1;case gr.INVALID_ARGUMENT:case gr.NOT_FOUND:case gr.ALREADY_EXISTS:case gr.PERMISSION_DENIED:case gr.FAILED_PRECONDITION:case gr.ABORTED:case gr.OUT_OF_RANGE:case gr.UNIMPLEMENTED:case gr.DATA_LOSS:return!0;default:return ir(15467,{code:e})}}(n=t.code)&&n!==gr.ABORTED){const n=e.ha.shift();_C(e).O_(),await xC(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await JC(e)}var n}(e,t),LC(e)&&TC(e)}async function zC(e,t){const n=ar(e);n.asyncQueue.verifyOperationInProgress(),tr(bC,"RemoteStore received new credentials");const A=NC(n);n.Ta.add(3),await wC(n),A&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ta.delete(3),await yC(n)}async function OC(e,t){const n=ar(e);t?(n.Ta.delete(2),await yC(n)):t||(n.Ta.add(2),await wC(n),n.da.set("Unknown"))}function PC(e){return e.Ra||(e.Ra=function(e,t,n){const A=ar(e);return A.ra(),new dC(t,A.connection,A.authCredentials,A.appCheckCredentials,A.serializer,n)}(e.datastore,e.asyncQueue,{e_:WC.bind(null,e),n_:FC.bind(null,e),i_:EC.bind(null,e),j_:XC.bind(null,e)}),e.Ia.push((async t=>{t?(e.Ra.O_(),VC(e)?RC(e):e.da.set("Unknown")):(await e.Ra.stop(),kC(e))}))),e.Ra}function _C(e){return e.Va||(e.Va=function(e,t,n){const A=ar(e);return A.ra(),new hC(t,A.connection,A.authCredentials,A.appCheckCredentials,A.serializer,n)}(e.datastore,e.asyncQueue,{e_:()=>Promise.resolve(),n_:KC.bind(null,e),i_:DC.bind(null,e),X_:MC.bind(null,e),ea:QC.bind(null,e)}),e.Ia.push((async t=>{t?(e.Va.O_(),await JC(e)):(await e.Va.stop(),e.ha.length>0&&(tr(bC,`Stopping write stream with ${e.ha.length} pending writes`),e.ha=[]))}))),e.Va
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class jC{constructor(e,t,n,A,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=A,this.removalCallback=r,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,A,r){const i=Date.now()+n,o=new jC(e,t,i,A,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new lr(gr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qC(e,t){if(nr("AsyncQueue",`${t}: ${e}`),ri(e))return new lr(gr.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{static emptySet(e){return new $C(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||xr.comparator(t.key,n.key):(e,t)=>xr.comparator(e.key,t.key),this.keyedMap=Wa(),this.sortedSet=new Fo(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $C))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,A=n.getNext().key;if(!e.isEqual(A))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new $C;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(){this.ma=new Fo(xr.comparator)}track(e){const t=e.doc.key,n=this.ma.get(t);n?0!==e.type&&3===n.type?this.ma=this.ma.insert(t,e):3===e.type&&1!==n.type?this.ma=this.ma.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ma=this.ma.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ma=this.ma.remove(t):1===e.type&&2===n.type?this.ma=this.ma.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ma=this.ma.insert(t,{type:2,doc:e.doc}):ir(63341,{Vt:e,fa:n}):this.ma=this.ma.insert(t,e)}ga(){const e=[];return this.ma.inorderTraversal(((t,n)=>{e.push(n)})),e}}class tu{constructor(e,t,n,A,r,i,o,s,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=A,this.mutatedKeys=r,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=a}static fromInitialDocuments(e,t,n,A,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new tu(e,t,$C.emptySet(t),i,n,A,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ba(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let A=0;A<t.length;A++)if(t[A].type!==n[A].type||!t[A].doc.isEqual(n[A].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some((e=>e.Sa()))}}class Au{constructor(){this.queries=ru(),this.onlineState="Unknown",this.ba=new Set}terminate(){!function(e,t){const n=ar(e),A=n.queries;n.queries=ru(),A.forEach(((e,n)=>{for(const A of n.ya)A.onError(t)}))}(this,new lr(gr.ABORTED,"Firestore shutting down"))}}function ru(){return new Ra((e=>ya(e)),Ba)}async function iu(e,t){const n=ar(e);let A=3;const r=t.query;let i=n.queries.get(r);i?!i.wa()&&t.Sa()&&(A=2):(i=new nu,A=t.Sa()?0:1);try{switch(A){case 0:i.pa=await n.onListen(r,!0);break;case 1:i.pa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const e=qC(o,`Initialization of query '${wa(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,i),i.ya.push(t),t.Da(n.onlineState),i.pa&&t.va(i.pa)&&gu(n)}async function ou(e,t){const n=ar(e),A=t.query;let r=3;const i=n.queries.get(A);if(i){const e=i.ya.indexOf(t);e>=0&&(i.ya.splice(e,1),0===i.ya.length?r=t.Sa()?0:1:!i.wa()&&t.Sa()&&(r=2))}switch(r){case 0:return n.queries.delete(A),n.onUnlisten(A,!0);case 1:return n.queries.delete(A),n.onUnlisten(A,!1);case 2:return n.onLastRemoteStoreUnlisten(A);default:return}}function su(e,t){const n=ar(e);let A=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.ya)e.va(r)&&(A=!0);t.pa=r}}A&&gu(n)}function au(e,t,n){const A=ar(e),r=A.queries.get(t);if(r)for(const i of r.ya)i.onError(n);A.queries.delete(t)}function gu(e){e.ba.forEach((e=>{e.next()}))}var lu,cu;(cu=lu||(lu={})).Ca="default",cu.Cache="cache";class Iu{constructor(e,t,n){this.query=e,this.Fa=t,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=n||{}}va(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new tu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),t=!0):this.Na(e,this.onlineState)&&(this.Ba(e),t=!0),this.xa=e,t}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let t=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),t=!0),t}Na(e,t){if(!e.fromCache)return!0;if(!this.Sa())return!0;const n="Offline"!==t;return(!this.options.La||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Oa(e){if(e.docChanges.length>0)return!0;const t=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Ba(e){e=tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==lu.Cache}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e){this.key=e}}class uu{constructor(e){this.key=e}}class du{constructor(e,t){this.query=e,this.Ga=t,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=Ya(),this.mutatedKeys=Ya(),this.Ha=va(e),this.Ja=new $C(this.Ha)}get Ya(){return this.Ga}Za(e,t){const n=t?t.Xa:new eu,A=t?t.Ja:this.Ja;let r=t?t.mutatedKeys:this.mutatedKeys,i=A,o=!1;const s="F"===this.query.limitType&&A.size===this.query.limit?A.last():null,a="L"===this.query.limitType&&A.size===this.query.limit?A.first():null;if(e.inorderTraversal(((e,t)=>{const g=A.get(e),l=Za(this.query,t)?t:null,c=!!g&&this.mutatedKeys.has(g.key),I=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let C=!1;g&&l?g.data.isEqual(l.data)?c!==I&&(n.track({type:3,doc:l}),C=!0):this.eu(g,l)||(n.track({type:2,doc:l}),C=!0,(s&&this.Ha(l,s)>0||a&&this.Ha(l,a)<0)&&(o=!0)):!g&&l?(n.track({type:0,doc:l}),C=!0):g&&!l&&(n.track({type:1,doc:g}),C=!0,(s||a)&&(o=!0)),C&&(l?(i=i.add(l),r=I?r.add(e):r.delete(e)):(i=i.delete(e),r=r.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{Ja:i,Xa:n,Cs:o,mutatedKeys:r}}eu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,A){const r=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const i=e.Xa.ga();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ir(20277,{Vt:e})}};return n(e)-n(t)}(e.type,t.type)||this.Ha(e.doc,t.doc))),this.tu(n),A=null!=A&&A;const o=t&&!A?this.nu():[],s=0===this.ja.size&&this.current&&!A?1:0,a=s!==this.za;return this.za=s,0!==i.length||a?{snapshot:new tu(this.query,e.Ja,r,i,e.mutatedKeys,0===s,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),ru:o}:{ru:o}}Da(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new eu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach((e=>this.Ga=this.Ga.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ga=this.Ga.delete(e))),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=Ya(),this.Ja.forEach((e=>{this.iu(e.key)&&(this.ja=this.ja.add(e.key))}));const t=[];return e.forEach((e=>{this.ja.has(e)||t.push(new uu(e))})),this.ja.forEach((n=>{e.has(n)||t.push(new Cu(n))})),t}su(e){this.Ga=e.$s,this.ja=Ya();const t=this.Za(e.documents);return this.applyChanges(t,!0)}ou(){return tu.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,0===this.za,this.hasCachedResults)}}const hu="SyncEngine";class mu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class pu{constructor(e){this.key=e,this._u=!1}}class fu{constructor(e,t,n,A,r,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=A,this.currentUser=r,this.maxConcurrentLimboResolutions=i,this.au={},this.uu=new Ra((e=>ya(e)),Ba),this.cu=new Map,this.lu=new Set,this.hu=new Fo(xr.comparator),this.Pu=new Map,this.Tu=new nI,this.Iu={},this.Eu=new Map,this.du=Rc.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return!0===this.Au}}async function bu(e,t,n=!0){const A=Pu(e);let r;const i=A.uu.get(t);return i?(A.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.ou()):r=await yu(A,t,n,!0),r}async function Bu(e,t){const n=Pu(e);await yu(n,t,!0,!1)}async function yu(e,t,n,A){const r=await WI(e.localStore,pa(t)),i=r.targetId,o=e.sharedClientState.addLocalQueryTarget(i,n);let s;return A&&(s=await wu(e,t,i,"current"===o,r.resumeToken)),e.isPrimaryClient&&n&&ZC(e.remoteStore,r),s}async function wu(e,t,n,A,r){e.Ru=(t,n,A)=>async function(e,t,n,A){let r=t.view.Za(n);r.Cs&&(r=await EI(e.localStore,t.query,!1).then((({documents:e})=>t.view.Za(e,r))));const i=A&&A.targetChanges.get(t.targetId),o=A&&null!=A.targetMismatches.get(t.targetId),s=t.view.applyChanges(r,e.isPrimaryClient,i,o);return Xu(e,t.targetId,s.ru),s.snapshot}(e,t,n,A);const i=await EI(e.localStore,t,!0),o=new du(t,i.$s),s=o.Za(i.documents),a=Wg.createSynthesizedTargetChangeForCurrentChange(n,A&&"Offline"!==e.onlineState,r),g=o.applyChanges(s,e.isPrimaryClient,a);Xu(e,n,g.ru);const l=new mu(t,n,o);return e.uu.set(t,l),e.cu.has(n)?e.cu.get(n).push(t):e.cu.set(n,[t]),g.snapshot}async function Zu(e,t,n){const A=ar(e),r=A.uu.get(t),i=A.cu.get(r.targetId);if(i.length>1)return A.cu.set(r.targetId,i.filter((e=>!Ba(e,t)))),void A.uu.delete(t);A.isPrimaryClient?(A.sharedClientState.removeLocalQueryTarget(r.targetId),A.sharedClientState.isActiveQueryTarget(r.targetId)||await FI(A.localStore,r.targetId,!1).then((()=>{A.sharedClientState.clearQueryState(r.targetId),n&&SC(A.remoteStore,r.targetId),Fu(A,r.targetId)})).catch(_r)):(Fu(A,r.targetId),await FI(A.localStore,r.targetId,!0))}async function Su(e,t){const n=ar(e),A=n.uu.get(t),r=n.cu.get(A.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(A.targetId),SC(n.remoteStore,A.targetId))}async function vu(e,t){const n=ar(e);try{const e=await NI(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const A=n.Pu.get(t);A&&(sr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?A._u=!0:e.modifiedDocuments.size>0?sr(A._u,14607):e.removedDocuments.size>0&&(sr(A._u,42227),A._u=!1))})),await Ju(n,e,t)}catch(A){await _r(A)}}function Gu(e,t,n){const A=ar(e);if(A.isPrimaryClient&&0===n||!A.isPrimaryClient&&1===n){const e=[];A.uu.forEach(((n,A)=>{const r=A.view.Da(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=ar(e);n.onlineState=t;let A=!1;n.queries.forEach(((e,n)=>{for(const r of n.ya)r.Da(t)&&(A=!0)})),A&&gu(n)}(A.eventManager,t),e.length&&A.au.j_(e),A.onlineState=t,A.isPrimaryClient&&A.sharedClientState.setOnlineState(t)}}async function Ru(e,t,n){const A=ar(e);A.sharedClientState.updateQueryState(t,"rejected",n);const r=A.Pu.get(t),i=r&&r.key;if(i){let e=new Fo(xr.comparator);e=e.insert(i,Fs.newNoDocument(i,kr.min()));const n=Ya().add(i),r=new kg(kr.min(),new Map,new Fo(yr),e,n);await vu(A,r),A.hu=A.hu.remove(i),A.Pu.delete(t),xu(A)}else await FI(A.localStore,t,!1).then((()=>Fu(A,t,n))).catch(_r)}async function Vu(e,t){const n=ar(e),A=t.batch.batchId;try{const e=await function(e,t){const n=ar(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const A=t.batch.keys(),r=n.Bs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,A){const r=n.batch,i=r.keys();let o=jr.resolve();return i.forEach((e=>{o=o.next((()=>A.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);sr(null!==i,48541),t.version.compareTo(i)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),A.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,A,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Ya();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,A)))}))}(n.localStore,t);Wu(n,A,null),ku(n,A),n.sharedClientState.updateMutationState(A,"acknowledged"),await Ju(n,e)}catch(r){await _r(r)}}async function Nu(e,t,n){const A=ar(e);try{const e=await function(e,t){const n=ar(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let A;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(sr(null!==t,37113),A=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,A,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,A))).next((()=>n.localDocuments.getDocuments(e,A)))}))}(A.localStore,t);Wu(A,t,n),ku(A,t),A.sharedClientState.updateMutationState(t,"rejected",n),await Ju(A,e)}catch(r){await _r(r)}}function ku(e,t){(e.Eu.get(t)||[]).forEach((e=>{e.resolve()})),e.Eu.delete(t)}function Wu(e,t,n){const A=ar(e);let r=A.Iu[A.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),A.Iu[A.currentUser.toKey()]=r}}function Fu(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const A of e.cu.get(t))e.uu.delete(A),n&&e.au.Vu(A,n);e.cu.delete(t),e.isPrimaryClient&&e.Tu.Hr(t).forEach((t=>{e.Tu.containsKey(t)||Eu(e,t)}))}function Eu(e,t){e.lu.delete(t.path.canonicalString());const n=e.hu.get(t);null!==n&&(SC(e.remoteStore,n),e.hu=e.hu.remove(t),e.Pu.delete(n),xu(e))}function Xu(e,t,n){for(const A of n)A instanceof Cu?(e.Tu.addReference(A.key,t),Hu(e,A)):A instanceof uu?(tr(hu,"Document no longer in limbo: "+A.key),e.Tu.removeReference(A.key,t),e.Tu.containsKey(A.key)||Eu(e,A.key)):ir(19791,{mu:A})}function Hu(e,t){const n=t.key,A=n.path.canonicalString();e.hu.get(n)||e.lu.has(A)||(tr(hu,"New document in limbo: "+n),e.lu.add(A),xu(e))}function xu(e){for(;e.lu.size>0&&e.hu.size<e.maxConcurrentLimboResolutions;){const t=e.lu.values().next().value;e.lu.delete(t);const n=new xr(Er.fromString(t)),A=e.du.next();e.Pu.set(A,new pu(n)),e.hu=e.hu.insert(n,A),ZC(e.remoteStore,new fl(pa(ua(n.path)),A,"TargetPurposeLimboResolution",Ii.le))}}async function Ju(e,t,n){const A=ar(e),r=[],i=[],o=[];A.uu.isEmpty()||(A.uu.forEach(((e,s)=>{o.push(A.Ru(s,t,n).then((e=>{var t;if((e||n)&&A.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(s.targetId))||void 0===t?void 0:t.current;A.sharedClientState.updateQueryState(s.targetId,r?"current":"not-current")}if(e){r.push(e);const t=yI.Rs(s.targetId,e);i.push(t)}})))})),await Promise.all(o),A.au.j_(r),await async function(e,t){const n=ar(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>jr.forEach(t,(t=>jr.forEach(t.ds,(A=>n.persistence.referenceDelegate.addReference(e,t.targetId,A))).next((()=>jr.forEach(t.As,(A=>n.persistence.referenceDelegate.removeReference(e,t.targetId,A)))))))))}catch(A){if(!ri(A))throw A;tr(SI,"Failed to update sequence numbers: "+A)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.xs.get(e),A=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(A);n.xs=n.xs.insert(e,r)}}}(A.localStore,i))}async function Yu(e,t){const n=ar(e);if(!n.currentUser.isEqual(t)){tr(hu,"User change. New user:",t.toKey());const e=await RI(n.localStore,t);n.currentUser=t,r="'waitForPendingWrites' promise is rejected due to a user change.",(A=n).Eu.forEach((e=>{e.forEach((e=>{e.reject(new lr(gr.CANCELLED,r))}))})),A.Eu.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ju(n,e.ks)}var A,r}function Uu(e,t){const n=ar(e),A=n.Pu.get(t);if(A&&A._u)return Ya().add(A.key);{let e=Ya();const A=n.cu.get(t);if(!A)return e;for(const t of A){const A=n.uu.get(t);e=e.unionWith(A.view.Ya)}return e}}async function Lu(e,t){const n=ar(e),A=await EI(n.localStore,t.query,!0),r=t.view.su(A);return n.isPrimaryClient&&Xu(n,t.targetId,r.ru),r}async function Tu(e,t){const n=ar(e);return HI(n.localStore,t).then((e=>Ju(n,e)))}async function Ku(e,t,n,A){const r=ar(e),i=await function(e,t){const n=ar(e),A=ar(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>A.tr(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):jr.resolve(null)))))}(r.localStore,t);var o,s;null!==i?("pending"===n?await JC(r.remoteStore):"acknowledged"===n||"rejected"===n?(Wu(r,t,A||null),ku(r,t),o=r.localStore,s=t,ar(ar(o).mutationQueue).sr(s)):ir(6720,"Unknown batchState",{fu:n}),await Ju(r,i)):tr(hu,"Cannot apply mutation batch with id: "+t)}async function Mu(e,t,n){const A=ar(e),r=[],i=[];for(const o of t){let e;const t=A.cu.get(o);if(t&&0!==t.length){e=await WI(A.localStore,pa(t[0]));for(const e of t){const t=A.uu.get(e),n=await Lu(A,t);n.snapshot&&i.push(n.snapshot)}}else{const t=await XI(A.localStore,o);e=await WI(A.localStore,t),await wu(A,Qu(t),o,!1,e.resumeToken)}r.push(e)}return A.au.j_(i),r}function Qu(e){return Ca(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Du(e){return t=ar(e).localStore,ar(ar(t).persistence).Is();var t}async function zu(e,t,n,A){const r=ar(e);if(r.Au)return void tr(hu,"Ignoring unexpected query state notification.");const i=r.cu.get(t);if(i&&i.length>0)switch(n){case"current":case"not-current":{const e=await HI(r.localStore,Sa(i[0])),A=kg.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,Lo.EMPTY_BYTE_STRING);await Ju(r,e,A);break}case"rejected":await FI(r.localStore,t,!0),Fu(r,t,A);break;default:ir(64155,n)}}async function Ou(e,t,n){const A=Pu(e);if(A.Au){for(const e of t){if(A.cu.has(e)&&A.sharedClientState.isActiveQueryTarget(e)){tr(hu,"Adding an already active target "+e);continue}const t=await XI(A.localStore,e),n=await WI(A.localStore,t);await wu(A,Qu(t),n.targetId,!1,n.resumeToken),ZC(A.remoteStore,n)}for(const e of n)A.cu.has(e)&&await FI(A.localStore,e,!1).then((()=>{SC(A.remoteStore,e),Fu(A,e)})).catch(_r)}}function Pu(e){const t=ar(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=vu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Uu.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ru.bind(null,t),t.au.j_=su.bind(null,t.eventManager),t.au.Vu=au.bind(null,t.eventManager),t}function _u(e){const t=ar(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Vu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Nu.bind(null,t),t}class ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cC(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,t){return null}bu(e,t){return null}wu(e){return GI(this.persistence,new ZI,e.initialUser,this.serializer)}yu(e){return new aI(lI.fi,this.serializer)}pu(e){return new jI}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ju.provider={build:()=>new ju};class qu extends ju{constructor(e){super(),this.cacheSizeBytes=e}Su(e,t){sr(this.persistence.referenceDelegate instanceof cI,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xc(n,e.asyncQueue,t)}yu(e){const t=void 0!==this.cacheSizeBytes?bc.withCacheSize(this.cacheSizeBytes):bc.DEFAULT;return new aI((e=>cI.fi(e,t)),this.serializer)}}class $u extends ju{constructor(e,t,n){super(),this.Du=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await _u(this.Du.syncEngine),await JC(this.Du.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}wu(e){return GI(this.persistence,new ZI,e.initialUser,this.serializer)}Su(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new xc(n,e.asyncQueue,t)}bu(e,t){const n=new ci(t,this.persistence);return new li(e.asyncQueue,n)}yu(e){const t=BI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?bc.withCacheSize(this.cacheSizeBytes):bc.DEFAULT;return new pI(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,gC(),lC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new jI}}class ed extends $u{constructor(e,t){super(e,t,!1),this.Du=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Du.syncEngine;this.sharedClientState instanceof _I&&(this.sharedClientState.syncEngine={Co:Ku.bind(null,t),Fo:zu.bind(null,t),Mo:Ou.bind(null,t),Is:Du.bind(null,t),vo:Tu.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async e=>{await async function(e,t){const n=ar(e);if(Pu(n),_u(n),!0===t&&!0!==n.Au){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Mu(n,e.toArray());n.Au=!0,await OC(n.remoteStore,!0);for(const A of t)ZC(n.remoteStore,A)}else if(!1===t&&!1!==n.Au){const e=[];let t=Promise.resolve();n.cu.forEach(((A,r)=>{n.sharedClientState.isLocalQueryTarget(r)?e.push(r):t=t.then((()=>(Fu(n,r),FI(n.localStore,r,!0)))),SC(n.remoteStore,r)})),await t,await Mu(n,e),function(e){const t=ar(e);t.Pu.forEach(((e,n)=>{SC(t.remoteStore,n)})),t.Tu.Jr(),t.Pu=new Map,t.hu=new Fo(xr.comparator)}(n),n.Au=!1,await OC(n.remoteStore,!1)}}(this.Du.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}pu(e){const t=gC();if(!_I.C(t))throw new lr(gr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=BI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new _I(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class td{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Gu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Yu.bind(null,this.syncEngine),await OC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Au}createDatastore(e){const t=cC(e.databaseInfo.databaseId),n=(A=e.databaseInfo,new aC(A));var A;return function(e,t,n,A){return new pC(e,t,n,A)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,A,r){return new BC(e,t,n,A,r)}(this.localStore,this.datastore,e.asyncQueue,(e=>Gu(this.syncEngine,e,0)),eC.C()?new eC:new qI)}createSyncEngine(e,t){return function(e,t,n,A,r,i,o){const s=new fu(e,t,n,A,r,i);return o&&(s.Au=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=ar(e);tr(bC,"RemoteStore shutting down."),t.Ta.add(5),await wC(t),t.Ea.shutdown(),t.da.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}td.provider={build:()=>new td};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class nd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):nr("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="FirestoreClient";class rd{constructor(e,t,n,A,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=A,this.user=jA.UNAUTHENTICATED,this.clientId=Br.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async e=>{tr(Ad,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(tr(Ad,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(sy){const n=qC(sy,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function id(e,t){e.asyncQueue.verifyOperationInProgress(),tr(Ad,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let A=n.initialUser;e.setCredentialChangeListener((async e=>{A.isEqual(e)||(await RI(t.localStore,e),A=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function od(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){tr(Ad,"Using user provided OfflineComponentProvider");try{await id(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!("FirebaseError"===(n=r).name?n.code===gr.FAILED_PRECONDITION||n.code===gr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw r;Ar("Error using user provided cache. Falling back to memory cache: "+r),await id(e,new ju)}}else tr(Ad,"Using default OfflineComponentProvider"),await id(e,new qu(void 0));var n;return e._offlineComponents}(e);tr(Ad,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>zC(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>zC(t.remoteStore,n))),e._onlineComponents=t}async function sd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(tr(Ad,"Using user provided OnlineComponentProvider"),await od(e,e._uninitializedComponentsProvider._online)):(tr(Ad,"Using default OnlineComponentProvider"),await od(e,new td))),e._onlineComponents}async function ad(e){const t=await sd(e),n=t.eventManager;return n.onListen=bu.bind(null,t.syncEngine),n.onUnlisten=Zu.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Bu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Su.bind(null,t.syncEngine),n}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function gd(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const ld=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(e,t,n){if(!n)throw new lr(gr.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Id(e){if(!xr.isDocumentKey(e))throw new lr(gr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Cd(e){if(xr.isDocumentKey(e))throw new lr(gr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function ud(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":ir(12329,{type:typeof e})}function dd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new lr(gr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ud(e);throw new lr(gr.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const hd=!0;class md{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new lr(gr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=hd}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:hd;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=fc;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ec)throw new lr(gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,A){if(!0===t&&!0===A)throw new lr(gr.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gd(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new lr(gr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new lr(gr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new lr(gr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class pd{constructor(e,t,n,A){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=A,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new md({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new lr(gr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new lr(gr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new md(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Cr;switch(e.type){case"firstParty":return new hr(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new lr(gr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=ld.get(e);t&&(tr("ComponentProvider","Removing Datastore"),ld.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new fd(this.firestore,e,this._query)}}class bd{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bd(this.firestore,e,this._key)}}class Bd extends fd{constructor(e,t,n){super(e,t,ua(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bd(this.firestore,null,new xr(e))}withConverter(e){return new Bd(this.firestore,e,this._path)}}function yd(e,t,...n){if(e=gn(e),cd("collection","path",t),e instanceof pd){const A=Er.fromString(t,...n);return Cd(A),new Bd(e,null,A)}{if(!(e instanceof bd||e instanceof Bd))throw new lr(gr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const A=e._path.child(Er.fromString(t,...n));return Cd(A),new Bd(e.firestore,null,A)}}function wd(e,t,...n){if(e=gn(e),1===arguments.length&&(t=Br.newId()),cd("doc","path",t),e instanceof pd){const A=Er.fromString(t,...n);return Id(A),new bd(e,null,new xr(A))}{if(!(e instanceof bd||e instanceof Bd))throw new lr(gr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const A=e._path.child(Er.fromString(t,...n));return Id(A),new bd(e.firestore,e instanceof Bd?e.converter:null,new xr(A))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="AsyncQueue";class Sd{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new IC(this,"async_queue_retry"),this.ec=()=>{const e=lC();e&&tr(Zd,"Visibility state changed to "+e.visibilityState),this.C_.p_()},this.tc=e;const t=lC();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const t=lC();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise((()=>{}));const t=new cr;return this.rc((()=>this.ju&&this.Zu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.zu.push(e),this.sc())))}async sc(){if(0!==this.zu.length){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(Zf){if(!ri(Zf))throw Zf;tr(Zd,"Operation failed with retryable error: "+Zf)}this.zu.length>0&&this.C_.f_((()=>this.sc()))}}rc(e){const t=this.tc.then((()=>(this.Yu=!0,e().catch((e=>{throw this.Ju=e,this.Yu=!1,nr("INTERNAL UNHANDLED ERROR: ",vd(e)),e})).then((e=>(this.Yu=!1,e))))));return this.tc=t,t}enqueueAfterDelay(e,t,n){this.nc(),this.Xu.indexOf(e)>-1&&(t=0);const A=jC.createAndSchedule(this,e,t,n,(e=>this.oc(e)));return this.Hu.push(A),A}nc(){this.Ju&&ir(47125,{_c:vd(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do{e=this.tc,await e}while(e!==this.tc)}uc(e){for(const t of this.Hu)if(t.timerId===e)return!0;return!1}cc(e){return this.ac().then((()=>{this.Hu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Hu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ac()}))}lc(e){this.Xu.push(e)}oc(e){const t=this.Hu.indexOf(e);this.Hu.splice(t,1)}}function vd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class Gd extends pd{constructor(e,t,n,A){super(e,t,n,A),this.type="firestore",this._queue=new Sd,this._persistenceKey=(null==A?void 0:A.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Sd(e),this._firestoreClient=void 0,await e}}}function Rd(e){if(e._terminated)throw new lr(gr.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Vd(e),e._firestoreClient}function Vd(e){var t,n,A;const r=e._freezeSettings(),i=(o=e._databaseId,s=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",a=e._persistenceKey,new $o(o,s,a,(g=r).host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,gd(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator));var o,s,a,g;e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(A=r.localCache)||void 0===A?void 0:A._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new rd(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Nd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nd(Lo.fromBase64String(e))}catch(t){throw new lr(gr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nd(Lo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new lr(gr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new lr(gr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new lr(gr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return yr(this._lat,e._lat)||yr(this._long,e._long)}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=/^__.*__$/;class Hd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Cg(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ig(e,this.data,t,this.fieldTransforms)}}class xd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Cg(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Jd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ir(40011,{hc:e})}}class Yd{constructor(e,t,n,A,r,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=A,void 0===r&&this.Pc(),this.fieldTransforms=r||[],this.fieldMask=i||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new Yd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),A=this.Tc({path:n,Ec:!1});return A.dc(e),A}Ac(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),A=this.Tc({path:n,Ec:!1});return A.Pc(),A}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return eh(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(0===e.length)throw this.Vc("Document fields must not be empty");if(Jd(this.hc)&&Xd.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class Ud{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||cC(e)}gc(e,t,n,A=!1){return new Yd({hc:e,methodName:t,fc:n,path:Hr.emptyPath(),Ec:!1,mc:A},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ld(e){const t=e._freezeSettings(),n=cC(e._databaseId);return new Ud(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Td(e,t,n,A,r,i={}){const o=e.gc(i.merge||i.mergeFields?2:0,t,n,r);_d("Data must be an object, but it was:",o,A);const s=Od(A,o);let a,g;if(i.merge)a=new Yo(o.fieldMask),g=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const A of i.mergeFields){const r=jd(t,A,n);if(!o.contains(r))throw new lr(gr.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);th(e,r)||e.push(r)}a=new Yo(e),g=o.fieldTransforms.filter((e=>a.covers(e.field)))}else a=null,g=o.fieldTransforms;return new Hd(new ks(s),a,g)}class Kd extends Wd{_toFieldTransform(e){if(2!==e.hc)throw 1===e.hc?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kd}}class Md extends Wd{_toFieldTransform(e){return new ng(e.path,new Oa)}isEqual(e){return e instanceof Md}}function Qd(e,t,n,A){const r=e.gc(1,t,n);_d("Data must be an object, but it was:",r,A);const i=[],o=ks.empty();ko(A,((e,A)=>{const s=$d(t,e,n);A=gn(A);const a=r.Ac(s);if(A instanceof Kd)i.push(s);else{const e=zd(A,a);null!=e&&(i.push(s),o.set(s,e))}}));const s=new Yo(i);return new xd(o,s,r.fieldTransforms)}function Dd(e,t,n,A,r,i){const o=e.gc(1,t,n),s=[jd(t,A,n)],a=[r];if(i.length%2!=0)throw new lr(gr.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<i.length;I+=2)s.push(jd(t,i[I])),a.push(i[I+1]);const g=[],l=ks.empty();for(let I=s.length-1;I>=0;--I)if(!th(g,s[I])){const e=s[I];let t=a[I];t=gn(t);const n=o.Ac(e);if(t instanceof Kd)g.push(e);else{const A=zd(t,n);null!=A&&(g.push(e),l.set(e,A))}}const c=new Yo(g);return new xd(l,c,o.fieldTransforms)}function zd(e,t){if(Pd(e=gn(e)))return _d("Unsupported field value:",t,e),Od(e,t);if(e instanceof Wd)return function(e,t){if(!Jd(t.hc))throw t.Vc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Vc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Ec&&4!==t.hc)throw t.Vc("Nested arrays are not supported");return function(e,t){const n=[];let A=0;for(const r of e){let e=zd(r,t.Rc(A));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),A++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=gn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return hi(t)?Ka(t):Ta(e,t)}(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Nr.fromDate(e);return{timestampValue:Qg(t.serializer,n)}}if(e instanceof Nr){const n=new Nr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Qg(t.serializer,n)}}if(e instanceof Fd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Nd)return{bytesValue:Dg(t.serializer,e._byteString)};if(e instanceof bd){const n=t.databaseId,A=e.firestore._databaseId;if(!A.isEqual(n))throw t.Vc(`Document reference is for database ${A.projectId}/${A.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Pg(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ed)return n=e,A=t,{mapValue:{fields:{[ns]:{stringValue:is},[os]:{arrayValue:{values:n.toArray().map((e=>{if("number"!=typeof e)throw A.Vc("VectorValues must only contain numeric values.");return Ta(A.serializer,e)}))}}}}};var n,A;throw t.Vc(`Unsupported field value: ${ud(e)}`)}(e,t)}function Od(e,t){const n={};return Wo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ko(e,((e,A)=>{const r=zd(A,t.Ic(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function Pd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Nr||e instanceof Fd||e instanceof Nd||e instanceof bd||e instanceof Wd||e instanceof Ed)}function _d(e,t,n){if(!Pd(n)||("object"!=typeof(A=n)||null===A||Object.getPrototypeOf(A)!==Object.prototype&&null!==Object.getPrototypeOf(A))){const A=ud(n);throw"an object"===A?t.Vc(e+" a custom object"):t.Vc(e+" "+A)}var A}function jd(e,t,n){if((t=gn(t))instanceof kd)return t._internalPath;if("string"==typeof t)return $d(e,t);throw eh("Field path arguments must be of type string or ",e,!1,void 0,n)}const qd=new RegExp("[~\\*/\\[\\]]");function $d(e,t,n){if(t.search(qd)>=0)throw eh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new kd(...t.split("."))._internalPath}catch(A){throw eh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function eh(e,t,n,A,r){const i=A&&!A.isEmpty(),o=void 0!==r;let s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=". ";let a="";return(i||o)&&(a+=" (found",i&&(a+=` in field ${A}`),o&&(a+=` in document ${r}`),a+=")"),new lr(gr.INVALID_ARGUMENT,s+e+a)}function th(e,t){return e.some((e=>e.isEqual(t)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,t,n,A,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=A,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new bd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ah(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ah extends nh{data(){return super.data()}}function rh(e,t){return"string"==typeof t?$d(e,t):t instanceof kd?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{}class oh extends ih{}function sh(e,t,...n){let A=[];t instanceof ih&&A.push(t),A=A.concat(n),function(e){const t=e.filter((e=>e instanceof gh)).length,n=e.filter((e=>e instanceof ah)).length;if(t>1||t>0&&n>0)throw new lr(gr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(A);for(const r of A)e=r._apply(e);return e}class ah extends oh{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ah(e,t,n)}_apply(e){const t=this._parse(e);return hh(e._query,t),new fd(e.firestore,e.converter,fa(e._query,t))}_parse(e){const t=Ld(e.firestore),n=function(e,t,n,A,r,i,o){let s;if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new lr(gr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){dh(o,i);const t=[];for(const n of o)t.push(uh(A,e,n));s={arrayValue:{values:t}}}else s=uh(A,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||dh(o,i),s=function(e,t,n,A=!1){return zd(n,e.gc(A?4:3,t))}(n,t,o,"in"===i||"not-in"===i);return Us.create(r,i,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class gh extends ih{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gh(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Ls.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const A=t.getFlattenedFilters();for(const r of A)hh(n,r),n=fa(n,r)}(e._query,t),new fd(e.firestore,e.converter,fa(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class lh extends oh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lh(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new lr(gr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new lr(gr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xs(t,n)}(e._query,this._field,this._direction);return new fd(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ia(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function ch(e,t="asc"){const n=t,A=rh("orderBy",e);return lh._create(A,n)}class Ih extends oh{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Ih(e,t,n)}_apply(e){return new fd(e.firestore,e.converter,ba(e._query,this._limit,this._limitType))}}function Ch(e){return function(e,t){if(t<=0)throw new lr(gr.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),Ih._create("limit",e,"F")}function uh(e,t,n){if("string"==typeof(n=gn(n))){if(""===n)throw new lr(gr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ha(t)&&-1!==n.indexOf("/"))throw new lr(gr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const A=t.path.child(Er.fromString(n));if(!xr.isDocumentKey(A))throw new lr(gr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${A}' is not because it has an odd number of segments (${A.length}).`);return ms(e,new xr(A))}if(n instanceof bd)return ms(e,n._key);throw new lr(gr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ud(n)}.`)}function dh(e,t){if(!Array.isArray(e)||0===e.length)throw new lr(gr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function hh(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new lr(gr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new lr(gr.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class mh{convertValue(e,t="none"){switch(as(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ir(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ko(e,((e,A)=>{n[e]=this.convertValue(A,t)})),n}convertVectorValue(e){var t,n,A;const r=null===(A=null===(n=null===(t=e.fields)||void 0===t?void 0:t[os].arrayValue)||void 0===n?void 0:n.values)||void 0===A?void 0:A.map((e=>Mo(e.doubleValue)));return new Ed(r)}convertGeoPoint(e){return new Fd(Mo(e.latitude),Mo(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=jo(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(qo(e));default:return null}}convertTimestamp(e){const t=Ko(e);return new Nr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Er.fromString(e);sr(pl(n),9688,{name:e});const A=new ts(n.get(1),n.get(3)),r=new xr(n.popFirst(5));return A.isEqual(t)||nr(`Document ${r} contains a document reference within a different database (${A.projectId}/${A.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ph(e,t,n){let A;return A=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,A
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class fh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bh extends nh{constructor(e,t,n,A,r,i){super(e,t,n,A,i),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Bh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(rh("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Bh extends bh{data(e={}){return super.data(e)}}class yh{constructor(e,t,n,A){this._firestore=e,this._userDataWriter=t,this._snapshot=A,this.metadata=new fh(A.hasPendingWrites,A.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Bh(this._firestore,this._userDataWriter,n.key,n,new fh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new lr(gr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const A=new Bh(e._firestore,e._userDataWriter,n.doc.key,n.doc,new fh(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:A,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const A=new Bh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,i=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:wh(t.type),doc:A,oldIndex:r,newIndex:i}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function wh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ir(61501,{type:e})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(e){e=dd(e,bd);const t=dd(e.firestore,Gd);return function(e,t,n={}){const A=new cr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,A,r){const i=new nd({next:s=>{i.Cu(),t.enqueueAndForget((()=>ou(e,o)));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new lr(gr.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&A&&"server"===A.source?r.reject(new lr(gr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:e=>r.reject(e)}),o=new Iu(ua(n.path),i,{includeMetadataChanges:!0,La:!0});return iu(e,o)}(await ad(e),e.asyncQueue,t,n,A))),A.promise}(Rd(t),e._key).then((n=>function(e,t,n){const A=n.docs.get(t._key),r=new Sh(e);return new bh(e,r,t._key,A,new fh(n.hasPendingWrites,n.fromCache),t.converter)}(t,e,n)))}class Sh extends mh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bd(this.firestore,null,t)}}function vh(e){e=dd(e,fd);const t=dd(e.firestore,Gd),n=Rd(t),A=new Sh(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new lr(gr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),function(e,t,n={}){const A=new cr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,A,r){const i=new nd({next:n=>{i.Cu(),t.enqueueAndForget((()=>ou(e,o))),n.fromCache&&"server"===A.source?r.reject(new lr(gr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),o=new Iu(n,i,{includeMetadataChanges:!0,La:!0});return iu(e,o)}(await ad(e),e.asyncQueue,t,n,A))),A.promise}(n,e._query).then((n=>new yh(t,A,e,n)))}function Gh(e,t,n,...A){e=dd(e,bd);const r=dd(e.firestore,Gd),i=Ld(r);let o;return o="string"==typeof(t=gn(t))||t instanceof kd?Dd(i,"updateDoc",e._key,t,n,A):Qd(i,"updateDoc",e._key,t),Rh(r,[o.toMutation(e._key,rg.exists(!0))])}function Rh(e,t){return function(e,t){const n=new cr;return e.asyncQueue.enqueueAndForget((async()=>async function(t,n,A){const r=_u(t);try{const e=await function(e,t){const n=ar(e),A=Nr.now(),r=t.reduce(((e,t)=>e.add(t.key)),Ya());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let s=Na(),a=Ya();return n.Bs.getEntries(e,r).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(a=a.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((r=>{i=r;const o=[];for(const e of t){const t=lg(e,i.get(e.key).overlayedDocument);null!=t&&o.push(new Cg(e.key,t,Ws(t.value.mapValue),rg.exists(!0)))}return n.mutationQueue.addMutationBatch(e,A,o,t)})).next((t=>{o=t;const A=t.applyToLocalDocumentSet(i,a);return n.documentOverlayCache.saveOverlays(e,t.batchId,A)}))})).then((()=>({batchId:o.batchId,changes:Fa(i)})))}(r.localStore,n);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let A=e.Iu[e.currentUser.toKey()];A||(A=new Fo(yr)),A=A.insert(t,n),e.Iu[e.currentUser.toKey()]=A}(r,e.batchId,A),await Ju(r,e.changes),await JC(r.remoteStore)}catch(e){const n=qC(e,"Failed to persist write");A.reject(n)}}(await function(e){return sd(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(Rd(e),t)}class Vh{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=new Nh(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Nh{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=td.provider,this._offlineComponentProvider={build:t=>new $u(t,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class kh{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=td.provider,this._offlineComponentProvider={build:t=>new ed(t,null==e?void 0:e.cacheSizeBytes)}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Wh{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ld(e)}set(e,t,n){this._verifyNotCommitted();const A=Fh(e,this._firestore),r=ph(A.converter,t,n),i=Td(this._dataReader,"WriteBatch.set",A._key,r,null!==A.converter,n);return this._mutations.push(i.toMutation(A._key,rg.none())),this}update(e,t,n,...A){this._verifyNotCommitted();const r=Fh(e,this._firestore);let i;return i="string"==typeof(t=gn(t))||t instanceof kd?Dd(this._dataReader,"WriteBatch.update",r._key,t,n,A):Qd(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,rg.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Fh(e,this._firestore);return this._mutations=this._mutations.concat(new mg(t._key,rg.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new lr(gr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Fh(e,t){if((e=gn(e)).firestore!==t)throw new lr(gr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Eh(){return new Md("serverTimestamp")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(e){return Rd(e=dd(e,Gd)),new Wh(e,(t=>Rh(e,t)))}function Hh(e,t){var n={};for(var A in e)Object.prototype.hasOwnProperty.call(e,A)&&t.indexOf(A)<0&&(n[A]=e[A]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(A=Object.getOwnPropertySymbols(e);r<A.length;r++)t.indexOf(A[r])<0&&Object.prototype.propertyIsEnumerable.call(e,A[r])&&(n[A[r]]=e[A[r]])}return n}function xh(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}!function(e,t=!0){qA=ZA,fA(new ln("firestore",((e,{instanceIdentifier:n,options:A})=>{const r=e.getProvider("app").getImmediate(),i=new Gd(new ur(e.getProvider("auth-internal")),new pr(r,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new lr(gr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ts(e.options.projectId,t)}(r,n),r);return A=Object.assign({useFetchStreams:t},A),i._setSettings(A),i}),"PUBLIC").setMultipleInstances(!0)),vA(PA,_A,e),vA(PA,_A,"esm2017")}(),"function"==typeof SuppressedError&&SuppressedError;const Jh=xh,Yh=new tn("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Uh=new bn("@firebase/auth");function Lh(e,...t){Uh.logLevel<=un.ERROR&&Uh.error(`Auth (${ZA}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(e,...t){throw Dh(e,...t)}function Kh(e,...t){return Dh(e,...t)}function Mh(e,t,n){const A=Object.assign(Object.assign({},Jh()),{[t]:n});return new tn("auth","Firebase",A).create(t,{appName:e.name})}function Qh(e){return Mh(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dh(e,...t){if("string"!=typeof e){const n=t[0],A=[...t.slice(1)];return A[0]&&(A[0].appName=e.name),e._errorFactory.create(n,...A)}return Yh.create(e,...t)}function zh(e,t,...n){if(!e)throw Dh(t,...n)}function Oh(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Lh(t),new Error(t)}function Ph(e,t){e||Oh(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _h(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function jh(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==jh()&&"https:"!==jh()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class $h{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ph(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return qh()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(e,t){Ph(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Oh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Oh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Oh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Am=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rm=new $h(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function om(e,t,n,A,r={}){return sm(e,r,(async()=>{let r={},i={};A&&("GET"===t?i=A:r={body:JSON.stringify(A)});const o=on(Object.assign({key:e.config.apiKey},i)).slice(1),s=await e._getAdditionalHeaders();s["Content-Type"]="application/json",e.languageCode&&(s["X-Firebase-Locale"]=e.languageCode);const a=Object.assign({method:t,headers:s},r);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(a.referrerPolicy="no-referrer"),e.emulatorConfig&&Mt(e.emulatorConfig.host)&&(a.credentials="include"),tm.fetch()(await am(e,e.config.apiHost,n,o),a)}))}async function sm(e,t,n){e._canInitEmulator=!1;const A=Object.assign(Object.assign({},nm),t);try{const t=new gm(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await r.json();if("needConfirmation"in i)throw lm(e,"account-exists-with-different-credential",i);if(r.ok&&!("errorMessage"in i))return i;{const t=r.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw lm(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw lm(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw lm(e,"user-disabled",i);const s=A[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Mh(e,s,o);Th(e,s)}}catch(Zf){if(Zf instanceof en)throw Zf;Th(e,"network-request-failed",{message:String(Zf)})}}async function am(e,t,n,A){const r=`${t}${n}?${A}`,i=e,o=i.config.emulator?em(e.config,r):`${e.config.apiScheme}://${r}`;if(Am.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(o).toString()}return o}class gm{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Kh(this.auth,"network-request-failed"))),rm.get())}))}}function lm(e,t,n){const A={appName:e.name};n.email&&(A.email=n.email),n.phoneNumber&&(A.phoneNumber=n.phoneNumber);const r=Kh(e,t,A);return r.customData._tokenResponse=n,r}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cm(e,t){return om(e,"POST","/v1/accounts:lookup",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Zf){}}function Cm(e){return 1e3*Number(e)}function um(e){const[t,n,A]=e.split(".");if(void 0===t||void 0===n||void 0===A)return Lh("JWT malformed, contained fewer than 3 sections"),null;try{const e=Jt(n);return e?JSON.parse(e):(Lh("Failed to decode base64 JWT payload"),null)}catch(Zf){return Lh("Caught error parsing JWT payload as JSON",null==Zf?void 0:Zf.toString()),null}}function dm(e){const t=um(e);return zh(t,"internal-error"),zh(void 0!==t.exp,"internal-error"),zh(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hm(e,t,n=!1){if(n)return t;try{return await t}catch(Zf){throw Zf instanceof en&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Zf)&&e.auth.currentUser===e&&await e.auth.signOut(),Zf}}class mm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Zf){return void("auth/network-request-failed"===(null==Zf?void 0:Zf.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Im(this.lastLoginAt),this.creationTime=Im(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fm(e){var t;const n=e.auth,A=await e.getIdToken(),r=await hm(e,cm(n,{idToken:A}));zh(null==r?void 0:r.users.length,n,"internal-error");const i=r.users[0];e._notifyReloadListener(i);const o=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?bm(i.providerUserInfo):[],s=(a=e.providerData,g=o,[...a.filter((e=>!g.some((t=>t.providerId===e.providerId)))),...g]);var a,g;const l=e.isAnonymous,c=!(e.email&&i.passwordHash||(null==s?void 0:s.length)),I=!!l&&c,C={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new pm(i.createdAt,i.lastLoginAt),isAnonymous:I};Object.assign(e,C)}function bm(e){return e.map((e=>{var{providerId:t}=e,n=Hh(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Bm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zh(e.idToken,"internal-error"),zh(void 0!==e.idToken,"internal-error"),zh(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):dm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){zh(0!==e.length,"internal-error");const t=dm(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(zh(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:A,expiresIn:r}=await async function(e,t){const n=await sm(e,{},(async()=>{const n=on({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:A,apiKey:r}=e.config,i=await am(e,A,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",tm.fetch()(i,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,A,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:A,expirationTime:r}=t,i=new Bm;return n&&(zh("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),A&&(zh("string"==typeof A,"internal-error",{appName:e}),i.accessToken=A),r&&(zh("number"==typeof r,"internal-error",{appName:e}),i.expirationTime=r),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bm,this.toJSON())}_performRefresh(){return Oh("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ym(e,t){zh("string"==typeof e||void 0===e,"internal-error",{appName:t})}class wm{constructor(e){var{uid:t,auth:n,stsTokenManager:A}=e,r=Hh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=A,this.accessToken=A.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new pm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await hm(this,this.stsTokenManager.getToken(this.auth,e));return zh(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=gn(e),A=await n.getIdToken(t),r=um(A);zh(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i="object"==typeof r.firebase?r.firebase:void 0,o=null==i?void 0:i.sign_in_provider;return{claims:r,token:A,authTime:Im(Cm(r.auth_time)),issuedAtTime:Im(Cm(r.iat)),expirationTime:Im(Cm(r.exp)),signInProvider:o||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=gn(e);await fm(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(zh(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wm(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){zh(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await fm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(BA(this.auth.app))return Promise.reject(Qh(this.auth));const e=await this.getIdToken();return await hm(this,async function(e,t){return om(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,A,r,i,o,s,a,g;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,c=null!==(A=t.email)&&void 0!==A?A:void 0,I=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,C=null!==(i=t.photoURL)&&void 0!==i?i:void 0,u=null!==(o=t.tenantId)&&void 0!==o?o:void 0,d=null!==(s=t._redirectEventId)&&void 0!==s?s:void 0,h=null!==(a=t.createdAt)&&void 0!==a?a:void 0,m=null!==(g=t.lastLoginAt)&&void 0!==g?g:void 0,{uid:p,emailVerified:f,isAnonymous:b,providerData:B,stsTokenManager:y}=t;zh(p&&y,e,"internal-error");const w=Bm.fromJSON(this.name,y);zh("string"==typeof p,e,"internal-error"),ym(l,e.name),ym(c,e.name),zh("boolean"==typeof f,e,"internal-error"),zh("boolean"==typeof b,e,"internal-error"),ym(I,e.name),ym(C,e.name),ym(u,e.name),ym(d,e.name),ym(h,e.name),ym(m,e.name);const Z=new wm({uid:p,auth:e,email:c,emailVerified:f,displayName:l,isAnonymous:b,photoURL:C,phoneNumber:I,tenantId:u,stsTokenManager:w,createdAt:h,lastLoginAt:m});return B&&Array.isArray(B)&&(Z.providerData=B.map((e=>Object.assign({},e)))),d&&(Z._redirectEventId=d),Z}static async _fromIdTokenResponse(e,t,n=!1){const A=new Bm;A.updateFromServerResponse(t);const r=new wm({uid:t.localId,auth:e,stsTokenManager:A,isAnonymous:n});return await fm(r),r}static async _fromGetAccountInfoResponse(e,t,n){const A=t.users[0];zh(void 0!==A.localId,"internal-error");const r=void 0!==A.providerUserInfo?bm(A.providerUserInfo):[],i=!(A.email&&A.passwordHash||(null==r?void 0:r.length)),o=new Bm;o.updateFromIdToken(n);const s=new wm({uid:A.localId,auth:e,stsTokenManager:o,isAnonymous:i}),a={uid:A.localId,displayName:A.displayName||null,photoURL:A.photoUrl||null,email:A.email||null,emailVerified:A.emailVerified||!1,phoneNumber:A.phoneNumber||null,tenantId:A.tenantId||null,providerData:r,metadata:new pm(A.createdAt,A.lastLoginAt),isAnonymous:!(A.email&&A.passwordHash||(null==r?void 0:r.length))};return Object.assign(s,a),s}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm=new Map;function Sm(e){Ph(e instanceof Function,"Expected a class definition");let t=Zm.get(e);return t?(Ph(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Zm.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vm.type="NONE";const Gm=vm;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(e,t,n){return`firebase:${e}:${t}:${n}`}class Vm{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:A,name:r}=this.auth;this.fullUserKey=Rm(this.userKey,A.apiKey,r),this.fullPersistenceKey=Rm("persistence",A.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await cm(this.auth,{idToken:e}).catch((()=>{}));return t?wm._fromGetAccountInfoResponse(this.auth,t,e):null}return wm._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Vm(Sm(Gm),e,n);const A=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=A[0]||Sm(Gm);const i=Rm(n,e.config.apiKey,e.name);let o=null;for(const g of t)try{const t=await g._get(i);if(t){let n;if("string"==typeof t){const A=await cm(e,{idToken:t}).catch((()=>{}));if(!A)break;n=await wm._fromGetAccountInfoResponse(e,A,t)}else n=wm._fromJSON(e,t);g!==r&&(o=n),r=g;break}}catch(a){}const s=A.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&s.length?(r=s[0],o&&await r._set(i,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(i)}catch(a){}}))),new Vm(r,e,n)):new Vm(r,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Em(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(km(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Hm(t))return"Blackberry";if(xm(t))return"Webos";if(Wm(t))return"Safari";if((t.includes("chrome/")||Fm(t))&&!t.includes("edge/"))return"Chrome";if(Xm(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function km(e=Pt()){return/firefox\//i.test(e)}function Wm(e=Pt()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Fm(e=Pt()){return/crios\//i.test(e)}function Em(e=Pt()){return/iemobile/i.test(e)}function Xm(e=Pt()){return/android/i.test(e)}function Hm(e=Pt()){return/blackberry/i.test(e)}function xm(e=Pt()){return/webos/i.test(e)}function Jm(e=Pt()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ym(){return function(){const e=Pt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Um(e=Pt()){return Jm(e)||Xm(e)||xm(e)||Hm(e)||/windows phone/i.test(e)||Em(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(e,t=[]){let n;switch(e){case"Browser":n=Nm(Pt());break;case"Worker":n=`${Nm(Pt())}-${e}`;break;default:n=e}const A=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${ZA}/${A}`}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,A)=>{try{n(e(t))}catch(Zf){A(Zf)}}));n.onAbort=t,this.queue.push(n);const A=this.queue.length-1;return()=>{this.queue[A]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(Zf){t.reverse();for(const A of t)try{A()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==Zf?void 0:Zf.message})}}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e){var t,n,A,r;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(A=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==A?A:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,A,r,i,o;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(A=s.containsLowercaseLetter)||void 0===A||A),s.isValid&&(s.isValid=null===(r=s.containsUppercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(i=s.containsNumericCharacter)||void 0===i||i),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,A=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),A&&(t.meetsMaxPasswordLength=e.length<=A)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let A=0;A<e.length;A++)n=e.charAt(A),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,A,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=A)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,t,n,A){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=A,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dm(this),this.idTokenSubscription=new Dm(this),this.beforeStateQueue=new Tm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=A.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sm(t)),this._initializationPromise=this.queue((async()=>{var n,A,r;if(!this._deleted&&(this.persistenceManager=await Vm.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(A=this._popupRedirectResolver)||void 0===A?void 0:A._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Zf){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await cm(this,{idToken:e}),n=await wm._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(BA(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let A=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==A?void 0:A._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==i||!(null==o?void 0:o.user)||(A=o.user,r=!0)}if(!A)return this.directlySetCurrentUser(null);if(!A._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(A)}catch(Zf){A=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(Zf)))}return A?this.reloadAndSetCurrentUserOrClear(A):this.directlySetCurrentUser(null)}return zh(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===A._redirectEventId?this.directlySetCurrentUser(A):this.reloadAndSetCurrentUserOrClear(A)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Zf){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fm(e)}catch(Zf){if("auth/network-request-failed"!==(null==Zf?void 0:Zf.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(BA(this.app))return Promise.reject(Qh(this));const t=e?gn(e):null;return t&&zh(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&zh(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return BA(this.app)?Promise.reject(Qh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return BA(this.app)?Promise.reject(Qh(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Sm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return om(e,"GET","/v2/passwordPolicy",im(e,t))}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this),t=new Km(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tn("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return om(e,"POST","/v2/accounts:revokeToken",im(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sm(e)||this._popupRedirectResolver;zh(t,this,"argument-error"),this.redirectPersistenceManager=await Vm.create(this,[Sm(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,A){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(zh(o,this,"internal-error"),o.then((()=>{i||r(this.currentUser)})),"function"==typeof t){const r=e.addObserver(t,n,A);return()=>{i=!0,r()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zh(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Lm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const A=await this._getAppCheckToken();return A&&(t["X-Firebase-AppCheck"]=A),t}async _getAppCheckToken(){var e;if(BA(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Uh.logLevel<=un.WARN&&Uh.warn(`Auth (${ZA}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Qm(e){return gn(e)}class Dm{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new sn(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return zh(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Om(e,t,n){const A=Qm(e);zh(/^https?:\/\//.test(t),A,"invalid-emulator-scheme");const r=Pm(t),{host:i,port:o}=function(e){const t=Pm(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const A=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(A);if(r){const e=r[1];return{host:e,port:_m(A.substr(e.length+1))}}{const[e,t]=A.split(":");return{host:e,port:_m(t)}}}(t),s=null===o?"":`:${o}`,a={url:`${r}//${i}${s}/`},g=Object.freeze({host:i,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!A._canInitEmulator)return zh(A.config.emulator&&A.emulatorConfig,A,"emulator-config-failed"),void zh(An(a,A.config.emulator)&&An(g,A.emulatorConfig),A,"emulator-config-failed");A.config.emulator=a,A.emulatorConfig=g,A.settings.appVerificationDisabledForTesting=!0,Mt(i)?(Qt(`${r}//${i}${s}`),Ot("Auth",!0)):function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info;"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function Pm(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function _m(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class jm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Oh("not implemented")}_getIdTokenResponse(e){return Oh("not implemented")}_linkToIdToken(e,t){return Oh("not implemented")}_getReauthenticationResolver(e){return Oh("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qm(e,t){return async function(e,t,n,A,r={}){const i=await om(e,t,n,A,r);return"mfaPendingCredential"in i&&Th(e,"multi-factor-auth-required",{_serverResponse:i}),i}(e,"POST","/v1/accounts:signInWithIdp",im(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m extends jm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new $m(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Th("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:A}=t,r=Hh(t,["providerId","signInMethod"]);if(!n||!A)return null;const i=new $m(n,A);return i.idToken=r.idToken||void 0,i.accessToken=r.accessToken||void 0,i.secret=r.secret,i.nonce=r.nonce,i.pendingToken=r.pendingToken||null,i}_getIdTokenResponse(e){return qm(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,qm(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,qm(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=on(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp extends ep{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np extends tp{constructor(){super("facebook.com")}static credential(e){return $m._fromParams({providerId:np.PROVIDER_ID,signInMethod:np.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return np.credentialFromTaggedObject(e)}static credentialFromError(e){return np.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return np.credential(e.oauthAccessToken)}catch(t){return null}}}np.FACEBOOK_SIGN_IN_METHOD="facebook.com",np.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ap extends tp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return $m._fromParams({providerId:Ap.PROVIDER_ID,signInMethod:Ap.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ap.credentialFromTaggedObject(e)}static credentialFromError(e){return Ap.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ap.credential(t,n)}catch(A){return null}}}Ap.GOOGLE_SIGN_IN_METHOD="google.com",Ap.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class rp extends tp{constructor(){super("github.com")}static credential(e){return $m._fromParams({providerId:rp.PROVIDER_ID,signInMethod:rp.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rp.credentialFromTaggedObject(e)}static credentialFromError(e){return rp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return rp.credential(e.oauthAccessToken)}catch(t){return null}}}rp.GITHUB_SIGN_IN_METHOD="github.com",rp.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ip extends tp{constructor(){super("twitter.com")}static credential(e,t){return $m._fromParams({providerId:ip.PROVIDER_ID,signInMethod:ip.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ip.credentialFromTaggedObject(e)}static credentialFromError(e){return ip.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ip.credential(t,n)}catch(A){return null}}}ip.TWITTER_SIGN_IN_METHOD="twitter.com",ip.PROVIDER_ID="twitter.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class op{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,A=!1){const r=await wm._fromIdTokenResponse(e,n,A),i=sp(n);return new op({user:r,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const A=sp(n);return new op({user:e,providerId:A,_tokenResponse:n,operationType:t})}}function sp(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends en{constructor(e,t,n,A){var r;super(t.code,t.message),this.operationType=n,this.user=A,Object.setPrototypeOf(this,ap.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,A){return new ap(e,t,n,A)}}function gp(e,t,n,A){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw ap._fromErrorAndOperation(e,n,t,A);throw n}))}const lp="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lp,"1"),this.storage.removeItem(lp),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip extends cp{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Um(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),A=this.localCache[t];n!==A&&e(t,A,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const A=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Ym()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(A,10):A()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const A of Array.from(n))A(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ip.type="LOCAL";const Cp=Ip;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up extends cp{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}up.type="SESSION";const dp=up;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class hp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new hp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:A,data:r}=t.data,i=this.handlersMap[A];if(!(null==i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:A});const o=Array.from(i).map((async e=>e(t.origin,r))),s=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:A,response:s})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function mp(e="",t=10){let n="";for(let A=0;A<t;A++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hp.receivers=[];class pp{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const A="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!A)throw new Error("connection_unavailable");let r,i;return new Promise(((o,s)=>{const a=mp("",20);A.port1.start();const g=setTimeout((()=>{s(new Error("unsupported_event"))}),n);i={messageChannel:A,onMessage(e){const t=e;if(t.data.eventId===a)switch(t.data.status){case"ack":clearTimeout(g),r=setTimeout((()=>{s(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(g),clearTimeout(r),s(new Error("invalid_response"))}}},this.handlers.add(i),A.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:a,data:t},[A.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function bp(){return void 0!==fp().WorkerGlobalScope&&"function"==typeof fp().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Bp="firebaseLocalStorageDb",yp="firebaseLocalStorage",wp="fbase_key";class Zp{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Sp(e,t){return e.transaction([yp],t?"readwrite":"readonly").objectStore(yp)}function vp(){const e=indexedDB.open(Bp,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(yp,{keyPath:wp})}catch(Zf){n(Zf)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(yp)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Bp);return new Zp(e).toPromise()}(),t(await vp()))}))}))}async function Gp(e,t,n){const A=Sp(e,!0).put({[wp]:t,value:n});return new Zp(A).toPromise()}function Rp(e,t){const n=Sp(e,!0).delete(t);return new Zp(n).toPromise()}class Vp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await vp()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Zf){if(t++>3)throw Zf;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hp._getInstance(bp()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new pp(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vp();return await Gp(e,lp,"1"),await Rp(e,lp),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Gp(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Sp(e,!1).get(t),A=await new Zp(n).toPromise();return void 0===A?null:A.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Rp(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Sp(e,!1).getAll();return new Zp(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:A,value:r}of e)n.add(A),JSON.stringify(this.localCache[A])!==JSON.stringify(r)&&(this.notifyListeners(A,r),t.push(A));for(const A of Object.keys(this.localCache))this.localCache[A]&&!n.has(A)&&(this.notifyListeners(A,null),t.push(A));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const A of Array.from(n))A(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Vp.type="LOCAL";const Np=Vp;new $h(3e4,6e4);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class kp extends jm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Wp(e){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t,n=!1){if(BA(e.app))return Promise.reject(Qh(e));const A="signIn",r=await gp(e,A,t),i=await op._fromIdTokenResponse(e,A,r);return n||await e._updateCurrentUser(i.user),i}(e.auth,new kp(e),e.bypassAuthState)}function Fp(e){const{auth:t,user:n}=e;return zh(n,t,"internal-error"),
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t,n=!1){const{auth:A}=e;if(BA(A.app))return Promise.reject(Qh(A));const r="reauthenticate";try{const i=await hm(e,gp(A,r,t,e),n);zh(i.idToken,A,"internal-error");const o=um(i.idToken);zh(o,A,"internal-error");const{sub:s}=o;return zh(e.uid===s,A,"user-mismatch"),op._forOperation(e,r,i)}catch(Zf){throw"auth/user-not-found"===(null==Zf?void 0:Zf.code)&&Th(A,"user-mismatch"),Zf}}(n,new kp(e),e.bypassAuthState)}async function Ep(e){const{auth:t,user:n}=e;return zh(n,t,"internal-error"),async function(e,t,n=!1){const A=await hm(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return op._forOperation(e,"link",A)}(n,new kp(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,t,n,A,r=!1){this.auth=e,this.resolver=n,this.user=A,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Zf){this.reject(Zf)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:A,tenantId:r,error:i,type:o}=e;if(i)return void this.reject(i);const s={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:A||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(Zf){this.reject(Zf)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wp;case"linkViaPopup":case"linkViaRedirect":return Ep;case"reauthViaPopup":case"reauthViaRedirect":return Fp;default:Th(this.auth,"internal-error")}}resolve(e){Ph(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ph(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp=new $h(2e3,1e4);class xp extends Xp{constructor(e,t,n,A,r){super(e,t,A,r),this.provider=n,this.authWindow=null,this.pollId=null,xp.currentPopupAction&&xp.currentPopupAction.cancel(),xp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zh(e,this.auth,"internal-error"),e}async onExecution(){Ph(1===this.filter.length,"Popup operations only handle one event");const e=mp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Kh(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Kh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xp.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Kh(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Hp.get())};e()}}xp.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Jp="pendingRedirect",Yp=new Map;class Up extends Xp{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Yp.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Rm(Jp,e.config.apiKey,e.name)}(t),A=function(e){return Sm(e._redirectPersistence)}(e);if(!(await A._isAvailable()))return!1;const r="true"===await A._get(n);return await A._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(Zf){e=()=>Promise.reject(Zf)}Yp.set(this.auth._key(),e)}return this.bypassAuthState||Yp.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Lp(e,t){Yp.set(e._key(),t)}async function Tp(e,t,n=!1){if(BA(e.app))return Promise.reject(Qh(e));const A=Qm(e),r=
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){return t?Sm(t):(zh(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(A,t),i=new Up(A,r,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await A._persistUserIfCurrent(o.user),await A._setRedirectUser(null,t)),o}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qp(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Qp(e)){const A=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Kh(this.auth,A))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mp(e))}saveEventToCache(e){this.cachedEventUids.add(Mp(e)),this.lastProcessedEventTime=Date.now()}}function Mp(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Qp({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Dp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zp=/^https?/;async function Op(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return om(e,"GET","/v1/projects",t)}(e);for(const A of t)try{if(Pp(A))return}catch(n){}Th(e,"unauthorized-domain")}function Pp(e){const t=_h(),{protocol:n,hostname:A}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===A?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===A}if(!zp.test(n))return!1;if(Dp.test(e))return A===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(A)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=new $h(3e4,6e4);function jp(){const e=fp().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function qp(e){return new Promise(((t,n)=>{var A,r,i,o;function s(){jp(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{jp(),n(Kh(e,"network-request-failed"))},timeout:_p.get()})}if(null===(r=null===(A=fp().gapi)||void 0===A?void 0:A.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=fp().gapi)||void 0===i?void 0:i.load)){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return fp()[t]=()=>{gapi.load?s():n(Kh(e,"network-request-failed"))},(o=`${zm.gapiScript}?onload=${t}`,zm.loadJS(o)).catch((e=>n(e)))}s()}})).catch((e=>{throw $p=null,e}))}let $p=null;
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ef=new $h(5e3,15e3),tf={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Af(e){const t=e.config;zh(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?em(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,A={apiKey:t.apiKey,appName:e.name,v:ZA},r=nf.get(e.config.apiHost);r&&(A.eid=r);const i=e._getFrameworks();return i.length&&(A.fw=i.join(",")),`${n}?${on(A).slice(1)}`}async function rf(e){const t=await function(e){return $p=$p||qp(e),$p}(e),n=fp().gapi;return zh(n,e,"internal-error"),t.open({where:document.body,url:Af(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tf,dontclear:!0},(t=>new Promise((async(n,A)=>{await t.restyle({setHideOnLeave:!1});const r=Kh(e,"network-request-failed"),i=fp().setTimeout((()=>{A(r)}),ef.get());function o(){fp().clearTimeout(i),n(t)}t.ping(o).then(o,(()=>{A(r)}))}))))}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class sf{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Zf){}}}function af(e,t,n,A=500,r=600){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-A)/2,0).toString();let s="";const a=Object.assign(Object.assign({},of),{width:A.toString(),height:r.toString(),top:i,left:o}),g=Pt().toLowerCase();n&&(s=Fm(g)?"_blank":n),km(g)&&(t=t||"http://localhost",a.scrollbars="yes");const l=Object.entries(a).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=Pt()){var t;return Jm(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(g)&&"_self"!==s)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const A=document.createEvent("MouseEvent");A.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(A)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",s),new sf(null);const c=window.open(t||"",s,l);zh(c,e,"popup-blocked");try{c.focus()}catch(Zf){}return new sf(c)}const gf="__/auth/handler",lf="emulator/auth/handler",cf=encodeURIComponent("fac");async function If(e,t,n,A,r,i){zh(e.config.authDomain,e,"auth-domain-config-required"),zh(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:A,v:ZA,eventId:r};if(t instanceof ep){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))o[e]=t}if(t instanceof tp){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const s=o;for(const l of Object.keys(s))void 0===s[l]&&delete s[l];const a=await e._getAppCheckToken(),g=a?`#${cf}=${encodeURIComponent(a)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${gf}`;return em(e,lf)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${on(s).slice(1)}${g}`}const Cf="webStorageSupport";const uf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dp,this._completeRedirectFn=Tp,this._overrideRedirectResult=Lp}async _openPopup(e,t,n,A){var r;Ph(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return af(e,await If(e,t,n,_h(),A),mp())}async _openRedirect(e,t,n,A){await this._originValidation(e);return function(e){fp().location.href=e}(await If(e,t,n,_h(),A)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ph(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await rf(e),n=new Kp(e);return t.register("authEvent",(t=>{zh(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cf,{type:Cf},(n=>{var A;const r=null===(A=null==n?void 0:n[0])||void 0===A?void 0:A[Cf];void 0!==r&&t(!!r),Th(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Op(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Um()||Wm()||Jm()}};var df="@firebase/auth",hf="1.10.6";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class mf{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){zh(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const pf=Tt("authIdTokenMaxAge")||300;let ff=null;var bf,Bf;bf={loadJS:e=>new Promise(((t,n)=>{const A=document.createElement("script");var r,i;A.setAttribute("src",e),A.onload=t,A.onerror=e=>{const t=Kh("internal-error");t.customData=e,n(t)},A.type="text/javascript",A.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(A)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},zm=bf,Bf="Browser",fA(new ln("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),A=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;zh(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const s={apiKey:i,authDomain:o,clientPlatform:Bf,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lm(Bf)},a=new Mm(n,A,r,s);return function(e,t){const n=(null==t?void 0:t.persistence)||[],A=(Array.isArray(n)?n:[n]).map(Sm);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(A,null==t?void 0:t.popupRedirectResolver)}(a,t),a}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),fA(new ln("auth-internal",(e=>{const t=Qm(e.getProvider("auth").getImmediate());return new mf(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),vA(df,hf,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Bf)),vA(df,hf,"esm2017");const yf=SA({apiKey:"AIzaSyAJyHbhXTGWN8Frfnrkfh1yiAnNQuKb2Lg",authDomain:"mariage-a3309.firebaseapp.com",projectId:"mariage-a3309",storageBucket:"mariage-a3309.appspot.com",messagingSenderId:"851249523629",appId:"1:851249523629:web:0c73d232fbd2f2210a0f24",measurementId:"G-RJMFSEY5MB"}),wf=function(e,t,n){n||(n=es);const A=bA(e,"firestore");if(A.isInitialized(n)){const e=A.getImmediate({identifier:n});if(An(A.getOptions(n),t))return e;throw new lr(gr.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new lr(gr.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<Ec)throw new lr(gr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&Mt(t.host)&&Qt(t.host),A.initialize({options:t,instanceIdentifier:n})}(yf,{localCache:(Zf={tabManager:new kh},new Vh(Zf))});var Zf;try{(function(e){Ar("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();return function(e,t,n){if((e=dd(e,Gd))._firestoreClient||e._terminated)throw new lr(gr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new lr(gr.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Vd(e)}(e,td.provider,{build:e=>new $u(e,t.cacheSizeBytes,void 0)}),Promise.resolve()})(wf).catch((e=>{"failed-precondition"===e.code||e.code}))}catch(PWe){}!function(e=function(e=CA){const t=dA.get(e);if(!t&&e===CA&&Lt())return SA();if(!t)throw yA.create("no-app",{appName:e});return t}()){const t=bA(e,"auth");if(t.isInitialized())return t.getImmediate();const n=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){const n=bA(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(An(n.getOptions(),null!=t?t:{}))return e;Th(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:uf,persistence:[Np,Cp,dp]}),A=Tt("authTokenSyncURL");if(A&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(A,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>pf)return;const A=null==t?void 0:t.token;ff!==A&&(ff=A,await fetch(r,{method:A?"POST":"DELETE",headers:A?{Authorization:`Bearer ${A}`}:{}}))});!function(e,t,n){gn(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,A){gn(e).onIdTokenChanged(t,n,A)}(n,(e=>t(e)))}}var r;const i=(o="auth",null===(a=null===(s=Ut())||void 0===s?void 0:s.emulatorHosts)||void 0===a?void 0:a[o]);var o,s,a;i&&Om(n,`http://${i}`)}(yf);const Sf="guests",vf="scans",Gf={async syncGuestsFromLocal(e){try{const t=500;let n=0,A=Xh(wf),r=[];return Object.entries(e).forEach((([e,i])=>{i.forEach((i=>{const o=this.generateGuestId(e,i.name),s={id:o,name:i.name,group:e,count:i.count,message:i.message,createdAt:Eh(),updatedAt:Eh(),scanned:!1,scanCount:0},a=wd(wf,Sf,o);A.set(a,s),n++,n>=t&&(r.push(A),A=Xh(wf),n=0)}))})),n>0&&r.push(A),Promise.all(r.map((e=>e.commit())))}catch(PWe){throw PWe}},async getAllGuests(e=1e3){try{const t=sh(yd(wf,Sf),Ch(e));return(await vh(t)).docs.map((e=>e.data()))}catch(PWe){return[]}},async getGuestById(e){try{const t=this.sanitizeFirestoreId(e),n=await Zh(wd(wf,Sf,t));return n.exists()?n.data():null}catch(PWe){return null}},async addGuest(e){try{const t=this.generateGuestId(e.group,e.name),n={...e,id:t,createdAt:Eh(),updatedAt:Eh(),scanned:!1,scanCount:0};return await function(e,t,n){e=dd(e,bd);const A=dd(e.firestore,Gd),r=ph(e.converter,t,n);return Rh(A,[Td(Ld(A),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,rg.none())])}(wd(wf,Sf,t),n),n}catch(PWe){throw PWe}},async updateGuest(e,t){try{const n=wd(wf,Sf,e);await Gh(n,{...t,updatedAt:Eh()});return{id:e,...t,updatedAt:new Date}}catch(PWe){throw PWe}},async deleteGuest(e){try{return function(e){return Rh(dd(e.firestore,Gd),[new mg(e._key,rg.none())])}(wd(wf,Sf,e))}catch(PWe){throw PWe}},async recordScan(e,t){try{const n=this.sanitizeFirestoreId(e),A=await function(e,t){const n=dd(e.firestore,Gd),A=wd(e),r=ph(e.converter,t);return Rh(n,[Td(Ld(e.firestore),"addDoc",A._key,r,null!==e.converter,{}).toMutation(A._key,rg.exists(!1))]).then((()=>A))}(yd(wf,vf),{guestId:n,timestamp:Eh(),...t}),r=wd(wf,Sf,n),i=await Zh(r);if(i.exists()){const e=i.data();await Gh(r,{scanned:!0,scanCount:(e.scanCount||0)+1,lastScan:Eh()})}return A.id}catch(PWe){throw PWe}},async getGuestScans(e,t=10){try{const n=this.sanitizeFirestoreId(e),A=sh(yd(wf,vf),function(e,t,n){const A=t,r=rh("where",e);return ah._create(r,A,n)}("guestId","==",n),ch("timestamp","desc"),Ch(t));return(await vh(A)).docs.map((e=>({id:e.id,...e.data()})))}catch(PWe){return[]}},async getAllScans(e=20,t=null){try{let n;n=t?sh(yd(wf,vf),ch("timestamp","desc"),t,Ch(e)):sh(yd(wf,vf),ch("timestamp","desc"),Ch(e));const A=await vh(n),r=A.docs[A.docs.length-1];return{scans:A.docs.map((e=>({id:e.id,...e.data()}))),lastDoc:r,hasMore:A.docs.length===e}}catch(PWe){return{scans:[],lastDoc:null,hasMore:!1}}},generateGuestId:(e,t)=>`${e.replace(/\s+/g,"-").toLowerCase()}_${t.replace(/\s+/g,"-").toLowerCase()}`,sanitizeFirestoreId(e){if(e.includes("/")){const t=e.split("/");for(let e=t.length-1;e>=0;e--)if(t[e].trim())return t[e].trim()}return e.replace(/[#.[\]/]/g,"_")}},Rf={},Vf=function(e,t,n){let A=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));A=Promise.allSettled(t.map((e=>{if((e=function(e){return"/"+e}(e))in Rf)return;Rf[e]=!0;const t=e.endsWith(".css"),A=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${A}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,n&&r.setAttribute("nonce",n),document.head.appendChild(r),t?new Promise(((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return A.then((t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))};function Nf(e){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var kf=Uint8Array,Wf=Uint16Array,Ff=Int32Array,Ef=new kf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Xf=new kf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hf=new kf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xf=function(e,t){for(var n=new Wf(31),A=0;A<31;++A)n[A]=t+=1<<e[A-1];var r=new Ff(n[30]);for(A=1;A<30;++A)for(var i=n[A];i<n[A+1];++i)r[i]=i-n[A]<<5|A;return{b:n,r:r}},Jf=xf(Ef,2),Yf=Jf.b,Uf=Jf.r;Yf[28]=258,Uf[258]=28;for(var Lf=xf(Xf,0),Tf=Lf.b,Kf=Lf.r,Mf=new Wf(32768),Qf=0;Qf<32768;++Qf){var Df=(43690&Qf)>>1|(21845&Qf)<<1;Df=(61680&(Df=(52428&Df)>>2|(13107&Df)<<2))>>4|(3855&Df)<<4,Mf[Qf]=((65280&Df)>>8|(255&Df)<<8)>>1}var zf=function(e,t,n){for(var A=e.length,r=0,i=new Wf(t);r<A;++r)e[r]&&++i[e[r]-1];var o,s=new Wf(t);for(r=1;r<t;++r)s[r]=s[r-1]+i[r-1]<<1;if(n){o=new Wf(1<<t);var a=15-t;for(r=0;r<A;++r)if(e[r])for(var g=r<<4|e[r],l=t-e[r],c=s[e[r]-1]++<<l,I=c|(1<<l)-1;c<=I;++c)o[Mf[c]>>a]=g}else for(o=new Wf(A),r=0;r<A;++r)e[r]&&(o[r]=Mf[s[e[r]-1]++]>>15-e[r]);return o},Of=new kf(288);for(Qf=0;Qf<144;++Qf)Of[Qf]=8;for(Qf=144;Qf<256;++Qf)Of[Qf]=9;for(Qf=256;Qf<280;++Qf)Of[Qf]=7;for(Qf=280;Qf<288;++Qf)Of[Qf]=8;var Pf=new kf(32);for(Qf=0;Qf<32;++Qf)Pf[Qf]=5;var _f=zf(Of,9,0),jf=zf(Of,9,1),qf=zf(Pf,5,0),$f=zf(Pf,5,1),eb=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},tb=function(e,t,n){var A=t/8|0;return(e[A]|e[A+1]<<8)>>(7&t)&n},nb=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Ab=function(e){return(e+7)/8|0},rb=function(e,t,n){return(null==n||n>e.length)&&(n=e.length),new kf(e.subarray(t,n))},ib=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ob=function(e,t,n){var A=new Error(t||ib[e]);if(A.code=e,Error.captureStackTrace&&Error.captureStackTrace(A,ob),!n)throw A;return A},sb=function(e,t,n){n<<=7&t;var A=t/8|0;e[A]|=n,e[A+1]|=n>>8},ab=function(e,t,n){n<<=7&t;var A=t/8|0;e[A]|=n,e[A+1]|=n>>8,e[A+2]|=n>>16},gb=function(e,t){for(var n=[],A=0;A<e.length;++A)e[A]&&n.push({s:A,f:e[A]});var r=n.length,i=n.slice();if(!r)return{t:hb,l:0};if(1==r){var o=new kf(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var s=n[0],a=n[1],g=0,l=1,c=2;for(n[0]={s:-1,f:s.f+a.f,l:s,r:a};l!=r-1;)s=n[n[g].f<n[c].f?g++:c++],a=n[g!=l&&n[g].f<n[c].f?g++:c++],n[l++]={s:-1,f:s.f+a.f,l:s,r:a};var I=i[0].s;for(A=1;A<r;++A)i[A].s>I&&(I=i[A].s);var C=new Wf(I+1),u=lb(n[l-1],C,0);if(u>t){A=0;var d=0,h=u-t,m=1<<h;for(i.sort((function(e,t){return C[t.s]-C[e.s]||e.f-t.f}));A<r;++A){var p=i[A].s;if(!(C[p]>t))break;d+=m-(1<<u-C[p]),C[p]=t}for(d>>=h;d>0;){var f=i[A].s;C[f]<t?d-=1<<t-C[f]++-1:++A}for(;A>=0&&d;--A){var b=i[A].s;C[b]==t&&(--C[b],++d)}u=t}return{t:new kf(C),l:u}},lb=function(e,t,n){return-1==e.s?Math.max(lb(e.l,t,n+1),lb(e.r,t,n+1)):t[e.s]=n},cb=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Wf(++t),A=0,r=e[0],i=1,o=function(e){n[A++]=e},s=1;s<=t;++s)if(e[s]==r&&s!=t)++i;else{if(!r&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(r),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(r);i=1,r=e[s]}return{c:n.subarray(0,A),n:t}},Ib=function(e,t){for(var n=0,A=0;A<t.length;++A)n+=e[A]*t[A];return n},Cb=function(e,t,n){var A=n.length,r=Ab(t+2);e[r]=255&A,e[r+1]=A>>8,e[r+2]=255^e[r],e[r+3]=255^e[r+1];for(var i=0;i<A;++i)e[r+i+4]=n[i];return 8*(r+4+A)},ub=function(e,t,n,A,r,i,o,s,a,g,l){sb(t,l++,n),++r[256];for(var c=gb(r,15),I=c.t,C=c.l,u=gb(i,15),d=u.t,h=u.l,m=cb(I),p=m.c,f=m.n,b=cb(d),B=b.c,y=b.n,w=new Wf(19),Z=0;Z<p.length;++Z)++w[31&p[Z]];for(Z=0;Z<B.length;++Z)++w[31&B[Z]];for(var S=gb(w,7),v=S.t,G=S.l,R=19;R>4&&!v[Hf[R-1]];--R);var V,N,k,W,F=g+5<<3,E=Ib(r,Of)+Ib(i,Pf)+o,X=Ib(r,I)+Ib(i,d)+o+14+3*R+Ib(w,v)+2*w[16]+3*w[17]+7*w[18];if(a>=0&&F<=E&&F<=X)return Cb(t,l,e.subarray(a,a+g));if(sb(t,l,1+(X<E)),l+=2,X<E){V=zf(I,C,0),N=I,k=zf(d,h,0),W=d;var H=zf(v,G,0);sb(t,l,f-257),sb(t,l+5,y-1),sb(t,l+10,R-4),l+=14;for(Z=0;Z<R;++Z)sb(t,l+3*Z,v[Hf[Z]]);l+=3*R;for(var x=[p,B],J=0;J<2;++J){var Y=x[J];for(Z=0;Z<Y.length;++Z){var U=31&Y[Z];sb(t,l,H[U]),l+=v[U],U>15&&(sb(t,l,Y[Z]>>5&127),l+=Y[Z]>>12)}}}else V=_f,N=Of,k=qf,W=Pf;for(Z=0;Z<s;++Z){var L=A[Z];if(L>255){ab(t,l,V[(U=L>>18&31)+257]),l+=N[U+257],U>7&&(sb(t,l,L>>23&31),l+=Ef[U]);var T=31&L;ab(t,l,k[T]),l+=W[T],T>3&&(ab(t,l,L>>5&8191),l+=Xf[T])}else ab(t,l,V[L]),l+=N[L]}return ab(t,l,V[256]),l+N[256]},db=new Ff([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hb=new kf(0),mb=function(){var e=1,t=0;return{p:function(n){for(var A=e,r=t,i=0|n.length,o=0;o!=i;){for(var s=Math.min(o+2655,i);o<s;++o)r+=A+=n[o];A=(65535&A)+15*(A>>16),r=(65535&r)+15*(r>>16)}e=A,t=r},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},pb=function(e,t,n,A,r){if(!r&&(r={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new kf(i.length+e.length);o.set(i),o.set(e,i.length),e=o,r.w=i.length}return function(e,t,n,A,r,i){var o=i.z||e.length,s=new kf(A+o+5*(1+Math.ceil(o/7e3))+r),a=s.subarray(A,s.length-r),g=i.l,l=7&(i.r||0);if(t){l&&(a[0]=i.r>>3);for(var c=db[t-1],I=c>>13,C=8191&c,u=(1<<n)-1,d=i.p||new Wf(32768),h=i.h||new Wf(u+1),m=Math.ceil(n/3),p=2*m,f=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<p)&u},b=new Ff(25e3),B=new Wf(288),y=new Wf(32),w=0,Z=0,S=i.i||0,v=0,G=i.w||0,R=0;S+2<o;++S){var V=f(S),N=32767&S,k=h[V];if(d[N]=k,h[V]=N,G<=S){var W=o-S;if((w>7e3||v>24576)&&(W>423||!g)){l=ub(e,a,0,b,B,y,Z,v,R,S-R,l),v=w=Z=0,R=S;for(var F=0;F<286;++F)B[F]=0;for(F=0;F<30;++F)y[F]=0}var E=2,X=0,H=C,x=N-k&32767;if(W>2&&V==f(S-x))for(var J=Math.min(I,W)-1,Y=Math.min(32767,S),U=Math.min(258,W);x<=Y&&--H&&N!=k;){if(e[S+E]==e[S+E-x]){for(var L=0;L<U&&e[S+L]==e[S+L-x];++L);if(L>E){if(E=L,X=x,L>J)break;var T=Math.min(x,L-2),K=0;for(F=0;F<T;++F){var M=S-x+F&32767,Q=M-d[M]&32767;Q>K&&(K=Q,k=M)}}}x+=(N=k)-(k=d[N])&32767}if(X){b[v++]=268435456|Uf[E]<<18|Kf[X];var D=31&Uf[E],z=31&Kf[X];Z+=Ef[D]+Xf[z],++B[257+D],++y[z],G=S+E,++w}else b[v++]=e[S],++B[e[S]]}}for(S=Math.max(S,G);S<o;++S)b[v++]=e[S],++B[e[S]];l=ub(e,a,g,b,B,y,Z,v,R,S-R,l),g||(i.r=7&l|a[l/8|0]<<3,l-=7,i.h=h,i.p=d,i.i=S,i.w=G)}else{for(S=i.w||0;S<o+g;S+=65535){var O=S+65535;O>=o&&(a[l/8|0]=g,O=o),l=Cb(a,l+1,e.subarray(S,O))}i.i=o}return rb(s,0,A+Ab(l)+r)}(e,null==t.level?6:t.level,null==t.mem?r.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,A,r)},fb=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function bb(e,t){t||(t={});var n=mb();n.p(e);var A=pb(e,t,t.dictionary?6:2,4);return function(e,t){var n=t.level,A=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=A<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var r=mb();r.p(t.dictionary),fb(e,2,r.d())}}(A,t),fb(A,A.length-4,n.d()),A}function Bb(e,t){return function(e,t,n,A){var r=e.length;if(!r||t.f&&!t.l)return n||new kf(0);var i=!n,o=i||2!=t.i,s=t.i;i&&(n=new kf(3*r));var a=function(e){var t=n.length;if(e>t){var A=new kf(Math.max(2*t,e));A.set(n),n=A}},g=t.f||0,l=t.p||0,c=t.b||0,I=t.l,C=t.d,u=t.m,d=t.n,h=8*r;do{if(!I){g=tb(e,l,1);var m=tb(e,l+1,3);if(l+=3,!m){var p=e[(V=Ab(l)+4)-4]|e[V-3]<<8,f=V+p;if(f>r){s&&ob(0);break}o&&a(c+p),n.set(e.subarray(V,f),c),t.b=c+=p,t.p=l=8*f,t.f=g;continue}if(1==m)I=jf,C=$f,u=9,d=5;else if(2==m){var b=tb(e,l,31)+257,B=tb(e,l+10,15)+4,y=b+tb(e,l+5,31)+1;l+=14;for(var w=new kf(y),Z=new kf(19),S=0;S<B;++S)Z[Hf[S]]=tb(e,l+3*S,7);l+=3*B;var v=eb(Z),G=(1<<v)-1,R=zf(Z,v,1);for(S=0;S<y;){var V,N=R[tb(e,l,G)];if(l+=15&N,(V=N>>4)<16)w[S++]=V;else{var k=0,W=0;for(16==V?(W=3+tb(e,l,3),l+=2,k=w[S-1]):17==V?(W=3+tb(e,l,7),l+=3):18==V&&(W=11+tb(e,l,127),l+=7);W--;)w[S++]=k}}var F=w.subarray(0,b),E=w.subarray(b);u=eb(F),d=eb(E),I=zf(F,u,1),C=zf(E,d,1)}else ob(1);if(l>h){s&&ob(0);break}}o&&a(c+131072);for(var X=(1<<u)-1,H=(1<<d)-1,x=l;;x=l){var J=(k=I[nb(e,l)&X])>>4;if((l+=15&k)>h){s&&ob(0);break}if(k||ob(2),J<256)n[c++]=J;else{if(256==J){x=l,I=null;break}var Y=J-254;if(J>264){var U=Ef[S=J-257];Y=tb(e,l,(1<<U)-1)+Yf[S],l+=U}var L=C[nb(e,l)&H],T=L>>4;if(L||ob(3),l+=15&L,E=Tf[T],T>3&&(U=Xf[T],E+=nb(e,l)&(1<<U)-1,l+=U),l>h){s&&ob(0);break}o&&a(c+131072);var K=c+Y;if(c<E){var M=0-E,Q=Math.min(E,K);for(M+c<0&&ob(3);c<Q;++c)n[c]=A[M+c]}for(;c<K;++c)n[c]=n[c-E]}}t.l=I,t.p=x,t.b=c,t.f=g,I&&(g=1,t.m=u,t.d=C,t.n=d)}while(!g);return c!=n.length&&i?rb(n,0,c):n.subarray(0,c)}(e.subarray(((8!=(15&(n=e)[0])||n[0]>>4>7||(n[0]<<8|n[1])%31)&&ob(6,"invalid zlib data"),1==(n[1]>>5&1)&&ob(6,"invalid zlib data: "+(32&n[1]?"need":"unexpected")+" dictionary"),2+(n[1]>>3&4)),-4),{i:2},t,t);var n}var yb="undefined"!=typeof TextDecoder&&new TextDecoder;try{yb.decode(hb,{stream:!0})}catch(Zf){}var wb=function(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this}();function Zb(){wb.console&&"function"==typeof wb.console.log&&wb.console.log.apply(wb.console,arguments)}var Sb={log:Zb,warn:function(e){wb.console&&("function"==typeof wb.console.warn?wb.console.warn.apply(wb.console,arguments):Zb.call(null,arguments))},error:function(e){wb.console&&("function"==typeof wb.console.error?wb.console.error.apply(wb.console,arguments):Zb(e))}};function vb(e,t,n){var A=new XMLHttpRequest;A.open("GET",e),A.responseType="blob",A.onload=function(){kb(A.response,t,n)},A.onerror=function(){Sb.error("could not download file")},A.send()}function Gb(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return t.status>=200&&t.status<=299}function Rb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Vb,Nb,kb=wb.saveAs||("object"!==("undefined"==typeof window?"undefined":Nf(window))||window!==wb?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var A=wb.URL||wb.webkitURL,r=document.createElement("a");t=t||e.name||"download",r.download=t,r.rel="noopener","string"==typeof e?(r.href=e,r.origin!==location.origin?Gb(r.href)?vb(e,t,n):Rb(r,r.target="_blank"):Rb(r)):(r.href=A.createObjectURL(e),setTimeout((function(){A.revokeObjectURL(r.href)}),4e4),setTimeout((function(){Rb(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(Gb(e))vb(e,t,n);else{var A=document.createElement("a");A.href=e,A.target="_blank",setTimeout((function(){Rb(A)}))}else navigator.msSaveOrOpenBlob((r=e,void 0===(i=n)?i={autoBom:!1}:"object"!==Nf(i)&&(Sb.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob([String.fromCharCode(65279),r],{type:r.type}):r),t);var r,i}:function(e,t,n,A){if((A=A||open("","_blank"))&&(A.document.title=A.document.body.innerText="downloading..."),"string"==typeof e)return vb(e,t,n);var r="application/octet-stream"===e.type,i=/constructor/i.test(wb.HTMLElement)||wb.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||r&&i)&&"object"===("undefined"==typeof FileReader?"undefined":Nf(FileReader))){var s=new FileReader;s.onloadend=function(){var e=s.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),A?A.location.href=e:location=e,A=null},s.readAsDataURL(e)}else{var a=wb.URL||wb.webkitURL,g=a.createObjectURL(e);A?A.location=g:location.href=g,A=null,setTimeout((function(){a.revokeObjectURL(g)}),4e4)}});
/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Wb(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],A=0;A<n.length;A++){var r=n[A].re,i=n[A].process,o=r.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}}
/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Fb(e,t){var n=e[0],A=e[1],r=e[2],i=e[3];n=Xb(n,A,r,i,t[0],7,-680876936),i=Xb(i,n,A,r,t[1],12,-389564586),r=Xb(r,i,n,A,t[2],17,606105819),A=Xb(A,r,i,n,t[3],22,-1044525330),n=Xb(n,A,r,i,t[4],7,-176418897),i=Xb(i,n,A,r,t[5],12,1200080426),r=Xb(r,i,n,A,t[6],17,-1473231341),A=Xb(A,r,i,n,t[7],22,-45705983),n=Xb(n,A,r,i,t[8],7,1770035416),i=Xb(i,n,A,r,t[9],12,-1958414417),r=Xb(r,i,n,A,t[10],17,-42063),A=Xb(A,r,i,n,t[11],22,-1990404162),n=Xb(n,A,r,i,t[12],7,1804603682),i=Xb(i,n,A,r,t[13],12,-40341101),r=Xb(r,i,n,A,t[14],17,-1502002290),n=Hb(n,A=Xb(A,r,i,n,t[15],22,1236535329),r,i,t[1],5,-165796510),i=Hb(i,n,A,r,t[6],9,-1069501632),r=Hb(r,i,n,A,t[11],14,643717713),A=Hb(A,r,i,n,t[0],20,-373897302),n=Hb(n,A,r,i,t[5],5,-701558691),i=Hb(i,n,A,r,t[10],9,38016083),r=Hb(r,i,n,A,t[15],14,-660478335),A=Hb(A,r,i,n,t[4],20,-405537848),n=Hb(n,A,r,i,t[9],5,568446438),i=Hb(i,n,A,r,t[14],9,-1019803690),r=Hb(r,i,n,A,t[3],14,-187363961),A=Hb(A,r,i,n,t[8],20,1163531501),n=Hb(n,A,r,i,t[13],5,-1444681467),i=Hb(i,n,A,r,t[2],9,-51403784),r=Hb(r,i,n,A,t[7],14,1735328473),n=xb(n,A=Hb(A,r,i,n,t[12],20,-1926607734),r,i,t[5],4,-378558),i=xb(i,n,A,r,t[8],11,-2022574463),r=xb(r,i,n,A,t[11],16,1839030562),A=xb(A,r,i,n,t[14],23,-35309556),n=xb(n,A,r,i,t[1],4,-1530992060),i=xb(i,n,A,r,t[4],11,1272893353),r=xb(r,i,n,A,t[7],16,-155497632),A=xb(A,r,i,n,t[10],23,-1094730640),n=xb(n,A,r,i,t[13],4,681279174),i=xb(i,n,A,r,t[0],11,-358537222),r=xb(r,i,n,A,t[3],16,-722521979),A=xb(A,r,i,n,t[6],23,76029189),n=xb(n,A,r,i,t[9],4,-640364487),i=xb(i,n,A,r,t[12],11,-421815835),r=xb(r,i,n,A,t[15],16,530742520),n=Jb(n,A=xb(A,r,i,n,t[2],23,-995338651),r,i,t[0],6,-198630844),i=Jb(i,n,A,r,t[7],10,1126891415),r=Jb(r,i,n,A,t[14],15,-1416354905),A=Jb(A,r,i,n,t[5],21,-57434055),n=Jb(n,A,r,i,t[12],6,1700485571),i=Jb(i,n,A,r,t[3],10,-1894986606),r=Jb(r,i,n,A,t[10],15,-1051523),A=Jb(A,r,i,n,t[1],21,-2054922799),n=Jb(n,A,r,i,t[8],6,1873313359),i=Jb(i,n,A,r,t[15],10,-30611744),r=Jb(r,i,n,A,t[6],15,-1560198380),A=Jb(A,r,i,n,t[13],21,1309151649),n=Jb(n,A,r,i,t[4],6,-145523070),i=Jb(i,n,A,r,t[11],10,-1120210379),r=Jb(r,i,n,A,t[2],15,718787259),A=Jb(A,r,i,n,t[9],21,-343485551),e[0]=Db(n,e[0]),e[1]=Db(A,e[1]),e[2]=Db(r,e[2]),e[3]=Db(i,e[3])}function Eb(e,t,n,A,r,i){return t=Db(Db(t,e),Db(A,i)),Db(t<<r|t>>>32-r,n)}function Xb(e,t,n,A,r,i,o){return Eb(t&n|~t&A,e,t,r,i,o)}function Hb(e,t,n,A,r,i,o){return Eb(t&A|n&~A,e,t,r,i,o)}function xb(e,t,n,A,r,i,o){return Eb(t^n^A,e,t,r,i,o)}function Jb(e,t,n,A,r,i,o){return Eb(n^(t|~A),e,t,r,i,o)}function Yb(e){var t,n=e.length,A=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Fb(A,Ub(e.substring(t-64,t)));e=e.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(Fb(A,r),t=0;t<16;t++)r[t]=0;return r[14]=8*n,Fb(A,r),A}function Ub(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}Vb=wb.atob.bind(wb),Nb=wb.btoa.bind(wb);var Lb="0123456789abcdef".split("");function Tb(e){for(var t="",n=0;n<4;n++)t+=Lb[e>>8*n+4&15]+Lb[e>>8*n&15];return t}function Kb(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Mb(e){return Yb(e).map(Kb).join("")}var Qb="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=Tb(e[t]);return e.join("")}(Yb("hello"));function Db(e,t){if(Qb){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}
/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function zb(e,t){var n,A,r,i;if(e!==n){for(var o=(r=e,i=1+(256/e.length|0),new Array(i+1).join(r)),s=[],a=0;a<256;a++)s[a]=a;var g=0;for(a=0;a<256;a++){var l=s[a];g=(g+l+o.charCodeAt(a))%256,s[a]=s[g],s[g]=l}n=e,A=s}else s=A;var c=t.length,I=0,C=0,u="";for(a=0;a<c;a++)C=(C+(l=s[I=(I+1)%256]))%256,s[I]=s[C],s[C]=l,o=s[(s[I]+s[C])%256],u+=String.fromCharCode(t.charCodeAt(a)^o);return u}
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Ob={print:4,modify:8,copy:16,"annot-forms":32};function Pb(e,t,n,A){this.v=1,this.r=2;var r=192;e.forEach((function(e){if(void 0!==Ob.perm)throw new Error("Invalid permission: "+e);r+=Ob[e]})),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(t+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^r)),this.encryptionKey=Mb(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(A)).substr(0,5),this.U=zb(this.encryptionKey,this.padding)}function _b(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,A=0;A<n;A++){var r=e.charCodeAt(A);t+=r<33||35===r||37===r||40===r||41===r||47===r||60===r||62===r||91===r||93===r||123===r||125===r||r>126?"#"+("0"+r.toString(16)).slice(-2):e[A]}return t}function jb(e){if("object"!==Nf(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,A){if(A=A||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof A)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var r=Math.random().toString(35);return t[e][r]=[n,!!A],r},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],0===Object.keys(t[n]).length&&delete t[n],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var A=Array.prototype.slice.call(arguments,1),r=[];for(var i in t[n]){var o=t[n][i];try{o[0].apply(e,A)}catch(s){wb.console&&Sb.error("jsPDF PubSub Error",s.message,s)}o[1]&&r.push(i)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function qb(e){if(!(this instanceof qb))return new qb(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function $b(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function eB(e,t,n,A,r){if(!(this instanceof eB))return new eB(e,t,n,A,r);this.type="axial"===e?2:3,this.coords=t,this.colors=n,$b.call(this,A,r)}function tB(e,t,n,A,r){if(!(this instanceof tB))return new tB(e,t,n,A,r);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,$b.call(this,A,r)}function nB(e){var t,n="string"==typeof arguments[0]?arguments[0]:"p",A=arguments[1],r=arguments[2],i=arguments[3],o=[],s=1,a=16,g="S",l=null;"object"===Nf(e=e||{})&&(n=e.orientation,A=e.unit||A,r=e.format||r,i=e.compress||e.compressPdf||i,null!==(l=e.encryption||null)&&(l.userPassword=l.userPassword||"",l.ownerPassword=l.ownerPassword||"",l.userPermissions=l.userPermissions||[]),s="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(a=e.floatPrecision),g=e.defaultPathOperation||"S"),o=e.filters||(!0===i?["FlateEncode"]:o),A=A||"mm",n=(""+(n||"P")).toLowerCase();var c=e.putOnlyUsedFonts||!1,I={},C={internal:{},__private__:{}};C.__private__.PubSub=jb;var u="1.3",d=C.__private__.getPdfVersion=function(){return u};C.__private__.setPdfVersion=function(e){u=e};var h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};C.__private__.getPageFormats=function(){return h};var m=C.__private__.getPageFormat=function(e){return h[e]};r=r||"a4";var p="compat",f="advanced",b=p;function B(){this.saveGraphicsState(),j(new ke(Ie,0,0,-Ie,0,ln()*Ie).toString()+" cm"),this.setFontSize(this.getFontSize()/Ie),g="n",b=f}function y(){this.restoreGraphicsState(),g="S",b=p}var w=C.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};C.advancedAPI=function(e){var t=b===p;return t&&B.call(this),"function"!=typeof e||(e(this),t&&y.call(this)),this},C.compatAPI=function(e){var t=b===f;return t&&y.call(this),"function"!=typeof e||(e(this),t&&B.call(this)),this},C.isAdvancedAPI=function(){return b===f};var Z,S=function(e){if(b!==f)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},v=C.roundToPrecision=C.__private__.roundToPrecision=function(e,n){var A=t||n;if(isNaN(e)||isNaN(A))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(A).replace(/0+$/,"")};Z=C.hpf=C.__private__.hpf="number"==typeof a?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return v(e,a)}:"smart"===a?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return v(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return v(e,16)};var G=C.f2=C.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return v(e,2)},R=C.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return v(e,3)},V=C.scale=C.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return b===p?e*Ie:b===f?e:void 0},N=function(e){return V(function(e){return b===p?ln()-e:b===f?e:void 0}(e))};C.__private__.setPrecision=C.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var k,W="00000000000000000000000000000000",F=C.__private__.getFileId=function(){return W},E=C.__private__.setFileId=function(e){return W=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():W.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),null!==l&&(ft=new Pb(l.userPermissions,l.userPassword,l.ownerPassword,W)),W};C.setFileId=function(e){return E(e),this},C.getFileId=function(){return F()};var X=C.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),n=t<0?"+":"-",A=Math.floor(Math.abs(t/60)),r=Math.abs(t%60),i=[n,U(A),"'",U(r),"'"].join("");return["D:",e.getFullYear(),U(e.getMonth()+1),U(e.getDate()),U(e.getHours()),U(e.getMinutes()),U(e.getSeconds()),i].join("")},H=C.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),n=parseInt(e.substr(6,2),10)-1,A=parseInt(e.substr(8,2),10),r=parseInt(e.substr(10,2),10),i=parseInt(e.substr(12,2),10),o=parseInt(e.substr(14,2),10);return new Date(t,n,A,r,i,o,0)},x=C.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=X(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return k=t},J=C.__private__.getCreationDate=function(e){var t=k;return"jsDate"===e&&(t=H(k)),t};C.setCreationDate=function(e){return x(e),this},C.getCreationDate=function(e){return J(e)};var Y,U=C.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},L=C.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},T=0,K=[],M=[],Q=0,D=[],z=[],O=!1,P=M;C.__private__.setCustomOutputDestination=function(e){O=!0,P=e};var _=function(e){O||(P=e)};C.__private__.resetCustomOutputDestination=function(){O=!1,P=M};var j=C.__private__.out=function(e){return e=e.toString(),Q+=e.length+1,P.push(e),P},q=C.__private__.write=function(e){return j(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},$=C.__private__.getArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),A=new Uint8Array(n);t--;)A[t]=e.charCodeAt(t);return n},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];C.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;C.__private__.setFontSize=C.setFontSize=function(e){return te=b===f?e/Ie:e,this};var ne,Ae=C.__private__.getFontSize=C.getFontSize=function(){return b===p?te:te*Ie},re=e.R2L||!1;C.__private__.setR2L=C.setR2L=function(e){return re=e,this},C.__private__.getR2L=C.getR2L=function(){return re};var ie,oe=C.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))ne=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');ne=e}else ne=parseInt(e,10)};C.__private__.getZoomMode=function(){return ne};var se,ae=C.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');ie=e};C.__private__.getPageMode=function(){return ie};var ge=C.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');se=e};C.__private__.getLayoutMode=function(){return se},C.__private__.setDisplayMode=C.setDisplayMode=function(e,t,n){return oe(e),ge(t),ae(n),this};var le={title:"",subject:"",author:"",keywords:"",creator:""};C.__private__.getDocumentProperty=function(e){if(-1===Object.keys(le).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return le[e]},C.__private__.getDocumentProperties=function(){return le},C.__private__.setDocumentProperties=C.setProperties=C.setDocumentProperties=function(e){for(var t in le)le.hasOwnProperty(t)&&e[t]&&(le[t]=e[t]);return this},C.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(le).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return le[e]=t};var ce,Ie,Ce,ue,de,he={},me={},pe=[],fe={},be={},Be={},ye={},we=null,Ze=0,Se=[],ve=new jb(C),Ge=e.hotfixes||[],Re={},Ve={},Ne=[],ke=function e(t,n,A,r,i,o){if(!(this instanceof e))return new e(t,n,A,r,i,o);isNaN(t)&&(t=1),isNaN(n)&&(n=0),isNaN(A)&&(A=0),isNaN(r)&&(r=1),isNaN(i)&&(i=0),isNaN(o)&&(o=0),this._matrix=[t,n,A,r,i,o]};Object.defineProperty(ke.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(ke.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(ke.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(ke.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(ke.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(ke.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(ke.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(ke.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(ke.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(ke.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(ke.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(ke.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(ke.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ke.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ke.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ke.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),ke.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Z).join(e)},ke.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,n=e.sx*this.shy+e.shy*this.sy,A=e.shx*this.sx+e.sy*this.shx,r=e.shx*this.shy+e.sy*this.sy,i=e.tx*this.sx+e.ty*this.shx+this.tx,o=e.tx*this.shy+e.ty*this.sy+this.ty;return new ke(t,n,A,r,i,o)},ke.prototype.decompose=function(){var e=this.sx,t=this.shy,n=this.shx,A=this.sy,r=this.tx,i=this.ty,o=Math.sqrt(e*e+t*t),s=(e/=o)*n+(t/=o)*A;n-=e*s,A-=t*s;var a=Math.sqrt(n*n+A*A);return s/=a,e*(A/=a)<t*(n/=a)&&(e=-e,t=-t,s=-s,o=-o),{scale:new ke(o,0,0,a,0,0),translate:new ke(1,0,0,1,r,i),rotate:new ke(e,t,-t,e,0,0),skew:new ke(1,0,s,1,0,0)}},ke.prototype.toString=function(e){return this.join(" ")},ke.prototype.inversed=function(){var e=this.sx,t=this.shy,n=this.shx,A=this.sy,r=this.tx,i=this.ty,o=1/(e*A-t*n),s=A*o,a=-t*o,g=-n*o,l=e*o;return new ke(s,a,g,l,-s*r-g*i,-a*r-l*i)},ke.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,n=e.x*this.shy+e.y*this.sy+this.ty;return new nn(t,n)},ke.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),n=this.applyToPoint(new nn(e.x+e.w,e.y+e.h));return new An(t.x,t.y,n.x-t.x,n.y-t.y)},ke.prototype.clone=function(){var e=this.sx,t=this.shy,n=this.shx,A=this.sy,r=this.tx,i=this.ty;return new ke(e,t,n,A,r,i)},C.Matrix=ke;var We=C.matrixMult=function(e,t){return t.multiply(e)},Fe=new ke(1,0,0,1,0,0);C.unitMatrix=C.identityMatrix=Fe;var Ee=function(e,t){if(!be[e]){var n=(t instanceof eB?"Sh":"P")+(Object.keys(fe).length+1).toString(10);t.id=n,be[e]=n,fe[n]=t,ve.publish("addPattern",t)}};C.ShadingPattern=eB,C.TilingPattern=tB,C.addShadingPattern=function(e,t){return S("addShadingPattern()"),Ee(e,t),this},C.beginTilingPattern=function(e){S("beginTilingPattern()"),on(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},C.endTilingPattern=function(e,t){S("endTilingPattern()"),t.stream=z[Y].join("\n"),Ee(e,t),ve.publish("endTilingPattern",t),Ne.pop().restore()};var Xe,He=C.__private__.newObject=function(){var e=xe();return Je(e,!0),e},xe=C.__private__.newObjectDeferred=function(){return T++,K[T]=function(){return Q},T},Je=function(e,t){return t="boolean"==typeof t&&t,K[e]=Q,t&&j(e+" 0 obj"),e},Ye=C.__private__.newAdditionalObject=function(){var e={objId:xe(),content:""};return D.push(e),e},Ue=xe(),Le=xe(),Te=C.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var n=parseFloat(t[0]);t=[n,n,n,"r"]}for(var A="#",r=0;r<3;r++)A+=("0"+Math.floor(255*parseFloat(t[r])).toString(16)).slice(-2);return A},Ke=C.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var n=e.ch1,A=e.ch2,r=e.ch3,i=e.ch4,o="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var s=new Wb(n);if(s.ok)n=s.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var a=parseInt(n.substr(1),16);n=a>>16&255,A=a>>8&255,r=255&a}if(void 0===A||void 0===i&&n===A&&A===r)if("string"==typeof n)t=n+" "+o[0];else if(2===e.precision)t=G(n/255)+" "+o[0];else t=R(n/255)+" "+o[0];else if(void 0===i||"object"===Nf(i)){if(i&&!isNaN(i.a)&&0===i.a)return["1.","1.","1.",o[1]].join(" ");if("string"==typeof n)t=[n,A,r,o[1]].join(" ");else if(2===e.precision)t=[G(n/255),G(A/255),G(r/255),o[1]].join(" ");else t=[R(n/255),R(A/255),R(r/255),o[1]].join(" ")}else if("string"==typeof n)t=[n,A,r,i,o[2]].join(" ");else if(2===e.precision)t=[G(n),G(A),G(r),G(i),o[2]].join(" ");else t=[R(n),R(A),R(r),R(i),o[2]].join(" ");return t},Me=C.__private__.getFilters=function(){return o},Qe=C.__private__.putStream=function(e){var t=(e=e||{}).data||"",n=e.filters||Me(),A=e.alreadyAppliedFilters||[],r=e.addLength1||!1,i=t.length,o=e.objectId,s=function(e){return e};if(null!==l&&void 0===o)throw new Error("ObjectId must be passed to putStream for file encryption");null!==l&&(s=ft.encryptor(o,0));var a={};!0===n&&(n=["FlateEncode"]);var g=e.additionalKeyValues||[],c=(a=void 0!==nB.API.processDataByFilters?nB.API.processDataByFilters(t,n):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(A)?A.join(" "):A.toString());if(0!==a.data.length&&(g.push({key:"Length",value:a.data.length}),!0===r&&g.push({key:"Length1",value:i})),0!=c.length)if(c.split("/").length-1==1)g.push({key:"Filter",value:c});else{g.push({key:"Filter",value:"["+c+"]"});for(var I=0;I<g.length;I+=1)if("DecodeParms"===g[I].key){for(var C=[],u=0;u<a.reverseChain.split("/").length-1;u+=1)C.push("null");C.push(g[I].value),g[I].value="["+C.join(" ")+"]"}}j("<<");for(var d=0;d<g.length;d++)j("/"+g[d].key+" "+g[d].value);j(">>"),0!==a.data.length&&(j("stream"),j(s(a.data)),j("endstream"))},De=C.__private__.putPage=function(e){var t=e.number,n=e.data,A=e.objId,r=e.contentsObjId;Je(A,!0),j("<</Type /Page"),j("/Parent "+e.rootDictionaryObjId+" 0 R"),j("/Resources "+e.resourceDictionaryObjId+" 0 R"),j("/MediaBox ["+parseFloat(Z(e.mediaBox.bottomLeftX))+" "+parseFloat(Z(e.mediaBox.bottomLeftY))+" "+Z(e.mediaBox.topRightX)+" "+Z(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&j("/CropBox ["+Z(e.cropBox.bottomLeftX)+" "+Z(e.cropBox.bottomLeftY)+" "+Z(e.cropBox.topRightX)+" "+Z(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&j("/BleedBox ["+Z(e.bleedBox.bottomLeftX)+" "+Z(e.bleedBox.bottomLeftY)+" "+Z(e.bleedBox.topRightX)+" "+Z(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&j("/TrimBox ["+Z(e.trimBox.bottomLeftX)+" "+Z(e.trimBox.bottomLeftY)+" "+Z(e.trimBox.topRightX)+" "+Z(e.trimBox.topRightY)+"]"),null!==e.artBox&&j("/ArtBox ["+Z(e.artBox.bottomLeftX)+" "+Z(e.artBox.bottomLeftY)+" "+Z(e.artBox.topRightX)+" "+Z(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&j("/UserUnit "+e.userUnit),ve.publish("putPage",{objId:A,pageContext:Se[t],pageNumber:t,page:n}),j("/Contents "+r+" 0 R"),j(">>"),j("endobj");var i=n.join("\n");return b===f&&(i+="\nQ"),Je(r,!0),Qe({data:i,filters:Me(),objectId:r}),j("endobj"),A},ze=C.__private__.putPages=function(){var e,t,n=[];for(e=1;e<=Ze;e++)Se[e].objId=xe(),Se[e].contentsObjId=xe();for(e=1;e<=Ze;e++)n.push(De({number:e,data:z[e],objId:Se[e].objId,contentsObjId:Se[e].contentsObjId,mediaBox:Se[e].mediaBox,cropBox:Se[e].cropBox,bleedBox:Se[e].bleedBox,trimBox:Se[e].trimBox,artBox:Se[e].artBox,userUnit:Se[e].userUnit,rootDictionaryObjId:Ue,resourceDictionaryObjId:Le}));Je(Ue,!0),j("<</Type /Pages");var A="/Kids [";for(t=0;t<Ze;t++)A+=n[t]+" 0 R ";j(A+"]"),j("/Count "+Ze),j(">>"),j("endobj"),ve.publish("postPutPages")},Oe=function(e){ve.publish("putFont",{font:e,out:j,newObject:He,putStream:Qe}),!0!==e.isAlreadyPutted&&(e.objectNumber=He(),j("<<"),j("/Type /Font"),j("/BaseFont /"+_b(e.postScriptName)),j("/Subtype /Type1"),"string"==typeof e.encoding&&j("/Encoding /"+e.encoding),j("/FirstChar 32"),j("/LastChar 255"),j(">>"),j("endobj"))},Pe=function(e){e.objectNumber=He();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[Z(e.x),Z(e.y),Z(e.x+e.width),Z(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var n=e.pages[1].join("\n");Qe({data:n,additionalKeyValues:t,objectId:e.objectNumber}),j("endobj")},_e=function(e,t){t||(t=21);var n=He(),A=function(e,t){var n,A=[],r=1/(t-1);for(n=0;n<1;n+=r)A.push(n);if(A.push(1),0!=e[0].offset){var i={offset:0,color:e[0].color};e.unshift(i)}if(1!=e[e.length-1].offset){var o={offset:1,color:e[e.length-1].color};e.push(o)}for(var s="",a=0,g=0;g<A.length;g++){for(n=A[g];n>e[a+1].offset;)a++;var l=e[a].offset,c=(n-l)/(e[a+1].offset-l),I=e[a].color,C=e[a+1].color;s+=L(Math.round((1-c)*I[0]+c*C[0]).toString(16))+L(Math.round((1-c)*I[1]+c*C[1]).toString(16))+L(Math.round((1-c)*I[2]+c*C[2]).toString(16))}return s.trim()}(e.colors,t),r=[];r.push({key:"FunctionType",value:"0"}),r.push({key:"Domain",value:"[0.0 1.0]"}),r.push({key:"Size",value:"["+t+"]"}),r.push({key:"BitsPerSample",value:"8"}),r.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),r.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:A,additionalKeyValues:r,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),j("endobj"),e.objectNumber=He(),j("<< /ShadingType "+e.type),j("/ColorSpace /DeviceRGB");var i="/Coords ["+Z(parseFloat(e.coords[0]))+" "+Z(parseFloat(e.coords[1]))+" ";2===e.type?i+=Z(parseFloat(e.coords[2]))+" "+Z(parseFloat(e.coords[3])):i+=Z(parseFloat(e.coords[2]))+" "+Z(parseFloat(e.coords[3]))+" "+Z(parseFloat(e.coords[4]))+" "+Z(parseFloat(e.coords[5])),j(i+="]"),e.matrix&&j("/Matrix ["+e.matrix.toString()+"]"),j("/Function "+n+" 0 R"),j("/Extend [true true]"),j(">>"),j("endobj")},je=function(e,t){var n=xe(),A=He();t.push({resourcesOid:n,objectOid:A}),e.objectNumber=A;var r=[];r.push({key:"Type",value:"/Pattern"}),r.push({key:"PatternType",value:"1"}),r.push({key:"PaintType",value:"1"}),r.push({key:"TilingType",value:"1"}),r.push({key:"BBox",value:"["+e.boundingBox.map(Z).join(" ")+"]"}),r.push({key:"XStep",value:Z(e.xStep)}),r.push({key:"YStep",value:Z(e.yStep)}),r.push({key:"Resources",value:n+" 0 R"}),e.matrix&&r.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Qe({data:e.stream,additionalKeyValues:r,objectId:e.objectNumber}),j("endobj")},qe=function(e){for(var t in e.objectNumber=He(),j("<<"),e)switch(t){case"opacity":j("/ca "+G(e[t]));break;case"stroke-opacity":j("/CA "+G(e[t]))}j(">>"),j("endobj")},$e=function(e){Je(e.resourcesOid,!0),j("<<"),j("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in j("/Font <<"),he)he.hasOwnProperty(e)&&(!1===c||!0===c&&I.hasOwnProperty(e))&&j("/"+e+" "+he[e].objectNumber+" 0 R");j(">>")}(),function(){if(Object.keys(fe).length>0){for(var e in j("/Shading <<"),fe)fe.hasOwnProperty(e)&&fe[e]instanceof eB&&fe[e].objectNumber>=0&&j("/"+e+" "+fe[e].objectNumber+" 0 R");ve.publish("putShadingPatternDict"),j(">>")}}(),function(e){if(Object.keys(fe).length>0){for(var t in j("/Pattern <<"),fe)fe.hasOwnProperty(t)&&fe[t]instanceof C.TilingPattern&&fe[t].objectNumber>=0&&fe[t].objectNumber<e&&j("/"+t+" "+fe[t].objectNumber+" 0 R");ve.publish("putTilingPatternDict"),j(">>")}}(e.objectOid),function(){if(Object.keys(Be).length>0){var e;for(e in j("/ExtGState <<"),Be)Be.hasOwnProperty(e)&&Be[e].objectNumber>=0&&j("/"+e+" "+Be[e].objectNumber+" 0 R");ve.publish("putGStateDict"),j(">>")}}(),function(){for(var e in j("/XObject <<"),Re)Re.hasOwnProperty(e)&&Re[e].objectNumber>=0&&j("/"+e+" "+Re[e].objectNumber+" 0 R");ve.publish("putXobjectDict"),j(">>")}(),j(">>"),j("endobj")},et=function(){var e=[];(function(){for(var e in he)he.hasOwnProperty(e)&&(!1===c||!0===c&&I.hasOwnProperty(e))&&Oe(he[e])})(),function(){var e;for(e in Be)Be.hasOwnProperty(e)&&qe(Be[e])}(),function(){for(var e in Re)Re.hasOwnProperty(e)&&Pe(Re[e])}(),function(e){var t;for(t in fe)fe.hasOwnProperty(t)&&(fe[t]instanceof eB?_e(fe[t]):fe[t]instanceof tB&&je(fe[t],e))}(e),ve.publish("putResources"),e.forEach($e),$e({resourcesOid:Le,objectOid:Number.MAX_SAFE_INTEGER}),ve.publish("postPutResources")},tt=function(e){me[e.fontName]=me[e.fontName]||{},me[e.fontName][e.fontStyle]=e.id},nt=function(e,t,n,A,r){var i={id:"F"+(Object.keys(he).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:n,encoding:A,isStandardFont:r||!1,metadata:{}};return ve.publish("addFont",{font:i,instance:this}),he[i.id]=i,tt(i),i.id},At=C.__private__.pdfEscape=C.pdfEscape=function(e,t){return function(e,t){var n,A,r,i,o,s,a,g,l;if(r=(t=t||{}).sourceEncoding||"Unicode",o=t.outputEncoding,(t.autoencode||o)&&he[ce].metadata&&he[ce].metadata[r]&&he[ce].metadata[r].encoding&&(i=he[ce].metadata[r].encoding,!o&&he[ce].encoding&&(o=he[ce].encoding),!o&&i.codePages&&(o=i.codePages[0]),"string"==typeof o&&(o=i[o]),o)){for(a=!1,s=[],n=0,A=e.length;n<A;n++)(g=o[e.charCodeAt(n)])?s.push(String.fromCharCode(g)):s.push(e[n]),s[n].charCodeAt(0)>>8&&(a=!0);e=s.join("")}for(n=e.length;void 0===a&&0!==n;)e.charCodeAt(n-1)>>8&&(a=!0),n--;if(!a)return e;for(s=t.noBOM?[]:[254,255],n=0,A=e.length;n<A;n++){if((l=(g=e.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");s.push(l),s.push(g-(l<<8))}return String.fromCharCode.apply(void 0,s)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rt=C.__private__.beginPage=function(e){z[++Ze]=[],Se[Ze]={objId:0,contentsObjId:0,userUnit:Number(s),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},st(Ze),_(z[Y])},it=function(e,t){var A,i,o;switch(n=t||n,"string"==typeof e&&(A=m(e.toLowerCase()),Array.isArray(A)&&(i=A[0],o=A[1])),Array.isArray(e)&&(i=e[0]*Ie,o=e[1]*Ie),isNaN(i)&&(i=r[0],o=r[1]),(i>14400||o>14400)&&(Sb.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),i=Math.min(14400,i),o=Math.min(14400,o)),r=[i,o],n.substr(0,1)){case"l":o>i&&(r=[o,i]);break;case"p":i>o&&(r=[o,i])}rt(r),Yt(xt),j(zt),0!==$t&&j($t+" J"),0!==en&&j(en+" j"),ve.publish("addPage",{pageNumber:Ze})},ot=function(e){e>0&&e<=Ze&&(z.splice(e,1),Se.splice(e,1),Ze--,Y>Ze&&(Y=Ze),this.setPage(Y))},st=function(e){e>0&&e<=Ze&&(Y=e)},at=C.__private__.getNumberOfPages=C.getNumberOfPages=function(){return z.length-1},gt=function(e,t,n){var A,r=void 0;return n=n||{},e=void 0!==e?e:he[ce].fontName,t=void 0!==t?t:he[ce].fontStyle,A=e.toLowerCase(),void 0!==me[A]&&void 0!==me[A][t]?r=me[A][t]:void 0!==me[e]&&void 0!==me[e][t]?r=me[e][t]:!1===n.disableWarning&&Sb.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),r||n.noFallback||null==(r=me.times[t])&&(r=me.times.normal),r},lt=C.__private__.putInfo=function(){var e=He(),t=function(e){return e};for(var n in null!==l&&(t=ft.encryptor(e,0)),j("<<"),j("/Producer ("+At(t("jsPDF "+nB.version))+")"),le)le.hasOwnProperty(n)&&le[n]&&j("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+At(t(le[n]))+")");j("/CreationDate ("+At(t(k))+")"),j(">>"),j("endobj")},ct=C.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Ue;switch(He(),j("<<"),j("/Type /Catalog"),j("/Pages "+t+" 0 R"),ne||(ne="fullwidth"),ne){case"fullwidth":j("/OpenAction [3 0 R /FitH null]");break;case"fullheight":j("/OpenAction [3 0 R /FitV null]");break;case"fullpage":j("/OpenAction [3 0 R /Fit]");break;case"original":j("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+ne;"%"===n.substr(n.length-1)&&(ne=parseInt(ne)/100),"number"==typeof ne&&j("/OpenAction [3 0 R /XYZ null null "+G(ne)+"]")}switch(se||(se="continuous"),se){case"continuous":j("/PageLayout /OneColumn");break;case"single":j("/PageLayout /SinglePage");break;case"two":case"twoleft":j("/PageLayout /TwoColumnLeft");break;case"tworight":j("/PageLayout /TwoColumnRight")}ie&&j("/PageMode /"+ie),ve.publish("putCatalog"),j(">>"),j("endobj")},It=C.__private__.putTrailer=function(){j("trailer"),j("<<"),j("/Size "+(T+1)),j("/Root "+T+" 0 R"),j("/Info "+(T-1)+" 0 R"),null!==l&&j("/Encrypt "+ft.oid+" 0 R"),j("/ID [ <"+W+"> <"+W+"> ]"),j(">>")},Ct=C.__private__.putHeader=function(){j("%PDF-"+u),j("%ºß¬à")},ut=C.__private__.putXRef=function(){var e="0000000000";j("xref"),j("0 "+(T+1)),j("0000000000 65535 f ");for(var t=1;t<=T;t++)"function"==typeof K[t]?j((e+K[t]()).slice(-10)+" 00000 n "):void 0!==K[t]?j((e+K[t]).slice(-10)+" 00000 n "):j("0000000000 00000 n ")},dt=C.__private__.buildDocument=function(){T=0,Q=0,M=[],K=[],D=[],Ue=xe(),Le=xe(),_(M),ve.publish("buildDocument"),Ct(),ze(),function(){ve.publish("putAdditionalObjects");for(var e=0;e<D.length;e++){var t=D[e];Je(t.objId,!0),j(t.content),j("endobj")}ve.publish("postPutAdditionalObjects")}(),et(),null!==l&&(ft.oid=He(),j("<<"),j("/Filter /Standard"),j("/V "+ft.v),j("/R "+ft.r),j("/U <"+ft.toHexString(ft.U)+">"),j("/O <"+ft.toHexString(ft.O)+">"),j("/P "+ft.P),j(">>"),j("endobj")),lt(),ct();var e=Q;return ut(),It(),j("startxref"),j(""+e),j("%%EOF"),_(z[Y]),M.join("\n")},ht=C.__private__.getBlob=function(e){return new Blob([$(e)],{type:"application/pdf"})},mt=C.output=C.__private__.output=((Xe=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return dt();case"save":C.save(t.filename);break;case"arraybuffer":return $(dt());case"blob":return ht(dt());case"bloburi":case"bloburl":if(void 0!==wb.URL&&"function"==typeof wb.URL.createObjectURL)return wb.URL&&wb.URL.createObjectURL(ht(dt()))||void 0;Sb.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",A=dt();try{n=Nb(A)}catch(u){n=Nb(unescape(encodeURIComponent(A)))}return"data:application/pdf;filename="+t.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(wb)){var r="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",i=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(r=t.pdfObjectUrl,i="");var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+r+'"'+i+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",s=wb.open();return null!==s&&s.document.write(o),s}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(wb)){var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',g=wb.open();if(null!==g){g.document.write(a);var l=this;g.document.documentElement.querySelector("#pdfViewer").onload=function(){g.document.title=t.filename,g.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(l.output("bloburl"))}}return g}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(wb))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var c='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',I=wb.open();if(null!==I&&(I.document.write(c),I.document.title=t.filename),I||"undefined"==typeof safari)return I;break;case"datauri":case"dataurl":return wb.document.location.href=this.output("datauristring",t);default:return null}}).foo=function(){try{return Xe.apply(this,arguments)}catch(n){var e=n.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var t="Error in function "+e.split("\n")[0].split("<")[0]+": "+n.message;if(!wb.console)throw new Error(t);wb.console.error(t,n),wb.alert&&alert(t)}},Xe.foo.bar=Xe,Xe.foo),pt=function(e){return!0===Array.isArray(Ge)&&Ge.indexOf(e)>-1};switch(A){case"pt":Ie=1;break;case"mm":Ie=72/25.4;break;case"cm":Ie=72/2.54;break;case"in":Ie=72;break;case"px":Ie=1==pt("px_scaling")?.75:96/72;break;case"pc":case"em":Ie=12;break;case"ex":Ie=6;break;default:if("number"!=typeof A)throw new Error("Invalid unit: "+A);Ie=A}var ft=null;x(),E();var bt=C.__private__.getPageInfo=C.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[e].objId,pageNumber:e,pageContext:Se[e]}},Bt=C.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Se)if(Se[t].objId===e)break;return bt(t)},yt=C.__private__.getCurrentPageInfo=C.getCurrentPageInfo=function(){return{objId:Se[Y].objId,pageNumber:Y,pageContext:Se[Y]}};C.addPage=function(){return it.apply(this,arguments),this},C.setPage=function(){return st.apply(this,arguments),_.call(this,z[Y]),this},C.insertPage=function(e){return this.addPage(),this.movePage(Y,e),this},C.movePage=function(e,t){var n,A;if(e>t){n=z[e],A=Se[e];for(var r=e;r>t;r--)z[r]=z[r-1],Se[r]=Se[r-1];z[t]=n,Se[t]=A,this.setPage(t)}else if(e<t){n=z[e],A=Se[e];for(var i=e;i<t;i++)z[i]=z[i+1],Se[i]=Se[i+1];z[t]=n,Se[t]=A,this.setPage(t)}return this},C.deletePage=function(){return ot.apply(this,arguments),this},C.__private__.text=C.text=function(e,t,n,A,r){var i,o,s,a,g,l,c,C,u,d=(A=A||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof n||Array.isArray(n))){var h=n;n=t,t=e,e=h}if(arguments[3]instanceof ke==0?(s=arguments[4],a=arguments[5],"object"===Nf(c=arguments[3])&&null!==c||("string"==typeof s&&(a=s,s=null),"string"==typeof c&&(a=c,c=null),"number"==typeof c&&(s=c,c=null),A={flags:c,angle:s,align:a})):(S("The transform parameter of text() with a Matrix value"),u=r),isNaN(t)||isNaN(n)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return d;var m,p="",B="number"==typeof A.lineHeightFactor?A.lineHeightFactor:Ht,y=d.internal.scaleFactor;function w(e){return e=e.split("\t").join(Array(A.TabLen||9).join(" ")),At(e,c)}function v(e){for(var t,n=e.concat(),A=[],r=n.length;r--;)"string"==typeof(t=n.shift())?A.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?A.push(t[0]):A.push([t[0],t[1],t[2]]);return A}function G(e,t){var n;if("string"==typeof e)n=t(e)[0];else if(Array.isArray(e)){for(var A,r,i=e.concat(),o=[],s=i.length;s--;)"string"==typeof(A=i.shift())?o.push(t(A)[0]):Array.isArray(A)&&"string"==typeof A[0]&&(r=t(A[0],A[1],A[2]),o.push([r[0],r[1],r[2]]));n=o}return n}var R=!1,N=!0;if("string"==typeof e)R=!0;else if(Array.isArray(e)){var k=e.concat();o=[];for(var W,F=k.length;F--;)("string"!=typeof(W=k.shift())||Array.isArray(W)&&"string"!=typeof W[0])&&(N=!1);R=N}if(!1===R)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var E=te/d.internal.scaleFactor,X=E*(B-1);switch(A.baseline){case"bottom":n-=X;break;case"top":n+=E-X;break;case"hanging":n+=E-2*X;break;case"middle":n+=E/2-X}if((l=A.maxWidth||0)>0&&("string"==typeof e?e=d.splitTextToSize(e,l):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(d.splitTextToSize(t,l))}),[]))),i={text:e,x:t,y:n,options:A,mutex:{pdfEscape:At,activeFontKey:ce,fonts:he,activeFontSize:te}},ve.publish("preProcessText",i),e=i.text,s=(A=i.options).angle,u instanceof ke==0&&s&&"number"==typeof s){s*=Math.PI/180,0===A.rotationDirection&&(s=-s),b===f&&(s=-s);var H=Math.cos(s),x=Math.sin(s);u=new ke(H,x,-x,H,0,0)}else s&&s instanceof ke&&(u=s);b!==f||u||(u=Fe),void 0!==(g=A.charSpace||jt)&&(p+=Z(V(g))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(C=A.horizontalScale)&&(p+=Z(100*C)+" Tz\n"),A.lang;var J=-1,Y=void 0!==A.renderingMode?A.renderingMode:A.stroke,U=d.internal.getCurrentPageInfo().pageContext;switch(Y){case 0:case!1:case"fill":J=0;break;case 1:case!0:case"stroke":J=1;break;case 2:case"fillThenStroke":J=2;break;case 3:case"invisible":J=3;break;case 4:case"fillAndAddForClipping":J=4;break;case 5:case"strokeAndAddPathForClipping":J=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":J=6;break;case 7:case"addToPathForClipping":J=7}var L=void 0!==U.usedRenderingMode?U.usedRenderingMode:-1;-1!==J?p+=J+" Tr\n":-1!==L&&(p+="0 Tr\n"),-1!==J&&(U.usedRenderingMode=J),a=A.align||"left";var T,K=te*B,M=d.internal.pageSize.getWidth(),Q=he[ce];g=A.charSpace||jt,l=A.maxWidth||0,c=Object.assign({autoencode:!0,noBOM:!0},A.flags);var D=[],z=function(e){return d.getStringUnitWidth(e,{font:Q,charSpace:g,fontSize:te,doKerning:!1})*te/y};if("[object Array]"===Object.prototype.toString.call(e)){var O;o=v(e),"left"!==a&&(T=o.map(z));var P,_=0;if("right"===a){t-=T[0],e=[],F=o.length;for(var q=0;q<F;q++)0===q?(P=Kt(t),O=Mt(n)):(P=V(_-T[q]),O=-K),e.push([o[q],P,O]),_=T[q]}else if("center"===a){t-=T[0]/2,e=[],F=o.length;for(var $=0;$<F;$++)0===$?(P=Kt(t),O=Mt(n)):(P=V((_-T[$])/2),O=-K),e.push([o[$],P,O]),_=T[$]}else if("left"===a){e=[],F=o.length;for(var ee=0;ee<F;ee++)e.push(o[ee])}else if("justify"===a&&"Identity-H"===Q.encoding){e=[],F=o.length,l=0!==l?l:M;for(var ne=0,Ae=0;Ae<F;Ae++)if(O=0===Ae?Mt(n):-K,P=0===Ae?Kt(t):ne,Ae<F-1){var ie=V((l-T[Ae])/(o[Ae].split(" ").length-1)),oe=o[Ae].split(" ");e.push([oe[0]+" ",P,O]),ne=0;for(var se=1;se<oe.length;se++){var ae=(z(oe[se-1]+" "+oe[se])-z(oe[se]))*y+ie;se==oe.length-1?e.push([oe[se],ae,0]):e.push([oe[se]+" ",ae,0]),ne-=ae}}else e.push([o[Ae],P,O]);e.push(["",ne,0])}else{if("justify"!==a)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],F=o.length,l=0!==l?l:M,Ae=0;Ae<F;Ae++)O=0===Ae?Mt(n):-K,P=0===Ae?Kt(t):0,Ae<F-1?D.push(Z(V((l-T[Ae])/(o[Ae].split(" ").length-1)))):D.push(0),e.push([o[Ae],P,O])}}!0===("boolean"==typeof A.R2L?A.R2L:re)&&(e=G(e,(function(e,t,n){return[e.split("").reverse().join(""),t,n]}))),i={text:e,x:t,y:n,options:A,mutex:{pdfEscape:At,activeFontKey:ce,fonts:he,activeFontSize:te}},ve.publish("postProcessText",i),e=i.text,m=i.mutex.isHex||!1;var ge=he[ce].encoding;"WinAnsiEncoding"!==ge&&"StandardEncoding"!==ge||(e=G(e,(function(e,t,n){return[w(e),t,n]}))),o=v(e),e=[];for(var le,Ie,Ce,ue=Array.isArray(o[0])?1:0,de="",me=function(e,t,n){var r="";return n instanceof ke?(n="number"==typeof A.angle?We(n,new ke(1,0,0,1,e,t)):We(new ke(1,0,0,1,e,t),n),b===f&&(n=We(new ke(1,0,0,-1,0,0),n)),r=n.join(" ")+" Tm\n"):r=Z(e)+" "+Z(t)+" Td\n",r},pe=0;pe<o.length;pe++){switch(de="",ue){case 1:Ce=(m?"<":"(")+o[pe][0]+(m?">":")"),le=parseFloat(o[pe][1]),Ie=parseFloat(o[pe][2]);break;case 0:Ce=(m?"<":"(")+o[pe]+(m?">":")"),le=Kt(t),Ie=Mt(n)}void 0!==D&&void 0!==D[pe]&&(de=D[pe]+" Tw\n"),0===pe?e.push(de+me(le,Ie,u)+Ce):0===ue?e.push(de+Ce):1===ue&&e.push(de+me(le,Ie,u)+Ce)}e=0===ue?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var fe="BT\n/";return fe+=ce+" "+te+" Tf\n",fe+=Z(te*B)+" TL\n",fe+=Pt+"\n",fe+=p,fe+=e,j(fe+="ET"),I[ce]=!0,d};var wt=C.__private__.clip=C.clip=function(e){return j("evenodd"===e?"W*":"W"),this};C.clipEvenOdd=function(){return wt("evenodd")},C.__private__.discardPath=C.discardPath=function(){return j("n"),this};var Zt=C.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};C.__private__.setDefaultPathOperation=C.setDefaultPathOperation=function(e){return Zt(e)&&(g=e),this};var St=C.__private__.getStyle=C.getStyle=function(e){var t=g;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},vt=C.close=function(){return j("h"),this};C.stroke=function(){return j("S"),this},C.fill=function(e){return Gt("f",e),this},C.fillEvenOdd=function(e){return Gt("f*",e),this},C.fillStroke=function(e){return Gt("B",e),this},C.fillStrokeEvenOdd=function(e){return Gt("B*",e),this};var Gt=function(e,t){"object"===Nf(t)?Nt(t,e):j(e)},Rt=function(e){null===e||b===f&&void 0===e||(e=St(e),j(e))};function Vt(e,t,n,A,r){var i=new tB(t||this.boundingBox,n||this.xStep,A||this.yStep,this.gState,r||this.matrix);i.stream=this.stream;var o=e+"$$"+this.cloneIndex+++"$$";return Ee(o,i),i}var Nt=function(e,t){var n=be[e.key],A=fe[n];if(A instanceof eB)j("q"),j(kt(t)),A.gState&&C.setGState(A.gState),j(e.matrix.toString()+" cm"),j("/"+n+" sh"),j("Q");else if(A instanceof tB){var r=new ke(1,0,0,-1,0,ln());e.matrix&&(r=r.multiply(e.matrix||Fe),n=Vt.call(A,e.key,e.boundingBox,e.xStep,e.yStep,r).id),j("q"),j("/Pattern cs"),j("/"+n+" scn"),A.gState&&C.setGState(A.gState),j(t),j("Q")}},kt=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Wt=C.moveTo=function(e,t){return j(Z(V(e))+" "+Z(N(t))+" m"),this},Ft=C.lineTo=function(e,t){return j(Z(V(e))+" "+Z(N(t))+" l"),this},Et=C.curveTo=function(e,t,n,A,r,i){return j([Z(V(e)),Z(N(t)),Z(V(n)),Z(N(A)),Z(V(r)),Z(N(i)),"c"].join(" ")),this};C.__private__.line=C.line=function(e,t,n,A,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||!Zt(r))throw new Error("Invalid arguments passed to jsPDF.line");return b===p?this.lines([[n-e,A-t]],e,t,[1,1],r||"S"):this.lines([[n-e,A-t]],e,t,[1,1]).stroke()},C.__private__.lines=C.lines=function(e,t,n,A,r,i){var o,s,a,g,l,c,I,C,u,d,h,m;if("number"==typeof e&&(m=n,n=t,t=e,e=m),A=A||[1,1],i=i||!1,isNaN(t)||isNaN(n)||!Array.isArray(e)||!Array.isArray(A)||!Zt(r)||"boolean"!=typeof i)throw new Error("Invalid arguments passed to jsPDF.lines");for(Wt(t,n),o=A[0],s=A[1],g=e.length,d=t,h=n,a=0;a<g;a++)2===(l=e[a]).length?(d=l[0]*o+d,h=l[1]*s+h,Ft(d,h)):(c=l[0]*o+d,I=l[1]*s+h,C=l[2]*o+d,u=l[3]*s+h,d=l[4]*o+d,h=l[5]*s+h,Et(c,I,C,u,d,h));return i&&vt(),Rt(r),this},C.path=function(e){for(var t=0;t<e.length;t++){var n=e[t],A=n.c;switch(n.op){case"m":Wt(A[0],A[1]);break;case"l":Ft(A[0],A[1]);break;case"c":Et.apply(this,A);break;case"h":vt()}}return this},C.__private__.rect=C.rect=function(e,t,n,A,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||!Zt(r))throw new Error("Invalid arguments passed to jsPDF.rect");return b===p&&(A=-A),j([Z(V(e)),Z(N(t)),Z(V(n)),Z(V(A)),"re"].join(" ")),Rt(r),this},C.__private__.triangle=C.triangle=function(e,t,n,A,r,i,o){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||isNaN(r)||isNaN(i)||!Zt(o))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-e,A-t],[r-n,i-A],[e-r,t-i]],e,t,[1,1],o,!0),this},C.__private__.roundedRect=C.roundedRect=function(e,t,n,A,r,i,o){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||isNaN(r)||isNaN(i)||!Zt(o))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var s=4/3*(Math.SQRT2-1);return r=Math.min(r,.5*n),i=Math.min(i,.5*A),this.lines([[n-2*r,0],[r*s,0,r,i-i*s,r,i],[0,A-2*i],[0,i*s,-r*s,i,-r,i],[2*r-n,0],[-r*s,0,-r,-i*s,-r,-i],[0,2*i-A],[0,-i*s,r*s,-i,r,-i]],e+r,t,[1,1],o,!0),this},C.__private__.ellipse=C.ellipse=function(e,t,n,A,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||!Zt(r))throw new Error("Invalid arguments passed to jsPDF.ellipse");var i=4/3*(Math.SQRT2-1)*n,o=4/3*(Math.SQRT2-1)*A;return Wt(e+n,t),Et(e+n,t-o,e+i,t-A,e,t-A),Et(e-i,t-A,e-n,t-o,e-n,t),Et(e-n,t+o,e-i,t+A,e,t+A),Et(e+i,t+A,e+n,t+o,e+n,t),Rt(r),this},C.__private__.circle=C.circle=function(e,t,n,A){if(isNaN(e)||isNaN(t)||isNaN(n)||!Zt(A))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,n,n,A)},C.setFont=function(e,t,n){return n&&(t=w(t,n)),ce=gt(e,t,{disableWarning:!1}),this};var Xt=C.__private__.getFont=C.getFont=function(){return he[gt.apply(C,arguments)]};C.__private__.getFontList=C.getFontList=function(){var e,t,n={};for(e in me)if(me.hasOwnProperty(e))for(t in n[e]=[],me[e])me[e].hasOwnProperty(t)&&n[e].push(t);return n},C.addFont=function(e,t,n,A,r){var i=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==i.indexOf(arguments[3])?r=arguments[3]:arguments[3]&&-1==i.indexOf(arguments[3])&&(n=w(n,A)),nt.call(this,e,t,n,r=r||"Identity-H")};var Ht,xt=e.lineWidth||.200025,Jt=C.__private__.getLineWidth=C.getLineWidth=function(){return xt},Yt=C.__private__.setLineWidth=C.setLineWidth=function(e){return xt=e,j(Z(V(e))+" w"),this};C.__private__.setLineDash=nB.API.setLineDash=nB.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map((function(e){return Z(V(e))})).join(" "),t=Z(V(t)),j("["+e+"] "+t+" d"),this};var Ut=C.__private__.getLineHeight=C.getLineHeight=function(){return te*Ht};C.__private__.getLineHeight=C.getLineHeight=function(){return te*Ht};var Lt=C.__private__.setLineHeightFactor=C.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Ht=e),this},Tt=C.__private__.getLineHeightFactor=C.getLineHeightFactor=function(){return Ht};Lt(e.lineHeight);var Kt=C.__private__.getHorizontalCoordinate=function(e){return V(e)},Mt=C.__private__.getVerticalCoordinate=function(e){return b===f?e:Se[Y].mediaBox.topRightY-Se[Y].mediaBox.bottomLeftY-V(e)},Qt=C.__private__.getHorizontalCoordinateString=C.getHorizontalCoordinateString=function(e){return Z(Kt(e))},Dt=C.__private__.getVerticalCoordinateString=C.getVerticalCoordinateString=function(e){return Z(Mt(e))},zt=e.strokeColor||"0 G";C.__private__.getStrokeColor=C.getDrawColor=function(){return Te(zt)},C.__private__.setStrokeColor=C.setDrawColor=function(e,t,n,A){return zt=Ke({ch1:e,ch2:t,ch3:n,ch4:A,pdfColorType:"draw",precision:2}),j(zt),this};var Ot=e.fillColor||"0 g";C.__private__.getFillColor=C.getFillColor=function(){return Te(Ot)},C.__private__.setFillColor=C.setFillColor=function(e,t,n,A){return Ot=Ke({ch1:e,ch2:t,ch3:n,ch4:A,pdfColorType:"fill",precision:2}),j(Ot),this};var Pt=e.textColor||"0 g",_t=C.__private__.getTextColor=C.getTextColor=function(){return Te(Pt)};C.__private__.setTextColor=C.setTextColor=function(e,t,n,A){return Pt=Ke({ch1:e,ch2:t,ch3:n,ch4:A,pdfColorType:"text",precision:3}),this};var jt=e.charSpace,qt=C.__private__.getCharSpace=C.getCharSpace=function(){return parseFloat(jt||0)};C.__private__.setCharSpace=C.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return jt=e,this};var $t=0;C.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},C.__private__.setLineCap=C.setLineCap=function(e){var t=C.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $t=t,j(t+" J"),this};var en=0;C.__private__.setLineJoin=C.setLineJoin=function(e){var t=C.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return en=t,j(t+" j"),this},C.__private__.setLineMiterLimit=C.__private__.setMiterLimit=C.setLineMiterLimit=C.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return j(Z(V(e))+" M"),this},C.GState=qb,C.setGState=function(e){(e="string"==typeof e?Be[ye[e]]:tn(null,e)).equals(we)||(j("/"+e.id+" gs"),we=e)};var tn=function(e,t){if(!e||!ye[e]){var n=!1;for(var A in Be)if(Be.hasOwnProperty(A)&&Be[A].equals(t)){n=!0;break}if(n)t=Be[A];else{var r="GS"+(Object.keys(Be).length+1).toString(10);Be[r]=t,t.id=r}return e&&(ye[e]=t.id),ve.publish("addGState",t),t}};C.addGState=function(e,t){return tn(e,t),this},C.saveGraphicsState=function(){return j("q"),pe.push({key:ce,size:te,color:Pt}),this},C.restoreGraphicsState=function(){j("Q");var e=pe.pop();return ce=e.key,te=e.size,Pt=e.color,we=null,this},C.setCurrentTransformationMatrix=function(e){return j(e.toString()+" cm"),this},C.comment=function(e){return j("#"+e),this};var nn=function(e,t){var n=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var A=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(e){isNaN(e)||(A=parseFloat(e))}});var r="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return r},set:function(e){r=e.toString()}}),this},An=function(e,t,n,A){nn.call(this,e,t),this.type="rect";var r=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var i=A||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}}),this},rn=function(){this.page=Ze,this.currentPage=Y,this.pages=z.slice(0),this.pagesContext=Se.slice(0),this.x=Ce,this.y=ue,this.matrix=de,this.width=an(Y),this.height=ln(Y),this.outputDestination=P,this.id="",this.objectNumber=-1};rn.prototype.restore=function(){Ze=this.page,Y=this.currentPage,Se=this.pagesContext,z=this.pages,Ce=this.x,ue=this.y,de=this.matrix,gn(Y,this.width),cn(Y,this.height),P=this.outputDestination};var on=function(e,t,n,A,r){Ne.push(new rn),Ze=Y=0,z=[],Ce=e,ue=t,de=r,rt([n,A])};for(var sn in C.beginFormObject=function(e,t,n,A,r){return on(e,t,n,A,r),this},C.endFormObject=function(e){return function(e){if(Ve[e])Ne.pop().restore();else{var t=new rn,n="Xo"+(Object.keys(Re).length+1).toString(10);t.id=n,Ve[e]=n,Re[n]=t,ve.publish("addFormObject",t),Ne.pop().restore()}}(e),this},C.doFormObject=function(e,t){var n=Re[Ve[e]];return j("q"),j(t.toString()+" cm"),j("/"+n.id+" Do"),j("Q"),this},C.getFormObject=function(e){var t=Re[Ve[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},C.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(kb(ht(dt()),e),"function"==typeof kb.unload&&wb.setTimeout&&setTimeout(kb.unload,911),this):new Promise((function(t,n){try{var A=kb(ht(dt()),e);"function"==typeof kb.unload&&wb.setTimeout&&setTimeout(kb.unload,911),t(A)}catch(r){n(r.message)}}))},nB.API)nB.API.hasOwnProperty(sn)&&("events"===sn&&nB.API.events.length?function(e,t){var n,A,r;for(r=t.length-1;-1!==r;r--)n=t[r][0],A=t[r][1],e.subscribe.apply(e,[n].concat("function"==typeof A?[A]:A))}(ve,nB.API.events):C[sn]=nB.API[sn]);var an=C.getPageWidth=function(e){return(Se[e=e||Y].mediaBox.topRightX-Se[e].mediaBox.bottomLeftX)/Ie},gn=C.setPageWidth=function(e,t){Se[e].mediaBox.topRightX=t*Ie+Se[e].mediaBox.bottomLeftX},ln=C.getPageHeight=function(e){return(Se[e=e||Y].mediaBox.topRightY-Se[e].mediaBox.bottomLeftY)/Ie},cn=C.setPageHeight=function(e,t){Se[e].mediaBox.topRightY=t*Ie+Se[e].mediaBox.bottomLeftY};return C.internal={pdfEscape:At,getStyle:St,getFont:Xt,getFontSize:Ae,getCharSpace:qt,getTextColor:_t,getLineHeight:Ut,getLineHeightFactor:Tt,getLineWidth:Jt,write:q,getHorizontalCoordinate:Kt,getVerticalCoordinate:Mt,getCoordinateString:Qt,getVerticalCoordinateString:Dt,collections:{},newObject:He,newAdditionalObject:Ye,newObjectDeferred:xe,newObjectDeferredBegin:Je,getFilters:Me,putStream:Qe,events:ve,scaleFactor:Ie,pageSize:{getWidth:function(){return an(Y)},setWidth:function(e){gn(Y,e)},getHeight:function(){return ln(Y)},setHeight:function(e){cn(Y,e)}},encryptionOptions:l,encryption:ft,getEncryptor:function(e){return null!==l?ft.encryptor(e,0):function(e){return e}},output:mt,getNumberOfPages:at,pages:z,out:j,f2:G,f3:R,getPageInfo:bt,getPageInfoByObjId:Bt,getCurrentPageInfo:yt,getPDFVersion:d,Point:nn,Rectangle:An,Matrix:ke,hasHotfix:pt},Object.defineProperty(C.internal.pageSize,"width",{get:function(){return an(Y)},set:function(e){gn(Y,e)},enumerable:!0,configurable:!0}),Object.defineProperty(C.internal.pageSize,"height",{get:function(){return ln(Y)},set:function(e){cn(Y,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,n=ee.length;t<n;t++){var A=nt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===c&&(I[A]=!0);var r=e[t][0].split("-");tt({id:A,fontName:r[0],fontStyle:r[1]||""})}ve.publish("addFonts",{fonts:he,dictionary:me})}.call(C,ee),ce="F1",it(r,n),ve.publish("initialized"),C}Pb.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Pb.prototype.toHexString=function(e){return e.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Pb.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Pb.prototype.processOwnerPassword=function(e,t){return zb(Mb(t).substr(0,5),e)},Pb.prototype.encryptor=function(e,t){var n=Mb(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return zb(n,e)}},qb.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Nf(e)!==Nf(this))return!1;var A=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;A++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&A--;return 0===A},nB.API={events:[]},nB.version="3.0.1";var AB=nB.API,rB=1,iB=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},oB=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},sB=function(e){return e.toFixed(2)},aB=function(e){return e.toFixed(5)};AB.__acroform__={};var gB=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},lB=function(e){return e*rB},cB=function(e){var t=new RB,n=TB.internal.getHeight(e)||0,A=TB.internal.getWidth(e)||0;return t.BBox=[0,0,Number(sB(A)),Number(sB(n))],t},IB=AB.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},CB=AB.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},uB=AB.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},dB=AB.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return uB(e,t-1)},hB=AB.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return IB(e,t-1)},mB=AB.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return CB(e,t-1)},pB=AB.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,A=t.internal.getVerticalCoordinate,r=e[0],i=e[1],o=e[2],s=e[3],a={};return a.lowerLeft_X=n(r)||0,a.lowerLeft_Y=A(i+s)||0,a.upperRight_X=n(r+o)||0,a.upperRight_Y=A(i)||0,[Number(sB(a.lowerLeft_X)),Number(sB(a.lowerLeft_Y)),Number(sB(a.upperRight_X)),Number(sB(a.upperRight_Y))]},fB=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,A=bB(e,n),r=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+r+" "+sB(A.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(A.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=cB(e);return i.scope=e.scope,i.stream=t.join("\n"),i}},bB=function(e,t){var n=0===e.fontSize?e.maxFontSize:e.fontSize,A={text:"",fontSize:""},r=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");r=e.multiline?r.map((function(e){return e.split("\n")})):r.map((function(e){return[e]}));var i=n,o=TB.internal.getHeight(e)||0;o=o<0?-o:o;var s=TB.internal.getWidth(e)||0;s=s<0?-s:s;var a=function(t,n,A){if(t+1<r.length){var i=n+" "+r[t+1][0];return BB(i,e,A).width<=s-4}return!1};i++;e:for(;i>0;){t="",i--;var g,l,c=BB("3",e,i).height,I=e.multiline?o-i:(o-c)/2,C=I+=2,u=0,d=0,h=0;if(i<=0){t="(...) Tj\n",t+="% Width of Text: "+BB(t,e,i=12).width+", FieldWidth:"+s+"\n";break}for(var m="",p=0,f=0;f<r.length;f++)if(r.hasOwnProperty(f)){var b=!1;if(1!==r[f].length&&h!==r[f].length-1){if((c+2)*(p+2)+2>o)continue e;m+=r[f][h],b=!0,d=f,f--}else{m=" "==(m+=r[f][h]+" ").substr(m.length-1)?m.substr(0,m.length-1):m;var B=parseInt(f),y=a(B,m,i),w=f>=r.length-1;if(y&&!w){m+=" ",h=0;continue}if(y||w){if(w)d=B;else if(e.multiline&&(c+2)*(p+2)+2>o)continue e}else{if(!e.multiline)continue e;if((c+2)*(p+2)+2>o)continue e;d=B}}for(var Z="",S=u;S<=d;S++){var v=r[S];if(e.multiline){if(S===d){Z+=v[h]+" ",h=(h+1)%v.length;continue}if(S===u){Z+=v[v.length-1]+" ";continue}}Z+=v[0]+" "}switch(Z=" "==Z.substr(Z.length-1)?Z.substr(0,Z.length-1):Z,l=BB(Z,e,i).width,e.textAlign){case"right":g=s-l-2;break;case"center":g=(s-l)/2;break;default:g=2}t+=sB(g)+" "+sB(C)+" Td\n",t+="("+iB(Z)+") Tj\n",t+=-sB(g)+" 0 Td\n",C=-(i+2),l=0,u=b?d:d+1,p++,m=""}break}return A.text=t,A.fontSize=i,A},BB=function(e,t,n){var A=t.scope.internal.getFont(t.fontName,t.fontStyle),r=t.scope.getStringUnitWidth(e,{font:A,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:A,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},yB={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},wB=function(e,t){var n={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find((function(e){return e.type===n.type&&e.object===n.object}))&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},ZB=function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(NB.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(yB)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");rB=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new VB,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",(function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})),e.internal.events.subscribe("buildDocument",(function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in t)if(t.hasOwnProperty(n)){var A=t[n];A.objId=void 0,A.hasAnnotation&&wB(A,e)}}(e)})),e.internal.events.subscribe("putCatalog",(function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)})),e.internal.events.subscribe("postPutPages",(function(t){!function(e,t){var n=!e;for(var A in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(A)){var r=e[A],i=[],o=r.Rect;if(r.Rect&&(r.Rect=pB(r.Rect,t)),t.internal.newObjectDeferredBegin(r.objId,!0),r.DA=TB.createDefaultAppearanceStream(r),"object"===Nf(r)&&"function"==typeof r.getKeyValueListForStream&&(i=r.getKeyValueListForStream()),r.Rect=o,r.hasAppearanceStream&&!r.appearanceStreamContent){var s=fB(r);i.push({key:"AP",value:"<</N "+s+">>"}),t.internal.acroformPlugin.xForms.push(s)}if(r.appearanceStreamContent){var a="";for(var g in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(g)){var l=r.appearanceStreamContent[g];if(a+="/"+g+" ",a+="<<",Object.keys(l).length>=1||Array.isArray(l)){for(var A in l)if(l.hasOwnProperty(A)){var c=l[A];"function"==typeof c&&(c=c.call(t,r)),a+="/"+A+" "+c+" ",t.internal.acroformPlugin.xForms.indexOf(c)>=0||t.internal.acroformPlugin.xForms.push(c)}}else"function"==typeof(c=l)&&(c=c.call(t,r)),a+="/"+A+" "+c,t.internal.acroformPlugin.xForms.indexOf(c)>=0||t.internal.acroformPlugin.xForms.push(c);a+=">>"}i.push({key:"AP",value:"<<\n"+a+">>"})}t.internal.putStream({additionalKeyValues:i,objectId:r.objId}),t.internal.out("endobj")}n&&function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var A=n,r=e[n];t.internal.newObjectDeferredBegin(r.objId,!0),"object"===Nf(r)&&"function"==typeof r.putStream&&r.putStream(),delete e[A]}}(t.internal.acroformPlugin.xForms,t)}(t,e)})),e.internal.acroformPlugin.isInitialized=!0}},SB=AB.__acroform__.arrayToPdfArray=function(e,t,n){var A=function(e){return e};if(Array.isArray(e)){for(var r="[",i=0;i<e.length;i++)switch(0!==i&&(r+=" "),Nf(e[i])){case"boolean":case"number":case"object":r+=e[i].toString();break;case"string":"/"!==e[i].substr(0,1)?(void 0!==t&&n&&(A=n.internal.getEncryptor(t)),r+="("+iB(A(e[i].toString()))+")"):r+=e[i].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},vB=function(e,t,n){var A=function(e){return e};return void 0!==t&&n&&(A=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+iB(A(e))+")"},GB=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};GB.prototype.toString=function(){return this.objId+" 0 R"},GB.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},GB.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter((function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)}));for(var n in t)if(!1===Object.getOwnPropertyDescriptor(this,t[n]).configurable){var A=t[n],r=this[A];r&&(Array.isArray(r)?e.push({key:A,value:SB(r,this.objId,this.scope)}):r instanceof GB?(r.scope=this.scope,e.push({key:A,value:r.objId+" 0 R"})):"function"!=typeof r&&e.push({key:A,value:r}))}return e};var RB=function(){GB.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};gB(RB,GB);var VB=function(){GB.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+iB(t(e))+")"}},set:function(t){e=t}})};gB(VB,GB);var NB=function e(){GB.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(t,3))},set:function(e){!0===Boolean(e)?this.F=hB(t,3):this.F=mB(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');n=e}});var A=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==A.length)return A},set:function(e){A=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!A||isNaN(A[0])?0:A[0]},set:function(e){A[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!A||isNaN(A[1])?0:A[1]},set:function(e){A[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!A||isNaN(A[2])?0:A[2]},set:function(e){A[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!A||isNaN(A[3])?0:A[3]},set:function(e){A[3]=e}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof JB)return;i="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+iB(t(i))+")"},set:function(e){i=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(e){i=e}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var s="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){s=e}});var a=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){a=e}});var g=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===g?50/rB:g},set:function(e){g=e}});var l="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!c||this instanceof JB||this instanceof UB))return vB(c,this.objId,this.scope)},set:function(e){e=e.toString(),c=e}});var I=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(I)return this instanceof XB==0?vB(I,this.objId,this.scope):I},set:function(e){e=e.toString(),I=this instanceof XB==0?"("===e.substr(0,1)?oB(e.substr(1,e.length-2)):oB(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof XB==1?oB(I.substr(1,I.length-1)):I},set:function(e){e=e.toString(),I=this instanceof XB==1?"/"+e:e}});var C=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(C)return C},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(C)return this instanceof XB==0?vB(C,this.objId,this.scope):C},set:function(e){e=e.toString(),C=this instanceof XB==0?"("===e.substr(0,1)?oB(e.substr(1,e.length-2)):oB(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof XB==1?oB(C.substr(1,C.length-1)):C},set:function(e){e=e.toString(),C=this instanceof XB==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var u,d=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){e=Boolean(e),d=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(u)return u},set:function(e){u=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,1):this.Ff=mB(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,2):this.Ff=mB(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,3):this.Ff=mB(this.Ff,3)}});var h=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==h)return h},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');h=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(h){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:h=2;break;case"center":case 1:h=1;break;default:h=0}}})};gB(NB,GB);var kB=function(){NB.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return SB(t,this.objId,this.scope)},set:function(e){var n,A;A=[],"string"==typeof(n=e)&&(A=function(e,t,n){n||(n=1);for(var A,r=[];A=t.exec(e);)r.push(A[n]);return r}(n,/\((.*?)\)/g)),t=A}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,18):this.Ff=mB(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=hB(this.Ff,19):this.Ff=mB(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=hB(this.Ff,20),t.sort()):this.Ff=mB(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,22):this.Ff=mB(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,23):this.Ff=mB(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,27):this.Ff=mB(this.Ff,27)}}),this.hasAppearanceStream=!1};gB(kB,NB);var WB=function(){kB.call(this),this.fontName="helvetica",this.combo=!1};gB(WB,kB);var FB=function(){WB.call(this),this.combo=!0};gB(FB,WB);var EB=function(){FB.call(this),this.edit=!0};gB(EB,FB);var XB=function(){NB.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,15):this.Ff=mB(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,16):this.Ff=mB(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,17):this.Ff=mB(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,26):this.Ff=mB(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var n,A=[];for(n in A.push("<<"),t)A.push("/"+n+" ("+iB(e(t[n]))+")");return A.push(">>"),A.join("\n")}},set:function(e){"object"===Nf(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};gB(XB,NB);var HB=function(){XB.call(this),this.pushButton=!0};gB(HB,XB);var xB=function(){XB.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};gB(xB,XB);var JB=function(){var e,t;NB.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var n,A={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,n=[];for(t in n.push("<<"),A)n.push("/"+t+" ("+iB(e(A[t]))+")");return n.push(">>"),n.join("\n")},set:function(e){"object"===Nf(e)&&(A=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return A.CA||""},set:function(e){"string"==typeof e&&(A.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(e){n="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=TB.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};gB(JB,NB),xB.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},xB.prototype.createOption=function(e){var t=new JB;return t.Parent=this,t.optionName=e,this.Kids.push(t),KB.call(this.scope,t),t};var YB=function(){XB.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=TB.CheckBox.createAppearanceStream()};gB(YB,XB);var UB=function(){NB.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,13):this.Ff=mB(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,21):this.Ff=mB(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,23):this.Ff=mB(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,24):this.Ff=mB(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,25):this.Ff=mB(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,26):this.Ff=mB(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};gB(UB,NB);var LB=function(){UB.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(dB(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=hB(this.Ff,14):this.Ff=mB(this.Ff,14)}}),this.password=!0};gB(LB,UB);var TB={CheckBox:{createAppearanceStream:function(){return{N:{On:TB.CheckBox.YesNormal},D:{On:TB.CheckBox.YesPushDown,Off:TB.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=[],A=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=bB(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+sB(TB.internal.getWidth(e))+" "+sB(TB.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+A+" "+sB(i.fontSize)+" Tf "+r),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join("\n"),t},YesNormal:function(e){var t=cB(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,A=e.scope.__private__.encodeColorString(e.color),r=[],i=TB.internal.getHeight(e),o=TB.internal.getWidth(e),s=bB(e,e.caption);return r.push("1 g"),r.push("0 0 "+sB(o)+" "+sB(i)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+sB(o-1)+" "+sB(i-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+sB(s.fontSize)+" Tf "+A),r.push(s.text),r.push("ET"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+sB(TB.internal.getWidth(e))+" "+sB(TB.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:TB.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=TB.RadioButton.Circle.YesNormal,t.D[e]=TB.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=cB(e);t.scope=e.scope;var n=[],A=TB.internal.getWidth(e)<=TB.internal.getHeight(e)?TB.internal.getWidth(e)/4:TB.internal.getHeight(e)/4;A=Number((.9*A).toFixed(5));var r=TB.internal.Bezier_C,i=Number((A*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+aB(TB.internal.getWidth(e)/2)+" "+aB(TB.internal.getHeight(e)/2)+" cm"),n.push(A+" 0 m"),n.push(A+" "+i+" "+i+" "+A+" 0 "+A+" c"),n.push("-"+i+" "+A+" -"+A+" "+i+" -"+A+" 0 c"),n.push("-"+A+" -"+i+" -"+i+" -"+A+" 0 -"+A+" c"),n.push(i+" -"+A+" "+A+" -"+i+" "+A+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=[],A=TB.internal.getWidth(e)<=TB.internal.getHeight(e)?TB.internal.getWidth(e)/4:TB.internal.getHeight(e)/4;A=Number((.9*A).toFixed(5));var r=Number((2*A).toFixed(5)),i=Number((r*TB.internal.Bezier_C).toFixed(5)),o=Number((A*TB.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+aB(TB.internal.getWidth(e)/2)+" "+aB(TB.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+aB(TB.internal.getWidth(e)/2)+" "+aB(TB.internal.getHeight(e)/2)+" cm"),n.push(A+" 0 m"),n.push(A+" "+o+" "+o+" "+A+" 0 "+A+" c"),n.push("-"+o+" "+A+" -"+A+" "+o+" -"+A+" 0 c"),n.push("-"+A+" -"+o+" -"+o+" -"+A+" 0 -"+A+" c"),n.push(o+" -"+A+" "+A+" -"+o+" "+A+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=[],A=TB.internal.getWidth(e)<=TB.internal.getHeight(e)?TB.internal.getWidth(e)/4:TB.internal.getHeight(e)/4;A=Number((.9*A).toFixed(5));var r=Number((2*A).toFixed(5)),i=Number((r*TB.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+aB(TB.internal.getWidth(e)/2)+" "+aB(TB.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:TB.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=TB.RadioButton.Cross.YesNormal,t.D[e]=TB.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=cB(e);t.scope=e.scope;var n=[],A=TB.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+sB(TB.internal.getWidth(e)-2)+" "+sB(TB.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(sB(A.x1.x)+" "+sB(A.x1.y)+" m"),n.push(sB(A.x2.x)+" "+sB(A.x2.y)+" l"),n.push(sB(A.x4.x)+" "+sB(A.x4.y)+" m"),n.push(sB(A.x3.x)+" "+sB(A.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=TB.internal.calculateCross(e),A=[];return A.push("0.749023 g"),A.push("0 0 "+sB(TB.internal.getWidth(e))+" "+sB(TB.internal.getHeight(e))+" re"),A.push("f"),A.push("q"),A.push("1 1 "+sB(TB.internal.getWidth(e)-2)+" "+sB(TB.internal.getHeight(e)-2)+" re"),A.push("W"),A.push("n"),A.push(sB(n.x1.x)+" "+sB(n.x1.y)+" m"),A.push(sB(n.x2.x)+" "+sB(n.x2.y)+" l"),A.push(sB(n.x4.x)+" "+sB(n.x4.y)+" m"),A.push(sB(n.x3.x)+" "+sB(n.x3.y)+" l"),A.push("s"),A.push("Q"),t.stream=A.join("\n"),t},OffPushDown:function(e){var t=cB(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+sB(TB.internal.getWidth(e))+" "+sB(TB.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};TB.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=TB.internal.getWidth(e),n=TB.internal.getHeight(e),A=Math.min(t,n);return{x1:{x:(t-A)/2,y:(n-A)/2+A},x2:{x:(t-A)/2+A,y:(n-A)/2},x3:{x:(t-A)/2,y:(n-A)/2},x4:{x:(t-A)/2+A,y:(n-A)/2+A}}}},TB.internal.getWidth=function(e){var t=0;return"object"===Nf(e)&&(t=lB(e.Rect[2])),t},TB.internal.getHeight=function(e){var t=0;return"object"===Nf(e)&&(t=lB(e.Rect[3])),t};var KB=AB.addField=function(e){if(ZB(this,e),!(e instanceof NB))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};function MB(e){return e.reduce((function(e,t,n){return e[t]=n,e}),{})}AB.AcroFormChoiceField=kB,AB.AcroFormListBox=WB,AB.AcroFormComboBox=FB,AB.AcroFormEditBox=EB,AB.AcroFormButton=XB,AB.AcroFormPushButton=HB,AB.AcroFormRadioButton=xB,AB.AcroFormCheckBox=YB,AB.AcroFormTextField=UB,AB.AcroFormPasswordField=LB,AB.AcroFormAppearance=TB,AB.AcroForm={ChoiceField:kB,ListBox:WB,ComboBox:FB,EditBox:EB,Button:XB,PushButton:HB,RadioButton:xB,CheckBox:YB,TextField:UB,PasswordField:LB,Appearance:TB},nB.AcroForm={ChoiceField:kB,ListBox:WB,ComboBox:FB,EditBox:EB,Button:XB,PushButton:HB,RadioButton:xB,CheckBox:YB,TextField:UB,PasswordField:LB,Appearance:TB},nB.AcroForm,function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},A=e.__addimage__.getImageFileTypeByImageData=function(e,A){var r,i,o,s,a,g=t;if("RGBA"===(A=A||t)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(y(e))for(a in n)for(o=n[a],r=0;r<o.length;r+=1){for(s=!0,i=0;i<o[r].length;i+=1)if(void 0!==o[r][i]&&o[r][i]!==e[i]){s=!1;break}if(!0===s){g=a;break}}else for(a in n)for(o=n[a],r=0;r<o.length;r+=1){for(s=!0,i=0;i<o[r].length;i+=1)if(void 0!==o[r][i]&&o[r][i]!==e.charCodeAt(i)){s=!1;break}if(!0===s){g=a;break}}return g===t&&A!==t&&(g=A),g},r=function e(t){for(var n=this.internal.write,A=this.internal.putStream,r=(0,this.internal.getFilters)();-1!==r.indexOf("FlateEncode");)r.splice(r.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var i=[];if(i.push({key:"Type",value:"/XObject"}),i.push({key:"Subtype",value:"/Image"}),i.push({key:"Width",value:t.width}),i.push({key:"Height",value:t.height}),t.colorSpace===h.INDEXED?i.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(i.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===h.DEVICE_CMYK&&i.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),i.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&i.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var o="",s=0,a=t.transparency.length;s<a;s++)o+=t.transparency[s]+" "+t.transparency[s]+" ";i.push({key:"Mask",value:"["+o+"]"})}void 0!==t.sMask&&i.push({key:"SMask",value:t.objectId+1+" 0 R"});var g=void 0!==t.filter?["/"+t.filter]:void 0;if(A({data:t.data,additionalKeyValues:i,alreadyAppliedFilters:g,objectId:t.objectId}),n("endobj"),"sMask"in t&&void 0!==t.sMask){var l="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,c={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:l,data:t.sMask};"filter"in t&&(c.filter=t.filter),e.call(this,c)}if(t.colorSpace===h.INDEXED){var I=this.internal.newObject();A({data:Z(new Uint8Array(t.palette)),objectId:I}),n("endobj")}},i=function(){var e=this.internal.collections.addImage_images;for(var t in e)r.call(this,e[t])},o=function(){var e,t=this.internal.collections.addImage_images,n=this.internal.write;for(var A in t)n("/I"+(e=t[A]).index,e.objectId,"0","R")},s=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},a=function(){var e=this.internal.collections.addImage_images;return s.call(this),e},g=function(){return Object.keys(this.internal.collections.addImage_images).length},l=function(t){return"function"==typeof e["process"+t.toUpperCase()]},c=function(e){return"object"===Nf(e)&&1===e.nodeType},I=function(t,n){if("IMG"===t.nodeName&&t.hasAttribute("src")){var A=""+t.getAttribute("src");if(0===A.indexOf("data:image/"))return Vb(unescape(A).split("base64,").pop());var r=e.loadFile(A,!0);if(void 0!==r)return r}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var i;switch(n){case"PNG":i="image/png";break;case"WEBP":i="image/webp";break;default:i="image/jpeg"}return Vb(t.toDataURL(i,1).split("base64,").pop())}},C=function(e){var t=this.internal.collections.addImage_images;if(t)for(var n in t)if(e===t[n].alias)return t[n]},u=function(e,t,n){return e||t||(e=-96,t=-96),e<0&&(e=-1*n.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*n.height*72/t/this.internal.scaleFactor),0===e&&(e=t*n.width/n.height),0===t&&(t=e*n.height/n.width),[e,t]},d=function(e,t,n,A,r,i){var o=u.call(this,n,A,r),s=this.internal.getCoordinateString,g=this.internal.getVerticalCoordinateString,l=a.call(this);if(n=o[0],A=o[1],l[r.index]=r,i){i*=Math.PI/180;var c=Math.cos(i),I=Math.sin(i),C=function(e){return e.toFixed(4)},d=[C(c),C(I),C(-1*I),C(c),0,0,"cm"]}this.internal.write("q"),i?(this.internal.write([1,"0","0",1,s(e),g(t+A),"cm"].join(" ")),this.internal.write(d.join(" ")),this.internal.write([s(n),"0","0",s(A),"0","0","cm"].join(" "))):this.internal.write([s(n),"0","0",s(A),s(e),g(t+A),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+r.index+" Do"),this.internal.write("Q")},h=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},p=e.__addimage__.sHashCode=function(e){var t,n,A=0;if("string"==typeof e)for(n=e.length,t=0;t<n;t++)A=(A<<5)-A+e.charCodeAt(t),A|=0;else if(y(e))for(n=e.byteLength/2,t=0;t<n;t++)A=(A<<5)-A+e[t],A|=0;return A},f=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},b=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null},B=e.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};e.__addimage__.isArrayBuffer=function(e){return B()&&e instanceof ArrayBuffer};var y=e.__addimage__.isArrayBufferView=function(e){return B()&&"undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)},w=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),A=0;A<t;A++)n[A]=e.charCodeAt(A);return n},Z=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",n=y(e)?e:new Uint8Array(e),A=0;A<n.length;A+=8192)t+=String.fromCharCode.apply(null,n.subarray(A,A+8192));return t};e.addImage=function(){var e,n,A,r,i,o,a,g,l;if("number"==typeof arguments[1]?(n=t,A=arguments[1],r=arguments[2],i=arguments[3],o=arguments[4],a=arguments[5],g=arguments[6],l=arguments[7]):(n=arguments[1],A=arguments[2],r=arguments[3],i=arguments[4],o=arguments[5],a=arguments[6],g=arguments[7],l=arguments[8]),"object"===Nf(e=arguments[0])&&!c(e)&&"imageData"in e){var I=e;e=I.imageData,n=I.format||n||t,A=I.x||A||0,r=I.y||r||0,i=I.w||I.width||i,o=I.h||I.height||o,a=I.alias||a,g=I.compression||g,l=I.rotation||I.angle||l}var C=this.internal.getFilters();if(void 0===g&&-1!==C.indexOf("FlateEncode")&&(g="SLOW"),isNaN(A)||isNaN(r))throw new Error("Invalid coordinates passed to jsPDF.addImage");s.call(this);var u=S.call(this,e,n,a,g);return d.call(this,A,r,i,o,u,l),this};var S=function(n,r,i,o){var s,a,u,d;if("string"==typeof n&&A(n)===t){n=unescape(n);var h=v(n,!1);(""!==h||void 0!==(h=e.loadFile(n,!0)))&&(n=h)}if(c(n)&&(n=I(n,r)),r=A(n,r),!l(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if((null==(u=i)||0===u.length)&&(i="string"==typeof(d=n)||y(d)?p(d):y(d.data)?p(d.data):null),(s=C.call(this,i))||(B()&&(n instanceof Uint8Array||"RGBA"===r||(a=n,n=w(n))),s=this["process"+r.toUpperCase()](n,g.call(this),i,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:m.NONE}(o),a)),!s)throw new Error("An unknown error occurred whilst processing the image.");return s},v=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var n,A="";if("string"==typeof e){var r;n=null!==(r=b(e))&&void 0!==r?r:e;try{A=Vb(n)}catch(i){if(t)throw f(n)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+i.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return A};e.getImageProperties=function(n){var r,i,o="";if(c(n)&&(n=I(n)),"string"==typeof n&&A(n)===t&&(""===(o=v(n,!1))&&(o=e.loadFile(n)||""),n=o),i=A(n),!l(i))throw new Error("addImage does not support files of type '"+i+"', please ensure that a plugin for '"+i+"' support is added.");if(!B()||n instanceof Uint8Array||(n=w(n)),!(r=this["process"+i.toUpperCase()](n)))throw new Error("An unknown error occurred whilst processing the image");return r.fileType=i,r}}(nB.API),
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};nB.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var n,A,r,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,s=this.internal.getPageInfoByObjId(e.objId),a=e.pageContext.annotations,g=!1,l=0;l<a.length&&!g;l++)switch((n=a[l]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(g=!0);break;case"reference":case"text":case"freetext":g=!0}if(0!=g){this.internal.write("/Annots [");for(var c=0;c<a.length;c++){n=a[c];var I=this.internal.pdfEscape,C=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var u=this.internal.newAdditionalObject(),d=this.internal.newAdditionalObject(),h=this.internal.getEncryptor(u.objId),m=n.title||"Note";r="<</Type /Annot /Subtype /Text "+(A="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+I(h(n.contents))+")",r+=" /Popup "+d.objId+" 0 R",r+=" /P "+s.objId+" 0 R",r+=" /T ("+I(h(m))+") >>",u.content=r;var p=u.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(A="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+p,n.open&&(r+=" /Open true"),r+=" >>",d.content=r,this.internal.write(u.objId,"0 R",d.objId,"0 R");break;case"freetext":A="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var f=n.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+A+"/Contents ("+I(C(n.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+f+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(n.options.name){var b=this.annotations._nameMap[n.options.name];n.options.pageNumber=b.page,n.options.top=b.y}else n.options.top||(n.options.top=0);if(A="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",r="",n.options.url)r="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /A <</S /URI /URI ("+I(C(n.options.url))+") >>";else if(n.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,r+=" /FitV "+n.options.left+"]";break;default:var B=o(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),r+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}""!=r&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,n,A,r){var i=this.internal.getCurrentPageInfo(),o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString;i.pageContext.annotations.push({finalBounds:{x:o(e),y:s(t),w:o(e+n),h:s(t+A)},options:r,type:"link"})},e.textWithLink=function(e,t,n,A){var r,i,o=this.getTextWidth(e),s=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==A.maxWidth){i=A.maxWidth;var a=this.splitTextToSize(e,i).length;r=Math.ceil(s*a)}else i=o,r=s;return this.text(e,t,n,A),n+=.2*s,"center"===A.align&&(t-=o/2),"right"===A.align&&(t-=o),this.link(t,n-s,i,r,A),o},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(nB.API),
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},A={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},o=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},s=e.__arabicParser__.isArabicEndLetter=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length<=2},a=e.__arabicParser__.isArabicAlfLetter=function(e){return o(e)&&r.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=1};var g=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=3};var l=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return o(e)&&i(e)&&4==t[e.charCodeAt(0)].length},c=e.__arabicParser__.resolveLigatures=function(e){var t=0,A=n,r="",i=0;for(t=0;t<e.length;t+=1)void 0!==A[e.charCodeAt(t)]?(i++,"number"==typeof(A=A[e.charCodeAt(t)])&&(r+=String.fromCharCode(A),A=n,i=0),t===e.length-1&&(A=n,r+=e.charAt(t-(i-1)),t-=i-1,i=0)):(A=n,r+=e.charAt(t-i),t-=i,i=0);return r};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==A[e.charCodeAt(0)]};var I=e.__arabicParser__.getCorrectForm=function(e,t,n){return o(e)?!1===i(e)?-1:!g(e)||!o(t)&&!o(n)||!o(n)&&s(t)||s(e)&&!o(t)||s(e)&&a(t)||s(e)&&s(t)?0:l(e)&&o(t)&&!s(t)&&o(n)&&g(n)?3:s(e)||!o(n)?1:2:-1},C=function(e){var n=0,A=0,r=0,i="",s="",a="",g=(e=e||"").split("\\s+"),l=[];for(n=0;n<g.length;n+=1){for(l.push(""),A=0;A<g[n].length;A+=1)i=g[n][A],s=g[n][A-1],a=g[n][A+1],o(i)?(r=I(i,s,a),l[n]+=-1!==r?String.fromCharCode(t[i.charCodeAt(0)][r]):i):l[n]+=i;l[n]=c(l[n])}return l.join(" ")},u=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(t)){var A=0;for(n=[],A=0;A<t.length;A+=1)Array.isArray(t[A])?n.push([C(t[A][0]),t[A][1],t[A][2]]):n.push([C(t[A])]);e=n}else e=C(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",u])}(nB.API),nB.API.autoPrint=function(e){var t;if("javascript"===((e=e||{}).variant=e.variant||"non-conform",e.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",(function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+t+" 0 R")}));return this},
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(e){n=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var A=[];Object.defineProperty(this,"childNodes",{get:function(){return A},set:function(e){A=e}});var r={};Object.defineProperty(this,"style",{get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var n;if("2d"!==(e=e||"2d"))return null;for(n in t)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=t[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(nB.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,A=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var A=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return A},set:function(e){A=e}});var r=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var i=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return i},set:function(e){i=e}});var o=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return o},set:function(e){o=e}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return A.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){A.call(this);var n=(t=t||{}).fontSize||this.getFontSize(),r=t.font||this.getFont(),i=t.scaleFactor||this.internal.scaleFactor,o=0,s=0,a=0,g=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var l=t.maxWidth;l>0?"string"==typeof e?e=this.splitTextToSize(e,l):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce((function(e,t){return e.concat(g.splitTextToSize(t,l))}),[])):e=Array.isArray(e)?e:[e];for(var c=0;c<e.length;c++)o<(a=this.getStringUnitWidth(e[c],{font:r})*n)&&(o=a);return 0!==o&&(s=e.length),{w:o/=i,h:Math.max((s*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/i,0)}},e.cellAddPage=function(){A.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var e;e=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),A.call(this);var r=this.internal.__cell__.lastCell,o=this.internal.__cell__.padding,s=this.internal.__cell__.margins||t,a=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return void 0!==r.lineNumber&&(r.lineNumber===e.lineNumber?(e.x=(r.x||0)+(r.width||0),e.y=r.y||0):r.y+r.height+e.height+s.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=s.top,g&&a&&(this.printHeaderRow(e.lineNumber,!0),e.y+=a[0].height)):e.y=r.y+r.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===n?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-o,e.y+o,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+o,{align:"center",baseline:"top",maxWidth:e.width-o-o}):this.text(e.text,e.x+o,e.y+o,{align:"left",baseline:"top",maxWidth:e.width-o-o})),this.internal.__cell__.lastCell=e,this};e.table=function(e,n,a,g,l){if(A.call(this),!a)throw new Error("No data for PDF table.");var c,I,C,u,d=[],h=[],m=[],p={},f={},b=[],B=[],y=(l=l||{}).autoSize||!1,w=!1!==l.printHeaders,Z=l.css&&void 0!==l.css["font-size"]?16*l.css["font-size"]:l.fontSize||12,S=l.margins||Object.assign({width:this.getPageWidth()},t),v="number"==typeof l.padding?l.padding:3,G=l.headerBackgroundColor||"#c8c8c8",R=l.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=w,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=Z,this.internal.__cell__.padding=v,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=R,this.setFontSize(Z),null==g)h=d=Object.keys(a[0]),m=d.map((function(){return"left"}));else if(Array.isArray(g)&&"object"===Nf(g[0]))for(d=g.map((function(e){return e.name})),h=g.map((function(e){return e.prompt||e.name||""})),m=g.map((function(e){return e.align||"left"})),c=0;c<g.length;c+=1)f[g[c].name]=g[c].width*(19.049976/25.4);else Array.isArray(g)&&"string"==typeof g[0]&&(h=d=g,m=d.map((function(){return"left"})));if(y||Array.isArray(g)&&"string"==typeof g[0])for(c=0;c<d.length;c+=1){for(p[u=d[c]]=a.map((function(e){return e[u]})),this.setFont(void 0,"bold"),b.push(this.getTextDimensions(h[c],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),I=p[u],this.setFont(void 0,"normal"),C=0;C<I.length;C+=1)b.push(this.getTextDimensions(I[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);f[u]=Math.max.apply(null,b)+v+v,b=[]}if(w){var V={};for(c=0;c<d.length;c+=1)V[d[c]]={},V[d[c]].text=h[c],V[d[c]].align=m[c];var N=s.call(this,V,f);B=d.map((function(t){return new i(e,n,f[t],N,V[t].text,void 0,V[t].align)})),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var k=g.reduce((function(e,t){return e[t.name]=t.align,e}),{});for(c=0;c<a.length;c+=1){"rowStart"in l&&l.rowStart instanceof Function&&l.rowStart({row:c,data:a[c]},this);var W=s.call(this,a[c],f);for(C=0;C<d.length;C+=1){var F=a[c][d[C]];"cellStart"in l&&l.cellStart instanceof Function&&l.cellStart({row:c,col:C,data:F},this),o.call(this,new i(e,n,f[d[C]],W,F,c+2,k[d[C]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=n,this};var s=function(e,t){var n=this.internal.__cell__.padding,A=this.internal.__cell__.table_font_size,r=this.internal.scaleFactor;return Object.keys(e).map((function(A){var r=e[A];return this.splitTextToSize(r.hasOwnProperty("text")?r.text:r,t[A]-n-n)}),this).map((function(e){return this.getLineHeightFactor()*e.length*A/r+n+n}),this).reduce((function(e,t){return Math.max(e,t)}),0)};e.setTableHeaderRow=function(e){A.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(A.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var r;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var s=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(s[0],s[1],s[2],s[3],void 0,-1)}this.setFont(void 0,"bold");for(var a=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){r=this.internal.__cell__.tableHeaderRow[g].clone(),t&&(r.y=this.internal.__cell__.margins.top||0,a.push(r)),r.lineNumber=e;var l=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,r),this.setTextColor(l)}a.length>0&&this.setTableHeaderRow(a),this.setFont(void 0,"normal"),n=!1}}(nB.API);var QB={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},DB=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],zB=MB(DB),OB=[100,200,300,400,500,600,700,800,900],PB=MB(OB);function _B(e){var t,n=e.family.replace(/"|'/g,"").toLowerCase(),A=(t=e.style,QB[t=t||"normal"]?t:"normal"),r=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),i=function(e){return"number"==typeof zB[e=e||"normal"]?e:"normal"}(e.stretch);return{family:n,style:A,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:n,style:[i,A,r].join(" ")}}}function jB(e,t,n,A){var r;for(r=n;r>=0&&r<t.length;r+=A)if(e[t[r]])return e[t[r]];for(r=n;r>=0&&r<t.length;r-=A)if(e[t[r]])return e[t[r]]}var qB={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},$B={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ey(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function ty(e){return e.trimLeft()}function ny(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function Ay(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var ry,iy,oy,sy,ay=["times"];!function(e){var t,n,A,r,i,o,s,a,g,l=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new a,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new o,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new o,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new c(this),t=this.internal.f2,n=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,s=this.internal.Rectangle,a=this.internal.Matrix,g=new l}]);var c=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var A=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return A},set:function(e){A=Boolean(e)}});var r=0;Object.defineProperty(this,"posX",{get:function(){return r},set:function(e){isNaN(e)||(r=e)}});var i=0;Object.defineProperty(this,"posY",{get:function(){return i},set:function(e){isNaN(e)||(i=e)}}),Object.defineProperty(this,"margin",{get:function(){return g.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),g.margin=t}});var o=!1;Object.defineProperty(this,"autoPaging",{get:function(){return o},set:function(e){o=e}});var s=0;Object.defineProperty(this,"lastBreak",{get:function(){return s},set:function(e){s=e}});var a=[];Object.defineProperty(this,"pageBreaks",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"ctx",{get:function(){return g},set:function(e){e instanceof l&&(g=e)}}),Object.defineProperty(this,"path",{get:function(){return g.path},set:function(e){g.path=e}});var c=[];Object.defineProperty(this,"ctxStack",{get:function(){return c},set:function(e){c=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=I(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=I(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var C=null;var u=null;Object.defineProperty(this,"fontFaces",{get:function(){return u},set:function(e){C=null,u=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var n=t[1];t[2];var A=t[3],r=t[4];t[5];var i=t[6],o=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(r)[2];r="px"===o?Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor):"em"===o?Math.floor(parseFloat(r)*this.pdf.getFontSize()):Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(r);var s=function(e){var t,n,A=[],r=e.trim();if(""===r)return ay;if(r in $B)return[$B[r]];for(;""!==r;){switch(n=null,t=(r=ty(r)).charAt(0)){case'"':case"'":n=ny(r.substring(1),t);break;default:n=Ay(r)}if(null===n)return ay;if(A.push(n[0]),""!==(r=ty(n[1]))&&","!==r.charAt(0))return ay;r=r.replace(/^,/,"")}return A}(i);if(this.fontFaces){var a=function(e,t,n){for(var A=(n=n||{}).defaultFontFamily||"times",r=Object.assign({},qB,n.genericFontFamilies||{}),i=null,o=null,s=0;s<t.length;++s)if(r[(i=_B(t[s])).family]&&(i.family=r[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[A]))throw new Error("Could not find a font-family for the rule '"+ey(i)+"' and default family '"+A+"'.");if(o=function(e,t){if(t[e])return t[e];var n=zB[e],A=n<=zB.normal?-1:1,r=jB(t,DB,n,A);if(!r)throw new Error("Could not find a matching font-stretch value for "+e);return r}(i.stretch,o),o=function(e,t){if(t[e])return t[e];for(var n=QB[e],A=0;A<n.length;++A)if(t[n[A]])return t[n[A]];throw new Error("Could not find a matching font-style for "+e)}(i.style,o),!(o=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var n=PB[e],A=jB(t,OB,n,e<400?-1:1);if(!A)throw new Error("Could not find a matching font-weight for value "+e);return A}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+ey(i)+"'.");return o}(function(e,t){if(null===C){var n=(A=e.getFontList(),r=[],Object.keys(A).forEach((function(e){A[e].forEach((function(t){var n=null;switch(t){case"bold":n={family:e,weight:"bold"};break;case"italic":n={family:e,style:"italic"};break;case"bolditalic":n={family:e,weight:"bold",style:"italic"};break;case"":case"normal":n={family:e}}null!==n&&(n.ref={name:e,style:t},r.push(n))}))})),r);C=function(e){for(var t={},n=0;n<e.length;++n){var A=_B(e[n]),r=A.family,i=A.stretch,o=A.style,s=A.weight;t[r]=t[r]||{},t[r][i]=t[r][i]||{},t[r][i][o]=t[r][i][o]||{},t[r][i][o][s]=A}return t}(n.concat(t))}var A,r;return C}(this.pdf,this.fontFaces),s.map((function(e){return{family:e,stretch:"normal",weight:A,style:n}})));this.pdf.setFont(a.ref.name,a.ref.style)}else{var g="";("bold"===A||parseInt(A,10)>=700||"bold"===n)&&(g="bold"),"italic"===n&&(g+="italic"),0===g.length&&(g="normal");for(var l="",c={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},I=0;I<s.length;I++){if(void 0!==this.pdf.internal.getFont(s[I],g,{noFallback:!0,disableWarning:!0})){l=s[I];break}if("bolditalic"===g&&void 0!==this.pdf.internal.getFont(s[I],"bold",{noFallback:!0,disableWarning:!0}))l=s[I],g="bold";else if(void 0!==this.pdf.internal.getFont(s[I],"normal",{noFallback:!0,disableWarning:!0})){l=s[I],g="normal";break}}if(""===l)for(var u=0;u<s.length;u++)if(c[s[u]]){l=c[s[u]];break}l=""===l?"Times":l,this.pdf.setFont(l,g)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,x.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,x.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};c.prototype.setLineDash=function(e){this.lineDash=e},c.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},c.prototype.fill=function(){b.call(this,"fill",!1)},c.prototype.stroke=function(){b.call(this,"stroke",!1)},c.prototype.beginPath=function(){this.path=[{type:"begin"}]},c.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw Sb.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new o(e,t)},c.prototype.closePath=function(){var e=new o(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===Nf(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new o(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(e.x,e.y)},c.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw Sb.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new o(n.x,n.y)},c.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},c.prototype.quadraticCurveTo=function(e,t,n,A){if(isNaN(n)||isNaN(A)||isNaN(e)||isNaN(t))throw Sb.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var r=this.ctx.transform.applyToPoint(new o(n,A)),i=this.ctx.transform.applyToPoint(new o(e,t));this.path.push({type:"qct",x1:i.x,y1:i.y,x:r.x,y:r.y}),this.ctx.lastPoint=new o(r.x,r.y)},c.prototype.bezierCurveTo=function(e,t,n,A,r,i){if(isNaN(r)||isNaN(i)||isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A))throw Sb.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var s=this.ctx.transform.applyToPoint(new o(r,i)),a=this.ctx.transform.applyToPoint(new o(e,t)),g=this.ctx.transform.applyToPoint(new o(n,A));this.path.push({type:"bct",x1:a.x,y1:a.y,x2:g.x,y2:g.y,x:s.x,y:s.y}),this.ctx.lastPoint=new o(s.x,s.y)},c.prototype.arc=function(e,t,n,A,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||isNaN(r))throw Sb.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(i=Boolean(i),!this.ctx.transform.isIdentity){var s=this.ctx.transform.applyToPoint(new o(e,t));e=s.x,t=s.y;var a=this.ctx.transform.applyToPoint(new o(0,n)),g=this.ctx.transform.applyToPoint(new o(0,0));n=Math.sqrt(Math.pow(a.x-g.x,2)+Math.pow(a.y-g.y,2))}Math.abs(r-A)>=2*Math.PI&&(A=0,r=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:n,startAngle:A,endAngle:r,counterclockwise:i})},c.prototype.arcTo=function(e,t,n,A,r){throw new Error("arcTo not implemented.")},c.prototype.rect=function(e,t,n,A){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A))throw Sb.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+A),this.lineTo(e,t+A),this.lineTo(e,t),this.lineTo(e+n,t),this.lineTo(e,t)},c.prototype.fillRect=function(e,t,n,A){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A))throw Sb.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!C.call(this)){var r={};"butt"!==this.lineCap&&(r.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(r.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,n,A),this.fill(),r.hasOwnProperty("lineCap")&&(this.lineCap=r.lineCap),r.hasOwnProperty("lineJoin")&&(this.lineJoin=r.lineJoin)}},c.prototype.strokeRect=function(e,t,n,A){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A))throw Sb.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");u.call(this)||(this.beginPath(),this.rect(e,t,n,A),this.stroke())},c.prototype.clearRect=function(e,t,n,A){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A))throw Sb.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,n,A))},c.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var A=new l(this.ctx);this.ctxStack.push(this.ctx),this.ctx=A}},c.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},c.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var I=function(e){var t,n,A,r;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,n=0,A=0,r=0;else{var i=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==i)t=parseInt(i[1]),n=parseInt(i[2]),A=parseInt(i[3]),r=1;else if(null!==(i=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(i[1]),n=parseInt(i[2]),A=parseInt(i[3]),r=parseFloat(i[4]);else{if(r=1,"string"==typeof e&&"#"!==e.charAt(0)){var o=new Wb(e);e=o.ok?o.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,n=e.substring(2,3),n+=n,A=e.substring(3,4),A+=A):(t=e.substring(1,3),n=e.substring(3,5),A=e.substring(5,7)),t=parseInt(t,16),n=parseInt(n,16),A=parseInt(A,16)}}return{r:t,g:n,b:A,a:r,style:e}},C=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},u=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};c.prototype.fillText=function(e,t,n,A){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw Sb.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(A=isNaN(A)?void 0:A,!C.call(this)){var r=E(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;R.call(this,{text:e,x:t,y:n,scale:i,angle:r,align:this.textAlign,maxWidth:A})}},c.prototype.strokeText=function(e,t,n,A){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw Sb.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!u.call(this)){A=isNaN(A)?void 0:A;var r=E(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;R.call(this,{text:e,x:t,y:n,scale:i,renderingMode:"stroke",angle:r,align:this.textAlign,maxWidth:A})}},c.prototype.measureText=function(e){if("string"!=typeof e)throw Sb.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,n=this.pdf.internal.scaleFactor,A=t.internal.getFontSize(),r=t.getStringUnitWidth(e)*A/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:r*=Math.round(96*n/72*1e4)/1e4})},c.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw Sb.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new a(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},c.prototype.rotate=function(e){if(isNaN(e))throw Sb.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new a(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},c.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw Sb.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new a(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(n)},c.prototype.transform=function(e,t,n,A,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(A)||isNaN(r)||isNaN(i))throw Sb.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var o=new a(e,t,n,A,r,i);this.ctx.transform=this.ctx.transform.multiply(o)},c.prototype.setTransform=function(e,t,n,A,r,i){e=isNaN(e)?1:e,t=isNaN(t)?0:t,n=isNaN(n)?0:n,A=isNaN(A)?1:A,r=isNaN(r)?0:r,i=isNaN(i)?0:i,this.ctx.transform=new a(e,t,n,A,r,i)};var d=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};c.prototype.drawImage=function(e,t,n,A,r,i,o,g,l){var c=this.pdf.getImageProperties(e),I=1,C=1,u=1,m=1;void 0!==A&&void 0!==g&&(u=g/A,m=l/r,I=c.width/A*g/A,C=c.height/r*l/r),void 0===i&&(i=t,o=n,t=0,n=0),void 0!==A&&void 0===g&&(g=A,l=r),void 0===A&&void 0===g&&(g=c.width,l=c.height);for(var b,y=this.ctx.transform.decompose(),w=E(y.rotate.shx),Z=new a,S=(Z=(Z=(Z=Z.multiply(y.translate)).multiply(y.skew)).multiply(y.scale)).applyToRectangle(new s(i-t*u,o-n*m,A*I,r*C)),v=h.call(this,S),G=[],R=0;R<v.length;R+=1)-1===G.indexOf(v[R])&&G.push(v[R]);if(f(G),this.autoPaging)for(var V=G[0],N=G[G.length-1],k=V;k<N+1;k++){this.pdf.setPage(k);var W=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],F=1===k?this.posY+this.margin[0]:this.margin[0],X=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],H=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],x=1===k?0:X+(k-2)*H;if(0!==this.ctx.clip_path.length){var J=this.path;b=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(b,this.posX+this.margin[3],-x+F+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=J}var Y=JSON.parse(JSON.stringify(S));Y=p([Y],this.posX+this.margin[3],-x+F+this.ctx.prevPageLastElemOffset)[0];var U=(k>V||k<N)&&d.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],W,H,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",Y.x,Y.y,Y.w,Y.h,null,null,w),U&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",S.x,S.y,S.w,S.h,null,null,w)};var h=function(e,t,n){var A=[];t=t||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var r=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":A.push(Math.floor((e.y+r)/n)+1);break;case"arc":A.push(Math.floor((e.y+r-e.radius)/n)+1),A.push(Math.floor((e.y+r+e.radius)/n)+1);break;case"qct":var i=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);A.push(Math.floor((i.y+r)/n)+1),A.push(Math.floor((i.y+i.h+r)/n)+1);break;case"bct":var o=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);A.push(Math.floor((o.y+r)/n)+1),A.push(Math.floor((o.y+o.h+r)/n)+1);break;case"rect":A.push(Math.floor((e.y+r)/n)+1),A.push(Math.floor((e.y+e.h+r)/n)+1)}for(var s=0;s<A.length;s+=1)for(;this.pdf.internal.getNumberOfPages()<A[s];)m.call(this);return A},m=function(){var e=this.fillStyle,t=this.strokeStyle,n=this.font,A=this.lineCap,r=this.lineWidth,i=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=n,this.lineCap=A,this.lineWidth=r,this.lineJoin=i},p=function(e,t,n){for(var A=0;A<e.length;A++)switch(e[A].type){case"bct":e[A].x2+=t,e[A].y2+=n;case"qct":e[A].x1+=t,e[A].y1+=n;default:e[A].x+=t,e[A].y+=n}return e},f=function(e){return e.sort((function(e,t){return e-t}))},b=function(e,t){for(var n,A,r=this.fillStyle,i=this.strokeStyle,o=this.lineCap,s=this.lineWidth,a=Math.abs(s*this.ctx.transform.scaleX),g=this.lineJoin,l=JSON.parse(JSON.stringify(this.path)),c=JSON.parse(JSON.stringify(this.path)),I=[],C=0;C<c.length;C++)if(void 0!==c[C].x)for(var u=h.call(this,c[C]),b=0;b<u.length;b+=1)-1===I.indexOf(u[b])&&I.push(u[b]);for(var y=0;y<I.length;y++)for(;this.pdf.internal.getNumberOfPages()<I[y];)m.call(this);if(f(I),this.autoPaging)for(var w=I[0],Z=I[I.length-1],S=w;S<Z+1;S++){this.pdf.setPage(S),this.fillStyle=r,this.strokeStyle=i,this.lineCap=o,this.lineWidth=a,this.lineJoin=g;var v=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],G=1===S?this.posY+this.margin[0]:this.margin[0],R=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],V=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],N=1===S?0:R+(S-2)*V;if(0!==this.ctx.clip_path.length){var k=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(n,this.posX+this.margin[3],-N+G+this.ctx.prevPageLastElemOffset),B.call(this,e,!0),this.path=k}if(A=JSON.parse(JSON.stringify(l)),this.path=p(A,this.posX+this.margin[3],-N+G+this.ctx.prevPageLastElemOffset),!1===t||0===S){var W=(S>w||S<Z)&&d.call(this);W&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],v,V,null).clip().discardPath()),B.call(this,e,t),W&&this.pdf.restoreGraphicsState()}this.lineWidth=s}else this.lineWidth=a,B.call(this,e,t),this.lineWidth=s;this.path=l},B=function(e,t){if(("stroke"!==e||t||!u.call(this))&&("stroke"===e||t||!C.call(this))){for(var n,A,r=[],i=this.path,o=0;o<i.length;o++){var s=i[o];switch(s.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:s,deltas:[],abs:[]});break;case"lt":var a=r.length;if(i[o-1]&&!isNaN(i[o-1].x)&&(n=[s.x-i[o-1].x,s.y-i[o-1].y],a>0))for(;a>=0;a--)if(!0!==r[a-1].close&&!0!==r[a-1].begin){r[a-1].deltas.push(n),r[a-1].abs.push(s);break}break;case"bct":n=[s.x1-i[o-1].x,s.y1-i[o-1].y,s.x2-i[o-1].x,s.y2-i[o-1].y,s.x-i[o-1].x,s.y-i[o-1].y],r[r.length-1].deltas.push(n);break;case"qct":var g=i[o-1].x+2/3*(s.x1-i[o-1].x),l=i[o-1].y+2/3*(s.y1-i[o-1].y),c=s.x+2/3*(s.x1-s.x),I=s.y+2/3*(s.y1-s.y),d=s.x,h=s.y;n=[g-i[o-1].x,l-i[o-1].y,c-i[o-1].x,I-i[o-1].y,d-i[o-1].x,h-i[o-1].y],r[r.length-1].deltas.push(n);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(s)}}A=t?null:"stroke"===e?"stroke":"fill";for(var m=!1,p=0;p<r.length;p++)if(r[p].arc)for(var f=r[p].abs,b=0;b<f.length;b++){var B=f[b];"arc"===B.type?Z.call(this,B.x,B.y,B.radius,B.startAngle,B.endAngle,B.counterclockwise,void 0,t,!m):V.call(this,B.x,B.y),m=!0}else if(!0===r[p].close)this.pdf.internal.out("h"),m=!1;else if(!0!==r[p].begin){var y=r[p].start.x,w=r[p].start.y;N.call(this,r[p].deltas,y,w),m=!0}A&&S.call(this,A),t&&v.call(this)}},y=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-n;case"top":return e+t-n;case"hanging":return e+t-2*n;case"middle":return e+t/2-n;default:return e}},w=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};c.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},c.prototype.createPattern=function(){return this.createLinearGradient()},c.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Z=function(e,t,n,A,r,i,o,s,a){for(var g=W.call(this,n,A,r,i),l=0;l<g.length;l++){var c=g[l];0===l&&(a?G.call(this,c.x1+e,c.y1+t):V.call(this,c.x1+e,c.y1+t)),k.call(this,e,t,c.x2,c.y2,c.x3,c.y3,c.x4,c.y4)}s?v.call(this):S.call(this,o)},S=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},v=function(){this.pdf.clip(),this.pdf.discardPath()},G=function(e,t){this.pdf.internal.out(n(e)+" "+A(t)+" m")},R=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var n=this.pdf.getTextDimensions(e.text),A=y.call(this,e.y),r=w.call(this,A)-n.h,i=this.ctx.transform.applyToPoint(new o(e.x,A)),g=this.ctx.transform.decompose(),l=new a;l=(l=(l=l.multiply(g.translate)).multiply(g.skew)).multiply(g.scale);for(var c,I,C,u=this.ctx.transform.applyToRectangle(new s(e.x,A,n.w,n.h)),m=l.applyToRectangle(new s(e.x,r,n.w,n.h)),b=h.call(this,m),Z=[],S=0;S<b.length;S+=1)-1===Z.indexOf(b[S])&&Z.push(b[S]);if(f(Z),this.autoPaging)for(var v=Z[0],G=Z[Z.length-1],R=v;R<G+1;R++){this.pdf.setPage(R);var V=1===R?this.posY+this.margin[0]:this.margin[0],N=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],k=this.pdf.internal.pageSize.height-this.margin[2],W=k-this.margin[0],F=this.pdf.internal.pageSize.width-this.margin[1],E=F-this.margin[3],X=1===R?0:N+(R-2)*W;if(0!==this.ctx.clip_path.length){var H=this.path;c=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=p(c,this.posX+this.margin[3],-1*X+V),B.call(this,"fill",!0),this.path=H}var x=p([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-X+V+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(I=this.pdf.internal.getFontSize(),this.pdf.setFontSize(I*e.scale),C=this.lineWidth,this.lineWidth=C*e.scale);var J="text"!==this.autoPaging;if(J||x.y+x.h<=k){if(J||x.y>=V&&x.x<=F){var Y=J?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||F-x.x)[0],U=p([JSON.parse(JSON.stringify(u))],this.posX+this.margin[3],-X+V+this.ctx.prevPageLastElemOffset)[0],L=J&&(R>v||R<G)&&d.call(this);L&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],E,W,null).clip().discardPath()),this.pdf.text(Y,U.x,U.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),L&&this.pdf.restoreGraphicsState()}}else x.y<k&&(this.ctx.prevPageLastElemOffset+=k-x.y);e.scale>=.01&&(this.pdf.setFontSize(I),this.lineWidth=C)}else e.scale>=.01&&(I=this.pdf.internal.getFontSize(),this.pdf.setFontSize(I*e.scale),C=this.lineWidth,this.lineWidth=C*e.scale),this.pdf.text(e.text,i.x+this.posX,i.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(I),this.lineWidth=C)},V=function(e,t,r,i){r=r||0,i=i||0,this.pdf.internal.out(n(e+r)+" "+A(t+i)+" l")},N=function(e,t,n){return this.pdf.lines(e,t,n,null,null)},k=function(e,n,A,o,s,a,g,l){this.pdf.internal.out([t(r(A+e)),t(i(o+n)),t(r(s+e)),t(i(a+n)),t(r(g+e)),t(i(l+n)),"c"].join(" "))},W=function(e,t,n,A){for(var r=2*Math.PI,i=Math.PI/2;t>n;)t-=r;var o=Math.abs(n-t);o<r&&A&&(o=r-o);for(var s=[],a=A?-1:1,g=t;o>1e-5;){var l=g+a*Math.min(o,i);s.push(F.call(this,e,g,l)),o-=Math.abs(l-g),g=l}return s},F=function(e,t,n){var A=(n-t)/2,r=e*Math.cos(A),i=e*Math.sin(A),o=r,s=-i,a=o*o+s*s,g=a+o*r+s*i,l=4/3*(Math.sqrt(2*a*g)-g)/(o*i-s*r),c=o-l*s,I=s+l*o,C=c,u=-I,d=A+t,h=Math.cos(d),m=Math.sin(d);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:c*h-I*m,y2:c*m+I*h,x3:C*h-u*m,y3:C*m+u*h,x4:e*Math.cos(n),y4:e*Math.sin(n)}},E=function(e){return 180*e/Math.PI},X=function(e,t,n,A,r,i){var o=e+.5*(n-e),a=t+.5*(A-t),g=r+.5*(n-r),l=i+.5*(A-i),c=Math.min(e,r,o,g),I=Math.max(e,r,o,g),C=Math.min(t,i,a,l),u=Math.max(t,i,a,l);return new s(c,C,I-c,u-C)},H=function(e,t,n,A,r,i,o,a){var g,l,c,I,C,u,d,h,m,p,f,b,B,y,w=n-e,Z=A-t,S=r-n,v=i-A,G=o-r,R=a-i;for(l=0;l<41;l++)m=(d=(c=e+(g=l/40)*w)+g*((C=n+g*S)-c))+g*(C+g*(r+g*G-C)-d),p=(h=(I=t+g*Z)+g*((u=A+g*v)-I))+g*(u+g*(i+g*R-u)-h),0==l?(f=m,b=p,B=m,y=p):(f=Math.min(f,m),b=Math.min(b,p),B=Math.max(B,m),y=Math.max(y,p));return new s(Math.round(f),Math.round(b),Math.round(B-f),Math.round(y-b))},x=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,n=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(nB.API),
/**
 * @license
 * jsPDF filters PlugIn
 * Copyright (c) 2014 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(e){var t,n,A,r,i,o,s,a,g,l;for(n=[],A=0,r=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;r>A;A+=4)0!==(i=(e.charCodeAt(A)<<24)+(e.charCodeAt(A+1)<<16)+(e.charCodeAt(A+2)<<8)+e.charCodeAt(A+3))?(o=(i=((i=((i=((i=(i-(l=i%85))/85)-(g=i%85))/85)-(a=i%85))/85)-(s=i%85))/85)%85,n.push(o+33,s+33,a+33,g+33,l+33)):n.push(122);return function(e,t){for(var n=t;n>0;n--)e.pop()}(n,t.length),String.fromCharCode.apply(String,n)+"~>"},n=function(e){var t,n,A,r,i,o=String,s="length",a=255,g="charCodeAt",l="slice",c="replace";for(e[l](-2),e=e[l](0,-2)[c](/\s/g,"")[c]("z","!!!!!"),A=[],r=0,i=(e+=t="uuuuu"[l](e[s]%5||5))[s];i>r;r+=5)n=52200625*(e[g](r)-33)+614125*(e[g](r+1)-33)+7225*(e[g](r+2)-33)+85*(e[g](r+3)-33)+(e[g](r+4)-33),A.push(a&n>>24,a&n>>16,a&n>>8,a&n);return function(e,t){for(var n=t;n>0;n--)e.pop()}(A,t[s]),o.fromCharCode.apply(o,A)},A=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var n="",A=0;A<e.length;A+=2)n+=String.fromCharCode("0x"+(e[A]+e[A+1]));return n},r=function(e){for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return(t=bb(t)).reduce((function(e,t){return e+String.fromCharCode(t)}),"")};e.processDataByFilters=function(e,i){var o=0,s=e||"",a=[];for("string"==typeof(i=i||[])&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":s=n(s),a.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":s=t(s),a.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":s=A(s),a.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":s=s.split("").map((function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)})).join("")+">",a.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":s=r(s),a.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:s,reverseChain:a.reverse().join(" ")}}}(nB.API),(
/**
 * @license
 * jsPDF fileloading PlugIn
 * Copyright (c) 2018 Aras Abbasi (aras.abbasi@gmail.com)
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
sy=nB.API).loadFile=function(e,t,n){return function(e,t,n){t=!1!==t,n="function"==typeof n?n:function(){};var A=void 0;try{A=function(e,t,n){var A=new XMLHttpRequest,r=0,i=function(e){var t=e.length,n=[],A=String.fromCharCode;for(r=0;r<t;r+=1)n.push(A(255&e.charCodeAt(r)));return n.join("")};if(A.open("GET",e,!t),A.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(A.onload=function(){200===A.status?n(i(this.responseText)):n(void 0)}),A.send(null),t&&200===A.status)return i(A.responseText)}(e,t,n)}catch(r){}return A}(e,t,n)},sy.loadImageFile=sy.loadFile,function(e){function t(){return(wb.html2canvas?Promise.resolve(wb.html2canvas):Vf((()=>Promise.resolve().then((()=>uN))),void 0)).catch((function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))})).then((function(e){return e.default?e.default:e}))}function n(){return(wb.DOMPurify?Promise.resolve(wb.DOMPurify):Vf((()=>import("./purify.es-CvAnTBAp.js")),[])).catch((function(e){return Promise.reject(new Error("Could not load dompurify: "+e))})).then((function(e){return e.default?e.default:e}))}var A=function(e){var t=Nf(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},r=function(e,t){var n=document.createElement(e);for(var A in t.className&&(n.className=t.className),t.innerHTML&&t.dompurify&&(n.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)n.style[A]=t.style[A];return n},i=function e(t){var n=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),A=e.convert(Promise.resolve(),n);return(A=A.setProgress(1,e,1,[e])).set(t)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(e,t){return e.__proto__=t||i.prototype,e},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(e,t){return this.then((function(){switch(t=t||function(e){switch(A(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(n).then((function(t){return this.set({src:r("div",{innerHTML:e,dompurify:t})})}));case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}}))},i.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=function e(t,n){for(var A=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),r=t.firstChild;r;r=r.nextSibling)!0!==n&&1===r.nodeType&&"SCRIPT"===r.nodeName||A.appendChild(e(r,n));return 1===t.nodeType&&("CANVAS"===t.nodeName?(A.width=t.width,A.height=t.height,A.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(A.value=t.value),A.addEventListener("load",(function(){A.scrollTop=t.scrollTop,A.scrollLeft=t.scrollLeft}),!0)),A}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},i.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)})).then((function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},i.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then((function(e){var t=this.opt.jsPDF,n=this.opt.fontFaces,A="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,r=Object.assign({async:!0,allowTaint:!0,scale:A,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete r.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=n,n)for(var i=0;i<n.length;++i){var o=n[i],s=o.src.find((function(e){return"truetype"===e.format}));s&&t.addFont(s.url,o.ref.name,o.ref.style)}return r.windowHeight=r.windowHeight||0,r.windowHeight=0==r.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):r.windowHeight,t.context2d.save(!0),e(this.prop.container,r)})).then((function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)}))},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e}))},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},i.prototype.output=function(e,t,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},i.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(e,t)}))},i.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}}))},i.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},i.prototype.set=function(e){if("object"!==A(e))return this;var t=Object.keys(e||{}).map((function(t){if(t in i.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}}),this);return this.then((function(){return this.thenList(t)}))},i.prototype.get=function(e,t){return this.then((function(){var n=e in i.template.prop?this.prop[e]:this.opt[e];return t?t(n):n}))},i.prototype.setMargin=function(e){return this.then((function(){switch(A(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e})).then(this.setPageSize)},i.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then((function(){(e=e||nB.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e}))},i.prototype.setProgress=function(e,t,n,A){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=n&&(this.progress.n=n),null!=A&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(e,t,n,A){return this.setProgress(e?this.progress.val+e:null,t||null,n?this.progress.n+n:null,A?this.progress.stack.concat(A):null)},i.prototype.then=function(e,t){var n=this;return this.thenCore(e,t,(function(e,t){return n.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,(function(t){return n.updateProgress(null,e),t})).then(e,t).then((function(e){return n.updateProgress(1),e}))}))},i.prototype.thenCore=function(e,t,n){n=n||Promise.prototype.then,e&&(e=e.bind(this)),t&&(t=t.bind(this));var A=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:i.convert(Object.assign({},this),Promise.prototype),r=n.call(A,e,t);return i.convert(r,this.__proto__)},i.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},i.prototype.thenList=function(e){var t=this;return e.forEach((function(e){t=t.thenCore(e)})),t},i.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return i.convert(t,this)},i.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},i.prototype.error=function(e){return this.then((function(){throw new Error(e)}))},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,nB.getPageSize=function(e,t,n){if("object"===Nf(e)){var A=e;e=A.orientation,t=A.unit||t,n=A.format||n}t=t||"mm",n=n||"a4",e=(""+(e||"P")).toLowerCase();var r,i=(""+n).toLowerCase(),o={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":r=1;break;case"mm":r=72/25.4;break;case"cm":r=72/2.54;break;case"in":r=72;break;case"px":r=.75;break;case"pc":case"em":r=12;break;case"ex":r=6;break;default:throw"Invalid unit: "+t}var s,a=0,g=0;if(o.hasOwnProperty(i))a=o[i][1]/r,g=o[i][0]/r;else try{a=n[1],g=n[0]}catch(sy){throw new Error("Invalid format: "+n)}if("p"===e||"portrait"===e)e="p",g>a&&(s=g,g=a,a=s);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",a>g&&(s=g,g=a,a=s)}return{width:g,height:a,unit:t,k:r,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(_B):null;var n=new i(t);return t.worker?n:n.from(e).doCallback()}}(nB.API),nB.API.addJS=function(e){return oy=e,this.internal.events.subscribe("postPutResources",(function(){ry=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ry+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),iy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+oy+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){void 0!==ry&&void 0!==iy&&this.internal.out("/Names <</JavaScript "+ry+" 0 R>>")})),this},
/**
 * @license
 * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t;e.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var A=e.outline.render().split(/\r\n/),r=0;r<A.length;r++){var i=A[r],o=n.exec(i);if(null!=o){var s=o[1];e.internal.newObjectDeferredBegin(s,!1)}e.internal.write(i)}if(this.outline.createNamedDestinations){var a=this.internal.pages.length,g=[];for(r=0;r<a;r++){var l=e.internal.newObject();g.push(l);var c=e.internal.getPageInfo(r+1);e.internal.write("<< /D["+c.objId+" 0 R /XYZ null null null]>> endobj")}var I=e.internal.newObject();for(e.internal.write("<< /Names [ "),r=0;r<g.length;r++)e.internal.write("(page_"+(r+1)+")"+g[r]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+I+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,n){var A={title:t,options:n,children:[]};return null==e&&(e=this.root),e.children.push(A),A},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var n=0;n<t.children.length;n++)this.genIds_r(t.children[n])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,A=0;A<t.children.length;A++){var r=t.children[A];this.objStart(r),this.line("/Title "+this.makeString(r.title)),this.line("/Parent "+this.makeRef(t)),A>0&&this.line("/Prev "+this.makeRef(t.children[A-1])),A<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[A+1])),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1])));var i=this.count=this.count_r({count:0},r);if(i>0&&this.line("/Count "+i),r.options&&r.options.pageNumber){var o=e.internal.getPageInfo(r.options.pageNumber);this.line("/Dest ["+o.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var s=0;s<t.children.length;s++)this.renderItems(t.children[s])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var n=0;n<t.children.length;n++)e.count++,this.count_r(e,t.children[n]);return e.count}}])}(nB.API),
/**
 * @license
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,n,A,r,i,o){var s,a=this.decode.DCT_DECODE,g=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=i||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(s=function(e){for(var n,A=256*e.charCodeAt(4)+e.charCodeAt(5),r=e.length,i={width:0,height:0,numcomponents:1},o=4;o<r;o+=2){if(o+=A,-1!==t.indexOf(e.charCodeAt(o+1))){n=256*e.charCodeAt(o+5)+e.charCodeAt(o+6),i={width:256*e.charCodeAt(o+7)+e.charCodeAt(o+8),height:n,numcomponents:e.charCodeAt(o+9)};break}A=256*e.charCodeAt(o+2)+e.charCodeAt(o+3)}return i}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}g={data:e,width:s.width,height:s.height,colorSpace:o,bitsPerComponent:8,filter:a,index:n,alias:A}}return g}}(nB.API);var gy,ly,cy,Iy,Cy,uy=function(){var e,t,n;function A(e){var t,n,A,r,i,o,s,a,g,l,c,I,C,u;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(t=this.readUInt32(),g=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),r=this.readUInt16()||100,o.delay=1e3*i/r,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===g&&(this.pos+=4,t-=4),e=(null!=o?o.data:void 0)||this.imgData,I=0;0<=t?I<t:I>t;0<=t?++I:--I)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((l=A-this.transparency.indexed.length)>0)for(C=0;0<=l?C<l:C>l;0<=l?++C:--C)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":s=(c=this.read(t)).indexOf(0),a=String.fromCharCode.apply(String,c.slice(0,s)),this.text[a]=String.fromCharCode.apply(String,c.slice(s+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(u=this.colorType)||6===u,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}A.prototype.read=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)n.push(this.data[this.pos++]);return n},A.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},A.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},A.prototype.decodePixels=function(e){var t=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*t),A=0,r=this;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);function i(i,o,s,a){var g,l,c,I,C,u,d,h,m,p,f,b,B,y,w,Z,S,v,G,R,V,N=Math.ceil((r.width-i)/s),k=Math.ceil((r.height-o)/a),W=r.width==N&&r.height==k;for(y=t*N,b=W?n:new Uint8Array(y*k),u=e.length,B=0,l=0;B<k&&A<u;){switch(e[A++]){case 0:for(I=S=0;S<y;I=S+=1)b[l++]=e[A++];break;case 1:for(I=v=0;v<y;I=v+=1)g=e[A++],C=I<t?0:b[l-t],b[l++]=(g+C)%256;break;case 2:for(I=G=0;G<y;I=G+=1)g=e[A++],c=(I-I%t)/t,w=B&&b[(B-1)*y+c*t+I%t],b[l++]=(w+g)%256;break;case 3:for(I=R=0;R<y;I=R+=1)g=e[A++],c=(I-I%t)/t,C=I<t?0:b[l-t],w=B&&b[(B-1)*y+c*t+I%t],b[l++]=(g+Math.floor((C+w)/2))%256;break;case 4:for(I=V=0;V<y;I=V+=1)g=e[A++],c=(I-I%t)/t,C=I<t?0:b[l-t],0===B?w=Z=0:(w=b[(B-1)*y+c*t+I%t],Z=c&&b[(B-1)*y+(c-1)*t+I%t]),d=C+w-Z,h=Math.abs(d-C),p=Math.abs(d-w),f=Math.abs(d-Z),m=h<=p&&h<=f?C:p<=f?w:Z,b[l++]=(g+m)%256;break;default:throw new Error("Invalid filter algorithm: "+e[A-1])}if(!W){var F=((o+B*a)*r.width+i)*t,E=B*y;for(I=0;I<N;I+=1){for(var X=0;X<t;X+=1)n[F++]=b[E++];F+=(s-1)*t}}B++}}return e=Bb(e),1==r.interlaceMethod?(i(0,0,8,8),i(4,0,8,8),i(0,4,4,8),i(2,0,4,4),i(0,2,2,4),i(1,0,2,2),i(0,1,1,2)):i(0,0,1,1),n},A.prototype.decodePalette=function(){var e,t,n,A,r,i,o,s,a;for(n=this.palette,i=this.transparency.indexed||[],r=new Uint8Array((i.length||0)+n.length),A=0,e=0,t=o=0,s=n.length;o<s;t=o+=3)r[A++]=n[t],r[A++]=n[t+1],r[A++]=n[t+2],r[A++]=null!=(a=i[e++])?a:255;return r},A.prototype.copyToImageData=function(e,t){var n,A,r,i,o,s,a,g,l,c,I;if(A=this.colors,l=null,n=this.hasAlphaChannel,this.palette.length&&(l=null!=(I=this._decodedPalette)?I:this._decodedPalette=this.decodePalette(),A=4,n=!0),g=(r=e.data||e).length,o=l||t,i=s=0,1===A)for(;i<g;)a=l?4*t[i/4]:s,c=o[a++],r[i++]=c,r[i++]=c,r[i++]=c,r[i++]=n?o[a++]:255,s=a;else for(;i<g;)a=l?4*t[i/4]:s,r[i++]=o[a++],r[i++]=o[a++],r[i++]=o[a++],r[i++]=n?o[a++]:255,s=a},A.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};var r=function(){if("[object Window]"===Object.prototype.toString.call(wb)){try{t=wb.document.createElement("canvas"),n=t.getContext("2d")}catch(e){return!1}return!0}return!1};return r(),e=function(e){var A;if(!0===r())return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(A=new Image).src=t.toDataURL(),A;throw new Error("This method requires a Browser with Canvas-capability.")},A.prototype.decodeFrames=function(t){var n,A,r,i,o,s,a,g;if(this.animation){for(g=[],A=o=0,s=(a=this.animation.frames).length;o<s;A=++o)n=a[A],r=t.createImageData(n.width,n.height),i=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(r,i),n.imageData=r,g.push(n.image=e(r));return g}},A.prototype.renderFrame=function(e,t){var n,A,r;return n=(A=this.animation.frames)[t],r=A[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=r?r.disposeOp:void 0)?e.clearRect(r.xOffset,r.yOffset,r.width,r.height):2===(null!=r?r.disposeOp:void 0)&&e.putImageData(r.imageData,r.xOffset,r.yOffset),0===n.blendOp&&e.clearRect(n.xOffset,n.yOffset,n.width,n.height),e.drawImage(n.image,n.xOffset,n.yOffset)},A.prototype.animate=function(e){var t,n,A,r,i,o,s=this;return n=0,o=this.animation,r=o.numFrames,A=o.frames,i=o.numPlays,(t=function(){var o,a;if(o=n++%r,a=A[o],s.renderFrame(e,o),r>1&&n/r<i)return s.animation._timeout=setTimeout(t,a.delay)})()},A.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},A.prototype.render=function(e){var t,n;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(n=t.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),t.putImageData(n,0,0))},A}();
/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
/**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function dy(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,A=e[t++]|e[t++]<<8,r=e[t++],i=r>>7,o=1<<1+(7&r);e[t++],e[t++];var s=null,a=null;i&&(s=t,a=o,t+=3*o);var g=!0,l=[],c=0,I=null,C=0,u=null;for(this.width=n,this.height=A;g&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,u=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((G=e[t++])>=0))throw Error("Invalid block size");if(0===G)break;t+=G}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var d=e[t++];c=e[t++]|e[t++]<<8,I=e[t++],!(1&d)&&(I=null),C=d>>2&7,t++;break;case 254:for(;;){if(!((G=e[t++])>=0))throw Error("Invalid block size");if(0===G)break;t+=G}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var h=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,f=e[t++]|e[t++]<<8,b=e[t++],B=b>>6&1,y=1<<1+(7&b),w=s,Z=a,S=!1;b>>7&&(S=!0,w=t,Z=y,t+=3*y);var v=t;for(t++;;){var G;if(!((G=e[t++])>=0))throw Error("Invalid block size");if(0===G)break;t+=G}l.push({x:h,y:m,width:p,height:f,has_local_palette:S,palette_offset:w,palette_size:Z,data_offset:v,data_length:t-v,transparent_index:I,interlaced:!!B,delay:c,disposal:C});break;case 59:g=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return l.length},this.loopCount=function(){return u},this.frameInfo=function(e){if(e<0||e>=l.length)throw new Error("Frame index out of range.");return l[e]},this.decodeAndBlitFrameBGRA=function(t,A){var r=this.frameInfo(t),i=r.width*r.height,o=new Uint8Array(i);hy(e,r.data_offset,o,i);var s=r.palette_offset,a=r.transparent_index;null===a&&(a=256);var g=r.width,l=n-g,c=g,I=4*(r.y*n+r.x),C=4*((r.y+r.height)*n+r.x),u=I,d=4*l;!0===r.interlaced&&(d+=4*n*7);for(var h=8,m=0,p=o.length;m<p;++m){var f=o[m];if(0===c&&(c=g,(u+=d)>=C&&(d=4*l+4*n*(h-1),u=I+(g+l)*(h<<1),h>>=1)),f===a)u+=4;else{var b=e[s+3*f],B=e[s+3*f+1],y=e[s+3*f+2];A[u++]=y,A[u++]=B,A[u++]=b,A[u++]=255}--c}},this.decodeAndBlitFrameRGBA=function(t,A){var r=this.frameInfo(t),i=r.width*r.height,o=new Uint8Array(i);hy(e,r.data_offset,o,i);var s=r.palette_offset,a=r.transparent_index;null===a&&(a=256);var g=r.width,l=n-g,c=g,I=4*(r.y*n+r.x),C=4*((r.y+r.height)*n+r.x),u=I,d=4*l;!0===r.interlaced&&(d+=4*n*7);for(var h=8,m=0,p=o.length;m<p;++m){var f=o[m];if(0===c&&(c=g,(u+=d)>=C&&(d=4*l+4*n*(h-1),u=I+(g+l)*(h<<1),h>>=1)),f===a)u+=4;else{var b=e[s+3*f],B=e[s+3*f+1],y=e[s+3*f+2];A[u++]=b,A[u++]=B,A[u++]=y,A[u++]=255}--c}}}function hy(e,t,n,A){for(var r=e[t++],i=1<<r,o=i+1,s=o+1,a=r+1,g=(1<<a)-1,l=0,c=0,I=0,C=e[t++],u=new Int32Array(4096),d=null;;){for(;l<16&&0!==C;)c|=e[t++]<<l,l+=8,1===C?C=e[t++]:--C;if(l<a)break;var h=c&g;if(c>>=a,l-=a,h!==i){if(h===o)break;for(var m=h<s?h:d,p=0,f=m;f>i;)f=u[f]>>8,++p;var b=f;if(I+p+(m!==h?1:0)>A)return void Sb.log("Warning, gif stream longer than expected.");n[I++]=b;var B=I+=p;for(m!==h&&(n[I++]=b),f=m;p--;)f=u[f],n[--B]=255&f,f>>=8;null!==d&&s<4096&&(u[s++]=d<<8|b,s>=g+1&&a<12&&(++a,g=g<<1|1)),d=h}else s=o+1,g=(1<<(a=r+1))-1,d=null}return I!==A&&Sb.log("Warning, gif stream shorter than expected."),n
/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/}function my(e){var t,n,A,r,i,o=Math.floor,s=new Array(64),a=new Array(64),g=new Array(64),l=new Array(64),c=new Array(65535),I=new Array(65535),C=new Array(64),u=new Array(64),d=[],h=0,m=7,p=new Array(64),f=new Array(64),b=new Array(64),B=new Array(256),y=new Array(2048),w=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],v=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],G=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],k=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function W(e,t){for(var n=0,A=0,r=new Array,i=1;i<=16;i++){for(var o=1;o<=e[i];o++)r[t[A]]=[],r[t[A]][0]=n,r[t[A]][1]=i,A++,n++;n*=2}return r}function F(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(h|=1<<m),n--,--m<0&&(255==h?(E(255),E(0)):E(h),m=7,h=0)}function E(e){d.push(e)}function X(e){E(e>>8&255),E(255&e)}function H(e,t,n,A,r){for(var i,o=r[0],s=r[240],a=function(e,t){var n,A,r,i,o,s,a,g,l,c,I=0;for(l=0;l<8;++l){n=e[I],A=e[I+1],r=e[I+2],i=e[I+3],o=e[I+4],s=e[I+5],a=e[I+6];var u=n+(g=e[I+7]),d=n-g,h=A+a,m=A-a,p=r+s,f=r-s,b=i+o,B=i-o,y=u+b,w=u-b,Z=h+p,S=h-p;e[I]=y+Z,e[I+4]=y-Z;var v=.707106781*(S+w);e[I+2]=w+v,e[I+6]=w-v;var G=.382683433*((y=B+f)-(S=m+d)),R=.5411961*y+G,V=1.306562965*S+G,N=.707106781*(Z=f+m),k=d+N,W=d-N;e[I+5]=W+R,e[I+3]=W-R,e[I+1]=k+V,e[I+7]=k-V,I+=8}for(I=0,l=0;l<8;++l){n=e[I],A=e[I+8],r=e[I+16],i=e[I+24],o=e[I+32],s=e[I+40],a=e[I+48];var F=n+(g=e[I+56]),E=n-g,X=A+a,H=A-a,x=r+s,J=r-s,Y=i+o,U=i-o,L=F+Y,T=F-Y,K=X+x,M=X-x;e[I]=L+K,e[I+32]=L-K;var Q=.707106781*(M+T);e[I+16]=T+Q,e[I+48]=T-Q;var D=.382683433*((L=U+J)-(M=H+E)),z=.5411961*L+D,O=1.306562965*M+D,P=.707106781*(K=J+H),_=E+P,j=E-P;e[I+40]=j+z,e[I+24]=j-z,e[I+8]=_+O,e[I+56]=_-O,I++}for(l=0;l<64;++l)c=e[l]*t[l],C[l]=c>0?c+.5|0:c-.5|0;return C}(e,t),g=0;g<64;++g)u[w[g]]=a[g];var l=u[0]-n;n=u[0],0==l?F(A[0]):(F(A[I[i=32767+l]]),F(c[i]));for(var d=63;d>0&&0==u[d];)d--;if(0==d)return F(o),n;for(var h,m=1;m<=d;){for(var p=m;0==u[m]&&m<=d;)++m;var f=m-p;if(f>=16){h=f>>4;for(var b=1;b<=h;++b)F(s);f&=15}i=32767+u[m],F(r[(f<<4)+I[i]]),F(c[i]),m++}return 63!=d&&F(o),n}function x(e){e=Math.min(Math.max(e,1),100),i!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var A=o((t[n]*e+50)/100);A=Math.min(Math.max(A,1),255),s[w[n]]=A}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],i=0;i<64;i++){var c=o((r[i]*e+50)/100);c=Math.min(Math.max(c,1),255),a[w[i]]=c}for(var I=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],C=0,u=0;u<8;u++)for(var d=0;d<8;d++)g[C]=1/(s[w[C]]*I[u]*I[d]*8),l[C]=1/(a[w[C]]*I[u]*I[d]*8),C++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),i=e)}this.encode=function(e,i){var o,c;i&&x(i),d=new Array,h=0,m=7,X(65496),X(65504),X(16),E(74),E(70),E(73),E(70),E(0),E(1),E(1),E(0),X(1),X(1),E(0),E(0),function(){X(65499),X(132),E(0);for(var e=0;e<64;e++)E(s[e]);E(1);for(var t=0;t<64;t++)E(a[t])}(),o=e.width,c=e.height,X(65472),X(17),E(8),X(c),X(o),E(3),E(1),E(17),E(0),E(2),E(17),E(1),E(3),E(17),E(1),function(){X(65476),X(418),E(0);for(var e=0;e<16;e++)E(Z[e+1]);for(var t=0;t<=11;t++)E(S[t]);E(16);for(var n=0;n<16;n++)E(v[n+1]);for(var A=0;A<=161;A++)E(G[A]);E(1);for(var r=0;r<16;r++)E(R[r+1]);for(var i=0;i<=11;i++)E(V[i]);E(17);for(var o=0;o<16;o++)E(N[o+1]);for(var s=0;s<=161;s++)E(k[s])}(),X(65498),X(12),E(3),E(1),E(0),E(2),E(17),E(3),E(17),E(0),E(63),E(0);var I=0,C=0,u=0;h=0,m=7,this.encode.displayName="_encode_";for(var B,w,W,J,Y,U,L,T,K,M=e.data,Q=e.width,D=e.height,z=4*Q,O=0;O<D;){for(B=0;B<z;){for(Y=z*O+B,L=-1,T=0,K=0;K<64;K++)U=Y+(T=K>>3)*z+(L=4*(7&K)),O+T>=D&&(U-=z*(O+1+T-D)),B+L>=z&&(U-=B+L-z+4),w=M[U++],W=M[U++],J=M[U++],p[K]=(y[w]+y[W+256|0]+y[J+512|0]>>16)-128,f[K]=(y[w+768|0]+y[W+1024|0]+y[J+1280|0]>>16)-128,b[K]=(y[w+1280|0]+y[W+1536|0]+y[J+1792|0]>>16)-128;I=H(p,g,I,t,A),C=H(f,l,C,n,r),u=H(b,l,u,n,r),B+=32}O+=8}if(m>=0){var P=[];P[1]=m+1,P[0]=(1<<m+1)-1,F(P)}return X(65497),new Uint8Array(d)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)B[t]=e(t)}(),t=W(Z,S),n=W(R,V),A=W(v,G),r=W(N,k),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var A=e;A<t;A++)I[32767+A]=n,c[32767+A]=[],c[32767+A][1]=n,c[32767+A][0]=A;for(var r=-(t-1);r<=-e;r++)I[32767+r]=n,c[32767+r]=[],c[32767+r][1]=n,c[32767+r][0]=t-1+r;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)y[e]=19595*e,y[e+256|0]=38470*e,y[e+512|0]=7471*e+32768,y[e+768|0]=-11059*e,y[e+1024|0]=-21709*e,y[e+1280|0]=32768*e+8421375,y[e+1536|0]=-27439*e,y[e+1792|0]=-5329*e}(),x(e)}
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function py(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function fy(e){function t(e){if(!e)throw Error("assert :P")}function n(e,t,n){for(var A=0;4>A;A++)if(e[t+A]!=n.charCodeAt(A))return!0;return!1}function A(e,t,n,A,r){for(var i=0;i<r;i++)e[t+i]=n[A+i]}function r(e,t,n,A){for(var r=0;r<A;r++)e[t+r]=n}function i(e){return new Int32Array(e)}function o(e,t){for(var n=[],A=0;A<e;A++)n.push(new t);return n}function s(e,t){var n=[];return function e(n,A,r){for(var i=r[A],o=0;o<i&&(n.push(r.length>A+1?[]:new t),!(r.length<A+1));o++)e(n[o],A+1,r)}(n,0,e),n}var a=function(){var e=this;function a(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function g(e,n,A,r,i){t(!(r%A));do{e[n+(r-=A)]=i}while(0<r)}function l(e,n,A,r,o){if(t(2328>=o),512>=o)var s=i(512);else if(null==(s=i(o)))return 0;return function(e,n,A,r,o,s){var l,I,C=n,u=1<<A,d=i(16),h=i(16);for(t(0!=o),t(null!=r),t(null!=e),t(0<A),I=0;I<o;++I){if(15<r[I])return 0;++d[r[I]]}if(d[0]==o)return 0;for(h[1]=0,l=1;15>l;++l){if(d[l]>1<<l)return 0;h[l+1]=h[l]+d[l]}for(I=0;I<o;++I)l=r[I],0<r[I]&&(s[h[l]++]=I);if(1==h[15])return(r=new c).g=0,r.value=s[0],g(e,C,1,u,r),u;var m,p=-1,f=u-1,b=0,B=1,y=1,w=1<<A;for(I=0,l=1,o=2;l<=A;++l,o<<=1){if(B+=y<<=1,0>(y-=d[l]))return 0;for(;0<d[l];--d[l])(r=new c).g=l,r.value=s[I++],g(e,C+b,o,w,r),b=a(b,l)}for(l=A+1,o=2;15>=l;++l,o<<=1){if(B+=y<<=1,0>(y-=d[l]))return 0;for(;0<d[l];--d[l]){if(r=new c,(b&f)!=p){for(C+=w,m=1<<(p=l)-A;15>p&&!(0>=(m-=d[p]));)++p,m<<=1;u+=w=1<<(m=p-A),e[n+(p=b&f)].g=m+A,e[n+p].value=C-n-p}r.g=l-A,r.value=s[I++],g(e,C+(b>>A),o,w,r),b=a(b,l)}}return B!=2*h[15]-1?0:u}(e,n,A,r,o,s)}function c(){this.value=this.g=0}function I(){this.value=this.g=0}function C(){this.G=o(5,c),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Jn,I)}function u(e,n,A,r){t(null!=e),t(null!=n),t(2147483648>r),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=n,e.pa=A,e.Jd=n,e.Yc=A+r,e.Zc=4<=r?A+r-4+1:A,v(e)}function d(e,t){for(var n=0;0<t--;)n|=R(e,128)<<t;return n}function h(e,t){var n=d(e,t);return G(e)?-n:n}function m(e,n,A,r){var i,o=0;for(t(null!=e),t(null!=n),t(4294967288>r),e.Sb=r,e.Ra=0,e.u=0,e.h=0,4<r&&(r=4),i=0;i<r;++i)o+=n[A+i]<<8*i;e.Ra=o,e.bb=r,e.oa=n,e.pa=A}function p(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Ln-8>>>0,++e.bb,e.u-=8;w(e)&&(e.h=1,e.u=0)}function f(e,n){if(t(0<=n),!e.h&&n<=Un){var A=y(e)&Yn[n];return e.u+=n,p(e),A}return e.h=1,e.u=0}function b(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function B(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function y(e){return e.Ra>>>(e.u&Ln-1)>>>0}function w(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Ln}function Z(e,t){e.u=t,e.h=w(e)}function S(e){e.u>=Tn&&(t(e.u>=Tn),p(e))}function v(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function G(e){return d(e,1)}function R(e,t){var n=e.Ca;0>e.b&&v(e);var A=e.b,r=n*t>>>8,i=(e.I>>>A>r)+0;for(i?(n-=r,e.I-=r+1<<A>>>0):n=r+1,A=n,r=0;256<=A;)r+=8,A>>=8;return A=7^r+Kn[A],e.b-=A,e.Ca=(n<<A)-1,i}function V(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function N(e,t){return e[t+0]|e[t+1]<<8}function k(e,t){return N(e,t)|e[t+2]<<16}function W(e,t){return N(e,t)|N(e,t+2)<<16}function F(e,n){var A=1<<n;return t(null!=e),t(0<n),e.X=i(A),null==e.X?0:(e.Mb=32-n,e.Xa=n,1)}function E(e,n){t(null!=e),t(null!=n),t(e.Xa==n.Xa),A(n.X,0,e.X,0,1<<n.Xa)}function X(){this.X=[],this.Xa=this.Mb=0}function H(e,n,A,r){t(null!=A),t(null!=r);var i=A[0],o=r[0];return 0==i&&(i=(e*o+n/2)/n),0==o&&(o=(n*i+e/2)/e),0>=i||0>=o?0:(A[0]=i,r[0]=o,1)}function x(e,t){return e+(1<<t)-1>>>t}function J(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function Y(t,n){e[n]=function(n,A,r,i,o,s,a){var g;for(g=0;g<o;++g){var l=e[t](s[a+g-1],r,i+g);s[a+g]=J(n[A+g],l)}}}function U(){this.ud=this.hd=this.jd=0}function L(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function T(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function K(e,t){return T(e+(e-t+.5>>1))}function M(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function Q(e,t,n,A,r,i,o){for(A=i[o-1],n=0;n<r;++n)i[o+n]=A=J(e[t+n],A)}function D(e,t,n,A,r){var i;for(i=0;i<n;++i){var o=e[t+i],s=o>>8&255,a=16711935&(a=(a=16711935&o)+((s<<16)+s));A[r+i]=(4278255360&o)+a>>>0}}function z(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function O(e,t,n,A,r,i){var o;for(o=0;o<A;++o){var s=t[n+o],a=s>>>8,g=s,l=255&(l=(l=s>>>16)+((e.jd<<24>>24)*(a<<24>>24)>>>5));g=255&(g=(g+=(e.hd<<24>>24)*(a<<24>>24)>>>5)+((e.ud<<24>>24)*(l<<24>>24)>>>5)),r[i+o]=(4278255360&s)+(l<<16)+g}}function P(t,n,A,r,i){e[n]=function(e,t,n,A,o,s,a,g,l){for(A=a;A<g;++A)for(a=0;a<l;++a)o[s++]=i(n[r(e[t++])])},e[t]=function(t,n,o,s,a,g,l){var c=8>>t.b,I=t.Ea,C=t.K[0],u=t.w;if(8>c)for(t=(1<<t.b)-1,u=(1<<c)-1;n<o;++n){var d,h=0;for(d=0;d<I;++d)d&t||(h=r(s[a++])),g[l++]=i(C[h&u]),h>>=c}else e["VP8LMapColor"+A](s,a,C,u,g,l,n,o,I)}}function _(e,t,n,A,r){for(n=t+n;t<n;){var i=e[t++];A[r++]=i>>16&255,A[r++]=i>>8&255,A[r++]=255&i}}function j(e,t,n,A,r){for(n=t+n;t<n;){var i=e[t++];A[r++]=i>>16&255,A[r++]=i>>8&255,A[r++]=255&i,A[r++]=i>>24&255}}function q(e,t,n,A,r){for(n=t+n;t<n;){var i=(o=e[t++])>>16&240|o>>12&15,o=240&o|o>>28&15;A[r++]=i,A[r++]=o}}function $(e,t,n,A,r){for(n=t+n;t<n;){var i=(o=e[t++])>>16&248|o>>13&7,o=o>>5&224|o>>3&31;A[r++]=i,A[r++]=o}}function ee(e,t,n,A,r){for(n=t+n;t<n;){var i=e[t++];A[r++]=255&i,A[r++]=i>>8&255,A[r++]=i>>16&255}}function te(e,t,n,r,i,o){if(0==o)for(n=t+n;t<n;)V(r,((o=e[t++])[0]>>24|o[1]>>8&65280|o[2]<<8&16711680|o[3]<<24)>>>0),i+=32;else A(r,i,e,t,n)}function ne(t,n){e[n][0]=e[t+"0"],e[n][1]=e[t+"1"],e[n][2]=e[t+"2"],e[n][3]=e[t+"3"],e[n][4]=e[t+"4"],e[n][5]=e[t+"5"],e[n][6]=e[t+"6"],e[n][7]=e[t+"7"],e[n][8]=e[t+"8"],e[n][9]=e[t+"9"],e[n][10]=e[t+"10"],e[n][11]=e[t+"11"],e[n][12]=e[t+"12"],e[n][13]=e[t+"13"],e[n][14]=e[t+"0"],e[n][15]=e[t+"0"]}function Ae(e){return e==TA||e==KA||e==MA||e==QA}function re(){this.eb=[],this.size=this.A=this.fb=0}function ie(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function oe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new re,this.f.kb=new ie,this.sd=null}function se(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ae(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ge(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function le(e,t){var n=e.T,r=t.ba.f.RGBA,i=r.eb,o=r.fb+e.ka*r.A,s=hr[t.ba.S],a=e.y,g=e.O,l=e.f,c=e.N,I=e.ea,C=e.W,u=t.cc,d=t.dc,h=t.Mc,m=t.Nc,p=e.ka,f=e.ka+e.T,b=e.U,B=b+1>>1;for(0==p?s(a,g,null,null,l,c,I,C,l,c,I,C,i,o,null,null,b):(s(t.ec,t.fc,a,g,u,d,h,m,l,c,I,C,i,o-r.A,i,o,b),++n);p+2<f;p+=2)u=l,d=c,h=I,m=C,c+=e.Rc,C+=e.Rc,o+=2*r.A,s(a,(g+=2*e.fa)-e.fa,a,g,u,d,h,m,l,c,I,C,i,o-r.A,i,o,b);return g+=e.fa,e.j+f<e.o?(A(t.ec,t.fc,a,g,b),A(t.cc,t.dc,l,c,B),A(t.Mc,t.Nc,I,C,B),n--):1&f||s(a,g,null,null,l,c,I,C,l,c,I,C,i,o+r.A,null,null,b),n}function ce(e,n,A){var r=e.F,i=[e.J];if(null!=r){var o=e.U,s=n.ba.S,a=s==YA||s==MA;n=n.ba.f.RGBA;var g=[0],l=e.ka;g[0]=e.T,e.Kb&&(0==l?--g[0]:(--l,i[0]-=e.width),e.j+e.ka+e.T==e.o&&(g[0]=e.o-e.j-l));var c=n.eb;l=n.fb+l*n.A,e=ZA(r,i[0],e.width,o,g,c,l+(a?0:3),n.A),t(A==g),e&&Ae(s)&&yA(c,l,a,o,g,n.A)}return 0}function Ie(e){var t=e.ma,n=t.ba.S,A=11>n,r=n==HA||n==JA||n==YA||n==UA||12==n||Ae(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Xn(t.Oa,e,r?11:12))return 0;if(r&&Ae(n)&&pn(),e.da)alert("todo:use_scaling");else{if(A){if(t.Ib=ge,e.Kb){if(n=e.U+1>>1,t.memory=i(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=le,pn()}}else alert("todo:EmitYUV");r&&(t.Jb=ce,A&&hn())}if(A&&!Vr){for(e=0;256>e;++e)Nr[e]=89858*(e-128)+Sr>>Zr,Fr[e]=-22014*(e-128)+Sr,Wr[e]=-45773*(e-128),kr[e]=113618*(e-128)+Sr>>Zr;for(e=vr;e<Gr;++e)t=76283*(e-16)+Sr>>Zr,Er[e-vr]=Qe(t,255),Xr[e-vr]=Qe(t+8>>4,15);Vr=1}return 1}function Ce(e){var n=e.ma,A=e.U,r=e.T;return t(!(1&e.ka)),0>=A||0>=r?0:(A=n.Ib(e,n),null!=n.Jb&&n.Jb(e,n,A),n.Dc+=A,1)}function ue(e){e.ma.memory=null}function de(e,t,n,A){return 47!=f(e,8)?0:(t[0]=f(e,14)+1,n[0]=f(e,14)+1,A[0]=f(e,1),0!=f(e,3)?0:!e.h)}function he(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+f(t,n)+1}function me(e,t){return 120<t?t-120:1<=(n=((n=jA[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function pe(e,t,n){var A=y(n),r=e[t+=255&A].g-8;return 0<r&&(Z(n,n.u+8),A=y(n),t+=e[t].value,t+=A&(1<<r)-1),Z(n,n.u+e[t].g),e[t].value}function fe(e,n,A){return A.g+=e.g,A.value+=e.value<<n>>>0,t(8>=A.g),e.g}function be(e,n,A){var r=e.xc;return t((n=0==r?0:e.vc[e.md*(A>>r)+(n>>r)])<e.Wb),e.Ya[n]}function Be(e,n,r,i){var o=e.ab,s=e.c*n,a=e.C;n=a+n;var g=r,l=i;for(i=e.Ta,r=e.Ua;0<o--;){var c=e.gc[o],I=a,C=n,u=g,d=l,h=(l=i,g=r,c.Ea);switch(t(I<C),t(C<=c.nc),c.hc){case 2:Dn(u,d,(C-I)*h,l,g);break;case 0:var m=I,p=C,f=l,b=g,B=(v=c).Ea;0==m&&(Mn(u,d,null,null,1,f,b),Q(u,d+1,0,0,B-1,f,b+1),d+=B,b+=B,++m);for(var y=1<<v.b,w=y-1,Z=x(B,v.b),S=v.K,v=v.w+(m>>v.b)*Z;m<p;){var G=S,R=v,V=1;for(Qn(u,d,f,b-B,1,f,b);V<B;){var N=(V&~w)+y;N>B&&(N=B),(0,jn[G[R++]>>8&15])(u,d+ +V,f,b+V-B,N-V,f,b+V),V=N}d+=B,b+=B,++m&w||(v+=Z)}C!=c.nc&&A(l,g-h,l,g+(C-I-1)*h,h);break;case 1:for(h=u,p=d,B=(u=c.Ea)-(b=u&~(f=(d=1<<c.b)-1)),m=x(u,c.b),y=c.K,c=c.w+(I>>c.b)*m;I<C;){for(w=y,Z=c,S=new U,v=p+b,G=p+u;p<v;)z(w[Z++],S),qn(S,h,p,d,l,g),p+=d,g+=d;p<G&&(z(w[Z++],S),qn(S,h,p,B,l,g),p+=B,g+=B),++I&f||(c+=m)}break;case 3:if(u==l&&d==g&&0<c.b){for(p=l,u=h=g+(C-I)*h-(b=(C-I)*x(c.Ea,c.b)),d=l,f=g,m=[],b=(B=b)-1;0<=b;--b)m[b]=d[f+b];for(b=B-1;0<=b;--b)p[u+b]=m[b];zn(c,I,C,l,h,l,g)}else zn(c,I,C,u,d,l,g)}g=i,l=r}l!=r&&A(i,r,g,l,s)}function ye(e,n){var A=e.V,r=e.Ba+e.c*e.C,i=n-e.C;if(t(n<=e.l.o),t(16>=i),0<i){var o=e.l,s=e.Ta,a=e.Ua,g=o.width;if(Be(e,i,A,r),i=a=[a],t((A=e.C)<(r=n)),t(o.v<o.va),r>o.o&&(r=o.o),A<o.j){var l=o.j-A;A=o.j,i[0]+=l*g}if(A>=r?A=0:(i[0]+=4*o.v,o.ka=A-o.j,o.U=o.va-o.v,o.T=r-A,A=1),A){if(a=a[0],11>(A=e.ca).S){var c=A.f.RGBA,I=(r=A.S,i=o.U,o=o.T,l=c.eb,c.A),C=o;for(c=c.fb+e.Ma*c.A;0<C--;){var u=s,d=a,h=i,m=l,p=c;switch(r){case XA:$n(u,d,h,m,p);break;case HA:eA(u,d,h,m,p);break;case TA:eA(u,d,h,m,p),yA(m,p,0,h,1,0);break;case xA:AA(u,d,h,m,p);break;case JA:te(u,d,h,m,p,1);break;case KA:te(u,d,h,m,p,1),yA(m,p,0,h,1,0);break;case YA:te(u,d,h,m,p,0);break;case MA:te(u,d,h,m,p,0),yA(m,p,1,h,1,0);break;case UA:tA(u,d,h,m,p);break;case QA:tA(u,d,h,m,p),wA(m,p,h,1,0);break;case LA:nA(u,d,h,m,p);break;default:t(0)}a+=g,c+=I}e.Ma+=o}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=A.height)}}e.C=n,t(e.C<=e.i)}function we(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,A=e.Ya[t].H;if(0<n[1][A[1]+0].g||0<n[2][A[2]+0].g||0<n[3][A[3]+0].g)return 0}return 1}function Ze(e,n,A,r,i,o){if(0!=e.Z){var s=e.qd,a=e.rd;for(t(null!=dr[e.Z]);n<A;++n)dr[e.Z](s,a,r,i,r,i,o),s=r,a=i,i+=o;e.qd=s,e.rd=a}}function Se(e,n){var A=e.l.ma,r=0==A.Z||1==A.Z?e.l.j:e.C;if(r=e.C<r?r:e.C,t(n<=e.l.o),n>r){var i=e.l.width,o=A.ca,s=A.tb+i*r,a=e.V,g=e.Ba+e.c*r,l=e.gc;t(1==e.ab),t(3==l[0].hc),Pn(l[0],r,n,a,g,o,s),Ze(A,r,n,o,s,i)}e.C=e.Ma=n}function ve(e,n,A,r,i,o,s){var a=e.$/r,g=e.$%r,l=e.m,c=e.s,I=A+e.$,C=I;i=A+r*i;var u=A+r*o,d=280+c.ua,h=e.Pb?a:16777216,m=0<c.ua?c.Wa:null,p=c.wc,f=I<u?be(c,g,a):null;t(e.C<o),t(u<=i);var b=!1;e:for(;;){for(;b||I<u;){var B=0;if(a>=h){var v=I-A;t((h=e).Pb),h.wd=h.m,h.xd=v,0<h.s.ua&&E(h.s.Wa,h.s.vb),h=a+$A}if(g&p||(f=be(c,g,a)),t(null!=f),f.Qb&&(n[I]=f.qb,b=!0),!b)if(S(l),f.jc){B=l,v=n;var G=I,R=f.pd[y(B)&Jn-1];t(f.jc),256>R.g?(Z(B,B.u+R.g),v[G]=R.value,B=0):(Z(B,B.u+R.g-256),t(256<=R.value),B=R.value),0==B&&(b=!0)}else B=pe(f.G[0],f.H[0],l);if(l.h)break;if(b||256>B){if(!b)if(f.nd)n[I]=(f.qb|B<<8)>>>0;else{if(S(l),b=pe(f.G[1],f.H[1],l),S(l),v=pe(f.G[2],f.H[2],l),G=pe(f.G[3],f.H[3],l),l.h)break;n[I]=(G<<24|b<<16|B<<8|v)>>>0}if(b=!1,++I,++g>=r&&(g=0,++a,null!=s&&a<=o&&!(a%16)&&s(e,a),null!=m))for(;C<I;)B=n[C++],m.X[(506832829*B&4294967295)>>>m.Mb]=B}else if(280>B){if(B=he(B-256,l),v=pe(f.G[4],f.H[4],l),S(l),v=me(r,v=he(v,l)),l.h)break;if(I-A<v||i-I<B)break e;for(G=0;G<B;++G)n[I+G]=n[I+G-v];for(I+=B,g+=B;g>=r;)g-=r,++a,null!=s&&a<=o&&!(a%16)&&s(e,a);if(t(I<=i),g&p&&(f=be(c,g,a)),null!=m)for(;C<I;)B=n[C++],m.X[(506832829*B&4294967295)>>>m.Mb]=B}else{if(!(B<d))break e;for(b=B-280,t(null!=m);C<I;)B=n[C++],m.X[(506832829*B&4294967295)>>>m.Mb]=B;B=I,t(!(b>>>(v=m).Xa)),n[B]=v.X[b],b=!0}b||t(l.h==w(l))}if(e.Pb&&l.h&&I<i)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&E(e.s.vb,e.s.Wa);else{if(l.h)break e;null!=s&&s(e,a>o?o:a),e.a=0,e.$=I-A}return 1}return e.a=3,0}function Ge(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var n=e.Wa;null!=n&&(n.X=null),e.vb=null,t(null!=e)}function Re(){var t=new on;return null==t?null:(t.a=0,t.xb=ur,ne("Predictor","VP8LPredictors"),ne("Predictor","VP8LPredictors_C"),ne("PredictorAdd","VP8LPredictorsAdd"),ne("PredictorAdd","VP8LPredictorsAdd_C"),Dn=D,qn=O,$n=_,eA=j,tA=q,nA=$,AA=ee,e.VP8LMapColor32b=On,e.VP8LMapColor8b=_n,t)}function Ve(e,n,A,s,a){var g=1,I=[e],u=[n],d=s.m,h=s.s,m=null,p=0;e:for(;;){if(A)for(;g&&f(d,1);){var b=I,B=u,w=s,v=1,G=w.m,R=w.gc[w.ab],V=f(G,2);if(w.Oc&1<<V)g=0;else{switch(w.Oc|=1<<V,R.hc=V,R.Ea=b[0],R.nc=B[0],R.K=[null],++w.ab,t(4>=w.ab),V){case 0:case 1:R.b=f(G,3)+2,v=Ve(x(R.Ea,R.b),x(R.nc,R.b),0,w,R.K),R.K=R.K[0];break;case 3:var N,k=f(G,8)+1,W=16<k?0:4<k?1:2<k?2:3;if(b[0]=x(R.Ea,W),R.b=W,N=v=Ve(k,1,0,w,R.K)){var E,X=k,H=R,Y=1<<(8>>H.b),U=i(Y);if(null==U)N=0;else{var L=H.K[0],T=H.w;for(U[0]=H.K[0][0],E=1;E<1*X;++E)U[E]=J(L[T+E],U[E-1]);for(;E<4*Y;++E)U[E]=0;H.K[0]=null,H.K[0]=U,N=1}}v=N;break;case 2:break;default:t(0)}g=v}}if(I=I[0],u=u[0],g&&f(d,1)&&!(g=1<=(p=f(d,4))&&11>=p)){s.a=3;break e}var K;if(K=g)t:{var M,Q,D,z=s,O=I,P=u,_=p,j=A,q=z.m,$=z.s,ee=[null],te=1,ne=0,Ae=qA[_];n:for(;;){if(j&&f(q,1)){var re=f(q,3)+2,ie=x(O,re),oe=x(P,re),se=ie*oe;if(!Ve(ie,oe,0,z,ee))break n;for(ee=ee[0],$.xc=re,M=0;M<se;++M){var ae=ee[M]>>8&65535;ee[M]=ae,ae>=te&&(te=ae+1)}}if(q.h)break n;for(Q=0;5>Q;++Q){var ge=OA[Q];!Q&&0<_&&(ge+=1<<_),ne<ge&&(ne=ge)}var le=o(te*Ae,c),ce=te,Ie=o(ce,C);if(null==Ie)var Ce=null;else t(65536>=ce),Ce=Ie;var ue=i(ne);if(null==Ce||null==ue||null==le){z.a=1;break n}var de=le;for(M=D=0;M<te;++M){var he=Ce[M],me=he.G,pe=he.H,be=0,Be=1,ye=0;for(Q=0;5>Q;++Q){ge=OA[Q],me[Q]=de,pe[Q]=D,!Q&&0<_&&(ge+=1<<_);A:{var we,Ze=ge,Se=z,Re=ue,Ne=de,ke=D,We=0,Fe=Se.m,Ee=f(Fe,1);if(r(Re,0,0,Ze),Ee){var Xe=f(Fe,1)+1,He=f(Fe,1),xe=f(Fe,0==He?1:8);Re[xe]=1,2==Xe&&(Re[xe=f(Fe,8)]=1);var Je=1}else{var Ye=i(19),Ue=f(Fe,4)+4;if(19<Ue){Se.a=3;var Le=0;break A}for(we=0;we<Ue;++we)Ye[_A[we]]=f(Fe,3);var Te=void 0,Ke=void 0,Me=Se,Qe=Ye,De=Ze,ze=Re,Oe=0,Pe=Me.m,_e=8,je=o(128,c);r:for(;l(je,0,7,Qe,19);){if(f(Pe,1)){var qe=2+2*f(Pe,3);if((Te=2+f(Pe,qe))>De)break r}else Te=De;for(Ke=0;Ke<De&&Te--;){S(Pe);var $e=je[0+(127&y(Pe))];Z(Pe,Pe.u+$e.g);var et=$e.value;if(16>et)ze[Ke++]=et,0!=et&&(_e=et);else{var tt=16==et,nt=et-16,At=zA[nt],rt=f(Pe,DA[nt])+At;if(Ke+rt>De)break r;for(var it=tt?_e:0;0<rt--;)ze[Ke++]=it}}Oe=1;break r}Oe||(Me.a=3),Je=Oe}(Je=Je&&!Fe.h)&&(We=l(Ne,ke,8,Re,Ze)),Je&&0!=We?Le=We:(Se.a=3,Le=0)}if(0==Le)break n;if(Be&&1==PA[Q]&&(Be=0==de[D].g),be+=de[D].g,D+=Le,3>=Q){var ot,st=ue[0];for(ot=1;ot<ge;++ot)ue[ot]>st&&(st=ue[ot]);ye+=st}}if(he.nd=Be,he.Qb=0,Be&&(he.qb=(me[3][pe[3]+0].value<<24|me[1][pe[1]+0].value<<16|me[2][pe[2]+0].value)>>>0,0==be&&256>me[0][pe[0]+0].value&&(he.Qb=1,he.qb+=me[0][pe[0]+0].value<<8)),he.jc=!he.Qb&&6>ye,he.jc){var at,gt=he;for(at=0;at<Jn;++at){var lt=at,ct=gt.pd[lt],It=gt.G[0][gt.H[0]+lt];256<=It.value?(ct.g=It.g+256,ct.value=It.value):(ct.g=0,ct.value=0,lt>>=fe(It,8,ct),lt>>=fe(gt.G[1][gt.H[1]+lt],16,ct),lt>>=fe(gt.G[2][gt.H[2]+lt],0,ct),fe(gt.G[3][gt.H[3]+lt],24,ct))}}}$.vc=ee,$.Wb=te,$.Ya=Ce,$.yc=le,K=1;break t}K=0}if(!(g=K)){s.a=3;break e}if(0<p){if(h.ua=1<<p,!F(h.Wa,p)){s.a=1,g=0;break e}}else h.ua=0;var Ct=s,ut=I,dt=u,ht=Ct.s,mt=ht.xc;if(Ct.c=ut,Ct.i=dt,ht.md=x(ut,mt),ht.wc=0==mt?-1:(1<<mt)-1,A){s.xb=Cr;break e}if(null==(m=i(I*u))){s.a=1,g=0;break e}g=(g=ve(s,m,0,I,u,u,null))&&!d.h;break e}return g?(null!=a?a[0]=m:(t(null==m),t(A)),s.$=0,A||Ge(h)):Ge(h),g}function Ne(e,n){var A=e.c*e.i,r=A+n+16*n;return t(e.c<=n),e.V=i(r),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+A+n,1)}function ke(e,n){var A=e.C,r=n-A,i=e.V,o=e.Ba+e.c*A;for(t(n<=e.l.o);0<r;){var s=16<r?16:r,a=e.l.ma,g=e.l.width,l=g*s,c=a.ca,I=a.tb+g*A,C=e.Ta,u=e.Ua;Be(e,s,i,o),SA(C,u,c,I,l),Ze(a,A,A+s,c,I,g),r-=s,i+=s*e.c,A+=s}t(A==n),e.C=e.Ma=n}function We(){this.ub=this.yd=this.td=this.Rb=0}function Fe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ee(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Xe(){var e;this.Yb=(function e(t,n,A){for(var r=A[n],i=0;i<r&&(t.push(A.length>n+1?[]:0),!(A.length<n+1));i++)e(t[i],n+1,A)}(e=[],0,[3,11]),e)}function He(){this.jb=i(3),this.Wc=s([4,8],Xe),this.Xc=s([4,17],Xe)}function xe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Je(){this.ld=this.La=this.dd=this.tc=0}function Ye(){this.Na=this.la=0}function Ue(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Le(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Te(){this.uc=this.M=this.Nb=0,this.wa=Array(new Je),this.Y=0,this.ya=Array(new Le),this.aa=0,this.l=new De}function Ke(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Me(){this.cb=this.a=0,this.sc="",this.m=new b,this.Od=new We,this.Kc=new Fe,this.ed=new xe,this.Qa=new Ee,this.Ic=this.$c=this.Aa=0,this.D=new Te,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,b),this.ia=0,this.pb=o(4,Ue),this.Pa=new He,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ke),this.Hd=0,this.rb=Array(new Ye),this.sb=0,this.wa=Array(new Je),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Le),this.L=this.aa=0,this.gd=s([4,2],Je),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qe(e,t){return 0>e?0:e>t?t:e}function De(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ze(){var e=new Me;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,nr||(nr=je)),e}function Oe(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Pe(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function _e(e,n){if(null==e)return 0;if(e.a=0,e.sc="OK",null==n)return Oe(e,2,"null VP8Io passed to VP8GetHeaders()");var A=n.data,i=n.w,o=n.ha;if(4>o)return Oe(e,7,"Truncated header.");var s=A[i+0]|A[i+1]<<8|A[i+2]<<16,a=e.Od;if(a.Rb=!(1&s),a.td=s>>1&7,a.yd=s>>4&1,a.ub=s>>5,3<a.td)return Oe(e,3,"Incorrect keyframe parameters.");if(!a.yd)return Oe(e,4,"Frame not displayable.");i+=3,o-=3;var g=e.Kc;if(a.Rb){if(7>o)return Oe(e,7,"cannot parse picture header");if(!Pe(A,i,o))return Oe(e,3,"Bad code word");g.c=16383&(A[i+4]<<8|A[i+3]),g.Td=A[i+4]>>6,g.i=16383&(A[i+6]<<8|A[i+5]),g.Ud=A[i+6]>>6,i+=7,o-=7,e.za=g.c+15>>4,e.Ub=g.i+15>>4,n.width=g.c,n.height=g.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,r((s=e.Pa).jb,0,255,s.jb.length),t(null!=(s=e.Qa)),s.Cb=0,s.Bb=0,s.Fb=1,r(s.Zb,0,0,s.Zb.length),r(s.Lb,0,0,s.Lb)}if(a.ub>o)return Oe(e,7,"bad partition length");u(s=e.m,A,i,a.ub),i+=a.ub,o-=a.ub,a.Rb&&(g.Ld=G(s),g.Kd=G(s)),g=e.Qa;var l,c=e.Pa;if(t(null!=s),t(null!=g),g.Cb=G(s),g.Cb){if(g.Bb=G(s),G(s)){for(g.Fb=G(s),l=0;4>l;++l)g.Zb[l]=G(s)?h(s,7):0;for(l=0;4>l;++l)g.Lb[l]=G(s)?h(s,6):0}if(g.Bb)for(l=0;3>l;++l)c.jb[l]=G(s)?d(s,8):255}else g.Bb=0;if(s.Ka)return Oe(e,3,"cannot parse segment header");if((g=e.ed).zd=G(s),g.Tb=d(s,6),g.wb=d(s,3),g.Pc=G(s),g.Pc&&G(s)){for(c=0;4>c;++c)G(s)&&(g.vd[c]=h(s,6));for(c=0;4>c;++c)G(s)&&(g.od[c]=h(s,6))}if(e.L=0==g.Tb?0:g.zd?1:2,s.Ka)return Oe(e,3,"cannot parse filter header");var I=o;if(o=l=i,i=l+I,g=I,e.Xb=(1<<d(e.m,2))-1,I<3*(c=e.Xb))A=7;else{for(l+=3*c,g-=3*c,I=0;I<c;++I){var C=A[o+0]|A[o+1]<<8|A[o+2]<<16;C>g&&(C=g),u(e.Jc[+I],A,l,C),l+=C,g-=C,o+=3}u(e.Jc[+c],A,l,g),A=l<i?0:5}if(0!=A)return Oe(e,A,"cannot parse partitions");for(A=d(l=e.m,7),o=G(l)?h(l,4):0,i=G(l)?h(l,4):0,g=G(l)?h(l,4):0,c=G(l)?h(l,4):0,l=G(l)?h(l,4):0,I=e.Qa,C=0;4>C;++C){if(I.Cb){var m=I.Zb[C];I.Fb||(m+=A)}else{if(0<C){e.pb[C]=e.pb[0];continue}m=A}var p=e.pb[C];p.Sc[0]=er[Qe(m+o,127)],p.Sc[1]=tr[Qe(m+0,127)],p.Eb[0]=2*er[Qe(m+i,127)],p.Eb[1]=101581*tr[Qe(m+g,127)]>>16,8>p.Eb[1]&&(p.Eb[1]=8),p.Qc[0]=er[Qe(m+c,117)],p.Qc[1]=tr[Qe(m+l,127)],p.lc=m+l}if(!a.Rb)return Oe(e,4,"Not a key frame.");for(G(s),a=e.Pa,A=0;4>A;++A){for(o=0;8>o;++o)for(i=0;3>i;++i)for(g=0;11>g;++g)c=R(s,ar[A][o][i][g])?d(s,8):or[A][o][i][g],a.Wc[A][o].Yb[i][g]=c;for(o=0;17>o;++o)a.Xc[A][o]=a.Wc[A][gr[o]]}return e.kc=G(s),e.kc&&(e.Bd=d(s,8)),e.cb=1}function je(e,t,n,A,r,i,o){var s=t[r].Yb[n];for(n=0;16>r;++r){if(!R(e,s[n+0]))return r;for(;!R(e,s[n+1]);)if(s=t[++r].Yb[0],n=0,16==r)return 16;var a=t[r+1].Yb;if(R(e,s[n+2])){var g=e,l=0;if(R(g,(I=s)[(c=n)+3]))if(R(g,I[c+6])){for(s=0,c=2*(l=R(g,I[c+8]))+(I=R(g,I[c+9+l])),l=0,I=Ar[c];I[s];++s)l+=l+R(g,I[s]);l+=3+(8<<c)}else R(g,I[c+7])?(l=7+2*R(g,165),l+=R(g,145)):l=5+R(g,159);else l=R(g,I[c+4])?3+R(g,I[c+5]):2;s=a[2]}else l=1,s=a[1];a=o+rr[r],0>(g=e).b&&v(g);var c,I=g.b,C=(c=g.Ca>>1)-(g.I>>I)>>31;--g.b,g.Ca+=C,g.Ca|=1,g.I-=(c+1&C)<<I,i[a]=((l^C)-C)*A[(0<r)+0]}return 16}function qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,r(e.zc,0,0,e.zc.length),e.ja=0}function $e(e,t,n,A,r){r=e[t+n+32*A]+(r>>3),e[t+n+32*A]=-256&r?0>r?0:255:r}function et(e,t,n,A,r,i){$e(e,t,0,n,A+r),$e(e,t,1,n,A+i),$e(e,t,2,n,A-i),$e(e,t,3,n,A-r)}function tt(e){return(20091*e>>16)+e}function nt(e,t,n,A){var r,o=0,s=i(16);for(r=0;4>r;++r){var a=e[t+0]+e[t+8],g=e[t+0]-e[t+8],l=(35468*e[t+4]>>16)-tt(e[t+12]),c=tt(e[t+4])+(35468*e[t+12]>>16);s[o+0]=a+c,s[o+1]=g+l,s[o+2]=g-l,s[o+3]=a-c,o+=4,t++}for(r=o=0;4>r;++r)a=(e=s[o+0]+4)+s[o+8],g=e-s[o+8],l=(35468*s[o+4]>>16)-tt(s[o+12]),$e(n,A,0,0,a+(c=tt(s[o+4])+(35468*s[o+12]>>16))),$e(n,A,1,0,g+l),$e(n,A,2,0,g-l),$e(n,A,3,0,a-c),o++,A+=32}function At(e,t,n,A){var r=e[t+0]+4,i=35468*e[t+4]>>16,o=tt(e[t+4]),s=35468*e[t+1]>>16;et(n,A,0,r+o,e=tt(e[t+1]),s),et(n,A,1,r+i,e,s),et(n,A,2,r-i,e,s),et(n,A,3,r-o,e,s)}function rt(e,t,n,A,r){nt(e,t,n,A),r&&nt(e,t+16,n,A+4)}function it(e,t,n,A){iA(e,t+0,n,A,1),iA(e,t+32,n,A+128,1)}function ot(e,t,n,A){var r;for(e=e[t+0]+4,r=0;4>r;++r)for(t=0;4>t;++t)$e(n,A,t,r,e)}function st(e,t,n,A){e[t+0]&&aA(e,t+0,n,A),e[t+16]&&aA(e,t+16,n,A+4),e[t+32]&&aA(e,t+32,n,A+128),e[t+48]&&aA(e,t+48,n,A+128+4)}function at(e,t,n,A){var r,o=i(16);for(r=0;4>r;++r){var s=e[t+0+r]+e[t+12+r],a=e[t+4+r]+e[t+8+r],g=e[t+4+r]-e[t+8+r],l=e[t+0+r]-e[t+12+r];o[0+r]=s+a,o[8+r]=s-a,o[4+r]=l+g,o[12+r]=l-g}for(r=0;4>r;++r)s=(e=o[0+4*r]+3)+o[3+4*r],a=o[1+4*r]+o[2+4*r],g=o[1+4*r]-o[2+4*r],l=e-o[3+4*r],n[A+0]=s+a>>3,n[A+16]=l+g>>3,n[A+32]=s-a>>3,n[A+48]=l-g>>3,A+=64}function gt(e,t,n){var A,r=t-32,i=FA,o=255-e[r-1];for(A=0;A<n;++A){var s,a=i,g=o+e[t-1];for(s=0;s<n;++s)e[t+s]=a[g+e[r+s]];t+=32}}function lt(e,t){gt(e,t,4)}function ct(e,t){gt(e,t,8)}function It(e,t){gt(e,t,16)}function Ct(e,t){var n;for(n=0;16>n;++n)A(e,t+32*n,e,t-32,16)}function ut(e,t){var n;for(n=16;0<n;--n)r(e,t,e[t-1],16),t+=32}function dt(e,t,n){var A;for(A=0;16>A;++A)r(t,n+32*A,e,16)}function ht(e,t){var n,A=16;for(n=0;16>n;++n)A+=e[t-1+32*n]+e[t+n-32];dt(A>>5,e,t)}function mt(e,t){var n,A=8;for(n=0;16>n;++n)A+=e[t-1+32*n];dt(A>>4,e,t)}function pt(e,t){var n,A=8;for(n=0;16>n;++n)A+=e[t+n-32];dt(A>>4,e,t)}function ft(e,t){dt(128,e,t)}function bt(e,t,n){return e+2*t+n+2>>2}function Bt(e,t){var n,r=t-32;for(r=new Uint8Array([bt(e[r-1],e[r+0],e[r+1]),bt(e[r+0],e[r+1],e[r+2]),bt(e[r+1],e[r+2],e[r+3]),bt(e[r+2],e[r+3],e[r+4])]),n=0;4>n;++n)A(e,t+32*n,r,0,r.length)}function yt(e,t){var n=e[t-1],A=e[t-1+32],r=e[t-1+64],i=e[t-1+96];V(e,t+0,16843009*bt(e[t-1-32],n,A)),V(e,t+32,16843009*bt(n,A,r)),V(e,t+64,16843009*bt(A,r,i)),V(e,t+96,16843009*bt(r,i,i))}function wt(e,t){var n,A=4;for(n=0;4>n;++n)A+=e[t+n-32]+e[t-1+32*n];for(A>>=3,n=0;4>n;++n)r(e,t+32*n,A,4)}function Zt(e,t){var n=e[t-1+0],A=e[t-1+32],r=e[t-1+64],i=e[t-1-32],o=e[t+0-32],s=e[t+1-32],a=e[t+2-32],g=e[t+3-32];e[t+0+96]=bt(A,r,e[t-1+96]),e[t+1+96]=e[t+0+64]=bt(n,A,r),e[t+2+96]=e[t+1+64]=e[t+0+32]=bt(i,n,A),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=bt(o,i,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=bt(s,o,i),e[t+3+32]=e[t+2+0]=bt(a,s,o),e[t+3+0]=bt(g,a,s)}function St(e,t){var n=e[t+1-32],A=e[t+2-32],r=e[t+3-32],i=e[t+4-32],o=e[t+5-32],s=e[t+6-32],a=e[t+7-32];e[t+0+0]=bt(e[t+0-32],n,A),e[t+1+0]=e[t+0+32]=bt(n,A,r),e[t+2+0]=e[t+1+32]=e[t+0+64]=bt(A,r,i),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=bt(r,i,o),e[t+3+32]=e[t+2+64]=e[t+1+96]=bt(i,o,s),e[t+3+64]=e[t+2+96]=bt(o,s,a),e[t+3+96]=bt(s,a,a)}function vt(e,t){var n=e[t-1+0],A=e[t-1+32],r=e[t-1+64],i=e[t-1-32],o=e[t+0-32],s=e[t+1-32],a=e[t+2-32],g=e[t+3-32];e[t+0+0]=e[t+1+64]=i+o+1>>1,e[t+1+0]=e[t+2+64]=o+s+1>>1,e[t+2+0]=e[t+3+64]=s+a+1>>1,e[t+3+0]=a+g+1>>1,e[t+0+96]=bt(r,A,n),e[t+0+64]=bt(A,n,i),e[t+0+32]=e[t+1+96]=bt(n,i,o),e[t+1+32]=e[t+2+96]=bt(i,o,s),e[t+2+32]=e[t+3+96]=bt(o,s,a),e[t+3+32]=bt(s,a,g)}function Gt(e,t){var n=e[t+0-32],A=e[t+1-32],r=e[t+2-32],i=e[t+3-32],o=e[t+4-32],s=e[t+5-32],a=e[t+6-32],g=e[t+7-32];e[t+0+0]=n+A+1>>1,e[t+1+0]=e[t+0+64]=A+r+1>>1,e[t+2+0]=e[t+1+64]=r+i+1>>1,e[t+3+0]=e[t+2+64]=i+o+1>>1,e[t+0+32]=bt(n,A,r),e[t+1+32]=e[t+0+96]=bt(A,r,i),e[t+2+32]=e[t+1+96]=bt(r,i,o),e[t+3+32]=e[t+2+96]=bt(i,o,s),e[t+3+64]=bt(o,s,a),e[t+3+96]=bt(s,a,g)}function Rt(e,t){var n=e[t-1+0],A=e[t-1+32],r=e[t-1+64],i=e[t-1+96];e[t+0+0]=n+A+1>>1,e[t+2+0]=e[t+0+32]=A+r+1>>1,e[t+2+32]=e[t+0+64]=r+i+1>>1,e[t+1+0]=bt(n,A,r),e[t+3+0]=e[t+1+32]=bt(A,r,i),e[t+3+32]=e[t+1+64]=bt(r,i,i),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=i}function Vt(e,t){var n=e[t-1+0],A=e[t-1+32],r=e[t-1+64],i=e[t-1+96],o=e[t-1-32],s=e[t+0-32],a=e[t+1-32],g=e[t+2-32];e[t+0+0]=e[t+2+32]=n+o+1>>1,e[t+0+32]=e[t+2+64]=A+n+1>>1,e[t+0+64]=e[t+2+96]=r+A+1>>1,e[t+0+96]=i+r+1>>1,e[t+3+0]=bt(s,a,g),e[t+2+0]=bt(o,s,a),e[t+1+0]=e[t+3+32]=bt(n,o,s),e[t+1+32]=e[t+3+64]=bt(A,n,o),e[t+1+64]=e[t+3+96]=bt(r,A,n),e[t+1+96]=bt(i,r,A)}function Nt(e,t){var n;for(n=0;8>n;++n)A(e,t+32*n,e,t-32,8)}function kt(e,t){var n;for(n=0;8>n;++n)r(e,t,e[t-1],8),t+=32}function Wt(e,t,n){var A;for(A=0;8>A;++A)r(t,n+32*A,e,8)}function Ft(e,t){var n,A=8;for(n=0;8>n;++n)A+=e[t+n-32]+e[t-1+32*n];Wt(A>>4,e,t)}function Et(e,t){var n,A=4;for(n=0;8>n;++n)A+=e[t+n-32];Wt(A>>3,e,t)}function Xt(e,t){var n,A=4;for(n=0;8>n;++n)A+=e[t-1+32*n];Wt(A>>3,e,t)}function Ht(e,t){Wt(128,e,t)}function xt(e,t,n){var A=e[t-n],r=e[t+0],i=3*(r-A)+kA[1020+e[t-2*n]-e[t+n]],o=WA[112+(i+4>>3)];e[t-n]=FA[255+A+WA[112+(i+3>>3)]],e[t+0]=FA[255+r-o]}function Jt(e,t,n,A){var r=e[t+0],i=e[t+n];return EA[255+e[t-2*n]-e[t-n]]>A||EA[255+i-r]>A}function Yt(e,t,n,A){return 4*EA[255+e[t-n]-e[t+0]]+EA[255+e[t-2*n]-e[t+n]]<=A}function Ut(e,t,n,A,r){var i=e[t-3*n],o=e[t-2*n],s=e[t-n],a=e[t+0],g=e[t+n],l=e[t+2*n],c=e[t+3*n];return 4*EA[255+s-a]+EA[255+o-g]>A?0:EA[255+e[t-4*n]-i]<=r&&EA[255+i-o]<=r&&EA[255+o-s]<=r&&EA[255+c-l]<=r&&EA[255+l-g]<=r&&EA[255+g-a]<=r}function Lt(e,t,n,A){var r=2*A+1;for(A=0;16>A;++A)Yt(e,t+A,n,r)&&xt(e,t+A,n)}function Tt(e,t,n,A){var r=2*A+1;for(A=0;16>A;++A)Yt(e,t+A*n,1,r)&&xt(e,t+A*n,1)}function Kt(e,t,n,A){var r;for(r=3;0<r;--r)Lt(e,t+=4*n,n,A)}function Mt(e,t,n,A){var r;for(r=3;0<r;--r)Tt(e,t+=4,n,A)}function Qt(e,t,n,A,r,i,o,s){for(i=2*i+1;0<r--;){if(Ut(e,t,n,i,o))if(Jt(e,t,n,s))xt(e,t,n);else{var a=e,g=t,l=n,c=a[g-2*l],I=a[g-l],C=a[g+0],u=a[g+l],d=a[g+2*l],h=27*(p=kA[1020+3*(C-I)+kA[1020+c-u]])+63>>7,m=18*p+63>>7,p=9*p+63>>7;a[g-3*l]=FA[255+a[g-3*l]+p],a[g-2*l]=FA[255+c+m],a[g-l]=FA[255+I+h],a[g+0]=FA[255+C-h],a[g+l]=FA[255+u-m],a[g+2*l]=FA[255+d-p]}t+=A}}function Dt(e,t,n,A,r,i,o,s){for(i=2*i+1;0<r--;){if(Ut(e,t,n,i,o))if(Jt(e,t,n,s))xt(e,t,n);else{var a=e,g=t,l=n,c=a[g-l],I=a[g+0],C=a[g+l],u=WA[112+(4+(d=3*(I-c))>>3)],d=WA[112+(d+3>>3)],h=u+1>>1;a[g-2*l]=FA[255+a[g-2*l]+h],a[g-l]=FA[255+c+d],a[g+0]=FA[255+I-u],a[g+l]=FA[255+C-h]}t+=A}}function zt(e,t,n,A,r,i){Qt(e,t,n,1,16,A,r,i)}function Ot(e,t,n,A,r,i){Qt(e,t,1,n,16,A,r,i)}function Pt(e,t,n,A,r,i){var o;for(o=3;0<o;--o)Dt(e,t+=4*n,n,1,16,A,r,i)}function _t(e,t,n,A,r,i){var o;for(o=3;0<o;--o)Dt(e,t+=4,1,n,16,A,r,i)}function jt(e,t,n,A,r,i,o,s){Qt(e,t,r,1,8,i,o,s),Qt(n,A,r,1,8,i,o,s)}function qt(e,t,n,A,r,i,o,s){Qt(e,t,1,r,8,i,o,s),Qt(n,A,1,r,8,i,o,s)}function $t(e,t,n,A,r,i,o,s){Dt(e,t+4*r,r,1,8,i,o,s),Dt(n,A+4*r,r,1,8,i,o,s)}function en(e,t,n,A,r,i,o,s){Dt(e,t+4,1,r,8,i,o,s),Dt(n,A+4,1,r,8,i,o,s)}function tn(){this.ba=new oe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ae,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function An(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function rn(){this.ua=0,this.Wa=new X,this.vb=new X,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new C,this.yc=new c}function on(){this.xb=this.a=0,this.l=new De,this.ca=new oe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new B,this.Pb=0,this.wd=new B,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new rn,this.ab=0,this.gc=o(4,An),this.Oc=0}function sn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new De,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function an(e,t,n,A,r,i,o){for(e=null==e?0:e[t+0],t=0;t<o;++t)r[i+t]=e+n[A+t]&255,e=r[i+t]}function gn(e,t,n,A,r,i,o){var s;if(null==e)an(null,null,n,A,r,i,o);else for(s=0;s<o;++s)r[i+s]=e[t+s]+n[A+s]&255}function ln(e,t,n,A,r,i,o){if(null==e)an(null,null,n,A,r,i,o);else{var s,a=e[t+0],g=a,l=a;for(s=0;s<o;++s)g=l+(a=e[t+s])-g,l=n[A+s]+(-256&g?0>g?0:255:g)&255,g=a,r[i+s]=l}}function cn(e,n,r,o){var s=n.width,a=n.o;if(t(null!=e&&null!=n),0>r||0>=o||r+o>a)return null;if(!e.Cc){if(null==e.ga){var g;if(e.ga=new sn,(g=null==e.ga)||(g=n.width*n.o,t(0==e.Gb.length),e.Gb=i(g),e.Uc=0,null==e.Gb?g=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,g=1),g=!g),!g){g=e.ga;var l=e.Fa,c=e.P,I=e.qc,C=e.mb,u=e.nb,d=c+1,h=I-1,p=g.l;if(t(null!=l&&null!=C&&null!=n),dr[0]=null,dr[1]=an,dr[2]=gn,dr[3]=ln,g.ca=C,g.tb=u,g.c=n.width,g.i=n.height,t(0<g.c&&0<g.i),1>=I)n=0;else if(g.$a=3&l[c+0],g.Z=l[c+0]>>2&3,g.Lc=l[c+0]>>4&3,c=l[c+0]>>6&3,0>g.$a||1<g.$a||4<=g.Z||1<g.Lc||c)n=0;else if(p.put=Ce,p.ac=Ie,p.bc=ue,p.ma=g,p.width=n.width,p.height=n.height,p.Da=n.Da,p.v=n.v,p.va=n.va,p.j=n.j,p.o=n.o,g.$a)e:{t(1==g.$a),n=Re();t:for(;;){if(null==n){n=0;break e}if(t(null!=g),g.mc=n,n.c=g.c,n.i=g.i,n.l=g.l,n.l.ma=g,n.l.width=g.c,n.l.height=g.i,n.a=0,m(n.m,l,d,h),!Ve(g.c,g.i,1,n,null))break t;if(1==n.ab&&3==n.gc[0].hc&&we(n.s)?(g.ic=1,l=n.c*n.i,n.Ta=null,n.Ua=0,n.V=i(l),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(g.ic=0,n=Ne(n,g.c)),!n)break t;n=1;break e}g.mc=null,n=0}else n=h>=g.c*g.i;g=!n}if(g)return null;1!=e.ga.Lc?e.Ga=0:o=a-r}t(null!=e.ga),t(r+o<=a);e:{if(n=(l=e.ga).c,a=l.l.o,0==l.$a){if(d=e.rc,h=e.Vc,p=e.Fa,c=e.P+1+r*n,I=e.mb,C=e.nb+r*n,t(c<=e.P+e.qc),0!=l.Z)for(t(null!=dr[l.Z]),g=0;g<o;++g)dr[l.Z](d,h,p,c,I,C,n),d=I,h=C,C+=n,c+=n;else for(g=0;g<o;++g)A(I,C,p,c,n),d=I,h=C,C+=n,c+=n;e.rc=d,e.Vc=h}else{if(t(null!=l.mc),n=r+o,t(null!=(g=l.mc)),t(n<=g.i),g.C>=n)n=1;else if(l.ic||hn(),l.ic){l=g.V,d=g.Ba,h=g.c;var f=g.i,b=(p=1,c=g.$/h,I=g.$%h,C=g.m,u=g.s,g.$),B=h*f,y=h*n,Z=u.wc,v=b<y?be(u,I,c):null;t(b<=B),t(n<=f),t(we(u));t:for(;;){for(;!C.h&&b<y;){if(I&Z||(v=be(u,I,c)),t(null!=v),S(C),256>(f=pe(v.G[0],v.H[0],C)))l[d+b]=f,++b,++I>=h&&(I=0,++c<=n&&!(c%16)&&Se(g,c));else{if(!(280>f)){p=0;break t}f=he(f-256,C);var G,R=pe(v.G[4],v.H[4],C);if(S(C),!(b>=(R=me(h,R=he(R,C)))&&B-b>=f)){p=0;break t}for(G=0;G<f;++G)l[d+b+G]=l[d+b+G-R];for(b+=f,I+=f;I>=h;)I-=h,++c<=n&&!(c%16)&&Se(g,c);b<y&&I&Z&&(v=be(u,I,c))}t(C.h==w(C))}Se(g,c>n?n:c);break t}!p||C.h&&b<B?(p=0,g.a=C.h?5:3):g.$=b,n=p}else n=ve(g,g.V,g.Ba,g.c,g.i,n,ke);if(!n){o=0;break e}}r+o>=a&&(e.Cc=1),o=1}if(!o)return null;if(e.Cc&&(null!=(o=e.ga)&&(o.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+r*s}function In(e,t,n,A,r,i){for(;0<r--;){var o,s=e,a=t+(n?1:0),g=e,l=t+(n?0:3);for(o=0;o<A;++o){var c=g[l+4*o];255!=c&&(c*=32897,s[a+4*o+0]=s[a+4*o+0]*c>>23,s[a+4*o+1]=s[a+4*o+1]*c>>23,s[a+4*o+2]=s[a+4*o+2]*c>>23)}t+=i}}function Cn(e,t,n,A,r){for(;0<A--;){var i;for(i=0;i<n;++i){var o=e[t+2*i+0],s=15&(g=e[t+2*i+1]),a=4369*s,g=(240&g|g>>4)*a>>16;e[t+2*i+0]=(240&o|o>>4)*a>>16&240|(15&o|o<<4)*a>>16>>4&15,e[t+2*i+1]=240&g|s}t+=r}}function un(e,t,n,A,r,i,o,s){var a,g,l=255;for(g=0;g<r;++g){for(a=0;a<A;++a){var c=e[t+a];i[o+4*a]=c,l&=c}t+=n,o+=s}return 255!=l}function dn(e,t,n,A,r){var i;for(i=0;i<r;++i)n[A+i]=e[t+i]>>8}function hn(){yA=In,wA=Cn,ZA=un,SA=dn}function mn(n,A,r){e[n]=function(e,n,i,o,s,a,g,l,c,I,C,u,d,h,m,p,f){var b,B=f-1>>1,y=s[a+0]|g[l+0]<<16,w=c[I+0]|C[u+0]<<16;t(null!=e);var Z=3*y+w+131074>>2;for(A(e[n+0],255&Z,Z>>16,d,h),null!=i&&(Z=3*w+y+131074>>2,A(i[o+0],255&Z,Z>>16,m,p)),b=1;b<=B;++b){var S=s[a+b]|g[l+b]<<16,v=c[I+b]|C[u+b]<<16,G=y+S+w+v+524296,R=G+2*(S+w)>>3;Z=R+y>>1,y=(G=G+2*(y+v)>>3)+S>>1,A(e[n+2*b-1],255&Z,Z>>16,d,h+(2*b-1)*r),A(e[n+2*b-0],255&y,y>>16,d,h+(2*b-0)*r),null!=i&&(Z=G+w>>1,y=R+v>>1,A(i[o+2*b-1],255&Z,Z>>16,m,p+(2*b-1)*r),A(i[o+2*b+0],255&y,y>>16,m,p+(2*b+0)*r)),y=S,w=v}1&f||(Z=3*y+w+131074>>2,A(e[n+f-1],255&Z,Z>>16,d,h+(f-1)*r),null!=i&&(Z=3*w+y+131074>>2,A(i[o+f-1],255&Z,Z>>16,m,p+(f-1)*r)))}}function pn(){hr[XA]=mr,hr[HA]=fr,hr[xA]=pr,hr[JA]=br,hr[YA]=Br,hr[UA]=yr,hr[LA]=wr,hr[TA]=fr,hr[KA]=br,hr[MA]=Br,hr[QA]=yr}function fn(e){return-16384&e?0>e?0:255:e>>Rr}function bn(e,t){return fn((19077*e>>8)+(26149*t>>8)-14234)}function Bn(e,t,n){return fn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function yn(e,t){return fn((19077*e>>8)+(33050*t>>8)-17685)}function wn(e,t,n,A,r){A[r+0]=bn(e,n),A[r+1]=Bn(e,t,n),A[r+2]=yn(e,t)}function Zn(e,t,n,A,r){A[r+0]=yn(e,t),A[r+1]=Bn(e,t,n),A[r+2]=bn(e,n)}function Sn(e,t,n,A,r){var i=Bn(e,t,n);t=i<<3&224|yn(e,t)>>3,A[r+0]=248&bn(e,n)|i>>5,A[r+1]=t}function vn(e,t,n,A,r){var i=240&yn(e,t)|15;A[r+0]=240&bn(e,n)|Bn(e,t,n)>>4,A[r+1]=i}function Gn(e,t,n,A,r){A[r+0]=255,wn(e,t,n,A,r+1)}function Rn(e,t,n,A,r){Zn(e,t,n,A,r),A[r+3]=255}function Vn(e,t,n,A,r){wn(e,t,n,A,r),A[r+3]=255}function Qe(e,t){return 0>e?0:e>t?t:e}function Nn(t,n,A){e[t]=function(e,t,r,i,o,s,a,g,l){for(var c=g+(-2&l)*A;g!=c;)n(e[t+0],r[i+0],o[s+0],a,g),n(e[t+1],r[i+0],o[s+0],a,g+A),t+=2,++i,++s,g+=2*A;1&l&&n(e[t+0],r[i+0],o[s+0],a,g)}}function kn(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function Wn(e,t,n,A,r){switch(e>>>30){case 3:iA(t,n,A,r,0);break;case 2:oA(t,n,A,r);break;case 1:aA(t,n,A,r)}}function Fn(e,t){var n,i,o=t.M,s=t.Nb,a=e.oc,g=e.pc+40,l=e.oc,c=e.pc+584,I=e.oc,C=e.pc+600;for(n=0;16>n;++n)a[g+32*n-1]=129;for(n=0;8>n;++n)l[c+32*n-1]=129,I[C+32*n-1]=129;for(0<o?a[g-1-32]=l[c-1-32]=I[C-1-32]=129:(r(a,g-32-1,127,21),r(l,c-32-1,127,9),r(I,C-32-1,127,9)),i=0;i<e.za;++i){var u=t.ya[t.aa+i];if(0<i){for(n=-1;16>n;++n)A(a,g+32*n-4,a,g+32*n+12,4);for(n=-1;8>n;++n)A(l,c+32*n-4,l,c+32*n+4,4),A(I,C+32*n-4,I,C+32*n+4,4)}var d=e.Gd,h=e.Hd+i,m=u.ad,p=u.Hc;if(0<o&&(A(a,g-32,d[h].y,0,16),A(l,c-32,d[h].f,0,8),A(I,C-32,d[h].ea,0,8)),u.Za){var f=a,b=g-32+16;for(0<o&&(i>=e.za-1?r(f,b,d[h].y[15],4):A(f,b,d[h+1].y,0,4)),n=0;4>n;n++)f[b+128+n]=f[b+256+n]=f[b+384+n]=f[b+0+n];for(n=0;16>n;++n,p<<=2)f=a,b=g+Hr[n],cr[u.Ob[n]](f,b),Wn(p,m,16*+n,f,b)}else if(f=kn(i,o,u.Ob[0]),lr[f](a,g),0!=p)for(n=0;16>n;++n,p<<=2)Wn(p,m,16*+n,a,g+Hr[n]);for(n=u.Gc,f=kn(i,o,u.Dd),Ir[f](l,c),Ir[f](I,C),p=m,f=l,b=c,255&(u=n|0)&&(170&u?sA(p,256,f,b):gA(p,256,f,b)),u=I,p=C,255&(n>>=8)&&(170&n?sA(m,320,u,p):gA(m,320,u,p)),o<e.Ub-1&&(A(d[h].y,0,a,g+480,16),A(d[h].f,0,l,c+224,8),A(d[h].ea,0,I,C+224,8)),n=8*s*e.B,d=e.sa,h=e.ta+16*i+16*s*e.R,m=e.qa,u=e.ra+8*i+n,p=e.Ha,f=e.Ia+8*i+n,n=0;16>n;++n)A(d,h+n*e.R,a,g+32*n,16);for(n=0;8>n;++n)A(m,u+n*e.B,l,c+32*n,8),A(p,f+n*e.B,I,C+32*n,8)}}function En(e,A,r,i,o,s,a,g,l){var c=[0],I=[0],C=0,u=null!=l?l.kd:0,d=null!=l?l:new nn;if(null==e||12>r)return 7;d.data=e,d.w=A,d.ha=r,A=[A],r=[r],d.gb=[d.gb];e:{var h=A,p=r,f=d.gb;if(t(null!=e),t(null!=p),t(null!=f),f[0]=0,12<=p[0]&&!n(e,h[0],"RIFF")){if(n(e,h[0]+8,"WEBP")){f=3;break e}var b=W(e,h[0]+4);if(12>b||4294967286<b){f=3;break e}if(u&&b>p[0]-8){f=7;break e}f[0]=b,h[0]+=12,p[0]-=12}f=0}if(0!=f)return f;for(b=0<d.gb[0],r=r[0];;){e:{var y=e;p=A,f=r;var w=c,Z=I,S=h=[0];if((R=C=[C])[0]=0,8>f[0])f=7;else{if(!n(y,p[0],"VP8X")){if(10!=W(y,p[0]+4)){f=3;break e}if(18>f[0]){f=7;break e}var v=W(y,p[0]+8),G=1+k(y,p[0]+12);if(2147483648<=G*(y=1+k(y,p[0]+15))){f=3;break e}null!=S&&(S[0]=v),null!=w&&(w[0]=G),null!=Z&&(Z[0]=y),p[0]+=18,f[0]-=18,R[0]=1}f=0}}if(C=C[0],h=h[0],0!=f)return f;if(p=!!(2&h),!b&&C)return 3;if(null!=s&&(s[0]=!!(16&h)),null!=a&&(a[0]=p),null!=g&&(g[0]=0),a=c[0],h=I[0],C&&p&&null==l){f=0;break}if(4>r){f=7;break}if(b&&C||!b&&!C&&!n(e,A[0],"ALPH")){r=[r],d.na=[d.na],d.P=[d.P],d.Sa=[d.Sa];e:{v=e,f=A,b=r;var R=d.gb;w=d.na,Z=d.P,S=d.Sa,G=22,t(null!=v),t(null!=b),y=f[0];var V=b[0];for(t(null!=w),t(null!=S),w[0]=null,Z[0]=null,S[0]=0;;){if(f[0]=y,b[0]=V,8>V){f=7;break e}var N=W(v,y+4);if(4294967286<N){f=3;break e}var F=8+N+1&-2;if(G+=F,0<R&&G>R){f=3;break e}if(!n(v,y,"VP8 ")||!n(v,y,"VP8L")){f=0;break e}if(V[0]<F){f=7;break e}n(v,y,"ALPH")||(w[0]=v,Z[0]=y+8,S[0]=N),y+=F,V-=F}}if(r=r[0],d.na=d.na[0],d.P=d.P[0],d.Sa=d.Sa[0],0!=f)break}r=[r],d.Ja=[d.Ja],d.xa=[d.xa];e:if(R=e,f=A,b=r,w=d.gb[0],Z=d.Ja,S=d.xa,v=f[0],y=!n(R,v,"VP8 "),G=!n(R,v,"VP8L"),t(null!=R),t(null!=b),t(null!=Z),t(null!=S),8>b[0])f=7;else{if(y||G){if(R=W(R,v+4),12<=w&&R>w-12){f=3;break e}if(u&&R>b[0]-8){f=7;break e}Z[0]=R,f[0]+=8,b[0]-=8,S[0]=G}else S[0]=5<=b[0]&&47==R[v+0]&&!(R[v+4]>>5),Z[0]=b[0];f=0}if(r=r[0],d.Ja=d.Ja[0],d.xa=d.xa[0],A=A[0],0!=f)break;if(4294967286<d.Ja)return 3;if(null==g||p||(g[0]=d.xa?2:1),a=[a],h=[h],d.xa){if(5>r){f=7;break}g=a,u=h,p=s,null==e||5>r?e=0:5<=r&&47==e[A+0]&&!(e[A+4]>>5)?(b=[0],R=[0],w=[0],m(Z=new B,e,A,r),de(Z,b,R,w)?(null!=g&&(g[0]=b[0]),null!=u&&(u[0]=R[0]),null!=p&&(p[0]=w[0]),e=1):e=0):e=0}else{if(10>r){f=7;break}g=h,null==e||10>r||!Pe(e,A+3,r-3)?e=0:(u=e[A+0]|e[A+1]<<8|e[A+2]<<16,p=16383&(e[A+7]<<8|e[A+6]),e=16383&(e[A+9]<<8|e[A+8]),1&u||3<(u>>1&7)||!(u>>4&1)||u>>5>=d.Ja||!p||!e?e=0:(a&&(a[0]=p),g&&(g[0]=e),e=1))}if(!e)return 3;if(a=a[0],h=h[0],C&&(c[0]!=a||I[0]!=h))return 3;null!=l&&(l[0]=d,l.offset=A-l.w,t(4294967286>A-l.w),t(l.offset==l.ha-r));break}return 0==f||7==f&&C&&null==l?(null!=s&&(s[0]|=null!=d.na&&0<d.na.length),null!=i&&(i[0]=a),null!=o&&(o[0]=h),0):f}function Xn(e,t,n){var A=t.width,r=t.height,i=0,o=0,s=A,a=r;if(t.Da=null!=e&&0<e.Da,t.Da&&(s=e.cd,a=e.bd,i=e.v,o=e.j,11>n||(i&=-2,o&=-2),0>i||0>o||0>=s||0>=a||i+s>A||o+a>r))return 0;if(t.v=i,t.j=o,t.va=i+s,t.o=o+a,t.U=s,t.T=a,t.da=null!=e&&0<e.da,t.da){if(!H(s,a,n=[e.ib],i=[e.hb]))return 0;t.ib=n[0],t.hb=i[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*A/4&&t.hb<3*r/4,t.Kb=0),1}function Hn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function xn(e,t,n,A){if(null==A||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var r=n.cd,o=n.bd,s=-2&n.v,a=-2&n.j;if(0>s||0>a||0>=r||0>=o||s+r>e||a+o>t)return 2;e=r,t=o}if(n.da){if(!H(e,t,r=[n.ib],o=[n.hb]))return 2;e=r[0],t=o[0]}}A.width=e,A.height=t;e:{var g=A.width,l=A.height;if(e=A.S,0>=g||0>=l||!(e>=XA&&13>e))e=2;else{if(0>=A.Rd&&null==A.sd){s=o=r=t=0;var c=(a=g*Ur[e])*l;if(11>e||(o=(l+1)/2*(t=(g+1)/2),12==e&&(s=(r=g)*l)),null==(l=i(c+2*o+s))){e=1;break e}A.sd=l,11>e?((g=A.f.RGBA).eb=l,g.fb=0,g.A=a,g.size=c):((g=A.f.kb).y=l,g.O=0,g.fa=a,g.Fd=c,g.f=l,g.N=0+c,g.Ab=t,g.Cd=o,g.ea=l,g.W=0+c+o,g.Db=t,g.Ed=o,12==e&&(g.F=l,g.J=0+c+2*o),g.Tc=s,g.lb=r)}if(t=1,r=A.S,o=A.width,s=A.height,r>=XA&&13>r)if(11>r)e=A.f.RGBA,t&=(a=Math.abs(e.A))*(s-1)+o<=e.size,t&=a>=o*Ur[r],t&=null!=e.eb;else{e=A.f.kb,a=(o+1)/2,c=(s+1)/2,g=Math.abs(e.fa),l=Math.abs(e.Ab);var I=Math.abs(e.Db),C=Math.abs(e.lb),u=C*(s-1)+o;t&=g*(s-1)+o<=e.Fd,t&=l*(c-1)+a<=e.Cd,t=(t&=I*(c-1)+a<=e.Ed)&g>=o&l>=a&I>=a,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==r&&(t&=C>=o,t&=u<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=Hn(A)),e}var Jn=64,Yn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Un=24,Ln=32,Tn=8,Kn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Y("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,n){return t[n+0]},e.Predictor3=function(e,t,n){return t[n+1]},e.Predictor4=function(e,t,n){return t[n-1]},e.Predictor5=function(e,t,n){return L(L(e,t[n+1]),t[n+0])},e.Predictor6=function(e,t,n){return L(e,t[n-1])},e.Predictor7=function(e,t,n){return L(e,t[n+0])},e.Predictor8=function(e,t,n){return L(t[n-1],t[n+0])},e.Predictor9=function(e,t,n){return L(t[n+0],t[n+1])},e.Predictor10=function(e,t,n){return L(L(e,t[n-1]),L(t[n+0],t[n+1]))},e.Predictor11=function(e,t,n){var A=t[n+0];return 0>=M(A>>24&255,e>>24&255,(t=t[n-1])>>24&255)+M(A>>16&255,e>>16&255,t>>16&255)+M(A>>8&255,e>>8&255,t>>8&255)+M(255&A,255&e,255&t)?A:e},e.Predictor12=function(e,t,n){var A=t[n+0];return(T((e>>24&255)+(A>>24&255)-((t=t[n-1])>>24&255))<<24|T((e>>16&255)+(A>>16&255)-(t>>16&255))<<16|T((e>>8&255)+(A>>8&255)-(t>>8&255))<<8|T((255&e)+(255&A)-(255&t)))>>>0},e.Predictor13=function(e,t,n){var A=t[n-1];return(K((e=L(e,t[n+0]))>>24&255,A>>24&255)<<24|K(e>>16&255,A>>16&255)<<16|K(e>>8&255,A>>8&255)<<8|K(255&e,255&A))>>>0};var Mn=e.PredictorAdd0;e.PredictorAdd1=Q,Y("Predictor2","PredictorAdd2"),Y("Predictor3","PredictorAdd3"),Y("Predictor4","PredictorAdd4"),Y("Predictor5","PredictorAdd5"),Y("Predictor6","PredictorAdd6"),Y("Predictor7","PredictorAdd7"),Y("Predictor8","PredictorAdd8"),Y("Predictor9","PredictorAdd9"),Y("Predictor10","PredictorAdd10"),Y("Predictor11","PredictorAdd11"),Y("Predictor12","PredictorAdd12"),Y("Predictor13","PredictorAdd13");var Qn=e.PredictorAdd2;P("ColorIndexInverseTransform","MapARGB","32b",(function(e){return e>>8&255}),(function(e){return e})),P("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(e){return e}),(function(e){return e>>8&255}));var Dn,zn=e.ColorIndexInverseTransform,On=e.MapARGB,Pn=e.VP8LColorIndexInverseTransformAlpha,_n=e.MapAlpha,jn=e.VP8LPredictorsAdd=[];jn.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var qn,$n,eA,tA,nA,AA,rA,iA,oA,sA,aA,gA,lA,cA,IA,CA,uA,dA,hA,mA,pA,fA,bA,BA,yA,wA,ZA,SA,vA=i(511),GA=i(2041),RA=i(225),VA=i(767),NA=0,kA=GA,WA=RA,FA=VA,EA=vA,XA=0,HA=1,xA=2,JA=3,YA=4,UA=5,LA=6,TA=7,KA=8,MA=9,QA=10,DA=[2,3,7],zA=[3,3,11],OA=[280,256,256,256,40],PA=[0,1,1,1,0],_A=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],jA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],qA=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$A=8,er=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],tr=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],nr=null,Ar=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ir=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],or=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],sr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ar=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],gr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],lr=[],cr=[],Ir=[],Cr=1,ur=2,dr=[],hr=[];mn("UpsampleRgbLinePair",wn,3),mn("UpsampleBgrLinePair",Zn,3),mn("UpsampleRgbaLinePair",Vn,4),mn("UpsampleBgraLinePair",Rn,4),mn("UpsampleArgbLinePair",Gn,4),mn("UpsampleRgba4444LinePair",vn,2),mn("UpsampleRgb565LinePair",Sn,2);var mr=e.UpsampleRgbLinePair,pr=e.UpsampleBgrLinePair,fr=e.UpsampleRgbaLinePair,br=e.UpsampleBgraLinePair,Br=e.UpsampleArgbLinePair,yr=e.UpsampleRgba4444LinePair,wr=e.UpsampleRgb565LinePair,Zr=16,Sr=1<<Zr-1,vr=-227,Gr=482,Rr=6,Vr=0,Nr=i(256),kr=i(256),Wr=i(256),Fr=i(256),Er=i(Gr-vr),Xr=i(Gr-vr);Nn("YuvToRgbRow",wn,3),Nn("YuvToBgrRow",Zn,3),Nn("YuvToRgbaRow",Vn,4),Nn("YuvToBgraRow",Rn,4),Nn("YuvToArgbRow",Gn,4),Nn("YuvToRgba4444Row",vn,2),Nn("YuvToRgb565Row",Sn,2);var Hr=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xr=[0,2,8],Jr=[8,7,6,4,4,2,2,2,1,1,1,1],Yr=1;this.WebPDecodeRGBA=function(e,n,s,a,g){var l=HA,c=new tn,I=new oe;c.ba=I,I.S=l,I.width=[I.width],I.height=[I.height];var C=I.width,u=I.height,d=new se;if(null==d||null==e)var h=2;else t(null!=d),h=En(e,n,s,d.width,d.height,d.Pd,d.Qd,d.format,null);if(0!=h?C=0:(null!=C&&(C[0]=d.width[0]),null!=u&&(u[0]=d.height[0]),C=1),C){I.width=I.width[0],I.height=I.height[0],null!=a&&(a[0]=I.width),null!=g&&(g[0]=I.height);e:{if(a=new De,(g=new nn).data=e,g.w=n,g.ha=s,g.kd=1,n=[0],t(null!=g),(0==(e=En(g.data,g.w,g.ha,null,null,null,n,null,g))||7==e)&&n[0]&&(e=4),0==(n=e)){if(t(null!=c),a.data=g.data,a.w=g.w+g.offset,a.ha=g.ha-g.offset,a.put=Ce,a.ac=Ie,a.bc=ue,a.ma=c,g.xa){if(null==(e=Re())){c=1;break e}if(function(e,n){var A=[0],r=[0],i=[0];t:for(;;){if(null==e)return 0;if(null==n)return e.a=2,0;if(e.l=n,e.a=0,m(e.m,n.data,n.w,n.ha),!de(e.m,A,r,i)){e.a=3;break t}if(e.xb=ur,n.width=A[0],n.height=r[0],!Ve(A[0],r[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,a)){if(a=0==(n=xn(a.width,a.height,c.Oa,c.ba))){t:{a=e;n:for(;;){if(null==a){a=0;break t}if(t(null!=a.s.yc),t(null!=a.s.Ya),t(0<a.s.Wb),t(null!=(s=a.l)),t(null!=(g=s.ma)),0!=a.xb){if(a.ca=g.ba,a.tb=g.tb,t(null!=a.ca),!Xn(g.Oa,s,JA)){a.a=2;break n}if(!Ne(a,s.width))break n;if(s.da)break n;if((s.da||Ae(a.ca.S))&&hn(),11>a.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=a.ca.f.kb.F&&hn()),a.Pb&&0<a.s.ua&&null==a.s.vb.X&&!F(a.s.vb,a.s.Wa.Xa)){a.a=1;break n}a.xb=0}if(!ve(a,a.V,a.Ba,a.c,a.i,s.o,ye))break n;g.Dc=a.Ma,a=1;break t}t(0!=a.a),a=0}a=!a}a&&(n=e.a)}else n=e.a}else{if(null==(e=new ze)){c=1;break e}if(e.Fa=g.na,e.P=g.P,e.qc=g.Sa,_e(e,a)){if(0==(n=xn(a.width,a.height,c.Oa,c.ba))){if(e.Aa=0,s=c.Oa,t(null!=(g=e)),null!=s){if(0<(C=0>(C=s.Md)?0:100<C?255:255*C/100)){for(u=d=0;4>u;++u)12>(h=g.pb[u]).lc&&(h.ia=C*Jr[0>h.lc?0:h.lc]>>3),d|=h.ia;d&&(alert("todo:VP8InitRandom"),g.ia=1)}g.Ga=s.Id,100<g.Ga?g.Ga=100:0>g.Ga&&(g.Ga=0)}(function(e,n){if(null==e)return 0;if(null==n)return Oe(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!_e(e,n))return 0;if(t(e.cb),null==n.ac||n.ac(n)){n.ob&&(e.L=0);var s=xr[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=n.v-s>>4,e.zb=n.j-s>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=n.o+15+s>>4,e.Hb=n.va+15+s>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var a=e.ed;for(s=0;4>s;++s){var g;if(e.Qa.Cb){var l=e.Qa.Lb[s];e.Qa.Fb||(l+=a.Tb)}else l=a.Tb;for(g=0;1>=g;++g){var c=e.gd[s][g],I=l;if(a.Pc&&(I+=a.vd[0],g&&(I+=a.od[0])),0<(I=0>I?0:63<I?63:I)){var C=I;0<a.wb&&(C=4<a.wb?C>>2:C>>1)>9-a.wb&&(C=9-a.wb),1>C&&(C=1),c.dd=C,c.tc=2*I+C,c.ld=40<=I?2:15<=I?1:0}else c.tc=0;c.La=g}}}s=0}else Oe(e,6,"Frame setup failed"),s=e.a;if(s=0==s){if(s){e.$c=0,0<e.Aa||(e.Ic=Yr);t:{s=e.Ic,a=4*(C=e.za);var u=32*C,d=C+1,h=0<e.L?C*(0<e.Aa?2:1):0,m=(2==e.Aa?2:1)*C;if((c=a+832+(g=3*(16*s+xr[e.L])/2*u)+(l=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=c)s=0;else{if(c>e.Vb){if(e.Vb=0,e.Ec=i(c),e.Fc=0,null==e.Ec){s=Oe(e,1,"no memory during frame initialization.");break t}e.Vb=c}c=e.Ec,I=e.Fc,e.Ac=c,e.Bc=I,I+=a,e.Gd=o(u,Ke),e.Hd=0,e.rb=o(d+1,Ye),e.sb=1,e.wa=h?o(h,Je):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=C),t(!0),e.oc=c,e.pc=I,I+=832,e.ya=o(m,Le),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=C),e.R=16*C,e.B=8*C,C=(u=xr[e.L])*e.R,u=u/2*e.B,e.sa=c,e.ta=I+C,e.qa=e.sa,e.ra=e.ta+16*s*e.R+u,e.Ha=e.qa,e.Ia=e.ra+8*s*e.B+u,e.$c=0,I+=g,e.mb=l?c:null,e.nb=l?I:null,t(I+l<=e.Fc+e.Vb),qe(e),r(e.Ac,e.Bc,0,a),s=1}}if(s){if(n.ka=0,n.y=e.sa,n.O=e.ta,n.f=e.qa,n.N=e.ra,n.ea=e.Ha,n.Vd=e.Ia,n.fa=e.R,n.Rc=e.B,n.F=null,n.J=0,!NA){for(s=-255;255>=s;++s)vA[255+s]=0>s?-s:s;for(s=-1020;1020>=s;++s)GA[1020+s]=-128>s?-128:127<s?127:s;for(s=-112;112>=s;++s)RA[112+s]=-16>s?-16:15<s?15:s;for(s=-255;510>=s;++s)VA[255+s]=0>s?0:255<s?255:s;NA=1}rA=at,iA=rt,sA=it,aA=ot,gA=st,oA=At,lA=zt,cA=Ot,IA=jt,CA=qt,uA=Pt,dA=_t,hA=$t,mA=en,pA=Lt,fA=Tt,bA=Kt,BA=Mt,cr[0]=wt,cr[1]=lt,cr[2]=Bt,cr[3]=yt,cr[4]=Zt,cr[5]=vt,cr[6]=St,cr[7]=Gt,cr[8]=Vt,cr[9]=Rt,lr[0]=ht,lr[1]=It,lr[2]=Ct,lr[3]=ut,lr[4]=mt,lr[5]=pt,lr[6]=ft,Ir[0]=Ft,Ir[1]=ct,Ir[2]=Nt,Ir[3]=kt,Ir[4]=Xt,Ir[5]=Et,Ir[6]=Ht,s=1}else s=0}s&&(s=function(e,n){for(e.M=0;e.M<e.Va;++e.M){var o,s=e.Jc[e.M&e.Xb],a=e.m,g=e;for(o=0;o<g.za;++o){var l=a,c=g,I=c.Ac,C=c.Bc+4*o,u=c.zc,d=c.ya[c.aa+o];if(c.Qa.Bb?d.$b=R(l,c.Pa.jb[0])?2+R(l,c.Pa.jb[2]):R(l,c.Pa.jb[1]):d.$b=0,c.kc&&(d.Ad=R(l,c.Bd)),d.Za=!R(l,145)+0,d.Za){var h=d.Ob,m=0;for(c=0;4>c;++c){var p,f=u[0+c];for(p=0;4>p;++p){f=sr[I[C+p]][f];for(var b=ir[R(l,f[0])];0<b;)b=ir[2*b+R(l,f[b])];f=-b,I[C+p]=f}A(h,m,I,C,4),m+=4,u[0+c]=f}}else f=R(l,156)?R(l,128)?1:3:R(l,163)?2:0,d.Ob[0]=f,r(I,C,f,4),r(u,0,f,4);d.Dd=R(l,142)?R(l,114)?R(l,183)?1:3:2:0}if(g.m.Ka)return Oe(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(g=s,l=(a=e).rb[a.sb-1],I=a.rb[a.sb+a.ja],o=a.ya[a.aa+a.ja],C=a.kc?o.Ad:0)l.la=I.la=0,o.Za||(l.Na=I.Na=0),o.Hc=0,o.Gc=0,o.ia=0;else{var B,y;if(l=I,I=g,C=a.Pa.Xc,u=a.ya[a.aa+a.ja],d=a.pb[u.$b],c=u.ad,h=0,m=a.rb[a.sb-1],f=p=0,r(c,h,0,384),u.Za)var w=0,Z=C[3];else{b=i(16);var S=l.Na+m.Na;if(S=nr(I,C[1],S,d.Eb,0,b,0),l.Na=m.Na=(0<S)+0,1<S)rA(b,0,c,h);else{var v=b[0]+3>>3;for(b=0;256>b;b+=16)c[h+b]=v}w=1,Z=C[0]}var G=15&l.la,V=15&m.la;for(b=0;4>b;++b){var N=1&V;for(v=y=0;4>v;++v)G=G>>1|(N=(S=nr(I,Z,S=N+(1&G),d.Sc,w,c,h))>w)<<7,y=y<<2|(3<S?3:1<S?2:0!=c[h+0]),h+=16;G>>=4,V=V>>1|N<<7,p=(p<<8|y)>>>0}for(Z=G,w=V>>4,B=0;4>B;B+=2){for(y=0,G=l.la>>4+B,V=m.la>>4+B,b=0;2>b;++b){for(N=1&V,v=0;2>v;++v)S=N+(1&G),G=G>>1|(N=0<(S=nr(I,C[2],S,d.Qc,0,c,h)))<<3,y=y<<2|(3<S?3:1<S?2:0!=c[h+0]),h+=16;G>>=2,V=V>>1|N<<5}f|=y<<4*B,Z|=G<<4<<B,w|=(240&V)<<B}l.la=Z,m.la=w,u.Hc=p,u.Gc=f,u.ia=43690&f?0:d.ia,C=!(p|f)}if(0<a.L&&(a.wa[a.Y+a.ja]=a.gd[o.$b][o.Za],a.wa[a.Y+a.ja].La|=!C),g.Ka)return Oe(e,7,"Premature end-of-file encountered.")}if(qe(e),a=n,g=1,o=(s=e).D,l=0<s.L&&s.M>=s.zb&&s.M<=s.Va,0==s.Aa)t:{if(o.M=s.M,o.uc=l,Fn(s,o),g=1,o=(y=s.D).Nb,l=(f=xr[s.L])*s.R,I=f/2*s.B,b=16*o*s.R,v=8*o*s.B,C=s.sa,u=s.ta-l+b,d=s.qa,c=s.ra-I+v,h=s.Ha,m=s.Ia-I+v,V=0==(G=y.M),p=G>=s.Va-1,2==s.Aa&&Fn(s,y),y.uc)for(N=(S=s).D.M,t(S.D.uc),y=S.yb;y<S.Hb;++y){w=y,Z=N;var k=(W=(L=S).D).Nb;B=L.R;var W=W.wa[W.Y+w],F=L.sa,E=L.ta+16*k*B+16*w,X=W.dd,H=W.tc;if(0!=H)if(t(3<=H),1==L.L)0<w&&fA(F,E,B,H+4),W.La&&BA(F,E,B,H),0<Z&&pA(F,E,B,H+4),W.La&&bA(F,E,B,H);else{var x=L.B,J=L.qa,Y=L.ra+8*k*x+8*w,U=L.Ha,L=L.Ia+8*k*x+8*w;k=W.ld,0<w&&(cA(F,E,B,H+4,X,k),CA(J,Y,U,L,x,H+4,X,k)),W.La&&(dA(F,E,B,H,X,k),mA(J,Y,U,L,x,H,X,k)),0<Z&&(lA(F,E,B,H+4,X,k),IA(J,Y,U,L,x,H+4,X,k)),W.La&&(uA(F,E,B,H,X,k),hA(J,Y,U,L,x,H,X,k))}}if(s.ia&&alert("todo:DitherRow"),null!=a.put){if(y=16*G,G=16*(G+1),V?(a.y=s.sa,a.O=s.ta+b,a.f=s.qa,a.N=s.ra+v,a.ea=s.Ha,a.W=s.Ia+v):(y-=f,a.y=C,a.O=u,a.f=d,a.N=c,a.ea=h,a.W=m),p||(G-=f),G>a.o&&(G=a.o),a.F=null,a.J=null,null!=s.Fa&&0<s.Fa.length&&y<G&&(a.J=cn(s,a,y,G-y),a.F=s.mb,null==a.F&&0==a.F.length)){g=Oe(s,3,"Could not decode alpha data.");break t}y<a.j&&(f=a.j-y,y=a.j,t(!(1&f)),a.O+=s.R*f,a.N+=s.B*(f>>1),a.W+=s.B*(f>>1),null!=a.F&&(a.J+=a.width*f)),y<G&&(a.O+=a.v,a.N+=a.v>>1,a.W+=a.v>>1,null!=a.F&&(a.J+=a.v),a.ka=y-a.j,a.U=a.va-a.v,a.T=G-y,g=a.put(a))}o+1!=s.Ic||p||(A(s.sa,s.ta-l,C,u+16*s.R,l),A(s.qa,s.ra-I,d,c+8*s.B,I),A(s.Ha,s.Ia-I,h,m+8*s.B,I))}if(!g)return Oe(e,6,"Output aborted.")}return 1}(e,n)),null!=n.bc&&n.bc(n),s&=1}return s?(e.cb=0,s):0})(e,a)||(n=e.a)}}else n=e.a}0==n&&null!=c.Oa&&c.Oa.fd&&(n=Hn(c.ba))}c=n}l=0!=c?null:11>l?I.f.RGBA.eb:I.f.kb.y}else l=null;return l};var Ur=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function g(e,t){for(var n="",A=0;A<4;A++)n+=String.fromCharCode(e[t++]);return n}function l(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function c(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new a;var I=[0],C=[0],u=[],d=new a,h=e,m=function(e,t){var n={},A=0,r=!1,i=0,o=0;if(n.frames=[],!
/** @license
       * Copyright (c) 2017 Dominik Homberger
      Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
      The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
      https://webpjs.appspot.com
      WebPRiffParser dominikhlbg@gmail.com
      */
function(e,t){for(var n=0;n<4;n++)if(e[t+n]!="RIFF".charCodeAt(n))return!0;return!1}(e,t)){for(c(e,t+=4),t+=8;t<e.length;){var s=g(e,t),a=c(e,t+=4);t+=4;var I=a+(1&a);switch(s){case"VP8 ":case"VP8L":void 0===n.frames[A]&&(n.frames[A]={}),(d=n.frames[A]).src_off=r?o:t-8,d.src_size=i+a+8,A++,r&&(r=!1,i=0,o=0);break;case"VP8X":(d=n.header={}).feature_flags=e[t];var C=t+4;d.canvas_width=1+l(e,C),C+=3,d.canvas_height=1+l(e,C),C+=3;break;case"ALPH":r=!0,i=I+8,o=t-8;break;case"ANIM":(d=n.header).bgcolor=c(e,t),C=t+4,d.loop_count=(h=e)[(m=C)+0]|h[m+1]<<8,C+=2;break;case"ANMF":var u,d;(d=n.frames[A]={}).offset_x=2*l(e,t),t+=3,d.offset_y=2*l(e,t),t+=3,d.width=1+l(e,t),t+=3,d.height=1+l(e,t),t+=3,d.duration=l(e,t),t+=3,u=e[t++],d.dispose=1&u,d.blend=u>>1&1}"ANMF"!=s&&(t+=I)}var h,m;return n}}(h,0);m.response=h,m.rgbaoutput=!0,m.dataurl=!1;var p=m.header?m.header:null,f=m.frames?m.frames:null;if(p){p.loop_counter=p.loop_count,I=[p.canvas_height],C=[p.canvas_width];for(var b=0;b<f.length&&0!=f[b].blend;b++);}var B=f[0],y=d.WebPDecodeRGBA(h,B.src_off,B.src_size,C,I);B.rgba=y,B.imgwidth=C[0],B.imgheight=I[0];for(var w=0;w<C[0]*I[0]*4;w++)u[w]=y[w];return this.width=C,this.height=I,this.data=u,this}!function(e){var t=function(t,A,a,g){var l=4,c=i;switch(g){case e.image_compression.FAST:l=1,c=r;break;case e.image_compression.MEDIUM:l=6,c=o;break;case e.image_compression.SLOW:l=9,c=s}var I=bb(t=n(t,A,a,c),{level:l});return e.__addimage__.arrayBufferToBinaryString(I)},n=function(e,t,n,A){for(var r,i,o,s=e.length/t,a=new Uint8Array(e.length+s),c=g(),I=0;I<s;I+=1){if(o=I*t,r=e.subarray(o,o+t),A)a.set(A(r,n,i),o+I);else{for(var C,u=c.length,d=[];C<u;C+=1)d[C]=c[C](r,n,i);var h=l(d.concat());a.set(d[h],o+I)}i=r}return a},A=function(e){var t=Array.apply([],e);return t.unshift(0),t},r=function(e,t){var n,A=[],r=e.length;A[0]=1;for(var i=0;i<r;i+=1)n=e[i-t]||0,A[i+1]=e[i]-n+256&255;return A},i=function(e,t,n){var A,r=[],i=e.length;r[0]=2;for(var o=0;o<i;o+=1)A=n&&n[o]||0,r[o+1]=e[o]-A+256&255;return r},o=function(e,t,n){var A,r,i=[],o=e.length;i[0]=3;for(var s=0;s<o;s+=1)A=e[s-t]||0,r=n&&n[s]||0,i[s+1]=e[s]+256-(A+r>>>1)&255;return i},s=function(e,t,n){var A,r,i,o,s=[],g=e.length;s[0]=4;for(var l=0;l<g;l+=1)A=e[l-t]||0,r=n&&n[l]||0,i=n&&n[l-t]||0,o=a(A,r,i),s[l+1]=e[l]-o+256&255;return s},a=function(e,t,n){if(e===t&&t===n)return e;var A=Math.abs(t-n),r=Math.abs(e-n),i=Math.abs(e+t-n-n);return A<=r&&A<=i?e:r<=i?t:n},g=function(){return[A,r,i,o,s]},l=function(e){var t=e.map((function(e){return e.reduce((function(e,t){return e+Math.abs(t)}),0)}));return t.indexOf(Math.min.apply(null,t))};e.processPNG=function(n,A,r,i){var o,s,a,g,l,c,I,C,u,d,h,m,p,f,b,B=this.decode.FLATE_DECODE,y="";if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){if(n=(a=new uy(n)).imgData,s=a.bits,o=a.colorSpace,l=a.colors,-1!==[4,6].indexOf(a.colorType)){if(8===a.bits){u=(C=32==a.pixelBitlength?new Uint32Array(a.decodePixels().buffer):16==a.pixelBitlength?new Uint16Array(a.decodePixels().buffer):new Uint8Array(a.decodePixels().buffer)).length,h=new Uint8Array(u*a.colors),d=new Uint8Array(u);var w,Z=a.pixelBitlength-a.bits;for(f=0,b=0;f<u;f++){for(p=C[f],w=0;w<Z;)h[b++]=p>>>w&255,w+=a.bits;d[f]=p>>>w&255}}if(16===a.bits){u=(C=new Uint32Array(a.decodePixels().buffer)).length,h=new Uint8Array(u*(32/a.pixelBitlength)*a.colors),d=new Uint8Array(u*(32/a.pixelBitlength)),m=a.colors>1,f=0,b=0;for(var S=0;f<u;)p=C[f++],h[b++]=p>>>0&255,m&&(h[b++]=p>>>16&255,p=C[f++],h[b++]=p>>>0&255),d[S++]=p>>>16&255;s=8}i!==e.image_compression.NONE?(n=t(h,a.width*a.colors,a.colors,i),I=t(d,a.width,1,i)):(n=h,I=d,B=void 0)}if(3===a.colorType&&(o=this.color_spaces.INDEXED,c=a.palette,a.transparency.indexed)){var v=a.transparency.indexed,G=0;for(f=0,u=v.length;f<u;++f)G+=v[f];if((G/=255)==u-1&&-1!==v.indexOf(0))g=[v.indexOf(0)];else if(G!==u){for(C=a.decodePixels(),d=new Uint8Array(C.length),f=0,u=C.length;f<u;f++)d[f]=v[C[f]];I=t(d,a.width,1)}}var R=function(t){var n;switch(t){case e.image_compression.FAST:n=11;break;case e.image_compression.MEDIUM:n=13;break;case e.image_compression.SLOW:n=14;break;default:n=12}return n}(i);return B===this.decode.FLATE_DECODE&&(y="/Predictor "+R+" "),y+="/Colors "+l+" /BitsPerComponent "+s+" /Columns "+a.width,(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(I&&this.__addimage__.isArrayBuffer(I)||this.__addimage__.isArrayBufferView(I))&&(I=this.__addimage__.arrayBufferToBinaryString(I)),{alias:r,data:n,index:A,filter:B,decodeParameters:y,transparency:g,palette:c,sMask:I,predictor:R,width:a.width,height:a.height,bitsPerComponent:s,colorSpace:o}}}}(nB.API),function(e){e.processGIF89A=function(t,n,A,r){var i=new dy(t),o=i.width,s=i.height,a=[];i.decodeAndBlitFrameRGBA(0,a);var g={data:a,width:o,height:s},l=new my(100).encode(g,100);return e.processJPEG.call(this,l,n,A,r)},e.processGIF87A=e.processGIF89A}(nB.API),py.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:r,green:A,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},py.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){Sb.log("bit decode error:"+n)}},py.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var A=this.bottom_up?e:this.height-1-e,r=0;r<t;r++)for(var i=this.datav.getUint8(this.pos++,!0),o=A*this.width*4+8*r*4,s=0;s<8&&8*r+s<this.width;s++){var a=this.palette[i>>7-s&1];this.data[o+4*s]=a.blue,this.data[o+4*s+1]=a.green,this.data[o+4*s+2]=a.red,this.data[o+4*s+3]=255}0!==n&&(this.pos+=4-n)}},py.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var A=this.bottom_up?n:this.height-1-n,r=0;r<e;r++){var i=this.datav.getUint8(this.pos++,!0),o=A*this.width*4+2*r*4,s=i>>4,a=15&i,g=this.palette[s];if(this.data[o]=g.blue,this.data[o+1]=g.green,this.data[o+2]=g.red,this.data[o+3]=255,2*r+1>=this.width)break;g=this.palette[a],this.data[o+4]=g.blue,this.data[o+4+1]=g.green,this.data[o+4+2]=g.red,this.data[o+4+3]=255}0!==t&&(this.pos+=4-t)}},py.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,A=0;A<this.width;A++){var r=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*A;if(r<this.palette.length){var o=this.palette[r];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}0!==e&&(this.pos+=4-e)}},py.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var A=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,s=(i>>5&t)/t*255|0,a=(i>>10&t)/t*255|0,g=i>>15?255:0,l=A*this.width*4+4*r;this.data[l]=a,this.data[l+1]=s,this.data[l+2]=o,this.data[l+3]=g}this.pos+=e}},py.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),A=this.height-1;A>=0;A--){for(var r=this.bottom_up?A:this.height-1-A,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&t)/t*255|0,a=(o>>5&n)/n*255|0,g=(o>>11)/t*255|0,l=r*this.width*4+4*i;this.data[l]=g,this.data[l+1]=a,this.data[l+2]=s,this.data[l+3]=255}this.pos+=e}},py.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var A=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=i,this.data[o+1]=r,this.data[o+2]=A,this.data[o+3]=255}this.pos+=this.width%4}},py.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var A=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;this.data[s]=i,this.data[s+1]=r,this.data[s+2]=A,this.data[s+3]=o}},py.prototype.getData=function(){return this.data},
/**
 * @license
 * Copyright (c) 2018 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){e.processBMP=function(t,n,A,r){var i=new py(t,!1),o=i.width,s=i.height,a={data:i.getData(),width:o,height:s},g=new my(100).encode(a,100);return e.processJPEG.call(this,g,n,A,r)}}(nB.API),fy.prototype.getData=function(){return this.data},
/**
 * @license
 * Copyright (c) 2019 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){e.processWEBP=function(t,n,A,r){var i=new fy(t),o=i.width,s=i.height,a={data:i.getData(),width:o,height:s},g=new my(100).encode(a,100);return e.processJPEG.call(this,g,n,A,r)}}(nB.API),nB.API.processRGBA=function(e,t,n){for(var A=e.data,r=A.length,i=new Uint8Array(r/4*3),o=new Uint8Array(r/4),s=0,a=0,g=0;g<r;g+=4){var l=A[g],c=A[g+1],I=A[g+2],C=A[g+3];i[s++]=l,i[s++]=c,i[s++]=I,o[a++]=C}var u=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:u,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},nB.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},gy=nB.API,ly=gy.getCharWidthsArray=function(e,t){var n,A,r=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),s=t.widths?t.widths:r.metadata.Unicode.widths,a=s.fof?s.fof:1,g=t.kerning?t.kerning:r.metadata.Unicode.kerning,l=g.fof?g.fof:1,c=!1!==t.doKerning,I=0,C=e.length,u=0,d=s[0]||a,h=[];for(n=0;n<C;n++)A=e.charCodeAt(n),"function"==typeof r.metadata.widthOfString?h.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(A))+o*(1e3/i)||0)/1e3):(I=c&&"object"===Nf(g[A])&&!isNaN(parseInt(g[A][u],10))?g[A][u]/l:0,h.push((s[A]||d)/a+I)),u=A;return h},cy=gy.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),A=t.font||this.internal.getFont(),r=t.charSpace||this.internal.getCharSpace();return gy.processArabic&&(e=gy.processArabic(e)),"function"==typeof A.metadata.widthOfString?A.metadata.widthOfString(e,n,r)/n:ly.apply(this,arguments).reduce((function(e,t){return e+t}),0)},Iy=function(e,t,n,A){for(var r=[],i=0,o=e.length,s=0;i!==o&&s+t[i]<n;)s+=t[i],i++;r.push(e.slice(0,i));var a=i;for(s=0;i!==o;)s+t[i]>A&&(r.push(e.slice(a,i)),s=0,a=i),s+=t[i],i++;return a!==i&&r.push(e.slice(a,i)),r},Cy=function(e,t,n){n||(n={});var A,r,i,o,s,a,g,l=[],c=[l],I=n.textIndent||0,C=0,u=0,d=e.split(" "),h=ly.apply(this,[" ",n])[0];if(a=-1===n.lineIndent?d[0].length+2:n.lineIndent||0){var m=Array(a).join(" "),p=[];d.map((function(e){(e=e.split(/\s*\n/)).length>1?p=p.concat(e.map((function(e,t){return(t&&e.length?"\n":"")+e}))):p.push(e[0])})),d=p,a=cy.apply(this,[m,n])}for(i=0,o=d.length;i<o;i++){var f=0;if(A=d[i],a&&"\n"==A[0]&&(A=A.substr(1),f=1),I+C+(u=(r=ly.apply(this,[A,n])).reduce((function(e,t){return e+t}),0))>t||f){if(u>t){for(s=Iy.apply(this,[A,r,t-(I+C),t]),l.push(s.shift()),l=[s.pop()];s.length;)c.push([s.shift()]);u=r.slice(A.length-(l[0]?l[0].length:0)).reduce((function(e,t){return e+t}),0)}else l=[A];c.push(l),I=u+a,C=h}else l.push(A),I+=C+u,C=h}return g=a?function(e,t){return(t?m:"")+e.join(" ")}:function(e){return e.join(" ")},c.map(g)},gy.splitTextToSize=function(e,t,n){var A,r=(n=n||{}).fontSize||this.internal.getFontSize(),i=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);A=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/r;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,i.lineIndent=n.lineIndent;var s,a,g=[];for(s=0,a=A.length;s<a;s++)g=g.concat(Cy.apply(this,[A[s],o,i]));return g},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},A={},r=0;r<16;r++)n[t[r]]="0123456789abcdef"[r],A["0123456789abcdef"[r]]=t[r];var i=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,n,r,s,a=["{"];for(var g in e){if(t=e[g],isNaN(parseInt(g,10))?n="'"+g+"'":(g=parseInt(g,10),n=(n=i(g).slice(2)).slice(0,-1)+A[n.slice(-1)]),"number"==typeof t)t<0?(r=i(t).slice(3),s="-"):(r=i(t).slice(2),s=""),r=s+r.slice(0,-1)+A[r.slice(-1)];else{if("object"!==Nf(t))throw new Error("Don't know what to do with value type "+Nf(t)+".");r=o(t)}a.push(n+r)}return a.push("}"),a.join("")},s=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,A,r,i,o={},s=1,a=o,g=[],l="",c="",I=e.length-1,C=1;C<I;C+=1)"'"==(i=e[C])?t?(r=t.join(""),t=void 0):t=[]:t?t.push(i):"{"==i?(g.push([a,r]),a={},r=void 0):"}"==i?((A=g.pop())[0][A[1]]=a,r=void 0,a=A[0]):"-"==i?s=-1:void 0===r?n.hasOwnProperty(i)?(l+=n[i],r=parseInt(l,16)*s,s=1,l=""):l+=i:n.hasOwnProperty(i)?(c+=n[i],a[r]=parseInt(c,16)*s,s=1,r=void 0,c=""):c+=i;return o},a={codePages:["WinAnsiEncoding"],WinAnsiEncoding:s("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},g={Unicode:{Courier:a,"Courier-Bold":a,"Courier-BoldOblique":a,"Courier-Oblique":a,Helvetica:a,"Helvetica-Bold":a,"Helvetica-BoldOblique":a,"Helvetica-Oblique":a,"Times-Roman":a,"Times-Bold":a,"Times-BoldItalic":a,"Times-Italic":a}},l={Unicode:{"Courier-Oblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":s("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":s("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:s("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:s("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":s("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":s("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,n=l.Unicode[t.postScriptName];n&&(t.metadata.Unicode={},t.metadata.Unicode.widths=n.widths,t.metadata.Unicode.kerning=n.kerning);var A=g.Unicode[t.postScriptName];A&&(t.metadata.Unicode.encoding=A,t.encoding=A.codePages[0])}])}(nB.API),
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(e){for(var t=e.length,n=new Uint8Array(t),A=0;A<t;A++)n[A]=e.charCodeAt(A);return n};e.API.events.push(["addFont",function(n){var A,r,i=void 0,o=n.font,s=n.instance;if(!o.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if("string"!=typeof(i=!1===s.existsFileInVFS(o.postScriptName)?s.loadFile(o.postScriptName):s.getFileFromVFS(o.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");A=o,r=/^\x00\x01\x00\x00/.test(r=i)?t(r):t(Vb(r)),A.metadata=e.API.TTFFont.open(r),A.metadata.Unicode=A.metadata.Unicode||{encoding:{},kerning:{},widths:[]},A.metadata.glyIdsUsed=[0]}}])}(nB),nB.API.addSvgAsImage=function(e,t,n,A,r,i,o,s){if(isNaN(t)||isNaN(n))throw Sb.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(A)||isNaN(r))throw Sb.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var a=document.createElement("canvas");a.width=A,a.height=r;var g=a.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,a.width,a.height);var l={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},c=this;return(wb.canvg?Promise.resolve(wb.canvg):Vf((()=>import("./index.es-CYkal4l0.js")),__vite__mapDeps([0,1]))).catch((function(e){return Promise.reject(new Error("Could not load canvg: "+e))})).then((function(e){return e.default?e.default:e})).then((function(t){return t.fromString(g,e,l)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(e){return e.render(l)})).then((function(){c.addImage(a.toDataURL("image/jpeg",1),t,n,A,r,o,s)}))},nB.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var A=1;A<=this.internal.getNumberOfPages();A++)for(var r=0;r<this.internal.pages[A].length;r++)this.internal.pages[A][r]=this.internal.pages[A][r].replace(t,n);return this},nB.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var A,r,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},s=Object.keys(o),a=[],g=0,l=0,c=0;function I(e,t){var n,A=!1;for(n=0;n<e.length;n+=1)e[n]===t&&(A=!0);return A}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var C=s.length;for(c=0;c<C;c+=1)n[s[c]].value=n[s[c]].defaultValue,n[s[c]].explicitSet=!1}if("object"===Nf(e))for(r in e)if(i=e[r],I(s,r)&&void 0!==i){if("boolean"===n[r].type&&"boolean"==typeof i)n[r].value=i;else if("name"===n[r].type&&I(n[r].valueSet,i))n[r].value=i;else if("integer"===n[r].type&&Number.isInteger(i))n[r].value=i;else if("array"===n[r].type){for(g=0;g<i.length;g+=1)if(A=!0,1===i[g].length&&"number"==typeof i[g][0])a.push(String(i[g]-1));else if(i[g].length>1){for(l=0;l<i[g].length;l+=1)"number"!=typeof i[g][l]&&(A=!1);!0===A&&a.push([i[g][0]-1,i[g][1]-1].join(" "))}n[r].value="["+a.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",(function(){var e,t=[];for(e in n)!0===n[e].explicitSet&&("name"===n[e].type?t.push("/"+e+" /"+n[e].value):t.push("/"+e+" "+n[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},
/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(e)),A=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),i=unescape(encodeURIComponent("</x:xmpmeta>")),o=n.length+A.length+r.length+t.length+i.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+o+" >>"),this.internal.write("stream"),this.internal.write(t+n+A+r+i),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,A){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:A||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(nB.API),function(e){var t=e.API,n=t.pdfEscape16=function(e,t){for(var n,A=t.metadata.Unicode.widths,r=["","0","00","000","0000"],i=[""],o=0,s=e.length;o<s;++o){if(n=t.metadata.characterToGlyph(e.charCodeAt(o)),t.metadata.glyIdsUsed.push(n),t.metadata.toUnicode[n]=e.charCodeAt(o),-1==A.indexOf(n)&&(A.push(n),A.push([parseInt(t.metadata.widthOfGlyph(n),10)])),"0"==n)return i.join("");n=n.toString(16),i.push(r[4-n.length],n)}return i.join("")},A=function(e){var t,n,A,r,i,o,s;for(i="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",A=[],o=0,s=(n=Object.keys(e).sort((function(e,t){return e-t}))).length;o<s;o++)t=n[o],A.length>=100&&(i+="\n"+A.length+" beginbfchar\n"+A.join("\n")+"\nendbfchar",A=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(r=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),A.push("<"+t+"><"+r+">"));return A.length&&(i+="\n"+A.length+" beginbfchar\n"+A.join("\n")+"\nendbfchar\n"),i+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var n=t.font,r=t.out,i=t.newObject,o=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"Identity-H"===n.encoding){for(var s=n.metadata.Unicode.widths,a=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),g="",l=0;l<a.length;l++)g+=String.fromCharCode(a[l]);var c=i();o({data:g,addLength1:!0,objectId:c}),r("endobj");var I=i();o({data:A(n.metadata.toUnicode),addLength1:!0,objectId:I}),r("endobj");var C=i();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+_b(n.fontName)),r("/FontFile2 "+c+" 0 R"),r("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),r("/Flags "+n.metadata.flags),r("/StemV "+n.metadata.stemV),r("/ItalicAngle "+n.metadata.italicAngle),r("/Ascent "+n.metadata.ascender),r("/Descent "+n.metadata.decender),r("/CapHeight "+n.metadata.capHeight),r(">>"),r("endobj");var u=i();r("<<"),r("/Type /Font"),r("/BaseFont /"+_b(n.fontName)),r("/FontDescriptor "+C+" 0 R"),r("/W "+e.API.PDFObject.convert(s)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+n.encoding+")"),r(">>"),r(">>"),r("endobj"),n.objectNumber=i(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+I+" 0 R"),r("/BaseFont /"+_b(n.fontName)),r("/Encoding /"+n.encoding),r("/DescendantFonts ["+u+" 0 R]"),r(">>"),r("endobj"),n.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var n=t.font,r=t.out,i=t.newObject,o=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var s=n.metadata.rawData,a="",g=0;g<s.length;g++)a+=String.fromCharCode(s[g]);var l=i();o({data:a,addLength1:!0,objectId:l}),r("endobj");var c=i();o({data:A(n.metadata.toUnicode),addLength1:!0,objectId:c}),r("endobj");var I=i();r("<<"),r("/Descent "+n.metadata.decender),r("/CapHeight "+n.metadata.capHeight),r("/StemV "+n.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+l+" 0 R"),r("/Flags 96"),r("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),r("/FontName /"+_b(n.fontName)),r("/ItalicAngle "+n.metadata.italicAngle),r("/Ascent "+n.metadata.ascender),r(">>"),r("endobj"),n.objectNumber=i();for(var C=0;C<n.metadata.hmtx.widths.length;C++)n.metadata.hmtx.widths[C]=parseInt(n.metadata.hmtx.widths[C]*(1e3/n.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+c+" 0 R/BaseFont/"+_b(n.fontName)+"/FontDescriptor "+I+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),r("endobj"),n.isAlreadyPutted=!0}}(t)}]);var r=function(e){var t,A=e.text||"",r=e.x,i=e.y,o=e.options||{},s=e.mutex||{},a=s.pdfEscape,g=s.activeFontKey,l=s.fonts,c=g,I="",C=0,u="",d=l[c].encoding;if("Identity-H"!==l[c].encoding)return{text:A,x:r,y:i,options:o,mutex:s};for(u=A,c=g,Array.isArray(A)&&(u=A[0]),C=0;C<u.length;C+=1)l[c].metadata.hasOwnProperty("cmap")&&(t=l[c].metadata.cmap.unicode.codeMap[u[C].charCodeAt(0)]),t||u[C].charCodeAt(0)<256&&l[c].metadata.hasOwnProperty("Unicode")?I+=u[C]:I+="";var h="";return parseInt(c.slice(1))<14||"WinAnsiEncoding"===d?h=a(I,c).split("").map((function(e){return e.charCodeAt(0).toString(16)})).join(""):"Identity-H"===d&&(h=n(I,l[c])),s.isHex=!0,{text:h,x:r,y:i,options:o,mutex:s}};t.events.push(["postProcessText",function(e){var t=e.text||"",n=[],A={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var i=0;for(i=0;i<t.length;i+=1)Array.isArray(t[i])&&3===t[i].length?n.push([r(Object.assign({},A,{text:t[i][0]})).text,t[i][1],t[i][2]]):n.push(r(Object.assign({},A,{text:t[i]})).text);e.text=n}else e.text=r(Object.assign({},A,{text:t})).text}])}(nB),
/**
 * @license
 * jsPDF virtual FileSystem functionality
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(nB.API),
/**
 * @license
 * Unicode Bidi Engine based on the work of Alex Shensis (@asthensis)
 * MIT License
 */
function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var n,A,r,i,o,s,a,g=t,l=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],c=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],I={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},C={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},u=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],d=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),h=!1,m=0;this.__bidiEngine__={};var p=function(e){var t=e.charCodeAt(),n=t>>8,A=C[n];return void 0!==A?g[256*A+(255&t)]:252===n||253===n?"AL":d.test(n)?"L":8===n?"R":"N"},f=function(e){for(var t,n=0;n<e.length;n++){if("L"===(t=p(e.charAt(n))))return!1;if("R"===t)return!0}return!1},b=function(e,t,o,s){var a,g,l,c,I=t[s];switch(I){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":h=!1;break;case"N":case"AN":break;case"EN":h&&(I="AN");break;case"AL":h=!0,I="R";break;case"WS":case"BN":I="N";break;case"CS":s<1||s+1>=t.length||"EN"!==(a=o[s-1])&&"AN"!==a||"EN"!==(g=t[s+1])&&"AN"!==g?I="N":h&&(g="AN"),I=g===a?g:"N";break;case"ES":I="EN"===(a=s>0?o[s-1]:"B")&&s+1<t.length&&"EN"===t[s+1]?"EN":"N";break;case"ET":if(s>0&&"EN"===o[s-1]){I="EN";break}if(h){I="N";break}for(l=s+1,c=t.length;l<c&&"ET"===t[l];)l++;I=l<c&&"EN"===t[l]?"EN":"N";break;case"NSM":if(r&&!i){for(c=t.length,l=s+1;l<c&&"NSM"===t[l];)l++;if(l<c){var C=e[s],u=C>=1425&&C<=2303||64286===C;if(a=t[l],u&&("R"===a||"AL"===a)){I="R";break}}}I=s<1||"B"===(a=t[s-1])?"N":o[s-1];break;case"B":h=!1,n=!0,I=m;break;case"S":A=!0,I="N"}return I},B=function(e,t,n){var A=e.split("");return n&&y(A,n,{hiLevel:m}),A.reverse(),t&&t.reverse(),A.join("")},y=function(e,t,r){var i,o,s,a,g,C=-1,u=e.length,d=0,f=[],B=m?c:l,y=[];for(h=!1,n=!1,A=!1,o=0;o<u;o++)y[o]=p(e[o]);for(s=0;s<u;s++){if(g=d,f[s]=b(e,y,f,s),i=240&(d=B[g][I[f[s]]]),d&=15,t[s]=a=B[d][5],i>0)if(16===i){for(o=C;o<s;o++)t[o]=1;C=-1}else C=-1;if(B[d][6])-1===C&&(C=s);else if(C>-1){for(o=C;o<s;o++)t[o]=a;C=-1}"B"===y[s]&&(t[s]=0),r.hiLevel|=a}A&&function(e,t,n){for(var A=0;A<n;A++)if("S"===e[A]){t[A]=m;for(var r=A-1;r>=0&&"WS"===e[r];r--)t[r]=m}}(y,t,u)},w=function(e,t,A,r,i){if(!(i.hiLevel<e)){if(1===e&&1===m&&!n)return t.reverse(),void(A&&A.reverse());for(var o,s,a,g,l=t.length,c=0;c<l;){if(r[c]>=e){for(a=c+1;a<l&&r[a]>=e;)a++;for(g=c,s=a-1;g<s;g++,s--)o=t[g],t[g]=t[s],t[s]=o,A&&(o=A[g],A[g]=A[s],A[s]=o);c=a}c++}}},Z=function(e,t,n){var A=e.split(""),r={hiLevel:m};return n||(n=[]),y(A,n,r),function(e,t,n){if(0!==n.hiLevel&&a)for(var A,r=0;r<e.length;r++)1===t[r]&&(A=u.indexOf(e[r]))>=0&&(e[r]=u[A+1])}(A,n,r),w(2,A,t,n,r),w(1,A,t,n,r),A.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,n){if(function(e,t){if(t)for(var n=0;n<e.length;n++)t[n]=n;void 0===i&&(i=f(e)),void 0===s&&(s=f(e))}(e,t),r||!o||s)if(r&&o&&i^s)m=i?1:0,e=B(e,t,n);else if(!r&&o&&s)m=i?1:0,e=Z(e,t,n),e=B(e,t);else if(!r||i||o||s){if(r&&!o&&i^s)e=B(e,t),i?(m=0,e=Z(e,t,n)):(m=1,e=Z(e,t,n),e=B(e,t));else if(r&&i&&!o&&s)m=1,e=Z(e,t,n),e=B(e,t);else if(!r&&!o&&i^s){var A=a;i?(m=1,e=Z(e,t,n),m=0,a=!1,e=Z(e,t,n),a=A):(m=0,e=Z(e,t,n),e=B(e,t),m=1,a=!1,e=Z(e,t,n),a=A,e=B(e,t))}}else m=0,e=Z(e,t,n);else m=i?1:0,e=Z(e,t,n);return e},this.__bidiEngine__.setOptions=function(e){e&&(r=e.isInputVisual,o=e.isOutputVisual,i=e.isInputRtl,s=e.isOutputRtl,a=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var A=e.options||{};e.mutex,A.lang;var r=[];if(A.isInputVisual="boolean"!=typeof A.isInputVisual||A.isInputVisual,n.setOptions(A),"[object Array]"===Object.prototype.toString.call(t)){var i=0;for(r=[],i=0;i<t.length;i+=1)"[object Array]"===Object.prototype.toString.call(t[i])?r.push([n.doBidiReorder(t[i][0]),t[i][1],t[i][2]]):r.push([n.doBidiReorder(t[i])]);e.text=r}else e.text=n.doBidiReorder(t);n.setOptions({isInputVisual:!0})}])}(nB),nB.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new By(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Uy(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new yy(this.contents),this.head=new Sy(this),this.name=new Wy(this),this.cmap=new Gy(this),this.toUnicode={},this.hhea=new Ry(this),this.maxp=new Fy(this),this.hmtx=new Ey(this),this.post=new Ny(this),this.os2=new Vy(this),this.loca=new Yy(this),this.glyf=new Hy(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,n,A,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,n,A,r;for(r=[],t=0,n=(A=this.bbox).length;t<n;t++)e=A[t],r.push(Math.round(e*this.scaleFactor));return r}.call(this),this.stemV=0,this.post.exists?(n=255&(A=this.post.italic_angle),!!(32768&(t=A>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(r=this.familyClass)||2===r||3===r||4===r||5===r||7===r,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,n){var A,r,i,o;for(i=0,r=0,o=(e=""+e).length;0<=o?r<o:r>o;r=0<=o?++r:--r)A=e.charCodeAt(r),i+=this.widthOfGlyph(this.characterToGlyph(A))+n*(1e3/t)||0;return i*(t/1e3)},e.prototype.lineHeight=function(e,t){var n;return null==t&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},e}();var by,By=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(e){var t,n,A;for(A=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)A.push(this.writeByte(e.charCodeAt(t)));return A},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,n,A,r,i,o,s;return e=this.readByte(),t=this.readByte(),n=this.readByte(),A=this.readByte(),r=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^A)+16777216*(255^r)+65536*(255^i)+256*(255^o)+(255^s)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*A+16777216*r+65536*i+256*o+s},e.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(e){var t,n,A,r;for(r=[],n=0,A=e.length;n<A;n++)t=e[n],r.push(this.writeByte(t));return r},e}(),yy=function(){var e;function t(e){var t,n,A;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,A=this.tableCount;0<=A?n<A:n>A;n=0<=A?++n:--n)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var n,A,r,i,o,s,a,g,l,c,I,C,u;for(u in I=Object.keys(t).length,s=Math.log(2),l=16*Math.floor(Math.log(I)/s),i=Math.floor(l/s),g=16*I-l,(A=new By).writeInt(this.scalarType),A.writeShort(I),A.writeShort(l),A.writeShort(i),A.writeShort(g),r=16*I,a=A.pos+r,o=null,C=[],t)for(c=t[u],A.writeString(u),A.writeInt(e(c)),A.writeInt(a),A.writeInt(c.length),C=C.concat(c),"head"===u&&(o=a),a+=c.length;a%4;)C.push(0),a++;return A.write(C),n=2981146554-e(A.data),A.pos=o+8,A.writeUInt32(n),A.data},e=function(e){var t,n,A,r;for(e=Xy.call(e);e.length%4;)e.push(0);for(A=new By(e),n=0,t=0,r=e.length;t<r;t=t+=4)n+=A.readUInt32();return 4294967295&n},t}(),wy={}.hasOwnProperty,Zy=function(e,t){for(var n in t)wy.call(t,n)&&(e[n]=t[n]);function A(){this.constructor=e}return A.prototype=t.prototype,e.prototype=new A,e.__super__=t.prototype,e};by=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Sy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new By).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),vy=function(){function e(e,t){var n,A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),l=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(s=0;s<256;++s)this.codeMap[s]=e.readByte();break;case 4:for(I=e.readUInt16(),c=I/2,e.pos+=6,r=function(){var t,n;for(n=[],s=t=0;0<=c?t<c:t>c;s=0<=c?++t:--t)n.push(e.readUInt16());return n}(),e.pos+=2,u=function(){var t,n;for(n=[],s=t=0;0<=c?t<c:t>c;s=0<=c?++t:--t)n.push(e.readUInt16());return n}(),a=function(){var t,n;for(n=[],s=t=0;0<=c?t<c:t>c;s=0<=c?++t:--t)n.push(e.readUInt16());return n}(),g=function(){var t,n;for(n=[],s=t=0;0<=c?t<c:t>c;s=0<=c?++t:--t)n.push(e.readUInt16());return n}(),A=(this.length-e.pos+this.offset)/2,o=function(){var t,n;for(n=[],s=t=0;0<=A?t<A:t>A;s=0<=A?++t:--t)n.push(e.readUInt16());return n}(),s=h=0,p=r.length;h<p;s=++h)for(d=r[s],n=m=C=u[s];C<=d?m<=d:m>=d;n=C<=d?++m:--m)0===g[s]?i=n+a[s]:0!==(i=o[g[s]/2+(n-C)-(c-s)]||0)&&(i+=a[s]),this.codeMap[n]=65535&i}e.pos=l}return e.encode=function(e,t){var n,A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p,f,b,B,y,w,Z,S,v,G,R,V,N,k,W,F,E,X,H,x,J,Y,U,L,T,K,M,Q,D,z;switch(V=new By,i=Object.keys(e).sort((function(e,t){return e-t})),t){case"macroman":for(u=0,d=function(){var e=[];for(C=0;C<256;++C)e.push(0);return e}(),m={0:0},r={},N=0,E=i.length;N<E;N++)null==m[M=e[A=i[N]]]&&(m[M]=++u),r[A]={old:e[A],new:m[e[A]]},d[A]=m[e[A]];return V.writeUInt16(1),V.writeUInt16(0),V.writeUInt32(12),V.writeUInt16(0),V.writeUInt16(262),V.writeUInt16(0),V.write(d),{charMap:r,subtable:V.data,maxGlyphID:u+1};case"unicode":for(G=[],l=[],p=0,m={},n={},h=a=null,k=0,X=i.length;k<X;k++)null==m[b=e[A=i[k]]]&&(m[b]=++p),n[A]={old:b,new:m[b]},o=m[b]-A,null!=h&&o===a||(h&&l.push(h),G.push(A),a=o),h=A;for(h&&l.push(h),l.push(65535),G.push(65535),S=2*(Z=G.length),w=2*Math.pow(Math.log(Z)/Math.LN2,2),c=Math.log(w/2)/Math.LN2,y=2*Z-w,s=[],B=[],I=[],C=W=0,H=G.length;W<H;C=++W){if(v=G[C],g=l[C],65535===v){s.push(0),B.push(0);break}if(v-(R=n[v].new)>=32768)for(s.push(0),B.push(2*(I.length+Z-C)),A=F=v;v<=g?F<=g:F>=g;A=v<=g?++F:--F)I.push(n[A].new);else s.push(R-v),B.push(0)}for(V.writeUInt16(3),V.writeUInt16(1),V.writeUInt32(12),V.writeUInt16(4),V.writeUInt16(16+8*Z+2*I.length),V.writeUInt16(0),V.writeUInt16(S),V.writeUInt16(w),V.writeUInt16(c),V.writeUInt16(y),T=0,x=l.length;T<x;T++)A=l[T],V.writeUInt16(A);for(V.writeUInt16(0),K=0,J=G.length;K<J;K++)A=G[K],V.writeUInt16(A);for(Q=0,Y=s.length;Q<Y;Q++)o=s[Q],V.writeUInt16(o);for(D=0,U=B.length;D<U;D++)f=B[D],V.writeUInt16(f);for(z=0,L=I.length;z<L;z++)u=I[z],V.writeUInt16(u);return{charMap:n,subtable:V.data,maxGlyphID:p+1}}},e}(),Gy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,n,A;for(e.pos=this.offset,this.version=e.readUInt16(),A=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=A?n<A:n>A;n=0<=A?++n:--n)t=new vy(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var n,A;return null==t&&(t="macroman"),n=vy.encode(e,t),(A=new By).writeUInt16(0),A.writeUInt16(1),n.table=A.data.concat(n.subtable),n},e}(),Ry=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),Vy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),Ny=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="post",e.prototype.parse=function(e){var t,n,A;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var r;for(n=e.readUInt16(),this.glyphNameIndex=[],r=0;0<=n?r<n:r>n;r=0<=n?++r:--r)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],A=[];e.pos<this.offset+this.length;)t=e.readByte(),A.push(this.names.push(e.readString(t)));return A;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=function(){var t,n,A;for(A=[],r=t=0,n=this.file.maxp.numGlyphs;0<=n?t<n:t>n;r=0<=n?++t:--t)A.push(e.readUInt32());return A}.call(this)}},e}(),ky=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Wy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="name",e.prototype.parse=function(e){var t,n,A,r,i,o,s,a,g,l,c;for(e.pos=this.offset,e.readShort(),t=e.readShort(),o=e.readShort(),n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(s={},r=g=0,l=n.length;g<l;r=++g)A=n[r],e.pos=A.offset,a=e.readString(A.length),i=new ky(a,A),null==s[c=A.nameID]&&(s[c]=[]),s[A.nameID].push(i);this.strings=s,this.copyright=s[0],this.fontFamily=s[1],this.fontSubfamily=s[2],this.uniqueSubfamily=s[3],this.fontName=s[4],this.version=s[5];try{this.postscriptName=s[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(I){this.postscriptName=s[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=s[7],this.manufacturer=s[8],this.designer=s[9],this.description=s[10],this.vendorUrl=s[11],this.designerUrl=s[12],this.license=s[13],this.licenseUrl=s[14],this.preferredFamily=s[15],this.preferredSubfamily=s[17],this.compatibleFull=s[18],this.sampleText=s[19]},e}(),Fy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),Ey=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,n,A,r,i,o,s;for(e.pos=this.offset,this.metrics=[],t=0,o=this.file.hhea.numberOfMetrics;0<=o?t<o:t>o;t=0<=o?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(A=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,r;for(r=[],t=n=0;0<=A?n<A:n>A;t=0<=A?++n:--n)r.push(e.readInt16());return r}(),this.widths=function(){var e,t,n,A;for(A=[],e=0,t=(n=this.metrics).length;e<t;e++)r=n[e],A.push(r.advance);return A}.call(this),n=this.widths[this.widths.length-1],s=[],t=i=0;0<=A?i<A:i>A;t=0<=A?++i:--i)s.push(this.widths.push(n));return s},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),Xy=[].slice,Hy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,n,A,r,i,o,s,a,g,l;return e in this.cache?this.cache[e]:(r=this.file.loca,t=this.file.contents,n=r.indexOf(e),0===(A=r.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+n,i=(o=new By(t.read(A))).readShort(),a=o.readShort(),l=o.readShort(),s=o.readShort(),g=o.readShort(),this.cache[e]=-1===i?new Jy(o,a,l,s,g):new xy(o,i,a,l,s,g),this.cache[e]))},e.prototype.encode=function(e,t,n){var A,r,i,o,s;for(i=[],r=[],o=0,s=t.length;o<s;o++)A=e[t[o]],r.push(i.length),A&&(i=i.concat(A.encode(n)));return r.push(i.length),{table:i,offsets:r}},e}(),xy=function(){function e(e,t,n,A,r,i){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=A,this.xMax=r,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Jy=function(){function e(e,t,n,A,r){var i,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=A,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var e,t,n;for(t=new By(Xy.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),Yy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Zy(e,by),e.prototype.tag="loca",e.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,A;for(A=[],n=0,t=this.length;n<t;n+=2)A.push(2*e.readUInt16());return A}.call(this):function(){var t,A;for(A=[],n=0,t=this.length;n<t;n+=4)A.push(e.readUInt32());return A}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),A=0,r=0,i=0;i<n.length;++i)if(n[i]=A,r<t.length&&t[r]==i){++r,n[i]=A;var o=this.offsets[i],s=this.offsets[i+1]-o;s>0&&(A+=s)}for(var a=new Array(4*n.length),g=0;g<n.length;++g)a[4*g+3]=255&n[g],a[4*g+2]=(65280&n[g])>>8,a[4*g+1]=(16711680&n[g])>>16,a[4*g]=(4278190080&n[g])>>24;return a},e}(),Uy=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,n,A,r;for(t in A=this.font.cmap.tables[0].codeMap,e={},r=this.subset)n=r[t],e[t]=A[n];return e},e.prototype.glyphsFor=function(e){var t,n,A,r,i,o,s;for(A={},i=0,o=e.length;i<o;i++)A[r=e[i]]=this.font.glyf.glyphFor(r);for(r in t=[],A)(null!=(n=A[r])?n.compound:void 0)&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(r in s=this.glyphsFor(t))n=s[r],A[r]=n;return A},e.prototype.encode=function(e,t){var n,A,r,i,o,s,a,g,l,c,I,C,u,d,h;for(A in n=Gy.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),I={0:0},h=n.charMap)I[(s=h[A]).old]=s.new;for(C in c=n.maxGlyphID,i)C in I||(I[C]=c++);return g=function(e){var t,n;for(t in n={},e)n[e[t]]=t;return n}(I),l=Object.keys(g).sort((function(e,t){return e-t})),u=function(){var e,t,n;for(n=[],e=0,t=l.length;e<t;e++)o=l[e],n.push(g[o]);return n}(),r=this.font.glyf.encode(i,u,I),a=this.font.loca.encode(r.offsets,u),d={cmap:this.font.cmap.raw(),glyf:r.table,loca:a,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(d["OS/2"]=this.font.os2.raw()),this.font.directory.encode(d)},e}();nB.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(n){var A,r,i,o;if(Array.isArray(n))return"["+function(){var e,r,i;for(i=[],e=0,r=n.length;e<r;e++)A=n[e],i.push(t.convert(A));return i}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(r in i=["<<"],n)o=n[r],i.push("/"+r+" "+t.convert(o));return i.push(">>"),i.join("\n")}return""+n},t}();
/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Ly=function(e,t){return Ly=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Ly(e,t)};function Ty(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Ly(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Ky=function(){return Ky=Object.assign||function(e){for(var t,n=1,A=arguments.length;n<A;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ky.apply(this,arguments)};function My(e,t,n,A){return new(n||(n=Promise))((function(t,r){function i(e){try{s(A.next(e))}catch(Zf){r(Zf)}}function o(e){try{s(A.throw(e))}catch(Zf){r(Zf)}}function s(e){var A;e.done?t(e.value):(A=e.value,A instanceof n?A:new n((function(e){e(A)}))).then(i,o)}s((A=A.apply(e,[])).next())}))}function Qy(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,A&&(r=2&i[0]?A.return:i[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,i[1])).done)return r;switch(A=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,A=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(Zf){i=[6,Zf],A=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}for(var Dy=function(){function e(e,t,n,A){this.left=e,this.top=t,this.width=n,this.height=A}return e.prototype.add=function(t,n,A,r){return new e(this.left+t,this.top+n,this.width+A,this.height+r)},e.fromClientRect=function(t,n){return new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height)},e.fromDOMRectList=function(t,n){var A=Array.from(n).find((function(e){return 0!==e.width}));return A?new e(A.left+t.windowBounds.left,A.top+t.windowBounds.top,A.width,A.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),zy=function(e,t){return Dy.fromClientRect(e,t.getBoundingClientRect())},Oy=function(e){for(var t=[],n=0,A=e.length;n<A;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<A){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&r)<<10)+(1023&i)+65536):(t.push(r),n--)}else t.push(r)}return t},Py=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var n=e.length;if(!n)return"";for(var A=[],r=-1,i="";++r<n;){var o=e[r];o<=65535?A.push(o):(o-=65536,A.push(55296+(o>>10),o%1024+56320)),(r+1===n||A.length>16384)&&(i+=String.fromCharCode.apply(String,A),A.length=0)}return i},_y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jy="undefined"==typeof Uint8Array?[]:new Uint8Array(256),qy=0;qy<64;qy++)jy[_y.charCodeAt(qy)]=qy;for(var $y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ew="undefined"==typeof Uint8Array?[]:new Uint8Array(256),tw=0;tw<64;tw++)ew[$y.charCodeAt(tw)]=tw;for(var nw=function(e,t,n){return e.slice?e.slice(t,n):new Uint16Array(Array.prototype.slice.call(e,t,n))},Aw=function(){function e(e,t,n,A,r,i){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=A,this.index=r,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>5])<<2)+(31&e),this.data[t];if(e<=65535)return t=((t=this.index[2048+(e-55296>>5)])<<2)+(31&e),this.data[t];if(e<this.highStart)return t=2080+(e>>11),t=this.index[t],t+=e>>5&63,t=((t=this.index[t])<<2)+(31&e),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),rw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",iw="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ow=0;ow<64;ow++)iw[rw.charCodeAt(ow)]=ow;var sw=10,aw=13,gw=15,lw=17,cw=18,Iw=19,Cw=20,uw=21,dw=22,hw=24,mw=25,pw=26,fw=27,bw=28,Bw=30,yw=32,ww=33,Zw=34,Sw=35,vw=37,Gw=38,Rw=39,Vw=40,Nw=42,kw=[9001,65288],Ww="×",Fw="÷",Ew=function(e){var t,n,A,r=function(e){var t,n,A,r,i,o=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var g="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(g)?g:new Uint8Array(g);for(t=0;t<s;t+=4)n=ew[e.charCodeAt(t)],A=ew[e.charCodeAt(t+1)],r=ew[e.charCodeAt(t+2)],i=ew[e.charCodeAt(t+3)],l[a++]=n<<2|A>>4,l[a++]=(15&A)<<4|r>>2,l[a++]=(3&r)<<6|63&i;return g}(e),i=Array.isArray(r)?function(e){for(var t=e.length,n=[],A=0;A<t;A+=4)n.push(e[A+3]<<24|e[A+2]<<16|e[A+1]<<8|e[A]);return n}(r):new Uint32Array(r),o=Array.isArray(r)?function(e){for(var t=e.length,n=[],A=0;A<t;A+=2)n.push(e[A+1]<<8|e[A]);return n}(r):new Uint16Array(r),s=nw(o,12,i[4]/2),a=2===i[5]?nw(o,(24+i[4])/2):(t=i,n=Math.ceil((24+i[4])/4),t.slice?t.slice(n,A):new Uint32Array(Array.prototype.slice.call(t,n,A)));return new Aw(i[0],i[1],i[2],i[3],s,a)}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),Xw=[Bw,36],Hw=[1,2,3,5],xw=[sw,8],Jw=[fw,pw],Yw=Hw.concat(xw),Uw=[Gw,Rw,Vw,Zw,Sw],Lw=[gw,aw],Tw=function(e,t,n,A){var r=A[n];if(Array.isArray(e)?-1!==e.indexOf(r):e===r)for(var i=n;i<=A.length;){if((a=A[++i])===t)return!0;if(a!==sw)break}if(r===sw)for(i=n;i>0;){var o=A[--i];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var s=n;s<=A.length;){var a;if((a=A[++s])===t)return!0;if(a!==sw)break}if(o!==sw)break}return!1},Kw=function(e,t){for(var n=e;n>=0;){var A=t[n];if(A!==sw)return A;n--}return 0},Mw=function(e,t,n,A,r){if(0===n[A])return Ww;var i=A-1;if(Array.isArray(r)&&!0===r[i])return Ww;var o=i-1,s=i+1,a=t[i],g=o>=0?t[o]:0,l=t[s];if(2===a&&3===l)return Ww;if(-1!==Hw.indexOf(a))return"!";if(-1!==Hw.indexOf(l))return Ww;if(-1!==xw.indexOf(l))return Ww;if(8===Kw(i,t))return Fw;if(11===Ew.get(e[i]))return Ww;if((a===yw||a===ww)&&11===Ew.get(e[s]))return Ww;if(7===a||7===l)return Ww;if(9===a)return Ww;if(-1===[sw,aw,gw].indexOf(a)&&9===l)return Ww;if(-1!==[lw,cw,Iw,hw,bw].indexOf(l))return Ww;if(Kw(i,t)===dw)return Ww;if(Tw(23,dw,i,t))return Ww;if(Tw([lw,cw],uw,i,t))return Ww;if(Tw(12,12,i,t))return Ww;if(a===sw)return Fw;if(23===a||23===l)return Ww;if(16===l||16===a)return Fw;if(-1!==[aw,gw,uw].indexOf(l)||14===a)return Ww;if(36===g&&-1!==Lw.indexOf(a))return Ww;if(a===bw&&36===l)return Ww;if(l===Cw)return Ww;if(-1!==Xw.indexOf(l)&&a===mw||-1!==Xw.indexOf(a)&&l===mw)return Ww;if(a===fw&&-1!==[vw,yw,ww].indexOf(l)||-1!==[vw,yw,ww].indexOf(a)&&l===pw)return Ww;if(-1!==Xw.indexOf(a)&&-1!==Jw.indexOf(l)||-1!==Jw.indexOf(a)&&-1!==Xw.indexOf(l))return Ww;if(-1!==[fw,pw].indexOf(a)&&(l===mw||-1!==[dw,gw].indexOf(l)&&t[s+1]===mw)||-1!==[dw,gw].indexOf(a)&&l===mw||a===mw&&-1!==[mw,bw,hw].indexOf(l))return Ww;if(-1!==[mw,bw,hw,lw,cw].indexOf(l))for(var c=i;c>=0;){if((I=t[c])===mw)return Ww;if(-1===[bw,hw].indexOf(I))break;c--}if(-1!==[fw,pw].indexOf(l))for(c=-1!==[lw,cw].indexOf(a)?o:i;c>=0;){var I;if((I=t[c])===mw)return Ww;if(-1===[bw,hw].indexOf(I))break;c--}if(Gw===a&&-1!==[Gw,Rw,Zw,Sw].indexOf(l)||-1!==[Rw,Zw].indexOf(a)&&-1!==[Rw,Vw].indexOf(l)||-1!==[Vw,Sw].indexOf(a)&&l===Vw)return Ww;if(-1!==Uw.indexOf(a)&&-1!==[Cw,pw].indexOf(l)||-1!==Uw.indexOf(l)&&a===fw)return Ww;if(-1!==Xw.indexOf(a)&&-1!==Xw.indexOf(l))return Ww;if(a===hw&&-1!==Xw.indexOf(l))return Ww;if(-1!==Xw.concat(mw).indexOf(a)&&l===dw&&-1===kw.indexOf(e[s])||-1!==Xw.concat(mw).indexOf(l)&&a===cw)return Ww;if(41===a&&41===l){for(var C=n[i],u=1;C>0&&41===t[--C];)u++;if(u%2!=0)return Ww}return a===yw&&l===ww?Ww:Fw},Qw=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=function(e,t){void 0===t&&(t="strict");var n=[],A=[],r=[];return e.forEach((function(e,i){var o=Ew.get(e);if(o>50?(r.push(!0),o-=50):r.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return A.push(i),n.push(16);if(4===o||11===o){if(0===i)return A.push(i),n.push(Bw);var s=n[i-1];return-1===Yw.indexOf(s)?(A.push(A[i-1]),n.push(s)):(A.push(i),n.push(Bw))}return A.push(i),31===o?n.push("strict"===t?uw:vw):o===Nw||29===o?n.push(Bw):43===o?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(vw):n.push(Bw):void n.push(o)})),[A,n,r]}(e,t.lineBreak),A=n[0],r=n[1],i=n[2];"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(r=r.map((function(e){return-1!==[mw,Bw,Nw].indexOf(e)?vw:e})));var o="keep-all"===t.wordBreak?i.map((function(t,n){return t&&e[n]>=19968&&e[n]<=40959})):void 0;return[A,r,o]},Dw=function(){function e(e,t,n,A){this.codePoints=e,this.required="!"===t,this.start=n,this.end=A}return e.prototype.slice=function(){return Py.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),zw=45,Ow=43,Pw=-1,_w=function(e){return e>=48&&e<=57},jw=function(e){return _w(e)||e>=65&&e<=70||e>=97&&e<=102},qw=function(e){return 10===e||9===e||32===e},$w=function(e){return function(e){return function(e){return e>=97&&e<=122}(e)||function(e){return e>=65&&e<=90}(e)}(e)||function(e){return e>=128}(e)||95===e},eZ=function(e){return $w(e)||_w(e)||e===zw},tZ=function(e){return e>=0&&e<=8||11===e||e>=14&&e<=31||127===e},nZ=function(e,t){return 92===e&&10!==t},AZ=function(e,t,n){return e===zw?$w(t)||nZ(t,n):!!$w(e)||!(92!==e||!nZ(e,t))},rZ=function(e,t,n){return e===Ow||e===zw?!!_w(t)||46===t&&_w(n):_w(46===e?t:e)},iZ=function(e){var t=0,n=1;e[t]!==Ow&&e[t]!==zw||(e[t]===zw&&(n=-1),t++);for(var A=[];_w(e[t]);)A.push(e[t++]);var r=A.length?parseInt(Py.apply(void 0,A),10):0;46===e[t]&&t++;for(var i=[];_w(e[t]);)i.push(e[t++]);var o=i.length,s=o?parseInt(Py.apply(void 0,i),10):0;69!==e[t]&&101!==e[t]||t++;var a=1;e[t]!==Ow&&e[t]!==zw||(e[t]===zw&&(a=-1),t++);for(var g=[];_w(e[t]);)g.push(e[t++]);var l=g.length?parseInt(Py.apply(void 0,g),10):0;return n*(r+s*Math.pow(10,-o))*Math.pow(10,a*l)},oZ={type:2},sZ={type:3},aZ={type:4},gZ={type:13},lZ={type:8},cZ={type:21},IZ={type:9},CZ={type:10},uZ={type:11},dZ={type:12},hZ={type:14},mZ={type:23},pZ={type:1},fZ={type:25},bZ={type:24},BZ={type:26},yZ={type:27},wZ={type:28},ZZ={type:29},SZ={type:31},vZ={type:32},GZ=function(){function e(){this._value=[]}return e.prototype.write=function(e){this._value=this._value.concat(Oy(e))},e.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==vZ;)e.push(t),t=this.consumeToken();return e},e.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case 34:return this.consumeStringToken(34);case 35:var t=this.peekCodePoint(0),n=this.peekCodePoint(1),A=this.peekCodePoint(2);if(eZ(t)||nZ(n,A)){var r=AZ(t,n,A)?2:1;return{type:5,value:this.consumeName(),flags:r}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),gZ;break;case 39:return this.consumeStringToken(39);case 40:return oZ;case 41:return sZ;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),hZ;break;case Ow:if(rZ(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 44:return aZ;case zw:var i=e,o=this.peekCodePoint(0),s=this.peekCodePoint(1);if(rZ(i,o,s))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(AZ(i,o,s))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(o===zw&&62===s)return this.consumeCodePoint(),this.consumeCodePoint(),bZ;break;case 46:if(rZ(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var a=this.consumeCodePoint();if(42===a&&47===(a=this.consumeCodePoint()))return this.consumeToken();if(a===Pw)return this.consumeToken()}break;case 58:return BZ;case 59:return yZ;case 60:if(33===this.peekCodePoint(0)&&this.peekCodePoint(1)===zw&&this.peekCodePoint(2)===zw)return this.consumeCodePoint(),this.consumeCodePoint(),fZ;break;case 64:var g=this.peekCodePoint(0),l=this.peekCodePoint(1),c=this.peekCodePoint(2);if(AZ(g,l,c))return{type:7,value:this.consumeName()};break;case 91:return wZ;case 92:if(nZ(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case 93:return ZZ;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),lZ;break;case 123:return uZ;case 125:return dZ;case 117:case 85:var I=this.peekCodePoint(0),C=this.peekCodePoint(1);return I!==Ow||!jw(C)&&63!==C||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),IZ;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),cZ;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),CZ;break;case Pw:return vZ}return qw(e)?(this.consumeWhiteSpace(),SZ):_w(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):$w(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Py(e)}},e.prototype.consumeCodePoint=function(){var e=this._value.shift();return void 0===e?-1:e},e.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},e.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},e.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();jw(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var n=!1;63===t&&e.length<6;)e.push(t),t=this.consumeCodePoint(),n=!0;if(n)return{type:30,start:parseInt(Py.apply(void 0,e.map((function(e){return 63===e?48:e}))),16),end:parseInt(Py.apply(void 0,e.map((function(e){return 63===e?70:e}))),16)};var A=parseInt(Py.apply(void 0,e),16);if(this.peekCodePoint(0)===zw&&jw(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var r=[];jw(t)&&r.length<6;)r.push(t),t=this.consumeCodePoint();return{type:30,start:A,end:parseInt(Py.apply(void 0,r),16)}}return{type:30,start:A,end:A}},e.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return"url"===e.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},e.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Pw)return{type:22,value:""};var t=this.peekCodePoint(0);if(39===t||34===t){var n=this.consumeStringToken(this.consumeCodePoint());return 0===n.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Pw||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),mZ)}for(;;){var A=this.consumeCodePoint();if(A===Pw||41===A)return{type:22,value:Py.apply(void 0,e)};if(qw(A))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Pw||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:Py.apply(void 0,e)}):(this.consumeBadUrlRemnants(),mZ);if(34===A||39===A||40===A||tZ(A))return this.consumeBadUrlRemnants(),mZ;if(92===A){if(!nZ(A,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),mZ;e.push(this.consumeEscapedCodePoint())}else e.push(A)}},e.prototype.consumeWhiteSpace=function(){for(;qw(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(41===e||e===Pw)return;nZ(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(e){for(var t="";e>0;){var n=Math.min(5e4,e);t+=Py.apply(void 0,this._value.splice(0,n)),e-=n}return this._value.shift(),t},e.prototype.consumeStringToken=function(e){for(var t="",n=0;;){var A=this._value[n];if(A===Pw||void 0===A||A===e)return{type:0,value:t+=this.consumeStringSlice(n)};if(10===A)return this._value.splice(0,n),pZ;if(92===A){var r=this._value[n+1];r!==Pw&&void 0!==r&&(10===r?(t+=this.consumeStringSlice(n),n=-1,this._value.shift()):nZ(A,r)&&(t+=this.consumeStringSlice(n),t+=Py(this.consumeEscapedCodePoint()),n=-1))}n++}},e.prototype.consumeNumber=function(){var e=[],t=4,n=this.peekCodePoint(0);for(n!==Ow&&n!==zw||e.push(this.consumeCodePoint());_w(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0);var A=this.peekCodePoint(1);if(46===n&&_w(A))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;_w(this.peekCodePoint(0));)e.push(this.consumeCodePoint());n=this.peekCodePoint(0),A=this.peekCodePoint(1);var r=this.peekCodePoint(2);if((69===n||101===n)&&((A===Ow||A===zw)&&_w(r)||_w(A)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=8;_w(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[iZ(e),t]},e.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],n=e[1],A=this.peekCodePoint(0),r=this.peekCodePoint(1),i=this.peekCodePoint(2);return AZ(A,r,i)?{type:15,number:t,flags:n,unit:this.consumeName()}:37===A?(this.consumeCodePoint(),{type:16,number:t,flags:n}):{type:17,number:t,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(jw(e)){for(var t=Py(e);jw(this.peekCodePoint(0))&&t.length<6;)t+=Py(this.consumeCodePoint());qw(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(t,16);return 0===n||function(e){return e>=55296&&e<=57343}(n)||n>1114111?65533:n}return e===Pw?65533:e},e.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(eZ(t))e+=Py(t);else{if(!nZ(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),e;e+=Py(this.consumeEscapedCodePoint())}}},e}(),RZ=function(){function e(e){this._tokens=e}return e.create=function(t){var n=new GZ;return n.write(t),new e(n.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var e=this.consumeToken();31===e.type;)e=this.consumeToken();if(32===e.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do{e=this.consumeToken()}while(31===e.type);if(32===e.type)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(32===t.type)return e;e.push(t),e.push()}},e.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},e.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},n=this.consumeToken();;){if(32===n.type||xZ(n,e))return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var n=this.consumeToken();if(32===n.type||3===n.type)return t;this.reconsumeToken(n),t.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var e=this._tokens.shift();return void 0===e?vZ:e},e.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},e}(),VZ=function(e){return 15===e.type},NZ=function(e){return 17===e.type},kZ=function(e){return 20===e.type},WZ=function(e){return 0===e.type},FZ=function(e,t){return kZ(e)&&e.value===t},EZ=function(e){return 31!==e.type},XZ=function(e){return 31!==e.type&&4!==e.type},HZ=function(e){var t=[],n=[];return e.forEach((function(e){if(4===e.type){if(0===n.length)throw new Error("Error parsing function args, zero tokens for arg");return t.push(n),void(n=[])}31!==e.type&&n.push(e)})),n.length&&t.push(n),t},xZ=function(e,t){return 11===t&&12===e.type||(28===t&&29===e.type||2===t&&3===e.type)},JZ=function(e){return 17===e.type||15===e.type},YZ=function(e){return 16===e.type||JZ(e)},UZ=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},LZ={type:17,number:0,flags:4},TZ={type:16,number:50,flags:4},KZ={type:16,number:100,flags:4},MZ=function(e,t,n){var A=e[0],r=e[1];return[QZ(A,t),QZ(void 0!==r?r:A,n)]},QZ=function(e,t){if(16===e.type)return e.number/100*t;if(VZ(e))switch(e.unit){case"rem":case"em":return 16*e.number;default:return e.number}return e.number},DZ="grad",zZ="turn",OZ=function(e,t){if(15===t.type)switch(t.unit){case"deg":return Math.PI*t.number/180;case DZ:return Math.PI/200*t.number;case"rad":return t.number;case zZ:return 2*Math.PI*t.number}throw new Error("Unsupported angle type")},PZ=function(e){return 15===e.type&&("deg"===e.unit||e.unit===DZ||"rad"===e.unit||e.unit===zZ)},_Z=function(e){switch(e.filter(kZ).map((function(e){return e.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[LZ,LZ];case"to top":case"bottom":return jZ(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[LZ,KZ];case"to right":case"left":return jZ(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[KZ,KZ];case"to bottom":case"top":return jZ(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[KZ,LZ];case"to left":case"right":return jZ(270)}return 0},jZ=function(e){return Math.PI*e/180},qZ=function(e,t){if(18===t.type){var n=oS[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return n(e,t.values)}if(5===t.type){if(3===t.value.length){var A=t.value.substring(0,1),r=t.value.substring(1,2),i=t.value.substring(2,3);return tS(parseInt(A+A,16),parseInt(r+r,16),parseInt(i+i,16),1)}if(4===t.value.length){A=t.value.substring(0,1),r=t.value.substring(1,2),i=t.value.substring(2,3);var o=t.value.substring(3,4);return tS(parseInt(A+A,16),parseInt(r+r,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(6===t.value.length){A=t.value.substring(0,2),r=t.value.substring(2,4),i=t.value.substring(4,6);return tS(parseInt(A,16),parseInt(r,16),parseInt(i,16),1)}if(8===t.value.length){A=t.value.substring(0,2),r=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8);return tS(parseInt(A,16),parseInt(r,16),parseInt(i,16),parseInt(o,16)/255)}}if(20===t.type){var s=aS[t.value.toUpperCase()];if(void 0!==s)return s}return aS.TRANSPARENT},$Z=function(e){return!(255&e)},eS=function(e){var t=255&e,n=255&e>>8,A=255&e>>16,r=255&e>>24;return t<255?"rgba("+r+","+A+","+n+","+t/255+")":"rgb("+r+","+A+","+n+")"},tS=function(e,t,n,A){return(e<<24|t<<16|n<<8|Math.round(255*A))>>>0},nS=function(e,t){if(17===e.type)return e.number;if(16===e.type){var n=3===t?1:255;return 3===t?e.number/100*n:Math.round(e.number/100*n)}return 0},AS=function(e,t){var n=t.filter(XZ);if(3===n.length){var A=n.map(nS),r=A[0],i=A[1],o=A[2];return tS(r,i,o,1)}if(4===n.length){var s=n.map(nS),a=(r=s[0],i=s[1],o=s[2],s[3]);return tS(r,i,o,a)}return 0};function rS(e,t,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(t-e)*n*6+e:n<.5?t:n<2/3?6*(t-e)*(2/3-n)+e:e}var iS=function(e,t){var n=t.filter(XZ),A=n[0],r=n[1],i=n[2],o=n[3],s=(17===A.type?jZ(A.number):OZ(e,A))/(2*Math.PI),a=YZ(r)?r.number/100:0,g=YZ(i)?i.number/100:0,l=void 0!==o&&YZ(o)?QZ(o,1):1;if(0===a)return tS(255*g,255*g,255*g,1);var c=g<=.5?g*(a+1):g+a-g*a,I=2*g-c,C=rS(I,c,s+1/3),u=rS(I,c,s),d=rS(I,c,s-1/3);return tS(255*C,255*u,255*d,l)},oS={hsl:iS,hsla:iS,rgb:AS,rgba:AS},sS=function(e,t){return qZ(e,RZ.create(t).parseComponentValue())},aS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},gS={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(kZ(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},lS={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},cS=function(e,t){var n=qZ(e,t[0]),A=t[1];return A&&YZ(A)?{color:n,stop:A}:{color:n,stop:null}},IS=function(e,t){var n=e[0],A=e[e.length-1];null===n.stop&&(n.stop=LZ),null===A.stop&&(A.stop=KZ);for(var r=[],i=0,o=0;o<e.length;o++){var s=e[o].stop;if(null!==s){var a=QZ(s,t);a>i?r.push(a):r.push(i),i=a}else r.push(null)}var g=null;for(o=0;o<r.length;o++){var l=r[o];if(null===l)null===g&&(g=o);else if(null!==g){for(var c=o-g,I=(l-r[g-1])/(c+1),C=1;C<=c;C++)r[g+C-1]=I*C;g=null}}return e.map((function(e,n){return{color:e.color,stop:Math.max(Math.min(1,r[n]/t),0)}}))},CS=function(e,t,n){var A="number"==typeof e?e:function(e,t,n){var A=t/2,r=n/2,i=QZ(e[0],t)-A,o=r-QZ(e[1],n);return(Math.atan2(o,i)+2*Math.PI)%(2*Math.PI)}(e,t,n),r=Math.abs(t*Math.sin(A))+Math.abs(n*Math.cos(A)),i=t/2,o=n/2,s=r/2,a=Math.sin(A-Math.PI/2)*s,g=Math.cos(A-Math.PI/2)*s;return[r,i-g,i+g,o-a,o+a]},uS=function(e,t){return Math.sqrt(e*e+t*t)},dS=function(e,t,n,A,r){return[[0,0],[0,t],[e,0],[e,t]].reduce((function(e,t){var i=t[0],o=t[1],s=uS(n-i,A-o);return(r?s<e.optimumDistance:s>e.optimumDistance)?{optimumCorner:t,optimumDistance:s}:e}),{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},hS=function(e,t){var n=jZ(180),A=[];return HZ(t).forEach((function(t,r){if(0===r){var i=t[0];if(20===i.type&&-1!==["top","left","right","bottom"].indexOf(i.value))return void(n=_Z(t));if(PZ(i))return void(n=(OZ(e,i)+jZ(270))%jZ(360))}var o=cS(e,t);A.push(o)})),{angle:n,stops:A,type:1}},mS="closest-side",pS="farthest-side",fS="closest-corner",bS="farthest-corner",BS="circle",yS="ellipse",wS="cover",ZS="contain",SS=function(e,t){var n=0,A=3,r=[],i=[];return HZ(t).forEach((function(t,o){var s=!0;if(0===o?s=t.reduce((function(e,t){if(kZ(t))switch(t.value){case"center":return i.push(TZ),!1;case"top":case"left":return i.push(LZ),!1;case"right":case"bottom":return i.push(KZ),!1}else if(YZ(t)||JZ(t))return i.push(t),!1;return e}),s):1===o&&(s=t.reduce((function(e,t){if(kZ(t))switch(t.value){case BS:return n=0,!1;case yS:return n=1,!1;case ZS:case mS:return A=0,!1;case pS:return A=1,!1;case fS:return A=2,!1;case wS:case bS:return A=3,!1}else if(JZ(t)||YZ(t))return Array.isArray(A)||(A=[]),A.push(t),!1;return e}),s)),s){var a=cS(e,t);r.push(a)}})),{size:A,shape:n,stops:r,position:i,type:2}},vS=function(e,t){if(22===t.type){var n={url:t.value,type:0};return e.cache.addImage(t.value),n}if(18===t.type){var A=VS[t.name];if(void 0===A)throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return A(e,t.values)}throw new Error("Unsupported image type "+t.type)};var GS,RS,VS={"linear-gradient":function(e,t){var n=jZ(180),A=[];return HZ(t).forEach((function(t,r){if(0===r){var i=t[0];if(20===i.type&&"to"===i.value)return void(n=_Z(t));if(PZ(i))return void(n=OZ(e,i))}var o=cS(e,t);A.push(o)})),{angle:n,stops:A,type:1}},"-moz-linear-gradient":hS,"-ms-linear-gradient":hS,"-o-linear-gradient":hS,"-webkit-linear-gradient":hS,"radial-gradient":function(e,t){var n=0,A=3,r=[],i=[];return HZ(t).forEach((function(t,o){var s=!0;if(0===o){var a=!1;s=t.reduce((function(e,t){if(a)if(kZ(t))switch(t.value){case"center":return i.push(TZ),e;case"top":case"left":return i.push(LZ),e;case"right":case"bottom":return i.push(KZ),e}else(YZ(t)||JZ(t))&&i.push(t);else if(kZ(t))switch(t.value){case BS:return n=0,!1;case yS:return n=1,!1;case"at":return a=!0,!1;case mS:return A=0,!1;case wS:case pS:return A=1,!1;case ZS:case fS:return A=2,!1;case bS:return A=3,!1}else if(JZ(t)||YZ(t))return Array.isArray(A)||(A=[]),A.push(t),!1;return e}),s)}if(s){var g=cS(e,t);r.push(g)}})),{size:A,shape:n,stops:r,position:i,type:2}},"-moz-radial-gradient":SS,"-ms-radial-gradient":SS,"-o-radial-gradient":SS,"-webkit-radial-gradient":SS,"-webkit-gradient":function(e,t){var n=jZ(180),A=[],r=1;return HZ(t).forEach((function(t,n){var i=t[0];if(0===n){if(kZ(i)&&"linear"===i.value)return void(r=1);if(kZ(i)&&"radial"===i.value)return void(r=2)}if(18===i.type)if("from"===i.name){var o=qZ(e,i.values[0]);A.push({stop:LZ,color:o})}else if("to"===i.name){o=qZ(e,i.values[0]);A.push({stop:KZ,color:o})}else if("color-stop"===i.name){var s=i.values.filter(XZ);if(2===s.length){o=qZ(e,s[1]);var a=s[0];NZ(a)&&A.push({stop:{type:16,number:100*a.number,flags:a.flags},color:o})}}})),1===r?{angle:(n+jZ(180))%jZ(360),stops:A,type:r}:{size:3,shape:0,stops:A,position:[],type:r}}},NS={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var n=t[0];return 20===n.type&&"none"===n.value?[]:t.filter((function(e){return XZ(e)&&function(e){return!(20===e.type&&"none"===e.value||18===e.type&&!VS[e.name])}(e)})).map((function(t){return vS(e,t)}))}},kS={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map((function(e){if(kZ(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},WS={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return HZ(t).map((function(e){return e.filter(YZ)})).map(UZ)}},FS={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return HZ(t).map((function(e){return e.filter(kZ).map((function(e){return e.value})).join(" ")})).map(ES)}},ES=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};(RS=GS||(GS={})).AUTO="auto",RS.CONTAIN="contain",RS.COVER="cover";var XS,HS,xS={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return HZ(t).map((function(e){return e.filter(JS)}))}},JS=function(e){return kZ(e)||YZ(e)},YS=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},US=YS("top"),LS=YS("right"),TS=YS("bottom"),KS=YS("left"),MS=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return UZ(t.filter(YZ))}}},QS=MS("top-left"),DS=MS("top-right"),zS=MS("bottom-right"),OS=MS("bottom-left"),PS=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},_S=PS("top"),jS=PS("right"),qS=PS("bottom"),$S=PS("left"),ev=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return VZ(t)?t.number:0}}},tv=ev("top"),nv=ev("right"),Av=ev("bottom"),rv=ev("left"),iv={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ov={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){return"rtl"===t?1:0}},sv={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(kZ).reduce((function(e,t){return e|av(t.value)}),0)}},av=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},gv={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},lv={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return 20===t.type&&"normal"===t.value?0:17===t.type||15===t.type?t.number:0}};(HS=XS||(XS={})).NORMAL="normal",HS.STRICT="strict";var cv,Iv,Cv={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"strict"===t?XS.STRICT:XS.NORMAL}},uv={name:"line-height",initialValue:"normal",prefix:!1,type:4},dv=function(e,t){return kZ(e)&&"normal"===e.value?1.2*t:17===e.type?t*e.number:YZ(e)?QZ(e,t):t},hv={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return 20===t.type&&"none"===t.value?null:vS(e,t)}},mv={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){return"inside"===t?0:1}},pv={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},fv=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},bv=fv("top"),Bv=fv("right"),yv=fv("bottom"),wv=fv("left"),Zv={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(kZ).map((function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}}))}},Sv={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){return"break-word"===t?"break-word":"normal"}},vv=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Gv=vv("top"),Rv=vv("right"),Vv=vv("bottom"),Nv=vv("left"),kv={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Wv={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Fv={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&FZ(t[0],"none")?[]:HZ(t).map((function(t){for(var n={color:aS.TRANSPARENT,offsetX:LZ,offsetY:LZ,blur:LZ},A=0,r=0;r<t.length;r++){var i=t[r];JZ(i)?(0===A?n.offsetX=i:1===A?n.offsetY=i:n.blur=i,A++):n.color=qZ(e,i)}return n}))}},Ev={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Xv={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(20===t.type&&"none"===t.value)return null;if(18===t.type){var n=Hv[t.name];if(void 0===n)throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return n(t.values)}return null}},Hv={matrix:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number}));return 6===t.length?t:null},matrix3d:function(e){var t=e.filter((function(e){return 17===e.type})).map((function(e){return e.number})),n=t[0],A=t[1];t[2],t[3];var r=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],s=t[13];return t[14],t[15],16===t.length?[n,A,r,i,o,s]:null}},xv={type:16,number:50,flags:4},Jv=[xv,xv],Yv={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var n=t.filter(YZ);return 2!==n.length?Jv:[n[0],n[1]]}},Uv={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;default:return 0}}};(Iv=cv||(cv={})).NORMAL="normal",Iv.BREAK_ALL="break-all",Iv.KEEP_ALL="keep-all";for(var Lv={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return cv.BREAK_ALL;case"keep-all":return cv.KEEP_ALL;default:return cv.NORMAL}}},Tv={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(20===t.type)return{auto:!0,order:0};if(NZ(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},Kv=function(e,t){if(15===t.type)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")},Mv={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return NZ(t)?t.number:1}},Qv={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Dv={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(kZ).map((function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(e){return 0!==e}))}},zv={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var n=[],A=[];return t.forEach((function(e){switch(e.type){case 20:case 0:n.push(e.value);break;case 17:n.push(e.number.toString());break;case 4:A.push(n.join(" ")),n.length=0}})),n.length&&A.push(n.join(" ")),A.map((function(e){return-1===e.indexOf(" ")?e:"'"+e+"'"}))}},Ov={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Pv={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){return NZ(t)?t.number:kZ(t)&&"bold"===t.value?700:400}},_v={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(kZ).map((function(e){return e.value}))}},jv={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},qv=function(e,t){return!!(e&t)},$v={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(0===t.length)return[];var n=t[0];return 20===n.type&&"none"===n.value?[]:t}},eG={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var n=t[0];if(20===n.type&&"none"===n.value)return null;for(var A=[],r=t.filter(EZ),i=0;i<r.length;i++){var o=r[i],s=r[i+1];if(20===o.type){var a=s&&NZ(s)?s.number:1;A.push({counter:o.value,increment:a})}}return A}},tG={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return[];for(var n=[],A=t.filter(EZ),r=0;r<A.length;r++){var i=A[r],o=A[r+1];if(kZ(i)&&"none"!==i.value){var s=o&&NZ(o)?o.number:0;n.push({counter:i.value,reset:s})}}return n}},nG={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(VZ).map((function(t){return Kv(e,t)}))}},AG={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(0===t.length)return null;var n=t[0];if(20===n.type&&"none"===n.value)return null;var A=[],r=t.filter(WZ);if(r.length%2!=0)return null;for(var i=0;i<r.length;i+=2){var o=r[i].value,s=r[i+1].value;A.push({open:o,close:s})}return A}},rG=function(e,t,n){if(!e)return"";var A=e[Math.min(t,e.length-1)];return A?n?A.open:A.close:""},iG={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return 1===t.length&&FZ(t[0],"none")?[]:HZ(t).map((function(t){for(var n={color:255,offsetX:LZ,offsetY:LZ,blur:LZ,spread:LZ,inset:!1},A=0,r=0;r<t.length;r++){var i=t[r];FZ(i,"inset")?n.inset=!0:JZ(i)?(0===A?n.offsetX=i:1===A?n.offsetY=i:2===A?n.blur=i:n.spread=i,A++):n.color=qZ(e,i)}return n}))}},oG={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var n=[];return t.filter(kZ).forEach((function(e){switch(e.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}})),[0,1,2].forEach((function(e){-1===n.indexOf(e)&&n.push(e)})),n}},sG={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},aG={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return VZ(t)?t.number:0}},gG=function(){function e(e,t){var n,A;this.animationDuration=IG(e,nG,t.animationDuration),this.backgroundClip=IG(e,gS,t.backgroundClip),this.backgroundColor=IG(e,lS,t.backgroundColor),this.backgroundImage=IG(e,NS,t.backgroundImage),this.backgroundOrigin=IG(e,kS,t.backgroundOrigin),this.backgroundPosition=IG(e,WS,t.backgroundPosition),this.backgroundRepeat=IG(e,FS,t.backgroundRepeat),this.backgroundSize=IG(e,xS,t.backgroundSize),this.borderTopColor=IG(e,US,t.borderTopColor),this.borderRightColor=IG(e,LS,t.borderRightColor),this.borderBottomColor=IG(e,TS,t.borderBottomColor),this.borderLeftColor=IG(e,KS,t.borderLeftColor),this.borderTopLeftRadius=IG(e,QS,t.borderTopLeftRadius),this.borderTopRightRadius=IG(e,DS,t.borderTopRightRadius),this.borderBottomRightRadius=IG(e,zS,t.borderBottomRightRadius),this.borderBottomLeftRadius=IG(e,OS,t.borderBottomLeftRadius),this.borderTopStyle=IG(e,_S,t.borderTopStyle),this.borderRightStyle=IG(e,jS,t.borderRightStyle),this.borderBottomStyle=IG(e,qS,t.borderBottomStyle),this.borderLeftStyle=IG(e,$S,t.borderLeftStyle),this.borderTopWidth=IG(e,tv,t.borderTopWidth),this.borderRightWidth=IG(e,nv,t.borderRightWidth),this.borderBottomWidth=IG(e,Av,t.borderBottomWidth),this.borderLeftWidth=IG(e,rv,t.borderLeftWidth),this.boxShadow=IG(e,iG,t.boxShadow),this.color=IG(e,iv,t.color),this.direction=IG(e,ov,t.direction),this.display=IG(e,sv,t.display),this.float=IG(e,gv,t.cssFloat),this.fontFamily=IG(e,zv,t.fontFamily),this.fontSize=IG(e,Ov,t.fontSize),this.fontStyle=IG(e,jv,t.fontStyle),this.fontVariant=IG(e,_v,t.fontVariant),this.fontWeight=IG(e,Pv,t.fontWeight),this.letterSpacing=IG(e,lv,t.letterSpacing),this.lineBreak=IG(e,Cv,t.lineBreak),this.lineHeight=IG(e,uv,t.lineHeight),this.listStyleImage=IG(e,hv,t.listStyleImage),this.listStylePosition=IG(e,mv,t.listStylePosition),this.listStyleType=IG(e,pv,t.listStyleType),this.marginTop=IG(e,bv,t.marginTop),this.marginRight=IG(e,Bv,t.marginRight),this.marginBottom=IG(e,yv,t.marginBottom),this.marginLeft=IG(e,wv,t.marginLeft),this.opacity=IG(e,Mv,t.opacity);var r=IG(e,Zv,t.overflow);this.overflowX=r[0],this.overflowY=r[r.length>1?1:0],this.overflowWrap=IG(e,Sv,t.overflowWrap),this.paddingTop=IG(e,Gv,t.paddingTop),this.paddingRight=IG(e,Rv,t.paddingRight),this.paddingBottom=IG(e,Vv,t.paddingBottom),this.paddingLeft=IG(e,Nv,t.paddingLeft),this.paintOrder=IG(e,oG,t.paintOrder),this.position=IG(e,Wv,t.position),this.textAlign=IG(e,kv,t.textAlign),this.textDecorationColor=IG(e,Qv,null!==(n=t.textDecorationColor)&&void 0!==n?n:t.color),this.textDecorationLine=IG(e,Dv,null!==(A=t.textDecorationLine)&&void 0!==A?A:t.textDecoration),this.textShadow=IG(e,Fv,t.textShadow),this.textTransform=IG(e,Ev,t.textTransform),this.transform=IG(e,Xv,t.transform),this.transformOrigin=IG(e,Yv,t.transformOrigin),this.visibility=IG(e,Uv,t.visibility),this.webkitTextStrokeColor=IG(e,sG,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=IG(e,aG,t.webkitTextStrokeWidth),this.wordBreak=IG(e,Lv,t.wordBreak),this.zIndex=IG(e,Tv,t.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},e.prototype.isTransparent=function(){return $Z(this.backgroundColor)},e.prototype.isTransformed=function(){return null!==this.transform},e.prototype.isPositioned=function(){return 0!==this.position},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return 0!==this.float},e.prototype.isInlineLevel=function(){return qv(this.display,4)||qv(this.display,33554432)||qv(this.display,268435456)||qv(this.display,536870912)||qv(this.display,67108864)||qv(this.display,134217728)},e}(),lG=function(){return function(e,t){this.content=IG(e,$v,t.content),this.quotes=IG(e,AG,t.quotes)}}(),cG=function(){return function(e,t){this.counterIncrement=IG(e,eG,t.counterIncrement),this.counterReset=IG(e,tG,t.counterReset)}}(),IG=function(e,t,n){var A=new GZ,r=null!=n?n.toString():t.initialValue;A.write(r);var i=new RZ(A.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,kZ(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return OZ(e,i.parseComponentValue());case"color":return qZ(e,i.parseComponentValue());case"image":return vS(e,i.parseComponentValue());case"length":var s=i.parseComponentValue();return JZ(s)?s:LZ;case"length-percentage":var a=i.parseComponentValue();return YZ(a)?a:LZ;case"time":return Kv(e,i.parseComponentValue())}}},CG=function(e,t){var n=function(e){switch(e.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(e);return 1===n||t===n},uG=function(){return function(e,t){this.context=e,this.textNodes=[],this.elements=[],this.flags=0,CG(t,3),this.styles=new gG(e,window.getComputedStyle(t,null)),fR(t)&&(this.styles.animationDuration.some((function(e){return e>0}))&&(t.style.animationDuration="0s"),null!==this.styles.transform&&(t.style.transform="none")),this.bounds=zy(this.context,t),CG(t,4)&&(this.flags|=16)}}(),dG="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hG="undefined"==typeof Uint8Array?[]:new Uint8Array(256),mG=0;mG<64;mG++)hG[dG.charCodeAt(mG)]=mG;for(var pG=function(e,t,n){return e.slice?e.slice(t,n):new Uint16Array(Array.prototype.slice.call(e,t,n))},fG=function(){function e(e,t,n,A,r,i){this.initialValue=e,this.errorValue=t,this.highStart=n,this.highValueIndex=A,this.index=r,this.data=i}return e.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>5])<<2)+(31&e),this.data[t];if(e<=65535)return t=((t=this.index[2048+(e-55296>>5)])<<2)+(31&e),this.data[t];if(e<this.highStart)return t=2080+(e>>11),t=this.index[t],t+=e>>5&63,t=((t=this.index[t])<<2)+(31&e),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),bG="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BG="undefined"==typeof Uint8Array?[]:new Uint8Array(256),yG=0;yG<64;yG++)BG[bG.charCodeAt(yG)]=yG;var wG,ZG,SG=8,vG=9,GG=11,RG=12,VG=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var n=e.length;if(!n)return"";for(var A=[],r=-1,i="";++r<n;){var o=e[r];o<=65535?A.push(o):(o-=65536,A.push(55296+(o>>10),o%1024+56320)),(r+1===n||A.length>16384)&&(i+=String.fromCharCode.apply(String,A),A.length=0)}return i},NG=function(e){var t,n,A,r=function(e){var t,n,A,r,i,o=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var g="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(g)?g:new Uint8Array(g);for(t=0;t<s;t+=4)n=hG[e.charCodeAt(t)],A=hG[e.charCodeAt(t+1)],r=hG[e.charCodeAt(t+2)],i=hG[e.charCodeAt(t+3)],l[a++]=n<<2|A>>4,l[a++]=(15&A)<<4|r>>2,l[a++]=(3&r)<<6|63&i;return g}(e),i=Array.isArray(r)?function(e){for(var t=e.length,n=[],A=0;A<t;A+=4)n.push(e[A+3]<<24|e[A+2]<<16|e[A+1]<<8|e[A]);return n}(r):new Uint32Array(r),o=Array.isArray(r)?function(e){for(var t=e.length,n=[],A=0;A<t;A+=2)n.push(e[A+1]<<8|e[A]);return n}(r):new Uint16Array(r),s=pG(o,12,i[4]/2),a=2===i[5]?pG(o,(24+i[4])/2):(t=i,n=Math.ceil((24+i[4])/4),t.slice?t.slice(n,A):new Uint32Array(Array.prototype.slice.call(t,n,A)));return new fG(i[0],i[1],i[2],i[3],s,a)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),kG="×",WG=function(e){return NG.get(e)},FG=function(e,t,n){var A=n-2,r=t[A],i=t[n-1],o=t[n];if(2===i&&3===o)return kG;if(2===i||3===i||4===i)return"÷";if(2===o||3===o||4===o)return"÷";if(i===SG&&-1!==[SG,vG,GG,RG].indexOf(o))return kG;if(!(i!==GG&&i!==vG||o!==vG&&10!==o))return kG;if((i===RG||10===i)&&10===o)return kG;if(13===o||5===o)return kG;if(7===o)return kG;if(1===i)return kG;if(13===i&&14===o){for(;5===r;)r=t[--A];if(14===r)return kG}if(15===i&&15===o){for(var s=0;15===r;)s++,r=t[--A];if(s%2==0)return kG}return"÷"},EG=function(e){var t=function(e){for(var t=[],n=0,A=e.length;n<A;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<A){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&r)<<10)+(1023&i)+65536):(t.push(r),n--)}else t.push(r)}return t}(e),n=t.length,A=0,r=0,i=t.map(WG);return{next:function(){if(A>=n)return{done:!0,value:null};for(var e=kG;A<n&&(e=FG(0,i,++A))===kG;);if(e!==kG||A===n){var o=VG.apply(null,t.slice(r,A));return r=A,{value:o,done:!1}}return{done:!0,value:null}}}},XG=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},HG=function(e,t,n,A,r){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),s=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),s.setAttributeNS(null,"width","100%"),s.setAttributeNS(null,"height","100%"),s.setAttributeNS(null,"x",n.toString()),s.setAttributeNS(null,"y",A.toString()),s.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(s),s.appendChild(r),o},xG=function(e){return new Promise((function(t,n){var A=new Image;A.onload=function(){return t(A)},A.onerror=n,A.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},JG={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n);var A=t.getBoundingClientRect(),r=Math.round(A.height);if(e.body.removeChild(n),123===r)return!0}}return!1}(document);return Object.defineProperty(JG,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=JG.SUPPORT_RANGE_BOUNDS&&function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var n=e.createRange();t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var A=t.firstChild,r=Oy(A.data).map((function(e){return Py(e)})),i=0,o={},s=r.every((function(e,t){n.setStart(A,i),n.setEnd(A,i+e.length);var r=n.getBoundingClientRect();i+=e.length;var s=r.x>o.x||r.y>o.y;return o=r,0===t||s}));return e.body.removeChild(t),s}(document);return Object.defineProperty(JG,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),A=n.getContext("2d");if(!A)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{A.drawImage(t,0,0),n.toDataURL()}catch(Zf){return!1}return!0}(document);return Object.defineProperty(JG,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas"),n=100;t.width=n,t.height=n;var A=t.getContext("2d");if(!A)return Promise.reject(!1);A.fillStyle="rgb(0, 255, 0)",A.fillRect(0,0,n,n);var r=new Image,i=t.toDataURL();r.src=i;var o=HG(n,n,0,0,r);return A.fillStyle="red",A.fillRect(0,0,n,n),xG(o).then((function(t){A.drawImage(t,0,0);var r=A.getImageData(0,0,n,n).data;A.fillStyle="red",A.fillRect(0,0,n,n);var o=e.createElement("div");return o.style.backgroundImage="url("+i+")",o.style.height=n+"px",XG(r)?xG(HG(n,n,0,0,o)):Promise.reject(!1)})).then((function(e){return A.drawImage(e,0,0),XG(A.getImageData(0,0,n,n).data)})).catch((function(){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(JG,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(JG,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(JG,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(JG,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(JG,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},YG=function(){return function(e,t){this.text=e,this.bounds=t}}(),UG=function(e,t){var n=t.ownerDocument;if(n){var A=n.createElement("html2canvaswrapper");A.appendChild(t.cloneNode(!0));var r=t.parentNode;if(r){r.replaceChild(A,t);var i=zy(e,A);return A.firstChild&&r.replaceChild(A.firstChild,A),i}}return Dy.EMPTY},LG=function(e,t,n){var A=e.ownerDocument;if(!A)throw new Error("Node has no owner document");var r=A.createRange();return r.setStart(e,t),r.setEnd(e,t+n),r},TG=function(e){if(JG.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map((function(e){return e.segment}))}return function(e){for(var t,n=EG(e),A=[];!(t=n.next()).done;)t.value&&A.push(t.value.slice());return A}(e)},KG=function(e,t){return 0!==t.letterSpacing?TG(e):function(e,t){if(JG.SUPPORT_NATIVE_TEXT_SEGMENTATION){var n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(e)).map((function(e){return e.segment}))}return QG(e,t)}(e,t)},MG=[32,160,4961,65792,65793,4153,4241],QG=function(e,t){for(var n,A=function(e,t){var n=Oy(e),A=Qw(n,t),r=A[0],i=A[1],o=A[2],s=n.length,a=0,g=0;return{next:function(){if(g>=s)return{done:!0,value:null};for(var e=Ww;g<s&&(e=Mw(n,i,r,++g,o))===Ww;);if(e!==Ww||g===s){var t=new Dw(n,e,a,g);return a=g,{value:t,done:!1}}return{done:!0,value:null}}}}(e,{lineBreak:t.lineBreak,wordBreak:"break-word"===t.overflowWrap?"break-word":t.wordBreak}),r=[],i=function(){if(n.value){var e=n.value.slice(),t=Oy(e),A="";t.forEach((function(e){-1===MG.indexOf(e)?A+=Py(e):(A.length&&r.push(A),r.push(Py(e)),A="")})),A.length&&r.push(A)}};!(n=A.next()).done;)i();return r},DG=function(){return function(e,t,n){this.text=zG(t.data,n.textTransform),this.textBounds=function(e,t,n,A){var r=KG(t,n),i=[],o=0;return r.forEach((function(t){if(n.textDecorationLine.length||t.trim().length>0)if(JG.SUPPORT_RANGE_BOUNDS){var r=LG(A,o,t.length).getClientRects();if(r.length>1){var s=TG(t),a=0;s.forEach((function(t){i.push(new YG(t,Dy.fromDOMRectList(e,LG(A,a+o,t.length).getClientRects()))),a+=t.length}))}else i.push(new YG(t,Dy.fromDOMRectList(e,r)))}else{var g=A.splitText(t.length);i.push(new YG(t,UG(e,A))),A=g}else JG.SUPPORT_RANGE_BOUNDS||(A=A.splitText(t.length));o+=t.length})),i}(e,this.text,n,t)}}(),zG=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(OG,PG);case 2:return e.toUpperCase();default:return e}},OG=/(^|\s|:|-|\(|\))([a-z])/g,PG=function(e,t,n){return e.length>0?t+n.toUpperCase():e},_G=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.src=n.currentSrc||n.src,A.intrinsicWidth=n.naturalWidth,A.intrinsicHeight=n.naturalHeight,A.context.cache.addImage(A.src),A}return Ty(t,e),t}(uG),jG=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.canvas=n,A.intrinsicWidth=n.width,A.intrinsicHeight=n.height,A}return Ty(t,e),t}(uG),qG=function(e){function t(t,n){var A=e.call(this,t,n)||this,r=new XMLSerializer,i=zy(t,n);return n.setAttribute("width",i.width+"px"),n.setAttribute("height",i.height+"px"),A.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(n)),A.intrinsicWidth=n.width.baseVal.value,A.intrinsicHeight=n.height.baseVal.value,A.context.cache.addImage(A.svg),A}return Ty(t,e),t}(uG),$G=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.value=n.value,A}return Ty(t,e),t}(uG),eR=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.start=n.start,A.reversed="boolean"==typeof n.reversed&&!0===n.reversed,A}return Ty(t,e),t}(uG),tR=[{type:15,flags:0,unit:"px",number:3}],nR=[{type:16,flags:0,number:50}],AR="checkbox",rR="radio",iR="password",oR=707406591,sR=function(e){function t(t,n){var A,r,i,o=e.call(this,t,n)||this;switch(o.type=n.type.toLowerCase(),o.checked=n.checked,o.value=0===(r=(A=n).type===iR?new Array(A.value.length+1).join("•"):A.value).length?A.placeholder||"":r,o.type!==AR&&o.type!==rR||(o.styles.backgroundColor=3739148031,o.styles.borderTopColor=o.styles.borderRightColor=o.styles.borderBottomColor=o.styles.borderLeftColor=2779096575,o.styles.borderTopWidth=o.styles.borderRightWidth=o.styles.borderBottomWidth=o.styles.borderLeftWidth=1,o.styles.borderTopStyle=o.styles.borderRightStyle=o.styles.borderBottomStyle=o.styles.borderLeftStyle=1,o.styles.backgroundClip=[0],o.styles.backgroundOrigin=[0],o.bounds=(i=o.bounds).width>i.height?new Dy(i.left+(i.width-i.height)/2,i.top,i.height,i.height):i.width<i.height?new Dy(i.left,i.top+(i.height-i.width)/2,i.width,i.width):i),o.type){case AR:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=tR;break;case rR:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=nR}return o}return Ty(t,e),t}(uG),aR=function(e){function t(t,n){var A=e.call(this,t,n)||this,r=n.options[n.selectedIndex||0];return A.value=r&&r.text||"",A}return Ty(t,e),t}(uG),gR=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.value=n.value,A}return Ty(t,e),t}(uG),lR=function(e){function t(t,n){var A=e.call(this,t,n)||this;A.src=n.src,A.width=parseInt(n.width,10)||0,A.height=parseInt(n.height,10)||0,A.backgroundColor=A.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){A.tree=uR(t,n.contentWindow.document.documentElement);var r=n.contentWindow.document.documentElement?sS(t,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):aS.TRANSPARENT,i=n.contentWindow.document.body?sS(t,getComputedStyle(n.contentWindow.document.body).backgroundColor):aS.TRANSPARENT;A.backgroundColor=$Z(r)?$Z(i)?A.styles.backgroundColor:i:r}}catch(Zf){}return A}return Ty(t,e),t}(uG),cR=["OL","UL","MENU"],IR=function(e,t,n,A){for(var r=t.firstChild,i=void 0;r;r=i)if(i=r.nextSibling,mR(r)&&r.data.trim().length>0)n.textNodes.push(new DG(e,r,n.styles));else if(pR(r))if(FR(r)&&r.assignedNodes)r.assignedNodes().forEach((function(t){return IR(e,t,n,A)}));else{var o=CR(e,r);o.styles.isVisible()&&(dR(r,o,A)?o.flags|=4:hR(o.styles)&&(o.flags|=2),-1!==cR.indexOf(r.tagName)&&(o.flags|=8),n.elements.push(o),r.slot,r.shadowRoot?IR(e,r.shadowRoot,o,A):kR(r)||ZR(r)||WR(r)||IR(e,r,o,A))}},CR=function(e,t){return RR(t)?new _G(e,t):vR(t)?new jG(e,t):ZR(t)?new qG(e,t):BR(t)?new $G(e,t):yR(t)?new eR(e,t):wR(t)?new sR(e,t):WR(t)?new aR(e,t):kR(t)?new gR(e,t):VR(t)?new lR(e,t):new uG(e,t)},uR=function(e,t){var n=CR(e,t);return n.flags|=4,IR(e,t,n,n),n},dR=function(e,t,n){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||SR(e)&&n.styles.isTransparent()},hR=function(e){return e.isPositioned()||e.isFloating()},mR=function(e){return e.nodeType===Node.TEXT_NODE},pR=function(e){return e.nodeType===Node.ELEMENT_NODE},fR=function(e){return pR(e)&&void 0!==e.style&&!bR(e)},bR=function(e){return"object"==typeof e.className},BR=function(e){return"LI"===e.tagName},yR=function(e){return"OL"===e.tagName},wR=function(e){return"INPUT"===e.tagName},ZR=function(e){return"svg"===e.tagName},SR=function(e){return"BODY"===e.tagName},vR=function(e){return"CANVAS"===e.tagName},GR=function(e){return"VIDEO"===e.tagName},RR=function(e){return"IMG"===e.tagName},VR=function(e){return"IFRAME"===e.tagName},NR=function(e){return"STYLE"===e.tagName},kR=function(e){return"TEXTAREA"===e.tagName},WR=function(e){return"SELECT"===e.tagName},FR=function(e){return"SLOT"===e.tagName},ER=function(e){return e.tagName.indexOf("-")>0},XR=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},e.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},e.prototype.pop=function(e){var t=this;e.forEach((function(e){return t.counters[e].pop()}))},e.prototype.parse=function(e){var t=this,n=e.counterIncrement,A=e.counterReset,r=!0;null!==n&&n.forEach((function(e){var n=t.counters[e.counter];n&&0!==e.increment&&(r=!1,n.length||n.push(1),n[Math.max(0,n.length-1)]+=e.increment)}));var i=[];return r&&A.forEach((function(e){var n=t.counters[e.counter];i.push(e.counter),n||(n=t.counters[e.counter]=[]),n.push(e.reset)})),i},e}(),HR={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},xR={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},JR={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},YR={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},UR=function(e,t,n,A,r,i){return e<t||e>n?PR(e,r,i.length>0):A.integers.reduce((function(t,n,r){for(;e>=n;)e-=n,t+=A.values[r];return t}),"")+i},LR=function(e,t,n,A){var r="";do{n||e--,r=A(e)+r,e/=t}while(e*t>=t);return r},TR=function(e,t,n,A,r){var i=n-t+1;return(e<0?"-":"")+(LR(Math.abs(e),i,A,(function(e){return Py(Math.floor(e%i)+t)}))+r)},KR=function(e,t,n){void 0===n&&(n=". ");var A=t.length;return LR(Math.abs(e),A,!1,(function(e){return t[Math.floor(e%A)]}))+n},MR=function(e,t,n,A,r,i){if(e<-9999||e>9999)return PR(e,4,r.length>0);var o=Math.abs(e),s=r;if(0===o)return t[0]+s;for(var a=0;o>0&&a<=4;a++){var g=o%10;0===g&&qv(i,1)&&""!==s?s=t[g]+s:g>1||1===g&&0===a||1===g&&1===a&&qv(i,2)||1===g&&1===a&&qv(i,4)&&e>100||1===g&&a>1&&qv(i,8)?s=t[g]+(a>0?n[a-1]:"")+s:1===g&&a>0&&(s=n[a-1]+s),o=Math.floor(o/10)}return(e<0?A:"")+s},QR="十百千萬",DR="拾佰仟萬",zR="マイナス",OR="마이너스",PR=function(e,t,n){var A=n?". ":"",r=n?"、":"",i=n?", ":"",o=n?" ":"";switch(t){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var s=TR(e,48,57,!0,A);return s.length<4?"0"+s:s;case 4:return KR(e,"〇一二三四五六七八九",r);case 6:return UR(e,1,3999,HR,3,A).toLowerCase();case 7:return UR(e,1,3999,HR,3,A);case 8:return TR(e,945,969,!1,A);case 9:return TR(e,97,122,!1,A);case 10:return TR(e,65,90,!1,A);case 11:return TR(e,1632,1641,!0,A);case 12:case 49:return UR(e,1,9999,xR,3,A);case 35:return UR(e,1,9999,xR,3,A).toLowerCase();case 13:return TR(e,2534,2543,!0,A);case 14:case 30:return TR(e,6112,6121,!0,A);case 15:return KR(e,"子丑寅卯辰巳午未申酉戌亥",r);case 16:return KR(e,"甲乙丙丁戊己庚辛壬癸",r);case 17:case 48:return MR(e,"零一二三四五六七八九",QR,"負",r,14);case 47:return MR(e,"零壹貳參肆伍陸柒捌玖",DR,"負",r,15);case 42:return MR(e,"零一二三四五六七八九",QR,"负",r,14);case 41:return MR(e,"零壹贰叁肆伍陆柒捌玖",DR,"负",r,15);case 26:return MR(e,"〇一二三四五六七八九","十百千万",zR,r,0);case 25:return MR(e,"零壱弐参四伍六七八九","拾百千万",zR,r,7);case 31:return MR(e,"영일이삼사오육칠팔구","십백천만",OR,i,7);case 33:return MR(e,"零一二三四五六七八九","十百千萬",OR,i,0);case 32:return MR(e,"零壹貳參四五六七八九","拾百千",OR,i,7);case 18:return TR(e,2406,2415,!0,A);case 20:return UR(e,1,19999,YR,3,A);case 21:return TR(e,2790,2799,!0,A);case 22:return TR(e,2662,2671,!0,A);case 22:return UR(e,1,10999,JR,3,A);case 23:return KR(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return KR(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return TR(e,3302,3311,!0,A);case 28:return KR(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",r);case 29:return KR(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",r);case 34:return TR(e,3792,3801,!0,A);case 37:return TR(e,6160,6169,!0,A);case 38:return TR(e,4160,4169,!0,A);case 39:return TR(e,2918,2927,!0,A);case 40:return TR(e,1776,1785,!0,A);case 43:return TR(e,3046,3055,!0,A);case 44:return TR(e,3174,3183,!0,A);case 45:return TR(e,3664,3673,!0,A);case 46:return TR(e,3872,3881,!0,A);default:return TR(e,48,57,!0,A)}},_R="data-html2canvas-ignore",jR=function(){function e(e,t,n){if(this.context=e,this.options=n,this.scrolledElements=[],this.referenceElement=t,this.counters=new XR,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(e,t){var n=this,A=eV(e,t);if(!A.contentWindow)return Promise.reject("Unable to find iframe window");var r=e.defaultView.pageXOffset,i=e.defaultView.pageYOffset,o=A.contentWindow,s=o.document,a=AV(A).then((function(){return My(n,0,void 0,(function(){var e,n;return Qy(this,(function(r){switch(r.label){case 0:return this.scrolledElements.forEach(aV),o&&(o.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||o.scrollY===t.top&&o.scrollX===t.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-t.left,o.scrollY-t.top,0,0))),e=this.options.onclone,void 0===(n=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:s.fonts&&s.fonts.ready?[4,s.fonts.ready]:[3,2];case 1:r.sent(),r.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,nV(s)]:[3,4];case 3:r.sent(),r.label=4;case 4:return"function"==typeof e?[2,Promise.resolve().then((function(){return e(s,n)})).then((function(){return A}))]:[2,A]}}))}))}));return s.open(),s.write(oV(document.doctype)+"<html></html>"),sV(this.referenceElement.ownerDocument,r,i),s.replaceChild(s.adoptNode(this.documentElement),s.documentElement),s.close(),a},e.prototype.createElementClone=function(e){if(CG(e,2),vR(e))return this.createCanvasClone(e);if(GR(e))return this.createVideoClone(e);if(NR(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return RR(t)&&(RR(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),"lazy"===t.loading&&(t.loading="eager")),ER(t)?this.createCustomElementClone(t):t},e.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return iV(e.style,t),t},e.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var n=[].slice.call(t.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),A=e.cloneNode(!1);return A.textContent=n,A}}catch(Zf){if(this.context.logger.error("Unable to access cssRules property",Zf),"SecurityError"!==Zf.name)throw Zf}return e.cloneNode(!1)},e.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch(Zf){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var A=e.cloneNode(!1);try{A.width=e.width,A.height=e.height;var r=e.getContext("2d"),i=A.getContext("2d");if(i)if(!this.options.allowTaint&&r)i.putImageData(r.getImageData(0,0,e.width,e.height),0,0);else{var o=null!==(t=e.getContext("webgl2"))&&void 0!==t?t:e.getContext("webgl");if(o){var s=o.getContextAttributes();!1===(null==s?void 0:s.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}i.drawImage(e,0,0)}return A}catch(Zf){this.context.logger.info("Unable to clone canvas as it is tainted",e)}return A},e.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var n=t.getContext("2d");try{return n&&(n.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||n.getImageData(0,0,t.width,t.height)),t}catch(Zf){this.context.logger.info("Unable to clone video as it is tainted",e)}var A=e.ownerDocument.createElement("canvas");return A.width=e.offsetWidth,A.height=e.offsetHeight,A},e.prototype.appendChildNode=function(e,t,n){pR(t)&&("SCRIPT"===t.tagName||t.hasAttribute(_R)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(t))||this.options.copyStyles&&pR(t)&&NR(t)||e.appendChild(this.cloneNode(t,n))},e.prototype.cloneChildNodes=function(e,t,n){for(var A=this,r=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;r;r=r.nextSibling)if(pR(r)&&FR(r)&&"function"==typeof r.assignedNodes){var i=r.assignedNodes();i.length&&i.forEach((function(e){return A.appendChildNode(t,e,n)}))}else this.appendChildNode(t,r,n)},e.prototype.cloneNode=function(e,t){if(mR(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var n=e.ownerDocument.defaultView;if(n&&pR(e)&&(fR(e)||bR(e))){var A=this.createElementClone(e);A.style.transitionProperty="none";var r=n.getComputedStyle(e),i=n.getComputedStyle(e,":before"),o=n.getComputedStyle(e,":after");this.referenceElement===e&&fR(A)&&(this.clonedReferenceElement=A),SR(A)&&IV(A);var s=this.counters.parse(new cG(this.context,r)),a=this.resolvePseudoContent(e,A,i,wG.BEFORE);ER(e)&&(t=!0),GR(e)||this.cloneChildNodes(e,A,t),a&&A.insertBefore(a,A.firstChild);var g=this.resolvePseudoContent(e,A,o,wG.AFTER);return g&&A.appendChild(g),this.counters.pop(s),(r&&(this.options.copyStyles||bR(e))&&!VR(e)||t)&&iV(r,A),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([A,e.scrollLeft,e.scrollTop]),(kR(e)||WR(e))&&(kR(A)||WR(A))&&(A.value=e.value),A}return e.cloneNode(!1)},e.prototype.resolvePseudoContent=function(e,t,n,A){var r=this;if(n){var i=n.content,o=t.ownerDocument;if(o&&i&&"none"!==i&&"-moz-alt-content"!==i&&"none"!==n.display){this.counters.parse(new cG(this.context,n));var s=new lG(this.context,n),a=o.createElement("html2canvaspseudoelement");iV(n,a),s.content.forEach((function(t){if(0===t.type)a.appendChild(o.createTextNode(t.value));else if(22===t.type){var n=o.createElement("img");n.src=t.value,n.style.opacity="1",a.appendChild(n)}else if(18===t.type){if("attr"===t.name){var A=t.values.filter(kZ);A.length&&a.appendChild(o.createTextNode(e.getAttribute(A[0].value)||""))}else if("counter"===t.name){var i=t.values.filter(XZ),g=i[0],l=i[1];if(g&&kZ(g)){var c=r.counters.getCounterValue(g.value),I=l&&kZ(l)?pv.parse(r.context,l.value):3;a.appendChild(o.createTextNode(PR(c,I,!1)))}}else if("counters"===t.name){var C=t.values.filter(XZ),u=(g=C[0],C[1]);l=C[2];if(g&&kZ(g)){var d=r.counters.getCounterValues(g.value),h=l&&kZ(l)?pv.parse(r.context,l.value):3,m=u&&0===u.type?u.value:"",p=d.map((function(e){return PR(e,h,!1)})).join(m);a.appendChild(o.createTextNode(p))}}}else if(20===t.type)switch(t.value){case"open-quote":a.appendChild(o.createTextNode(rG(s.quotes,r.quoteDepth++,!0)));break;case"close-quote":a.appendChild(o.createTextNode(rG(s.quotes,--r.quoteDepth,!1)));break;default:a.appendChild(o.createTextNode(t.value))}})),a.className=gV+" "+lV;var g=A===wG.BEFORE?" "+gV:" "+lV;return bR(t)?t.className.baseValue+=g:t.className+=g,a}}},e.destroy=function(e){return!!e.parentNode&&(e.parentNode.removeChild(e),!0)},e}();(ZG=wG||(wG={}))[ZG.BEFORE=0]="BEFORE",ZG[ZG.AFTER=1]="AFTER";var qR,$R,eV=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute(_R,"true"),e.body.appendChild(n),n},tV=function(e){return new Promise((function(t){e.complete?t():e.src?(e.onload=t,e.onerror=t):t()}))},nV=function(e){return Promise.all([].slice.call(e.images,0).map(tV))},AV=function(e){return new Promise((function(t,n){var A=e.contentWindow;if(!A)return n("No window assigned for iframe");var r=A.document;A.onload=e.onload=function(){A.onload=e.onload=null;var n=setInterval((function(){r.body.childNodes.length>0&&"complete"===r.readyState&&(clearInterval(n),t(e))}),50)}}))},rV=["all","d","content"],iV=function(e,t){for(var n=e.length-1;n>=0;n--){var A=e.item(n);-1===rV.indexOf(A)&&t.style.setProperty(A,e.getPropertyValue(A))}return t},oV=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},sV=function(e,t,n){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||n!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,n)},aV=function(e){var t=e[0],n=e[1],A=e[2];t.scrollLeft=n,t.scrollTop=A},gV="___html2canvas___pseudoelement_before",lV="___html2canvas___pseudoelement_after",cV='{\n    content: "" !important;\n    display: none !important;\n}',IV=function(e){CV(e,"."+gV+":before"+cV+"\n         ."+lV+":after"+cV)},CV=function(e,t){var n=e.ownerDocument;if(n){var A=n.createElement("style");A.textContent=t,e.appendChild(A)}},uV=function(){function e(){}return e.getOrigin=function(t){var n=e._link;return n?(n.href=t,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),dV=function(){function e(e,t){this.context=e,this._options=t,this._cache={}}return e.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)?t:yV(e)||fV(e)?((this._cache[e]=this.loadImage(e)).catch((function(){})),t):t},e.prototype.match=function(e){return this._cache[e]},e.prototype.loadImage=function(e){return My(this,0,void 0,(function(){var t,n,A,r,i=this;return Qy(this,(function(o){switch(o.label){case 0:return t=uV.isSameOrigin(e),n=!bV(e)&&!0===this._options.useCORS&&JG.SUPPORT_CORS_IMAGES&&!t,A=!bV(e)&&!t&&!yV(e)&&"string"==typeof this._options.proxy&&JG.SUPPORT_CORS_XHR&&!n,t||!1!==this._options.allowTaint||bV(e)||yV(e)||A||n?(r=e,A?[4,this.proxy(r)]:[3,2]):[2];case 1:r=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise((function(e,t){var A=new Image;A.onload=function(){return e(A)},A.onerror=t,(BV(r)||n)&&(A.crossOrigin="anonymous"),A.src=r,!0===A.complete&&setTimeout((function(){return e(A)}),500),i._options.imageTimeout>0&&setTimeout((function(){return t("Timed out ("+i._options.imageTimeout+"ms) loading image")}),i._options.imageTimeout)}))];case 3:return[2,o.sent()]}}))}))},e.prototype.has=function(e){return void 0!==this._cache[e]},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(e){var t=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var A=e.substring(0,256);return new Promise((function(r,i){var o=JG.SUPPORT_RESPONSE_TYPE?"blob":"text",s=new XMLHttpRequest;s.onload=function(){if(200===s.status)if("text"===o)r(s.response);else{var e=new FileReader;e.addEventListener("load",(function(){return r(e.result)}),!1),e.addEventListener("error",(function(e){return i(e)}),!1),e.readAsDataURL(s.response)}else i("Failed to proxy resource "+A+" with status code "+s.status)},s.onerror=i;var a=n.indexOf("?")>-1?"&":"?";if(s.open("GET",""+n+a+"url="+encodeURIComponent(e)+"&responseType="+o),"text"!==o&&s instanceof XMLHttpRequest&&(s.responseType=o),t._options.imageTimeout){var g=t._options.imageTimeout;s.timeout=g,s.ontimeout=function(){return i("Timed out ("+g+"ms) proxying "+A)}}s.send()}))},e}(),hV=/^data:image\/svg\+xml/i,mV=/^data:image\/.*;base64,/i,pV=/^data:image\/.*/i,fV=function(e){return JG.SUPPORT_SVG_DRAWING||!wV(e)},bV=function(e){return pV.test(e)},BV=function(e){return mV.test(e)},yV=function(e){return"blob"===e.substr(0,4)},wV=function(e){return"svg"===e.substr(-3).toLowerCase()||hV.test(e)},ZV=function(){function e(e,t){this.type=0,this.x=e,this.y=t}return e.prototype.add=function(t,n){return new e(this.x+t,this.y+n)},e}(),SV=function(e,t,n){return new ZV(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},vV=function(){function e(e,t,n,A){this.type=1,this.start=e,this.startControl=t,this.endControl=n,this.end=A}return e.prototype.subdivide=function(t,n){var A=SV(this.start,this.startControl,t),r=SV(this.startControl,this.endControl,t),i=SV(this.endControl,this.end,t),o=SV(A,r,t),s=SV(r,i,t),a=SV(o,s,t);return n?new e(this.start,A,o,a):new e(a,s,i,this.end)},e.prototype.add=function(t,n){return new e(this.start.add(t,n),this.startControl.add(t,n),this.endControl.add(t,n),this.end.add(t,n))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),GV=function(e){return 1===e.type},RV=function(){return function(e){var t=e.styles,n=e.bounds,A=MZ(t.borderTopLeftRadius,n.width,n.height),r=A[0],i=A[1],o=MZ(t.borderTopRightRadius,n.width,n.height),s=o[0],a=o[1],g=MZ(t.borderBottomRightRadius,n.width,n.height),l=g[0],c=g[1],I=MZ(t.borderBottomLeftRadius,n.width,n.height),C=I[0],u=I[1],d=[];d.push((r+s)/n.width),d.push((C+l)/n.width),d.push((i+u)/n.height),d.push((a+c)/n.height);var h=Math.max.apply(Math,d);h>1&&(r/=h,i/=h,s/=h,a/=h,l/=h,c/=h,C/=h,u/=h);var m=n.width-s,p=n.height-c,f=n.width-l,b=n.height-u,B=t.borderTopWidth,y=t.borderRightWidth,w=t.borderBottomWidth,Z=t.borderLeftWidth,S=QZ(t.paddingTop,e.bounds.width),v=QZ(t.paddingRight,e.bounds.width),G=QZ(t.paddingBottom,e.bounds.width),R=QZ(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=r>0||i>0?VV(n.left+Z/3,n.top+B/3,r-Z/3,i-B/3,qR.TOP_LEFT):new ZV(n.left+Z/3,n.top+B/3),this.topRightBorderDoubleOuterBox=r>0||i>0?VV(n.left+m,n.top+B/3,s-y/3,a-B/3,qR.TOP_RIGHT):new ZV(n.left+n.width-y/3,n.top+B/3),this.bottomRightBorderDoubleOuterBox=l>0||c>0?VV(n.left+f,n.top+p,l-y/3,c-w/3,qR.BOTTOM_RIGHT):new ZV(n.left+n.width-y/3,n.top+n.height-w/3),this.bottomLeftBorderDoubleOuterBox=C>0||u>0?VV(n.left+Z/3,n.top+b,C-Z/3,u-w/3,qR.BOTTOM_LEFT):new ZV(n.left+Z/3,n.top+n.height-w/3),this.topLeftBorderDoubleInnerBox=r>0||i>0?VV(n.left+2*Z/3,n.top+2*B/3,r-2*Z/3,i-2*B/3,qR.TOP_LEFT):new ZV(n.left+2*Z/3,n.top+2*B/3),this.topRightBorderDoubleInnerBox=r>0||i>0?VV(n.left+m,n.top+2*B/3,s-2*y/3,a-2*B/3,qR.TOP_RIGHT):new ZV(n.left+n.width-2*y/3,n.top+2*B/3),this.bottomRightBorderDoubleInnerBox=l>0||c>0?VV(n.left+f,n.top+p,l-2*y/3,c-2*w/3,qR.BOTTOM_RIGHT):new ZV(n.left+n.width-2*y/3,n.top+n.height-2*w/3),this.bottomLeftBorderDoubleInnerBox=C>0||u>0?VV(n.left+2*Z/3,n.top+b,C-2*Z/3,u-2*w/3,qR.BOTTOM_LEFT):new ZV(n.left+2*Z/3,n.top+n.height-2*w/3),this.topLeftBorderStroke=r>0||i>0?VV(n.left+Z/2,n.top+B/2,r-Z/2,i-B/2,qR.TOP_LEFT):new ZV(n.left+Z/2,n.top+B/2),this.topRightBorderStroke=r>0||i>0?VV(n.left+m,n.top+B/2,s-y/2,a-B/2,qR.TOP_RIGHT):new ZV(n.left+n.width-y/2,n.top+B/2),this.bottomRightBorderStroke=l>0||c>0?VV(n.left+f,n.top+p,l-y/2,c-w/2,qR.BOTTOM_RIGHT):new ZV(n.left+n.width-y/2,n.top+n.height-w/2),this.bottomLeftBorderStroke=C>0||u>0?VV(n.left+Z/2,n.top+b,C-Z/2,u-w/2,qR.BOTTOM_LEFT):new ZV(n.left+Z/2,n.top+n.height-w/2),this.topLeftBorderBox=r>0||i>0?VV(n.left,n.top,r,i,qR.TOP_LEFT):new ZV(n.left,n.top),this.topRightBorderBox=s>0||a>0?VV(n.left+m,n.top,s,a,qR.TOP_RIGHT):new ZV(n.left+n.width,n.top),this.bottomRightBorderBox=l>0||c>0?VV(n.left+f,n.top+p,l,c,qR.BOTTOM_RIGHT):new ZV(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=C>0||u>0?VV(n.left,n.top+b,C,u,qR.BOTTOM_LEFT):new ZV(n.left,n.top+n.height),this.topLeftPaddingBox=r>0||i>0?VV(n.left+Z,n.top+B,Math.max(0,r-Z),Math.max(0,i-B),qR.TOP_LEFT):new ZV(n.left+Z,n.top+B),this.topRightPaddingBox=s>0||a>0?VV(n.left+Math.min(m,n.width-y),n.top+B,m>n.width+y?0:Math.max(0,s-y),Math.max(0,a-B),qR.TOP_RIGHT):new ZV(n.left+n.width-y,n.top+B),this.bottomRightPaddingBox=l>0||c>0?VV(n.left+Math.min(f,n.width-Z),n.top+Math.min(p,n.height-w),Math.max(0,l-y),Math.max(0,c-w),qR.BOTTOM_RIGHT):new ZV(n.left+n.width-y,n.top+n.height-w),this.bottomLeftPaddingBox=C>0||u>0?VV(n.left+Z,n.top+Math.min(b,n.height-w),Math.max(0,C-Z),Math.max(0,u-w),qR.BOTTOM_LEFT):new ZV(n.left+Z,n.top+n.height-w),this.topLeftContentBox=r>0||i>0?VV(n.left+Z+R,n.top+B+S,Math.max(0,r-(Z+R)),Math.max(0,i-(B+S)),qR.TOP_LEFT):new ZV(n.left+Z+R,n.top+B+S),this.topRightContentBox=s>0||a>0?VV(n.left+Math.min(m,n.width+Z+R),n.top+B+S,m>n.width+Z+R?0:s-Z+R,a-(B+S),qR.TOP_RIGHT):new ZV(n.left+n.width-(y+v),n.top+B+S),this.bottomRightContentBox=l>0||c>0?VV(n.left+Math.min(f,n.width-(Z+R)),n.top+Math.min(p,n.height+B+S),Math.max(0,l-(y+v)),c-(w+G),qR.BOTTOM_RIGHT):new ZV(n.left+n.width-(y+v),n.top+n.height-(w+G)),this.bottomLeftContentBox=C>0||u>0?VV(n.left+Z+R,n.top+b,Math.max(0,C-(Z+R)),u-(w+G),qR.BOTTOM_LEFT):new ZV(n.left+Z+R,n.top+n.height-(w+G))}}();($R=qR||(qR={}))[$R.TOP_LEFT=0]="TOP_LEFT",$R[$R.TOP_RIGHT=1]="TOP_RIGHT",$R[$R.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",$R[$R.BOTTOM_LEFT=3]="BOTTOM_LEFT";var VV=function(e,t,n,A,r){var i=(Math.sqrt(2)-1)/3*4,o=n*i,s=A*i,a=e+n,g=t+A;switch(r){case qR.TOP_LEFT:return new vV(new ZV(e,g),new ZV(e,g-s),new ZV(a-o,t),new ZV(a,t));case qR.TOP_RIGHT:return new vV(new ZV(e,t),new ZV(e+o,t),new ZV(a,g-s),new ZV(a,g));case qR.BOTTOM_RIGHT:return new vV(new ZV(a,t),new ZV(a,t+s),new ZV(e+o,g),new ZV(e,g));case qR.BOTTOM_LEFT:default:return new vV(new ZV(a,g),new ZV(a-o,g),new ZV(e,t+s),new ZV(e,t))}},NV=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},kV=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},WV=function(){return function(e,t,n){this.offsetX=e,this.offsetY=t,this.matrix=n,this.type=0,this.target=6}}(),FV=function(){return function(e,t){this.path=e,this.target=t,this.type=1}}(),EV=function(){return function(e){this.opacity=e,this.type=2,this.target=6}}(),XV=function(e){return 1===e.type},HV=function(e,t){return e.length===t.length&&e.some((function(e,n){return e===t[n]}))},xV=function(){return function(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}}(),JV=function(){function e(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new RV(this.container),this.container.styles.opacity<1&&this.effects.push(new EV(this.container.styles.opacity)),null!==this.container.styles.transform){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,A=this.container.bounds.top+this.container.styles.transformOrigin[1].number,r=this.container.styles.transform;this.effects.push(new WV(n,A,r))}if(0!==this.container.styles.overflowX){var i=NV(this.curves),o=kV(this.curves);HV(i,o)?this.effects.push(new FV(i,6)):(this.effects.push(new FV(i,2)),this.effects.push(new FV(o,4)))}}return e.prototype.getEffects=function(e){for(var t=-1===[2,3].indexOf(this.container.styles.position),n=this.parent,A=this.effects.slice(0);n;){var r=n.effects.filter((function(e){return!XV(e)}));if(t||0!==n.container.styles.position||!n.parent){if(A.unshift.apply(A,r),t=-1===[2,3].indexOf(n.container.styles.position),0!==n.container.styles.overflowX){var i=NV(n.curves),o=kV(n.curves);HV(i,o)||A.unshift(new FV(o,6))}}else A.unshift.apply(A,r);n=n.parent}return A.filter((function(t){return qv(t.target,e)}))},e}(),YV=function(e,t,n,A){e.container.elements.forEach((function(r){var i=qv(r.flags,4),o=qv(r.flags,2),s=new JV(r,e);qv(r.styles.display,2048)&&A.push(s);var a=qv(r.flags,8)?[]:A;if(i||o){var g=i||r.styles.isPositioned()?n:t,l=new xV(s);if(r.styles.isPositioned()||r.styles.opacity<1||r.styles.isTransformed()){var c=r.styles.zIndex.order;if(c<0){var I=0;g.negativeZIndex.some((function(e,t){return c>e.element.container.styles.zIndex.order?(I=t,!1):I>0})),g.negativeZIndex.splice(I,0,l)}else if(c>0){var C=0;g.positiveZIndex.some((function(e,t){return c>=e.element.container.styles.zIndex.order?(C=t+1,!1):C>0})),g.positiveZIndex.splice(C,0,l)}else g.zeroOrAutoZIndexOrTransformedOrOpacity.push(l)}else r.styles.isFloating()?g.nonPositionedFloats.push(l):g.nonPositionedInlineLevel.push(l);YV(s,l,i?l:n,a)}else r.styles.isInlineLevel()?t.inlineLevel.push(s):t.nonInlineLevel.push(s),YV(s,t,n,a);qv(r.flags,8)&&UV(r,a)}))},UV=function(e,t){for(var n=e instanceof eR?e.start:1,A=e instanceof eR&&e.reversed,r=0;r<t.length;r++){var i=t[r];i.container instanceof $G&&"number"==typeof i.container.value&&0!==i.container.value&&(n=i.container.value),i.listValue=PR(n,i.container.styles.listStyleType,!0),n+=A?-1:1}},LV=function(e,t){switch(t){case 0:return KV(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return KV(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return KV(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);default:return KV(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},TV=function(e,t){var n=[];return GV(e)?n.push(e.subdivide(.5,!1)):n.push(e),GV(t)?n.push(t.subdivide(.5,!0)):n.push(t),n},KV=function(e,t,n,A){var r=[];return GV(e)?r.push(e.subdivide(.5,!1)):r.push(e),GV(n)?r.push(n.subdivide(.5,!0)):r.push(n),GV(A)?r.push(A.subdivide(.5,!0).reverse()):r.push(A),GV(t)?r.push(t.subdivide(.5,!1).reverse()):r.push(t),r},MV=function(e){var t=e.bounds,n=e.styles;return t.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},QV=function(e){var t=e.styles,n=e.bounds,A=QZ(t.paddingLeft,n.width),r=QZ(t.paddingRight,n.width),i=QZ(t.paddingTop,n.width),o=QZ(t.paddingBottom,n.width);return n.add(A+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+A+r),-(t.borderTopWidth+t.borderBottomWidth+i+o))},DV=function(e,t,n){var A,r,i=(A=_V(e.styles.backgroundOrigin,t),r=e,0===A?r.bounds:2===A?QV(r):MV(r)),o=function(e,t){return 0===e?t.bounds:2===e?QV(t):MV(t)}(_V(e.styles.backgroundClip,t),e),s=PV(_V(e.styles.backgroundSize,t),n,i),a=s[0],g=s[1],l=MZ(_V(e.styles.backgroundPosition,t),i.width-a,i.height-g);return[jV(_V(e.styles.backgroundRepeat,t),l,s,i,o),Math.round(i.left+l[0]),Math.round(i.top+l[1]),a,g]},zV=function(e){return kZ(e)&&e.value===GS.AUTO},OV=function(e){return"number"==typeof e},PV=function(e,t,n){var A=t[0],r=t[1],i=t[2],o=e[0],s=e[1];if(!o)return[0,0];if(YZ(o)&&s&&YZ(s))return[QZ(o,n.width),QZ(s,n.height)];var a=OV(i);if(kZ(o)&&(o.value===GS.CONTAIN||o.value===GS.COVER))return OV(i)?n.width/n.height<i!=(o.value===GS.COVER)?[n.width,n.width/i]:[n.height*i,n.height]:[n.width,n.height];var g=OV(A),l=OV(r),c=g||l;if(zV(o)&&(!s||zV(s)))return g&&l?[A,r]:a||c?c&&a?[g?A:r*i,l?r:A/i]:[g?A:n.width,l?r:n.height]:[n.width,n.height];if(a){var I=0,C=0;return YZ(o)?I=QZ(o,n.width):YZ(s)&&(C=QZ(s,n.height)),zV(o)?I=C*i:s&&!zV(s)||(C=I/i),[I,C]}var u=null,d=null;if(YZ(o)?u=QZ(o,n.width):s&&YZ(s)&&(d=QZ(s,n.height)),null===u||s&&!zV(s)||(d=g&&l?u/A*r:n.height),null!==d&&zV(o)&&(u=g&&l?d/r*A:n.width),null!==u&&null!==d)return[u,d];throw new Error("Unable to calculate background-size for element")},_V=function(e,t){var n=e[t];return void 0===n?e[0]:n},jV=function(e,t,n,A,r){var i=t[0],o=t[1],s=n[0],a=n[1];switch(e){case 2:return[new ZV(Math.round(A.left),Math.round(A.top+o)),new ZV(Math.round(A.left+A.width),Math.round(A.top+o)),new ZV(Math.round(A.left+A.width),Math.round(a+A.top+o)),new ZV(Math.round(A.left),Math.round(a+A.top+o))];case 3:return[new ZV(Math.round(A.left+i),Math.round(A.top)),new ZV(Math.round(A.left+i+s),Math.round(A.top)),new ZV(Math.round(A.left+i+s),Math.round(A.height+A.top)),new ZV(Math.round(A.left+i),Math.round(A.height+A.top))];case 1:return[new ZV(Math.round(A.left+i),Math.round(A.top+o)),new ZV(Math.round(A.left+i+s),Math.round(A.top+o)),new ZV(Math.round(A.left+i+s),Math.round(A.top+o+a)),new ZV(Math.round(A.left+i),Math.round(A.top+o+a))];default:return[new ZV(Math.round(r.left),Math.round(r.top)),new ZV(Math.round(r.left+r.width),Math.round(r.top)),new ZV(Math.round(r.left+r.width),Math.round(r.height+r.top)),new ZV(Math.round(r.left),Math.round(r.height+r.top))]}},qV="Hidden Text",$V=function(){function e(e){this._data={},this._document=e}return e.prototype.parseMetrics=function(e,t){var n=this._document.createElement("div"),A=this._document.createElement("img"),r=this._document.createElement("span"),i=this._document.body;n.style.visibility="hidden",n.style.fontFamily=e,n.style.fontSize=t,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",i.appendChild(n),A.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",A.width=1,A.height=1,A.style.margin="0",A.style.padding="0",A.style.verticalAlign="baseline",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.appendChild(this._document.createTextNode(qV)),n.appendChild(r),n.appendChild(A);var o=A.offsetTop-r.offsetTop+2;n.removeChild(r),n.appendChild(this._document.createTextNode(qV)),n.style.lineHeight="normal",A.style.verticalAlign="super";var s=A.offsetTop-n.offsetTop+2;return i.removeChild(n),{baseline:o,middle:s}},e.prototype.getMetrics=function(e,t){var n=e+" "+t;return void 0===this._data[n]&&(this._data[n]=this.parseMetrics(e,t)),this._data[n]},e}(),eN=function(){return function(e,t){this.context=e,this.options=t}}(),tN=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A._activeEffects=[],A.canvas=n.canvas?n.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),n.canvas||(A.canvas.width=Math.floor(n.width*n.scale),A.canvas.height=Math.floor(n.height*n.scale),A.canvas.style.width=n.width+"px",A.canvas.style.height=n.height+"px"),A.fontMetrics=new $V(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-n.x,-n.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),A}return Ty(t,e),t.prototype.applyEffects=function(e){for(var t=this;this._activeEffects.length;)this.popEffect();e.forEach((function(e){return t.applyEffect(e)}))},t.prototype.applyEffect=function(e){this.ctx.save(),function(e){return 2===e.type}(e)&&(this.ctx.globalAlpha=e.opacity),function(e){return 0===e.type}(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),XV(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return My(this,0,void 0,(function(){return Qy(this,(function(t){switch(t.label){case 0:return e.element.container.styles.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.renderNode=function(e){return My(this,0,void 0,(function(){return Qy(this,(function(t){switch(t.label){case 0:return qv(e.container.flags,16),e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return t.sent(),[4,this.renderNodeContent(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},t.prototype.renderTextWithLetterSpacing=function(e,t,n){var A=this;0===t?this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+n):TG(e.text).reduce((function(t,r){return A.ctx.fillText(r,t,e.bounds.top+n),t+A.ctx.measureText(r).width}),e.bounds.left)},t.prototype.createFontStyle=function(e){var t=e.fontVariant.filter((function(e){return"normal"===e||"small-caps"===e})).join(""),n=oN(e.fontFamily).join(", "),A=VZ(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,t,e.fontWeight,A,n].join(" "),n,A]},t.prototype.renderTextNode=function(e,t){return My(this,0,void 0,(function(){var n,A,r,i,o,s,a,g,l=this;return Qy(this,(function(c){return n=this.createFontStyle(t),A=n[0],r=n[1],i=n[2],this.ctx.font=A,this.ctx.direction=1===t.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",o=this.fontMetrics.getMetrics(r,i),s=o.baseline,a=o.middle,g=t.paintOrder,e.textBounds.forEach((function(e){g.forEach((function(n){switch(n){case 0:l.ctx.fillStyle=eS(t.color),l.renderTextWithLetterSpacing(e,t.letterSpacing,s);var A=t.textShadow;A.length&&e.text.trim().length&&(A.slice(0).reverse().forEach((function(n){l.ctx.shadowColor=eS(n.color),l.ctx.shadowOffsetX=n.offsetX.number*l.options.scale,l.ctx.shadowOffsetY=n.offsetY.number*l.options.scale,l.ctx.shadowBlur=n.blur.number,l.renderTextWithLetterSpacing(e,t.letterSpacing,s)})),l.ctx.shadowColor="",l.ctx.shadowOffsetX=0,l.ctx.shadowOffsetY=0,l.ctx.shadowBlur=0),t.textDecorationLine.length&&(l.ctx.fillStyle=eS(t.textDecorationColor||t.color),t.textDecorationLine.forEach((function(t){switch(t){case 1:l.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top+s),e.bounds.width,1);break;case 2:l.ctx.fillRect(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1);break;case 3:l.ctx.fillRect(e.bounds.left,Math.ceil(e.bounds.top+a),e.bounds.width,1)}})));break;case 1:t.webkitTextStrokeWidth&&e.text.trim().length&&(l.ctx.strokeStyle=eS(t.webkitTextStrokeColor),l.ctx.lineWidth=t.webkitTextStrokeWidth,l.ctx.lineJoin=window.chrome?"miter":"round",l.ctx.strokeText(e.text,e.bounds.left,e.bounds.top+s)),l.ctx.strokeStyle="",l.ctx.lineWidth=0,l.ctx.lineJoin="miter"}}))})),[2]}))}))},t.prototype.renderReplacedElement=function(e,t,n){if(n&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var A=QV(e),r=kV(t);this.path(r),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,e.intrinsicWidth,e.intrinsicHeight,A.left,A.top,A.width,A.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return My(this,0,void 0,(function(){var n,A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p,f;return Qy(this,(function(b){switch(b.label){case 0:this.applyEffects(e.getEffects(4)),n=e.container,A=e.curves,r=n.styles,i=0,o=n.textNodes,b.label=1;case 1:return i<o.length?(s=o[i],[4,this.renderTextNode(s,r)]):[3,4];case 2:b.sent(),b.label=3;case 3:return i++,[3,1];case 4:if(!(n instanceof _G))return[3,8];b.label=5;case 5:return b.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return h=b.sent(),this.renderReplacedElement(n,A,h),[3,8];case 7:return b.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof jG&&this.renderReplacedElement(n,A,n.canvas),!(n instanceof qG))return[3,12];b.label=9;case 9:return b.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return h=b.sent(),this.renderReplacedElement(n,A,h),[3,12];case 11:return b.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof lR&&n.tree?[4,new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}).render(n.tree)]:[3,14];case 13:a=b.sent(),n.width&&n.height&&this.ctx.drawImage(a,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),b.label=14;case 14:if(n instanceof sR&&(g=Math.min(n.bounds.width,n.bounds.height),n.type===AR?n.checked&&(this.ctx.save(),this.path([new ZV(n.bounds.left+.39363*g,n.bounds.top+.79*g),new ZV(n.bounds.left+.16*g,n.bounds.top+.5549*g),new ZV(n.bounds.left+.27347*g,n.bounds.top+.44071*g),new ZV(n.bounds.left+.39694*g,n.bounds.top+.5649*g),new ZV(n.bounds.left+.72983*g,n.bounds.top+.23*g),new ZV(n.bounds.left+.84*g,n.bounds.top+.34085*g),new ZV(n.bounds.left+.39363*g,n.bounds.top+.79*g)]),this.ctx.fillStyle=eS(oR),this.ctx.fill(),this.ctx.restore()):n.type===rR&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+g/2,n.bounds.top+g/2,g/4,0,2*Math.PI,!0),this.ctx.fillStyle=eS(oR),this.ctx.fill(),this.ctx.restore())),nN(n)&&n.value.length){switch(l=this.createFontStyle(r),p=l[0],c=l[1],I=this.fontMetrics.getMetrics(p,c).baseline,this.ctx.font=p,this.ctx.fillStyle=eS(r.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=rN(n.styles.textAlign),f=QV(n),C=0,n.styles.textAlign){case 1:C+=f.width/2;break;case 2:C+=f.width}u=f.add(C,0,0,-f.height/2+1),this.ctx.save(),this.path([new ZV(f.left,f.top),new ZV(f.left+f.width,f.top),new ZV(f.left+f.width,f.top+f.height),new ZV(f.left,f.top+f.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new YG(n.value,u),r.letterSpacing,I),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!qv(n.styles.display,2048))return[3,20];if(null===n.styles.listStyleImage)return[3,19];if(0!==(d=n.styles.listStyleImage).type)return[3,18];h=void 0,m=d.url,b.label=15;case 15:return b.trys.push([15,17,,18]),[4,this.context.cache.match(m)];case 16:return h=b.sent(),this.ctx.drawImage(h,n.bounds.left-(h.width+10),n.bounds.top),[3,18];case 17:return b.sent(),this.context.logger.error("Error loading list-style-image "+m),[3,18];case 18:return[3,20];case 19:e.listValue&&-1!==n.styles.listStyleType&&(p=this.createFontStyle(r)[0],this.ctx.font=p,this.ctx.fillStyle=eS(r.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",f=new Dy(n.bounds.left,n.bounds.top+QZ(n.styles.paddingTop,n.bounds.width),n.bounds.width,dv(r.lineHeight,r.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new YG(e.listValue,f),r.letterSpacing,dv(r.lineHeight,r.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),b.label=20;case 20:return[2]}}))}))},t.prototype.renderStackContent=function(e){return My(this,0,void 0,(function(){var t,n,A,r,i,o,s,a,g,l,c,I,C,u,d;return Qy(this,(function(h){switch(h.label){case 0:return qv(e.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:h.sent(),t=0,n=e.negativeZIndex,h.label=2;case 2:return t<n.length?(d=n[t],[4,this.renderStack(d)]):[3,5];case 3:h.sent(),h.label=4;case 4:return t++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:h.sent(),A=0,r=e.nonInlineLevel,h.label=7;case 7:return A<r.length?(d=r[A],[4,this.renderNode(d)]):[3,10];case 8:h.sent(),h.label=9;case 9:return A++,[3,7];case 10:i=0,o=e.nonPositionedFloats,h.label=11;case 11:return i<o.length?(d=o[i],[4,this.renderStack(d)]):[3,14];case 12:h.sent(),h.label=13;case 13:return i++,[3,11];case 14:s=0,a=e.nonPositionedInlineLevel,h.label=15;case 15:return s<a.length?(d=a[s],[4,this.renderStack(d)]):[3,18];case 16:h.sent(),h.label=17;case 17:return s++,[3,15];case 18:g=0,l=e.inlineLevel,h.label=19;case 19:return g<l.length?(d=l[g],[4,this.renderNode(d)]):[3,22];case 20:h.sent(),h.label=21;case 21:return g++,[3,19];case 22:c=0,I=e.zeroOrAutoZIndexOrTransformedOrOpacity,h.label=23;case 23:return c<I.length?(d=I[c],[4,this.renderStack(d)]):[3,26];case 24:h.sent(),h.label=25;case 25:return c++,[3,23];case 26:C=0,u=e.positiveZIndex,h.label=27;case 27:return C<u.length?(d=u[C],[4,this.renderStack(d)]):[3,30];case 28:h.sent(),h.label=29;case 29:return C++,[3,27];case 30:return[2]}}))}))},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var t=this;e.forEach((function(e,n){var A=GV(e)?e.start:e;0===n?t.ctx.moveTo(A.x,A.y):t.ctx.lineTo(A.x,A.y),GV(e)&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)}))},t.prototype.renderRepeat=function(e,t,n,A){this.path(e),this.ctx.fillStyle=t,this.ctx.translate(n,A),this.ctx.fill(),this.ctx.translate(-n,-A)},t.prototype.resizeImage=function(e,t,n){var A;if(e.width===t&&e.height===n)return e;var r=(null!==(A=this.canvas.ownerDocument)&&void 0!==A?A:document).createElement("canvas");return r.width=Math.max(1,t),r.height=Math.max(1,n),r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,n),r},t.prototype.renderBackgroundImage=function(e){return My(this,0,void 0,(function(){var t,n,A,r,i,o;return Qy(this,(function(s){switch(s.label){case 0:t=e.styles.backgroundImage.length-1,n=function(n){var r,i,o,s,a,g,l,c,I,C,u,d,h,m,p,f,b,B,y,w,Z,S,v,G,R,V,N,k,W,F,E;return Qy(this,(function(X){switch(X.label){case 0:if(0!==n.type)return[3,5];r=void 0,i=n.url,X.label=1;case 1:return X.trys.push([1,3,,4]),[4,A.context.cache.match(i)];case 2:return r=X.sent(),[3,4];case 3:return X.sent(),A.context.logger.error("Error loading background-image "+i),[3,4];case 4:return r&&(o=DV(e,t,[r.width,r.height,r.width/r.height]),f=o[0],S=o[1],v=o[2],y=o[3],w=o[4],m=A.ctx.createPattern(A.resizeImage(r,y,w),"repeat"),A.renderRepeat(f,m,S,v)),[3,6];case 5:1===n.type?(s=DV(e,t,[null,null,null]),f=s[0],S=s[1],v=s[2],y=s[3],w=s[4],a=CS(n.angle,y,w),g=a[0],l=a[1],c=a[2],I=a[3],C=a[4],(u=document.createElement("canvas")).width=y,u.height=w,d=u.getContext("2d"),h=d.createLinearGradient(l,I,c,C),IS(n.stops,g).forEach((function(e){return h.addColorStop(e.stop,eS(e.color))})),d.fillStyle=h,d.fillRect(0,0,y,w),y>0&&w>0&&(m=A.ctx.createPattern(u,"repeat"),A.renderRepeat(f,m,S,v))):function(e){return 2===e.type}(n)&&(p=DV(e,t,[null,null,null]),f=p[0],b=p[1],B=p[2],y=p[3],w=p[4],Z=0===n.position.length?[TZ]:n.position,S=QZ(Z[0],y),v=QZ(Z[Z.length-1],w),G=function(e,t,n,A,r){var i=0,o=0;switch(e.size){case 0:0===e.shape?i=o=Math.min(Math.abs(t),Math.abs(t-A),Math.abs(n),Math.abs(n-r)):1===e.shape&&(i=Math.min(Math.abs(t),Math.abs(t-A)),o=Math.min(Math.abs(n),Math.abs(n-r)));break;case 2:if(0===e.shape)i=o=Math.min(uS(t,n),uS(t,n-r),uS(t-A,n),uS(t-A,n-r));else if(1===e.shape){var s=Math.min(Math.abs(n),Math.abs(n-r))/Math.min(Math.abs(t),Math.abs(t-A)),a=dS(A,r,t,n,!0),g=a[0],l=a[1];o=s*(i=uS(g-t,(l-n)/s))}break;case 1:0===e.shape?i=o=Math.max(Math.abs(t),Math.abs(t-A),Math.abs(n),Math.abs(n-r)):1===e.shape&&(i=Math.max(Math.abs(t),Math.abs(t-A)),o=Math.max(Math.abs(n),Math.abs(n-r)));break;case 3:if(0===e.shape)i=o=Math.max(uS(t,n),uS(t,n-r),uS(t-A,n),uS(t-A,n-r));else if(1===e.shape){s=Math.max(Math.abs(n),Math.abs(n-r))/Math.max(Math.abs(t),Math.abs(t-A));var c=dS(A,r,t,n,!1);g=c[0],l=c[1],o=s*(i=uS(g-t,(l-n)/s))}}return Array.isArray(e.size)&&(i=QZ(e.size[0],A),o=2===e.size.length?QZ(e.size[1],r):i),[i,o]}(n,S,v,y,w),R=G[0],V=G[1],R>0&&V>0&&(N=A.ctx.createRadialGradient(b+S,B+v,0,b+S,B+v,R),IS(n.stops,2*R).forEach((function(e){return N.addColorStop(e.stop,eS(e.color))})),A.path(f),A.ctx.fillStyle=N,R!==V?(k=e.bounds.left+.5*e.bounds.width,W=e.bounds.top+.5*e.bounds.height,E=1/(F=V/R),A.ctx.save(),A.ctx.translate(k,W),A.ctx.transform(1,0,0,F,0,0),A.ctx.translate(-k,-W),A.ctx.fillRect(b,E*(B-W)+W,y,w*E),A.ctx.restore()):A.ctx.fill())),X.label=6;case 6:return t--,[2]}}))},A=this,r=0,i=e.styles.backgroundImage.slice(0).reverse(),s.label=1;case 1:return r<i.length?(o=i[r],[5,n(o)]):[3,4];case 2:s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype.renderSolidBorder=function(e,t,n){return My(this,0,void 0,(function(){return Qy(this,(function(A){return this.path(LV(n,t)),this.ctx.fillStyle=eS(e),this.ctx.fill(),[2]}))}))},t.prototype.renderDoubleBorder=function(e,t,n,A){return My(this,0,void 0,(function(){var r,i;return Qy(this,(function(o){switch(o.label){case 0:return t<3?[4,this.renderSolidBorder(e,n,A)]:[3,2];case 1:return o.sent(),[2];case 2:return r=function(e,t){switch(t){case 0:return KV(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return KV(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return KV(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);default:return KV(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}}(A,n),this.path(r),this.ctx.fillStyle=eS(e),this.ctx.fill(),i=function(e,t){switch(t){case 0:return KV(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return KV(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return KV(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);default:return KV(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}}(A,n),this.path(i),this.ctx.fill(),[2]}}))}))},t.prototype.renderNodeBackgroundAndBorders=function(e){return My(this,0,void 0,(function(){var t,n,A,r,i,o,s,a,g=this;return Qy(this,(function(l){switch(l.label){case 0:return this.applyEffects(e.getEffects(2)),t=e.container.styles,n=!$Z(t.backgroundColor)||t.backgroundImage.length,A=[{style:t.borderTopStyle,color:t.borderTopColor,width:t.borderTopWidth},{style:t.borderRightStyle,color:t.borderRightColor,width:t.borderRightWidth},{style:t.borderBottomStyle,color:t.borderBottomColor,width:t.borderBottomWidth},{style:t.borderLeftStyle,color:t.borderLeftColor,width:t.borderLeftWidth}],r=AN(_V(t.backgroundClip,0),e.curves),n||t.boxShadow.length?(this.ctx.save(),this.path(r),this.ctx.clip(),$Z(t.backgroundColor)||(this.ctx.fillStyle=eS(t.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:l.sent(),this.ctx.restore(),t.boxShadow.slice(0).reverse().forEach((function(t){g.ctx.save();var n,A,r,i,o,s=NV(e.curves),a=t.inset?0:1e4,l=(n=s,A=-a+(t.inset?1:-1)*t.spread.number,r=(t.inset?1:-1)*t.spread.number,i=t.spread.number*(t.inset?-2:2),o=t.spread.number*(t.inset?-2:2),n.map((function(e,t){switch(t){case 0:return e.add(A,r);case 1:return e.add(A+i,r);case 2:return e.add(A+i,r+o);case 3:return e.add(A,r+o)}return e})));t.inset?(g.path(s),g.ctx.clip(),g.mask(l)):(g.mask(s),g.ctx.clip(),g.path(l)),g.ctx.shadowOffsetX=t.offsetX.number+a,g.ctx.shadowOffsetY=t.offsetY.number,g.ctx.shadowColor=eS(t.color),g.ctx.shadowBlur=t.blur.number,g.ctx.fillStyle=t.inset?eS(t.color):"rgba(0,0,0,1)",g.ctx.fill(),g.ctx.restore()})),l.label=2;case 2:i=0,o=0,s=A,l.label=3;case 3:return o<s.length?0!==(a=s[o]).style&&!$Z(a.color)&&a.width>0?2!==a.style?[3,5]:[4,this.renderDashedDottedBorder(a.color,a.width,i,e.curves,2)]:[3,11]:[3,13];case 4:return l.sent(),[3,11];case 5:return 3!==a.style?[3,7]:[4,this.renderDashedDottedBorder(a.color,a.width,i,e.curves,3)];case 6:return l.sent(),[3,11];case 7:return 4!==a.style?[3,9]:[4,this.renderDoubleBorder(a.color,a.width,i,e.curves)];case 8:return l.sent(),[3,11];case 9:return[4,this.renderSolidBorder(a.color,i,e.curves)];case 10:l.sent(),l.label=11;case 11:i++,l.label=12;case 12:return o++,[3,3];case 13:return[2]}}))}))},t.prototype.renderDashedDottedBorder=function(e,t,n,A,r){return My(this,0,void 0,(function(){var i,o,s,a,g,l,c,I,C,u,d,h,m,p,f,b;return Qy(this,(function(B){return this.ctx.save(),i=function(e,t){switch(t){case 0:return TV(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return TV(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return TV(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);default:return TV(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}}(A,n),o=LV(A,n),2===r&&(this.path(o),this.ctx.clip()),GV(o[0])?(s=o[0].start.x,a=o[0].start.y):(s=o[0].x,a=o[0].y),GV(o[1])?(g=o[1].end.x,l=o[1].end.y):(g=o[1].x,l=o[1].y),c=0===n||2===n?Math.abs(s-g):Math.abs(a-l),this.ctx.beginPath(),3===r?this.formatPath(i):this.formatPath(o.slice(0,2)),I=t<3?3*t:2*t,C=t<3?2*t:t,3===r&&(I=t,C=t),u=!0,c<=2*I?u=!1:c<=2*I+C?(I*=d=c/(2*I+C),C*=d):(h=Math.floor((c+C)/(I+C)),m=(c-h*I)/(h-1),C=(p=(c-(h+1)*I)/h)<=0||Math.abs(C-m)<Math.abs(C-p)?m:p),u&&(3===r?this.ctx.setLineDash([0,I+C]):this.ctx.setLineDash([I,C])),3===r?(this.ctx.lineCap="round",this.ctx.lineWidth=t):this.ctx.lineWidth=2*t+1.1,this.ctx.strokeStyle=eS(e),this.ctx.stroke(),this.ctx.setLineDash([]),2===r&&(GV(o[0])&&(f=o[3],b=o[0],this.ctx.beginPath(),this.formatPath([new ZV(f.end.x,f.end.y),new ZV(b.start.x,b.start.y)]),this.ctx.stroke()),GV(o[1])&&(f=o[1],b=o[2],this.ctx.beginPath(),this.formatPath([new ZV(f.end.x,f.end.y),new ZV(b.start.x,b.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},t.prototype.render=function(e){return My(this,0,void 0,(function(){var t;return Qy(this,(function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=eS(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),A=new JV(e,null),r=new xV(A),YV(A,r,r,i=[]),UV(A.container,i),t=r,[4,this.renderStack(t)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}var A,r,i}))}))},t}(eN),nN=function(e){return e instanceof gR||(e instanceof aR||e instanceof sR&&e.type!==rR&&e.type!==AR)},AN=function(e,t){switch(e){case 0:return NV(t);case 2:return function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]}(t);default:return kV(t)}},rN=function(e){switch(e){case 1:return"center";case 2:return"right";default:return"left"}},iN=["-apple-system","system-ui"],oN=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter((function(e){return-1===iN.indexOf(e)})):e},sN=function(e){function t(t,n){var A=e.call(this,t,n)||this;return A.canvas=n.canvas?n.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=n,A.canvas.width=Math.floor(n.width*n.scale),A.canvas.height=Math.floor(n.height*n.scale),A.canvas.style.width=n.width+"px",A.canvas.style.height=n.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-n.x,-n.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),A}return Ty(t,e),t.prototype.render=function(e){return My(this,0,void 0,(function(){var t,n;return Qy(this,(function(A){switch(A.label){case 0:return t=HG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,aN(t)];case 1:return n=A.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=eS(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},t}(eN),aN=function(e){return new Promise((function(t,n){var A=new Image;A.onload=function(){t(A)},A.onerror=n,A.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))},gN=function(){function e(e){var t=e.id,n=e.enabled;this.id=t,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug||this.info.apply(this,e))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&"undefined"!=typeof window&&window.console&&console.info},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn||this.info.apply(this,e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error||this.info.apply(this,e))},e.instances={},e}(),lN=function(){function e(t,n){var A;this.windowBounds=n,this.instanceName="#"+e.instanceCount++,this.logger=new gN({id:this.instanceName,enabled:t.logging}),this.cache=null!==(A=t.cache)&&void 0!==A?A:new dV(this,t)}return e.instanceCount=1,e}(),cN=function(e,t){return void 0===t&&(t={}),IN(e,t)};"undefined"!=typeof window&&uV.setContext(window);var IN=function(e,t){return My(void 0,0,void 0,(function(){var n,A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p,f,b,B,y,w,Z,S,v,G,R,V,N,k,W,F,E,X,H,x,J,Y;return Qy(this,(function(U){switch(U.label){case 0:if(!e||"object"!=typeof e)return[2,Promise.reject("Invalid element provided as first argument")];if(!(n=e.ownerDocument))throw new Error("Element is not attached to a Document");if(!(A=n.defaultView))throw new Error("Document is not attached to a Window");return r={allowTaint:null!==(w=t.allowTaint)&&void 0!==w&&w,imageTimeout:null!==(Z=t.imageTimeout)&&void 0!==Z?Z:15e3,proxy:t.proxy,useCORS:null!==(S=t.useCORS)&&void 0!==S&&S},i=Ky({logging:null===(v=t.logging)||void 0===v||v,cache:t.cache},r),o={windowWidth:null!==(G=t.windowWidth)&&void 0!==G?G:A.innerWidth,windowHeight:null!==(R=t.windowHeight)&&void 0!==R?R:A.innerHeight,scrollX:null!==(V=t.scrollX)&&void 0!==V?V:A.pageXOffset,scrollY:null!==(N=t.scrollY)&&void 0!==N?N:A.pageYOffset},s=new Dy(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),a=new lN(i,s),g=null!==(k=t.foreignObjectRendering)&&void 0!==k&&k,l={allowTaint:null!==(W=t.allowTaint)&&void 0!==W&&W,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:g,copyStyles:g},a.logger.debug("Starting document clone with size "+s.width+"x"+s.height+" scrolled to "+-s.left+","+-s.top),c=new jR(a,e,l),(I=c.clonedReferenceElement)?[4,c.toIFrame(n,s)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return C=U.sent(),u=SR(I)||"HTML"===I.tagName?function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var A=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),r=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new Dy(0,0,A,r)}(I.ownerDocument):zy(a,I),d=u.width,h=u.height,m=u.left,p=u.top,f=CN(a,I,t.backgroundColor),b={canvas:t.canvas,backgroundColor:f,scale:null!==(E=null!==(F=t.scale)&&void 0!==F?F:A.devicePixelRatio)&&void 0!==E?E:1,x:(null!==(X=t.x)&&void 0!==X?X:0)+m,y:(null!==(H=t.y)&&void 0!==H?H:0)+p,width:null!==(x=t.width)&&void 0!==x?x:Math.ceil(d),height:null!==(J=t.height)&&void 0!==J?J:Math.ceil(h)},g?(a.logger.debug("Document cloned, using foreign object rendering"),[4,new sN(a,b).render(I)]):[3,3];case 2:return B=U.sent(),[3,5];case 3:return a.logger.debug("Document cloned, element located at "+m+","+p+" with size "+d+"x"+h+" using computed rendering"),a.logger.debug("Starting DOM parsing"),y=uR(a,I),f===y.styles.backgroundColor&&(y.styles.backgroundColor=aS.TRANSPARENT),a.logger.debug("Starting renderer for element at "+b.x+","+b.y+" with size "+b.width+"x"+b.height),[4,new tN(a,b).render(y)];case 4:B=U.sent(),U.label=5;case 5:return(null===(Y=t.removeContainer)||void 0===Y||Y)&&(jR.destroy(C)||a.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),a.logger.debug("Finished rendering"),[2,B]}}))}))},CN=function(e,t,n){var A=t.ownerDocument,r=A.documentElement?sS(e,getComputedStyle(A.documentElement).backgroundColor):aS.TRANSPARENT,i=A.body?sS(e,getComputedStyle(A.body).backgroundColor):aS.TRANSPARENT,o="string"==typeof n?sS(e,n):null===n?aS.TRANSPARENT:4294967295;return t===A.documentElement?$Z(r)?$Z(i)?o:i:r:o};const uN=Object.freeze(Object.defineProperty({__proto__:null,default:cN},Symbol.toStringTag,{value:"Module"}));var dN={},hN={},mN={};let pN;const fN=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];mN.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},mN.getSymbolTotalCodewords=function(e){return fN[e]},mN.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},mN.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');pN=e},mN.isKanjiModeEnabled=function(){return void 0!==pN},mN.toSJIS=function(e){return pN(e)};var bN,BN={};function yN(){this.buffer=[],this.length=0}(bN=BN).L={bit:1},bN.M={bit:0},bN.Q={bit:3},bN.H={bit:2},bN.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},bN.from=function(e,t){if(bN.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return bN.L;case"m":case"medium":return bN.M;case"q":case"quartile":return bN.Q;case"h":case"high":return bN.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(Zf){return t}},yN.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var wN=yN;function ZN(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ZN.prototype.set=function(e,t,n,A){const r=e*this.size+t;this.data[r]=n,A&&(this.reservedBit[r]=!0)},ZN.prototype.get=function(e,t){return this.data[e*this.size+t]},ZN.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},ZN.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var SN=ZN,vN={};!function(e){const t=mN.getSymbolSize;e.getRowColCoords=function(e){if(1===e)return[];const n=Math.floor(e/7)+2,A=t(e),r=145===A?26:2*Math.ceil((A-13)/(2*n-2)),i=[A-7];for(let t=1;t<n-1;t++)i[t]=i[t-1]-r;return i.push(6),i.reverse()},e.getPositions=function(t){const n=[],A=e.getRowColCoords(t),r=A.length;for(let e=0;e<r;e++)for(let t=0;t<r;t++)0===e&&0===t||0===e&&t===r-1||e===r-1&&0===t||n.push([A[e],A[t]]);return n}}(vN);var GN={};const RN=mN.getSymbolSize;GN.getPositions=function(e){const t=RN(e);return[[0,0],[t-7,0],[0,t-7]]};var VN={};!function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t=3,n=3,A=40,r=10;function i(t,n,A){switch(t){case e.Patterns.PATTERN000:return(n+A)%2==0;case e.Patterns.PATTERN001:return n%2==0;case e.Patterns.PATTERN010:return A%3==0;case e.Patterns.PATTERN011:return(n+A)%3==0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(A/3))%2==0;case e.Patterns.PATTERN101:return n*A%2+n*A%3==0;case e.Patterns.PATTERN110:return(n*A%2+n*A%3)%2==0;case e.Patterns.PATTERN111:return(n*A%3+(n+A)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(e){const n=e.size;let A=0,r=0,i=0,o=null,s=null;for(let a=0;a<n;a++){r=i=0,o=s=null;for(let g=0;g<n;g++){let n=e.get(a,g);n===o?r++:(r>=5&&(A+=t+(r-5)),o=n,r=1),n=e.get(g,a),n===s?i++:(i>=5&&(A+=t+(i-5)),s=n,i=1)}r>=5&&(A+=t+(r-5)),i>=5&&(A+=t+(i-5))}return A},e.getPenaltyN2=function(e){const t=e.size;let A=0;for(let n=0;n<t-1;n++)for(let r=0;r<t-1;r++){const t=e.get(n,r)+e.get(n,r+1)+e.get(n+1,r)+e.get(n+1,r+1);4!==t&&0!==t||A++}return A*n},e.getPenaltyN3=function(e){const t=e.size;let n=0,r=0,i=0;for(let A=0;A<t;A++){r=i=0;for(let o=0;o<t;o++)r=r<<1&2047|e.get(A,o),o>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|e.get(o,A),o>=10&&(1488===i||93===i)&&n++}return n*A},e.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let A=0;A<n;A++)t+=e.data[A];return Math.abs(Math.ceil(100*t/n/5)-10)*r},e.applyMask=function(e,t){const n=t.size;for(let A=0;A<n;A++)for(let r=0;r<n;r++)t.isReserved(r,A)||t.xor(r,A,i(e,r,A))},e.getBestMask=function(t,n){const A=Object.keys(e.Patterns).length;let r=0,i=1/0;for(let o=0;o<A;o++){n(o),e.applyMask(o,t);const A=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(o,t),A<i&&(i=A,r=o)}return r}}(VN);var NN={};const kN=BN,WN=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],FN=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];NN.getBlocksCount=function(e,t){switch(t){case kN.L:return WN[4*(e-1)+0];case kN.M:return WN[4*(e-1)+1];case kN.Q:return WN[4*(e-1)+2];case kN.H:return WN[4*(e-1)+3];default:return}},NN.getTotalCodewordsCount=function(e,t){switch(t){case kN.L:return FN[4*(e-1)+0];case kN.M:return FN[4*(e-1)+1];case kN.Q:return FN[4*(e-1)+2];case kN.H:return FN[4*(e-1)+3];default:return}};var EN={},XN={};const HN=new Uint8Array(512),xN=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)HN[t]=e,xN[e]=t,e<<=1,256&e&&(e^=285);for(let t=255;t<512;t++)HN[t]=HN[t-255]}(),XN.log=function(e){if(e<1)throw new Error("log("+e+")");return xN[e]},XN.exp=function(e){return HN[e]},XN.mul=function(e,t){return 0===e||0===t?0:HN[xN[e]+xN[t]]},function(e){const t=XN;e.mul=function(e,n){const A=new Uint8Array(e.length+n.length-1);for(let r=0;r<e.length;r++)for(let i=0;i<n.length;i++)A[r+i]^=t.mul(e[r],n[i]);return A},e.mod=function(e,n){let A=new Uint8Array(e);for(;A.length-n.length>=0;){const e=A[0];for(let i=0;i<n.length;i++)A[i]^=t.mul(n[i],e);let r=0;for(;r<A.length&&0===A[r];)r++;A=A.slice(r)}return A},e.generateECPolynomial=function(n){let A=new Uint8Array([1]);for(let r=0;r<n;r++)A=e.mul(A,new Uint8Array([1,t.exp(r)]));return A}}(EN);const JN=EN;function YN(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}YN.prototype.initialize=function(e){this.degree=e,this.genPoly=JN.generateECPolynomial(this.degree)},YN.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=JN.mod(t,this.genPoly),A=this.degree-n.length;if(A>0){const e=new Uint8Array(this.degree);return e.set(n,A),e}return n};var UN=YN,LN={},TN={},KN={isValid:function(e){return!isNaN(e)&&e>=1&&e<=40}},MN={};const QN="[0-9]+";let DN="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";DN=DN.replace(/u/g,"\\u");const zN="(?:(?![A-Z0-9 $%*+\\-./:]|"+DN+")(?:.|[\r\n]))+";MN.KANJI=new RegExp(DN,"g"),MN.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),MN.BYTE=new RegExp(zN,"g"),MN.NUMERIC=new RegExp(QN,"g"),MN.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const ON=new RegExp("^"+DN+"$"),PN=new RegExp("^"+QN+"$"),_N=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");MN.testKanji=function(e){return ON.test(e)},MN.testNumeric=function(e){return PN.test(e)},MN.testAlphanumeric=function(e){return _N.test(e)},function(e){const t=KN,n=MN;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(e,n){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!t.isValid(n))throw new Error("Invalid version: "+n);return n>=1&&n<10?e.ccBits[0]:n<27?e.ccBits[1]:e.ccBits[2]},e.getBestModeForData=function(t){return n.testNumeric(t)?e.NUMERIC:n.testAlphanumeric(t)?e.ALPHANUMERIC:n.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},e.isValid=function(e){return e&&e.bit&&e.ccBits},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(Zf){return n}}}(TN),function(e){const t=mN,n=NN,A=BN,r=TN,i=KN,o=t.getBCHDigit(7973);function s(e,t){return r.getCharCountIndicator(e,t)+4}function a(e,t){let n=0;return e.forEach((function(e){const A=s(e.mode,t);n+=A+e.getBitsLength()})),n}e.from=function(e,t){return i.isValid(e)?parseInt(e,10):t},e.getCapacity=function(e,A,o){if(!i.isValid(e))throw new Error("Invalid QR Code version");void 0===o&&(o=r.BYTE);const a=8*(t.getSymbolTotalCodewords(e)-n.getTotalCodewordsCount(e,A));if(o===r.MIXED)return a;const g=a-s(o,e);switch(o){case r.NUMERIC:return Math.floor(g/10*3);case r.ALPHANUMERIC:return Math.floor(g/11*2);case r.KANJI:return Math.floor(g/13);case r.BYTE:default:return Math.floor(g/8)}},e.getBestVersionForData=function(t,n){let i;const o=A.from(n,A.M);if(Array.isArray(t)){if(t.length>1)return function(t,n){for(let A=1;A<=40;A++)if(a(t,A)<=e.getCapacity(A,n,r.MIXED))return A}(t,o);if(0===t.length)return 1;i=t[0]}else i=t;return function(t,n,A){for(let r=1;r<=40;r++)if(n<=e.getCapacity(r,A,t))return r}(i.mode,i.getLength(),o)},e.getEncodedBits=function(e){if(!i.isValid(e)||e<7)throw new Error("Invalid QR Code version");let n=e<<12;for(;t.getBCHDigit(n)-o>=0;)n^=7973<<t.getBCHDigit(n)-o;return e<<12|n}}(LN);var jN={};const qN=mN,$N=qN.getBCHDigit(1335);jN.getEncodedBits=function(e,t){const n=e.bit<<3|t;let A=n<<10;for(;qN.getBCHDigit(A)-$N>=0;)A^=1335<<qN.getBCHDigit(A)-$N;return 21522^(n<<10|A)};var ek={};const tk=TN;function nk(e){this.mode=tk.NUMERIC,this.data=e.toString()}nk.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},nk.prototype.getLength=function(){return this.data.length},nk.prototype.getBitsLength=function(){return nk.getBitsLength(this.data.length)},nk.prototype.write=function(e){let t,n,A;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),A=parseInt(n,10),e.put(A,10);const r=this.data.length-t;r>0&&(n=this.data.substr(t),A=parseInt(n,10),e.put(A,3*r+1))};var Ak=nk;const rk=TN,ik=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ok(e){this.mode=rk.ALPHANUMERIC,this.data=e}ok.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},ok.prototype.getLength=function(){return this.data.length},ok.prototype.getBitsLength=function(){return ok.getBitsLength(this.data.length)},ok.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*ik.indexOf(this.data[t]);n+=ik.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(ik.indexOf(this.data[t]),6)};var sk=ok;const ak=TN;function gk(e){this.mode=ak.BYTE,this.data="string"==typeof e?(new TextEncoder).encode(e):new Uint8Array(e)}gk.getBitsLength=function(e){return 8*e},gk.prototype.getLength=function(){return this.data.length},gk.prototype.getBitsLength=function(){return gk.getBitsLength(this.data.length)},gk.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)};var lk=gk;const ck=TN,Ik=mN;function Ck(e){this.mode=ck.KANJI,this.data=e}Ck.getBitsLength=function(e){return 13*e},Ck.prototype.getLength=function(){return this.data.length},Ck.prototype.getBitsLength=function(){return Ck.getBitsLength(this.data.length)},Ck.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=Ik.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}};var uk,dk=Ck,hk={exports:{}};uk={single_source_shortest_paths:function(e,t,n){var A={},r={};r[t]=0;var i,o,s,a,g,l,c,I=uk.PriorityQueue.make();for(I.push(t,0);!I.empty();)for(s in o=(i=I.pop()).value,a=i.cost,g=e[o]||{})g.hasOwnProperty(s)&&(l=a+g[s],c=r[s],(void 0===r[s]||c>l)&&(r[s]=l,I.push(s,l),A[s]=o));if(void 0!==n&&void 0===r[n]){var C=["Could not find a path from ",t," to ",n,"."].join("");throw new Error(C)}return A},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],A=t;A;)n.push(A),e[A],A=e[A];return n.reverse(),n},find_path:function(e,t,n){var A=uk.single_source_shortest_paths(e,t,n);return uk.extract_shortest_path_from_predecessor_list(A,n)},PriorityQueue:{make:function(e){var t,n=uk.PriorityQueue,A={};for(t in e=e||{},n)n.hasOwnProperty(t)&&(A[t]=n[t]);return A.queue=[],A.sorter=e.sorter||n.default_sorter,A},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};var mk=hk.exports=uk;!function(e){const t=TN,n=Ak,A=sk,r=lk,i=dk,o=MN,s=mN,a=mk;function g(e){return unescape(encodeURIComponent(e)).length}function l(e,t,n){const A=[];let r;for(;null!==(r=e.exec(n));)A.push({data:r[0],index:r.index,mode:t,length:r[0].length});return A}function c(e){const n=l(o.NUMERIC,t.NUMERIC,e),A=l(o.ALPHANUMERIC,t.ALPHANUMERIC,e);let r,i;s.isKanjiModeEnabled()?(r=l(o.BYTE,t.BYTE,e),i=l(o.KANJI,t.KANJI,e)):(r=l(o.BYTE_KANJI,t.BYTE,e),i=[]);return n.concat(A,r,i).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function I(e,o){switch(o){case t.NUMERIC:return n.getBitsLength(e);case t.ALPHANUMERIC:return A.getBitsLength(e);case t.KANJI:return i.getBitsLength(e);case t.BYTE:return r.getBitsLength(e)}}function C(e,o){let a;const g=t.getBestModeForData(e);if(a=t.from(o,g),a!==t.BYTE&&a.bit<g.bit)throw new Error('"'+e+'" cannot be encoded with mode '+t.toString(a)+".\n Suggested mode is: "+t.toString(g));switch(a!==t.KANJI||s.isKanjiModeEnabled()||(a=t.BYTE),a){case t.NUMERIC:return new n(e);case t.ALPHANUMERIC:return new A(e);case t.KANJI:return new i(e);case t.BYTE:return new r(e)}}e.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(C(t,null)):t.data&&e.push(C(t.data,t.mode)),e}),[])},e.fromString=function(n,A){const r=function(e){const n=[];for(let A=0;A<e.length;A++){const r=e[A];switch(r.mode){case t.NUMERIC:n.push([r,{data:r.data,mode:t.ALPHANUMERIC,length:r.length},{data:r.data,mode:t.BYTE,length:r.length}]);break;case t.ALPHANUMERIC:n.push([r,{data:r.data,mode:t.BYTE,length:r.length}]);break;case t.KANJI:n.push([r,{data:r.data,mode:t.BYTE,length:g(r.data)}]);break;case t.BYTE:n.push([{data:r.data,mode:t.BYTE,length:g(r.data)}])}}return n}(c(n,s.isKanjiModeEnabled())),i=function(e,n){const A={},r={start:{}};let i=["start"];for(let o=0;o<e.length;o++){const s=e[o],a=[];for(let e=0;e<s.length;e++){const g=s[e],l=""+o+e;a.push(l),A[l]={node:g,lastCount:0},r[l]={};for(let e=0;e<i.length;e++){const o=i[e];A[o]&&A[o].node.mode===g.mode?(r[o][l]=I(A[o].lastCount+g.length,g.mode)-I(A[o].lastCount,g.mode),A[o].lastCount+=g.length):(A[o]&&(A[o].lastCount=g.length),r[o][l]=I(g.length,g.mode)+4+t.getCharCountIndicator(g.mode,n))}}i=a}for(let t=0;t<i.length;t++)r[i[t]].end=0;return{map:r,table:A}}(r,A),o=a.find_path(i.map,"start","end"),l=[];for(let e=1;e<o.length-1;e++)l.push(i.table[o[e]].node);return e.fromArray(function(e){return e.reduce((function(e,t){const n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[])}(l))},e.rawSplit=function(t){return e.fromArray(c(t,s.isKanjiModeEnabled()))}}(ek);const pk=mN,fk=BN,bk=wN,Bk=SN,yk=vN,wk=GN,Zk=VN,Sk=NN,vk=UN,Gk=LN,Rk=jN,Vk=TN,Nk=ek;function kk(e,t,n){const A=e.size,r=Rk.getEncodedBits(t,n);let i,o;for(i=0;i<15;i++)o=1==(r>>i&1),i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(A-15+i,8,o,!0),i<8?e.set(8,A-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(A-8,8,1,!0)}function Wk(e,t,n){const A=new bk;n.forEach((function(t){A.put(t.mode.bit,4),A.put(t.getLength(),Vk.getCharCountIndicator(t.mode,e)),t.write(A)}));const r=8*(pk.getSymbolTotalCodewords(e)-Sk.getTotalCodewordsCount(e,t));for(A.getLengthInBits()+4<=r&&A.put(0,4);A.getLengthInBits()%8!=0;)A.putBit(0);const i=(r-A.getLengthInBits())/8;for(let o=0;o<i;o++)A.put(o%2?17:236,8);return function(e,t,n){const A=pk.getSymbolTotalCodewords(t),r=Sk.getTotalCodewordsCount(t,n),i=A-r,o=Sk.getBlocksCount(t,n),s=A%o,a=o-s,g=Math.floor(A/o),l=Math.floor(i/o),c=l+1,I=g-l,C=new vk(I);let u=0;const d=new Array(o),h=new Array(o);let m=0;const p=new Uint8Array(e.buffer);for(let w=0;w<o;w++){const e=w<a?l:c;d[w]=p.slice(u,u+e),h[w]=C.encode(d[w]),u+=e,m=Math.max(m,e)}const f=new Uint8Array(A);let b,B,y=0;for(b=0;b<m;b++)for(B=0;B<o;B++)b<d[B].length&&(f[y++]=d[B][b]);for(b=0;b<I;b++)for(B=0;B<o;B++)f[y++]=h[B][b];return f}(A,e,t)}function Fk(e,t,n,A){let r;if(Array.isArray(e))r=Nk.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let A=t;if(!A){const t=Nk.rawSplit(e);A=Gk.getBestVersionForData(t,n)}r=Nk.fromString(e,A||40)}}const i=Gk.getBestVersionForData(r,n);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<i)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+i+".\n")}else t=i;const o=Wk(t,n,r),s=pk.getSymbolSize(t),a=new Bk(s);return function(e,t){const n=e.size,A=wk.getPositions(t);for(let r=0;r<A.length;r++){const t=A[r][0],i=A[r][1];for(let A=-1;A<=7;A++)if(!(t+A<=-1||n<=t+A))for(let r=-1;r<=7;r++)i+r<=-1||n<=i+r||(A>=0&&A<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===A||6===A)||A>=2&&A<=4&&r>=2&&r<=4?e.set(t+A,i+r,!0,!0):e.set(t+A,i+r,!1,!0))}}(a,t),function(e){const t=e.size;for(let n=8;n<t-8;n++){const t=n%2==0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(a),function(e,t){const n=yk.getPositions(t);for(let A=0;A<n.length;A++){const t=n[A][0],r=n[A][1];for(let n=-2;n<=2;n++)for(let A=-2;A<=2;A++)-2===n||2===n||-2===A||2===A||0===n&&0===A?e.set(t+n,r+A,!0,!0):e.set(t+n,r+A,!1,!0)}}(a,t),kk(a,n,0),t>=7&&function(e,t){const n=e.size,A=Gk.getEncodedBits(t);let r,i,o;for(let s=0;s<18;s++)r=Math.floor(s/3),i=s%3+n-8-3,o=1==(A>>s&1),e.set(r,i,o,!0),e.set(i,r,o,!0)}(a,t),function(e,t){const n=e.size;let A=-1,r=n-1,i=7,o=0;for(let s=n-1;s>0;s-=2)for(6===s&&s--;;){for(let n=0;n<2;n++)if(!e.isReserved(r,s-n)){let A=!1;o<t.length&&(A=1==(t[o]>>>i&1)),e.set(r,s-n,A),i--,-1===i&&(o++,i=7)}if(r+=A,r<0||n<=r){r-=A,A=-A;break}}}(a,o),isNaN(A)&&(A=Zk.getBestMask(a,kk.bind(null,a,n))),Zk.applyMask(A,a),kk(a,n,A),{modules:a,version:t,errorCorrectionLevel:n,maskPattern:A,segments:r}}hN.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");let n,A,r=fk.M;return void 0!==t&&(r=fk.from(t.errorCorrectionLevel,fk.M),n=Gk.from(t.version),A=Zk.from(t.maskPattern),t.toSJISFunc&&pk.setToSJISFunction(t.toSJISFunc)),Fk(e,n,r,A)};var Ek={},Xk={};!function(e){function t(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}e.getOptions=function(e){e||(e={}),e.color||(e.color={});const n=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,A=e.width&&e.width>=21?e.width:void 0,r=e.scale||4;return{width:A,scale:A?4:r,margin:n,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},e.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},e.getImageWidth=function(t,n){const A=e.getScale(t,n);return Math.floor((t+2*n.margin)*A)},e.qrToImageData=function(t,n,A){const r=n.modules.size,i=n.modules.data,o=e.getScale(r,A),s=Math.floor((r+2*A.margin)*o),a=A.margin*o,g=[A.color.light,A.color.dark];for(let e=0;e<s;e++)for(let n=0;n<s;n++){let l=4*(e*s+n),c=A.color.light;if(e>=a&&n>=a&&e<s-a&&n<s-a){c=g[i[Math.floor((e-a)/o)*r+Math.floor((n-a)/o)]?1:0]}t[l++]=c.r,t[l++]=c.g,t[l++]=c.b,t[l]=c.a}}}(Xk),function(e){const t=Xk;e.render=function(e,n,A){let r=A,i=n;void 0!==r||n&&n.getContext||(r=n,n=void 0),n||(i=function(){try{return document.createElement("canvas")}catch(Zf){throw new Error("You need to specify a canvas element")}}()),r=t.getOptions(r);const o=t.getImageWidth(e.modules.size,r),s=i.getContext("2d"),a=s.createImageData(o,o);return t.qrToImageData(a.data,e,r),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(s,i,o),s.putImageData(a,0,0),i},e.renderToDataURL=function(t,n,A){let r=A;void 0!==r||n&&n.getContext||(r=n,n=void 0),r||(r={});const i=e.render(t,n,r),o=r.type||"image/png",s=r.rendererOpts||{};return i.toDataURL(o,s.quality)}}(Ek);var Hk={};const xk=Xk;function Jk(e,t){const n=e.a/255,A=t+'="'+e.hex+'"';return n<1?A+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':A}function Yk(e,t,n){let A=e+t;return void 0!==n&&(A+=" "+n),A}Hk.render=function(e,t,n){const A=xk.getOptions(t),r=e.modules.size,i=e.modules.data,o=r+2*A.margin,s=A.color.light.a?"<path "+Jk(A.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",a="<path "+Jk(A.color.dark,"stroke")+' d="'+function(e,t,n){let A="",r=0,i=!1,o=0;for(let s=0;s<e.length;s++){const a=Math.floor(s%t),g=Math.floor(s/t);a||i||(i=!0),e[s]?(o++,s>0&&a>0&&e[s-1]||(A+=i?Yk("M",a+n,.5+g+n):Yk("m",r,0),r=0,i=!1),a+1<t&&e[s+1]||(A+=Yk("h",o),o=0)):r++}return A}(i,r,A.margin)+'"/>',g='viewBox="0 0 '+o+" "+o+'"',l='<svg xmlns="http://www.w3.org/2000/svg" '+(A.width?'width="'+A.width+'" height="'+A.width+'" ':"")+g+' shape-rendering="crispEdges">'+s+a+"</svg>\n";return"function"==typeof n&&n(null,l),l};const Uk=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},Lk=hN,Tk=Ek,Kk=Hk;function Mk(e,t,n,A,r){const i=[].slice.call(arguments,1),o=i.length,s="function"==typeof i[o-1];if(!s&&!Uk())throw new Error("Callback required as last argument");if(!s){if(o<1)throw new Error("Too few arguments provided");return 1===o?(n=t,t=A=void 0):2!==o||t.getContext||(A=n,n=t,t=void 0),new Promise((function(r,i){try{const i=Lk.create(n,A);r(e(i,t,A))}catch(Zf){i(Zf)}}))}if(o<2)throw new Error("Too few arguments provided");2===o?(r=n,n=t,t=A=void 0):3===o&&(t.getContext&&void 0===r?(r=A,A=void 0):(r=A,A=n,n=t,t=void 0));try{const i=Lk.create(n,A);r(null,e(i,t,A))}catch(Zf){r(Zf)}}dN.create=Lk.create,dN.toCanvas=Mk.bind(null,Tk.render),dN.toDataURL=Mk.bind(null,Tk.renderToDataURL),dN.toString=Mk.bind(null,(function(e,t,n){return Kk.render(e,n)}));const Qk={async generateQRCodeDataURL(e,t={}){try{const n={...{width:200,margin:1,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"H"},...t};return await dN.toDataURL(e,n)}catch(PWe){throw PWe}}},Dk={async generateTablesPDF(){try{const e=new nB({orientation:"landscape",unit:"mm",format:"a4"}),t=e.internal.pageSize.getWidth(),n=e.internal.pageSize.getHeight();for(let A=0;A<Te.tables.length;A++){A>0&&e.addPage();const r=Te.tables[A],i=await this.renderTablePage(r,A),o=(await cN(i,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"})).toDataURL("image/png");e.addImage(o,"PNG",0,0,t,n),document.body.removeChild(i)}return e.output("blob")}catch(PWe){throw PWe}},async renderTablePage(e,t){const n=document.createElement("div");n.id=`table-page-${t}`,n.style.width="297mm",n.style.height="210mm",n.style.position="absolute",n.style.left="-9999px",n.style.backgroundColor="#ffffff",n.style.fontFamily="'Montserrat', sans-serif",document.body.appendChild(n);const A=`${window.location.origin}/table/${e.name.toLowerCase().replace(/\s+/g,"-")}`;try{const t=await Qk.generateQRCodeDataURL(A,{color:{dark:e.color,light:"#FFFFFF"}});n.innerHTML=`\n        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 20mm;">\n          \x3c!-- Titre de la table --\x3e\n          <h1 style="font-size: 60px; color: ${e.color}; margin-bottom: 15mm; font-weight: bold; text-align: center;">Table ${e.name}</h1>\n          \n          \x3c!-- QR Code --\x3e\n          <div style="margin-bottom: 15mm; padding: 10px; background-color: white; border-radius: 10px; border: 4px solid ${e.color};">\n            <img src="${t}" alt="QR Code Table ${e.name}" style="width: 200px; height: 200px;" />\n          </div>\n          \n          \x3c!-- Liste des invités --\x3e\n          <div style="color: ${e.color}; font-size: 16px; text-align: center;">\n            <p style="margin-bottom: 5mm; font-size: 18px; font-weight: bold;">Invités à cette table:</p>\n            <ul style="list-style: none; padding: 0; margin: 0; columns: 2;">\n              ${e.invites.map((e=>`<li style="margin-bottom: 3mm;">${e.name} (${e.count})</li>`)).join("")}\n            </ul>\n          </div>\n        </div>\n      `}catch(PWe){n.innerHTML=`\n        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 20mm;">\n          \x3c!-- Titre de la table --\x3e\n          <h1 style="font-size: 60px; color: ${e.color}; margin-bottom: 15mm; font-weight: bold; text-align: center;">Table ${e.name}</h1>\n          \n          \x3c!-- Fallback au lieu du QR Code --\x3e\n          <div style="margin-bottom: 15mm; padding: 10px; background-color: white; border-radius: 10px; border: 4px solid ${e.color};">\n            <div style="width: 200px; height: 200px; display: flex; align-items: center; justify-content: center; background-color: #f8f8f8; color: ${e.color}; font-size: 14px; text-align: center;">\n              <p>QR Code non disponible</p>\n            </div>\n          </div>\n          \n          \x3c!-- Liste des invités --\x3e\n          <div style="color: ${e.color}; font-size: 16px; text-align: center;">\n            <p style="margin-bottom: 5mm; font-size: 18px; font-weight: bold;">Invités à cette table:</p>\n            <ul style="list-style: none; padding: 0; margin: 0; columns: 2;">\n              ${e.invites.map((e=>`<li style="margin-bottom: 3mm;">${e.name} (${e.count})</li>`)).join("")}\n            </ul>\n          </div>\n        </div>\n      `}return await new Promise((e=>setTimeout(e,500))),n}},zk=({className:t=""})=>{const[n,A]=e.useState(!1),[r,i]=e.useState(null);return f.jsx("div",{className:t,children:f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx(je,{variant:"primary",onClick:async()=>{A(!0),i(null);try{const e=await Dk.generateTablesPDF(),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`tables-mariage-${Te.couple.groom.split(" ")[0]}-${Te.couple.bride.split(" ")[0]}.pdf`,document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout((()=>URL.revokeObjectURL(t)),100)}catch(e){i("Une erreur est survenue lors de la génération du PDF. Veuillez réessayer.")}finally{A(!1)}},disabled:n,className:"flex items-center justify-center gap-2",children:n?f.jsxs(f.Fragment,{children:[f.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Génération en cours..."]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Générer PDF des tables avec QR codes"]})}),r&&f.jsx("div",{className:"text-danger text-sm mt-1",children:r}),f.jsxs("div",{className:"text-sm text-muted",children:[f.jsxs("p",{children:["Ce PDF contient ",Te.tables.length," pages, une pour chaque table."]}),f.jsx("p",{children:"Chaque page comprend le nom de la table, un QR code unique et la liste des invités."})]})]})})};zk.propTypes={className:De.string};const Ok=()=>{const[t,n]=e.useState(""),[A,r]=e.useState(""),[i,o]=e.useState([]),[s,a]=e.useState({totalGuests:0,totalPeople:0,sharedInvitations:0,scannedGuests:0}),[g,l]=e.useState([]),[c,I]=e.useState(!0),[C,u]=e.useState(!1),[d,h]=e.useState(null),[m,p]=e.useState([]);e.useEffect((()=>{(async()=>{I(!0);try{let e=await Gf.getAllGuests();0===e.length&&(await Gf.syncGuestsFromLocal(Le),e=await Gf.getAllGuests());const t=e.map((e=>{const t=e.id.split("_")[0],n=Te.tables.find((e=>e.name.toLowerCase()===t.toLowerCase()));return{...e,tableName:n?n.name:"Table inconnue",tableColor:n?n.color:"#4CAF50"}})),n=t.length,A=t.reduce(((e,t)=>e+t.count),0),r=t.filter((e=>e.scanned)).length;a({totalGuests:n,totalPeople:A,sharedInvitations:0,scannedGuests:r}),p(t),o(t)}catch(PWe){const t=[];Object.entries(Le).forEach((([e,n])=>{n.forEach((n=>{const A=Gf.generateGuestId(e,n.name).split("_")[0],r=Te.tables.find((e=>e.name.toLowerCase()===A.toLowerCase()));t.push({...n,group:e,tableName:r?r.name:"Table inconnue",tableColor:r?r.color:"#4CAF50"})}))})),o(t),p(t)}finally{I(!1)}})()}),[]),e.useEffect((()=>{if(0===m.length)return;const e=m.filter((e=>{const n=!A||e.group===A,r=e.name.toLowerCase().includes(t.toLowerCase())||e.group.toLowerCase().includes(t.toLowerCase());return n&&r}));o(e)}),[t,A,m]);const b=(e,t)=>{if(!g.some((n=>n.name===e.name&&n.group===t))){const n=[...g,{...e,group:t}];l(n),a((e=>({...e,sharedInvitations:e.sharedInvitations+1})))}},B=async e=>{I(!0);try{await Gf.deleteGuest(e.id),p((t=>t.filter((t=>t.id!==e.id)))),a((t=>({...t,totalGuests:t.totalGuests-1,totalPeople:t.totalPeople-e.count,scannedGuests:e.scanned?t.scannedGuests-1:t.scannedGuests})))}catch(PWe){alert("Erreur lors de la suppression. Veuillez réessayer.")}finally{I(!1)}},y=e=>{h(e),u(!0)},w=Object.keys(Le);return f.jsxs("div",{className:"bg-secondary min-h-screen pb-10",children:[f.jsx("header",{className:"bg-primary text-white py-6 sm:py-8 px-3 sm:px-4",children:f.jsx("div",{className:"max-w-7xl mx-auto",children:f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"font-elegant text-2xl sm:text-3xl",children:"Gestion des Invités"}),f.jsx("p",{className:"text-white/70 mt-1 sm:mt-2 text-sm sm:text-base",children:"Gérez les invitations pour le mariage de Fiston Zaka et Vino Banza"})]}),f.jsx("div",{className:"w-full sm:w-auto",children:f.jsxs("a",{href:"/qr-scanner",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 bg-white text-primary rounded-md shadow hover:bg-primary/10 transition-colors",children:[f.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Scanner les QR codes"]})})]})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 -mt-4 sm:-mt-6",children:f.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[f.jsx(Pk,{title:"Total des invités",value:s.totalGuests,icon:f.jsx("svg",{className:"w-6 sm:w-8 h-6 sm:h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),f.jsx(Pk,{title:"Total des personnes",value:s.totalPeople,icon:f.jsx("svg",{className:"w-6 sm:w-8 h-6 sm:h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),f.jsx(Pk,{title:"Invitations partagées",value:s.sharedInvitations,percentage:Math.round(s.sharedInvitations/s.totalGuests*100),icon:f.jsx("svg",{className:"w-6 sm:w-8 h-6 sm:h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),f.jsx(Pk,{title:"Invités scannés",value:s.scannedGuests,percentage:Math.round(s.scannedGuests/s.totalGuests*100),icon:f.jsx("svg",{className:"w-6 sm:w-8 h-6 sm:h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})})]})}),f.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 mt-6",children:f.jsx(Nt,{variant:"elegant",className:"p-4",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h2",{className:"font-elegant text-xl text-primary-dark mb-2",children:"Plans de tables avec QR codes"}),f.jsx("p",{className:"text-muted text-sm",children:"Générez un PDF contenant une page par table avec le nom de la table, un QR code et la liste des invités. Idéal pour imprimer les plans de table pour le jour J."})]}),f.jsx(zk,{})]})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 mt-6 sm:mt-8",children:f.jsx(Nt,{variant:"default",className:"p-3 sm:p-4",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-3 sm:gap-4",children:[f.jsx("div",{className:"flex-grow",children:f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx("svg",{className:"w-5 h-5 text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),f.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark placeholder-muted",placeholder:"Rechercher un invité...",value:t,onChange:e=>n(e.target.value)})]})}),f.jsx("div",{className:"w-full md:w-1/4",children:f.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",value:A,onChange:e=>r(e.target.value),children:[f.jsx("option",{value:"",children:"Tous les groupes"}),w.map((e=>f.jsx("option",{value:e,children:e},e)))]})}),f.jsx("div",{className:"w-full md:w-auto",children:f.jsx(je,{variant:"primary",className:"w-full md:w-auto",onClick:()=>{h(null),u(!0)},icon:f.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),children:"Ajouter un invité"})})]})})}),C&&f.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 mt-6",children:f.jsx(Wt,{guest:d,groups:w,onSubmit:d?async e=>{I(!0);try{await Gf.updateGuest(e.id,e),p((t=>t.map((t=>t.id===e.id?e:t)))),u(!1),h(null)}catch(PWe){alert("Erreur lors de la modification. Veuillez réessayer.")}finally{I(!1)}}:async e=>{I(!0);try{const t=await Gf.addGuest(e);p((e=>[...e,t])),a((t=>({...t,totalGuests:t.totalGuests+1,totalPeople:t.totalPeople+e.count}))),u(!1),h(null)}catch(PWe){alert("Erreur lors de l'ajout de l'invité. Veuillez réessayer.")}finally{I(!1)}},onCancel:()=>{h(null),u(!1)}})}),f.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 mt-6",children:[f.jsxs("h2",{className:"font-elegant text-xl sm:text-2xl text-primary-dark mb-3 sm:mb-4",children:[i.length," ",i.length>1?"invités trouvés":"invité trouvé"]}),f.jsx("div",{className:"space-y-3 sm:space-y-4",children:c?f.jsx(Nt,{variant:"flat",className:"p-6 sm:p-8 text-center",children:f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsxs("svg",{className:"animate-spin h-8 w-8 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f.jsx("p",{className:"ml-3 text-muted",children:"Chargement des invités..."})]})}):f.jsxs(f.Fragment,{children:[i.map(((e,t)=>f.jsx(kt,{guest:e,group:e.group,onShare:b,onEdit:y,onDelete:B},`${e.group}-${e.name}-${t}`))),0===i.length&&f.jsx(Nt,{variant:"flat",className:"p-6 sm:p-8 text-center",children:f.jsxs("div",{className:"text-muted",children:[f.jsx("svg",{className:"w-10 sm:w-12 h-10 sm:h-12 mx-auto mb-3 sm:mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),f.jsx("p",{className:"text-lg font-elegant",children:"Aucun invité ne correspond à votre recherche"})]})})]})})]})]})},Pk=({title:e,value:t,percentage:n,icon:A})=>f.jsx(Nt,{variant:"elegant",className:"transform hover:-translate-y-1 transition-transform duration-300",children:f.jsx(Nt.Body,{className:"p-3 sm:p-5",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"mr-3 sm:mr-4 bg-primary/10 p-2 sm:p-3 rounded-full",children:A}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm sm:text-lg font-medium text-primary-dark",children:e}),f.jsxs("div",{className:"flex items-end",children:[f.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-primary-dark",children:t}),void 0!==n&&f.jsxs("span",{className:"ml-1 sm:ml-2 text-xs sm:text-sm text-primary/80 mb-1",children:["(",n,"%)"]})]})]})]})})});Pk.propTypes={title:De.string.isRequired,value:De.number.isRequired,percentage:De.number,icon:De.node.isRequired};const _k=()=>{const[t,n]=e.useState("");return e.useEffect((()=>{document.title=`Mariage de ${Te.couple.groom} & ${Te.couple.bride} - ${Te.event.date}`;const e=document.querySelector('meta[name="description"]');e&&e.setAttribute("content",`Nous avons l'immense joie de vous convier au mariage de ${Te.couple.groom} & ${Te.couple.bride} qui aura lieu le ${Te.event.date} à ${Te.event.venue}.`);const t=localStorage.getItem("authMessage");if(t){n(t),localStorage.removeItem("authMessage");const e=setTimeout((()=>{n("")}),5e3);return()=>clearTimeout(e)}}),[]),f.jsxs("div",{className:"min-h-screen flex flex-col bg-secondary",children:[t&&f.jsx("div",{className:"fixed top-4 left-0 right-0 mx-auto max-w-md z-50 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded shadow-lg animate-fadeIn",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"py-1",children:f.jsx("svg",{className:"w-6 h-6 mr-4 fill-current text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"})})}),f.jsx("div",{children:f.jsx("p",{className:"text-sm",children:t})})]})}),f.jsxs("header",{className:"relative h-80 sm:h-96 bg-primary/10 overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-floral-pattern opacity-20"}),f.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4",children:[f.jsx(qe,{animation:"fade-down",delay:100,children:f.jsx("h1",{className:"text-primary font-elegant text-3xl sm:text-4xl md:text-5xl text-center",children:"Mariage de"})}),f.jsx(qe,{animation:"fade-up",delay:300,children:f.jsxs("div",{className:"mt-6 sm:mt-8 relative w-full px-4 max-w-4xl mx-auto",children:[f.jsxs("div",{className:"names-container flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-6 flex-wrap",children:[f.jsx("span",{className:"font-cursive text-4xl sm:text-5xl md:text-6xl text-primary text-center break-words",children:Te.couple.groom}),f.jsx("div",{className:"wedding-ampersand my-2 sm:my-0",children:f.jsx("span",{className:"wedding-symbol text-3xl sm:text-4xl md:text-5xl text-gradient",children:"&"})}),f.jsx("span",{className:"font-cursive text-4xl sm:text-5xl md:text-6xl text-primary text-center break-words",children:Te.couple.bride})]}),f.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-primary/40 to-transparent"})]})}),f.jsx(qe,{animation:"fade-up",delay:500,children:f.jsx("p",{className:"mt-8 text-muted font-sans text-lg sm:text-xl border-t border-primary/10 pt-4 px-6 rounded-full bg-white/30 shadow-sm",children:Te.event.date})})]})]}),f.jsxs("main",{className:"flex-1 px-4 py-10 max-w-4xl mx-auto",children:[f.jsx(qe,{className:"mb-8 text-center",delay:100,children:f.jsxs("div",{className:"glass-card p-6 sm:p-8 rounded-xl",children:[f.jsx("h2",{className:"font-elegant text-2xl sm:text-3xl text-primary-dark mb-4",children:"Notre invitation"}),f.jsx("p",{className:"text-muted mb-4 max-w-2xl mx-auto",children:Te.welcomeMessage}),f.jsx("p",{className:"text-sm text-primary-dark/70 italic",children:"Veuillez utiliser votre lien d'invitation personnalisé pour accéder à tous les détails."})]})}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8",children:[f.jsx(qe,{animation:"fade-right",delay:200,children:f.jsxs("div",{className:"card p-5 sm:p-7 hover:shadow-lg transition-shadow",children:[f.jsx("h3",{className:"font-elegant text-xl text-primary-dark mb-3",children:"Date & Horaire"}),f.jsxs("p",{className:"text-muted",children:["Le ",Te.event.date," à ",Te.event.time]}),f.jsx("div",{className:"mt-3 bg-accent/10 rounded-lg p-3 text-sm text-center text-accent border-l-2 border-accent",children:f.jsx("span",{className:"font-medium",children:"Accueil des invités à partir de 19h"})})]})}),f.jsx(qe,{animation:"fade-left",delay:300,children:f.jsxs("div",{className:"card p-5 sm:p-7 hover:shadow-lg transition-shadow",children:[f.jsx("h3",{className:"font-elegant text-xl text-primary-dark mb-3",children:"Lieu"}),f.jsxs("p",{className:"text-muted",children:[Te.event.venue,f.jsx("br",{}),Te.event.address,f.jsx("br",{}),Te.event.location]})]})})]}),f.jsx(qe,{animation:"zoom-in",delay:400,children:f.jsxs("div",{className:"text-center mt-8 mb-12 glass-card p-6 sm:p-8 rounded-xl",children:[f.jsx("h2",{className:"font-elegant text-2xl sm:text-3xl text-primary-dark mb-4",children:"Comment accéder à votre invitation personnalisée"}),f.jsx("p",{className:"text-muted mb-6",children:"L'invitation complète est accessible uniquement via le lien personnalisé qui vous a été envoyé. Si vous ne l'avez pas reçu, veuillez contacter les mariés."}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[f.jsx(He,{to:"/admin-login",className:"px-6 py-3 bg-primary text-white rounded-lg shadow-elegant hover:bg-primary-dark transition-all transform hover:-translate-y-1",children:"Accéder à l'administration"}),f.jsxs("a",{href:"https://wa.me/243899895733",target:"_blank",rel:"noopener noreferrer",className:"px-6 py-3 bg-white text-primary-dark border border-primary/20 rounded-lg shadow-elegant hover:bg-highlight transition-all transform hover:-translate-y-1 flex items-center justify-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"})}),"Contacter les mariés via WhatsApp"]})]})]})})]}),f.jsxs("footer",{className:"bg-primary text-white py-8 px-4 text-center",children:[f.jsx("div",{className:"mb-4",children:f.jsx(qe,{animation:"fade-up",children:f.jsxs("div",{className:"flex items-center justify-center gap-3 flex-wrap",children:[f.jsx("span",{className:"font-cursive text-2xl",children:Te.couple.groom}),f.jsx("span",{className:"text-xl",children:"&"}),f.jsx("span",{className:"font-cursive text-2xl",children:Te.couple.bride})]})})}),f.jsx("p",{className:"text-sm text-white/70",children:"Nous nous réjouissons de célébrer ce jour spécial avec vous"}),f.jsxs("div",{className:"mt-6 text-xs text-white/50",children:[f.jsxs("p",{children:["© ",(new Date).getFullYear()," - Tous droits réservés"]}),f.jsxs("p",{className:"mt-1",children:["Développé par Criho James,"," ",f.jsx("a",{href:"https://www.criho.tech",target:"_blank",rel:"noopener noreferrer",className:"hover:text-white transition-colors duration-300",children:"@https://www.criho.tech"})]})]})]}),f.jsx("style",{children:"\n        .text-gradient {\n          background-image: linear-gradient(to right, var(--color-primary), var(--color-accent));\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n        }\n        .wedding-symbol {\n          display: inline-block;\n        }\n        .shadow-elegant {\n          box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);\n        }\n        \n        /* Animation pour les messages d'alerte */\n        @keyframes fadeIn {\n          from { opacity: 0; transform: translateY(-20px); }\n          to { opacity: 1; transform: translateY(0); }\n        }\n        .animate-fadeIn {\n          animation: fadeIn 0.3s ease-in-out;\n        }\n      "})]})};var jk={exports:{}};var qk={exports:{}};const $k=i(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var eW;function tW(){return eW||(eW=1,qk.exports=(e=e||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==o&&o.crypto&&(n=o.crypto),!n)try{n=$k}catch(h){}var A=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(h){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(h){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},s=i.lib={},a=s.Base=function(){return{extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=s.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,A=this.sigBytes,r=e.sigBytes;if(this.clamp(),A%4)for(var i=0;i<r;i++){var o=n[i>>>2]>>>24-i%4*8&255;t[A+i>>>2]|=o<<24-(A+i)%4*8}else for(var s=0;s<r;s+=4)t[A+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(A());return new g.init(t,e)}}),l=i.enc={},c=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,A=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;A.push((i>>>4).toString(16)),A.push((15&i).toString(16))}return A.join("")},parse:function(e){for(var t=e.length,n=[],A=0;A<t;A+=2)n[A>>>3]|=parseInt(e.substr(A,2),16)<<24-A%8*4;return new g.init(n,t/2)}},I=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,A=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;A.push(String.fromCharCode(i))}return A.join("")},parse:function(e){for(var t=e.length,n=[],A=0;A<t;A++)n[A>>>2]|=(255&e.charCodeAt(A))<<24-A%4*8;return new g.init(n,t)}},C=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(I.stringify(e)))}catch(Zf){throw new Error("Malformed UTF-8 data")}},parse:function(e){return I.parse(unescape(encodeURIComponent(e)))}},u=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=C.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,A=this._data,r=A.words,i=A.sigBytes,o=this.blockSize,s=i/(4*o),a=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,l=e.min(4*a,i);if(a){for(var c=0;c<a;c+=o)this._doProcessBlock(r,c);n=r.splice(0,a),A.sigBytes-=l}return new g.init(n,l)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=u.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}});var d=i.algo={};return i}(Math),e)),qk.exports;var e}var nW,AW={exports:{}};function rW(){return nW||(nW=1,AW.exports=(o=tW(),n=(t=o).lib,A=n.Base,r=n.WordArray,(i=t.x64={}).Word=A.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=A.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:8*t.length},toX32:function(){for(var e=this.words,t=e.length,n=[],A=0;A<t;A++){var i=e[A];n.push(i.high),n.push(i.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=A.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),o)),AW.exports;var e,t,n,A,r,i,o}var iW,oW={exports:{}};function sW(){return iW||(iW=1,oW.exports=(e=tW(),function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init,A=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,A=[],r=0;r<t;r++)A[r>>>2]|=e[r]<<24-r%4*8;n.call(this,A,t)}else n.apply(this,arguments)};A.prototype=t}}(),e.lib.WordArray)),oW.exports;var e}var aW,gW={exports:{}};function lW(){return aW||(aW=1,gW.exports=(e=tW(),function(){var t=e,n=t.lib.WordArray,A=t.enc;function r(e){return e<<8&4278255360|e>>>8&16711935}A.Utf16=A.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,A=[],r=0;r<n;r+=2){var i=t[r>>>2]>>>16-r%4*8&65535;A.push(String.fromCharCode(i))}return A.join("")},parse:function(e){for(var t=e.length,A=[],r=0;r<t;r++)A[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return n.create(A,2*t)}},A.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,A=[],i=0;i<n;i+=2){var o=r(t[i>>>2]>>>16-i%4*8&65535);A.push(String.fromCharCode(o))}return A.join("")},parse:function(e){for(var t=e.length,A=[],i=0;i<t;i++)A[i>>>1]|=r(e.charCodeAt(i)<<16-i%2*16);return n.create(A,2*t)}}}(),e.enc.Utf16)),gW.exports;var e}var cW,IW={exports:{}};function CW(){return cW||(cW=1,IW.exports=(e=tW(),function(){var t=e,n=t.lib.WordArray;function A(e,t,A){for(var r=[],i=0,o=0;o<t;o++)if(o%4){var s=A[e.charCodeAt(o-1)]<<o%4*2|A[e.charCodeAt(o)]>>>6-o%4*2;r[i>>>2]|=s<<24-i%4*8,i++}return n.create(r,i)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,A=this._map;e.clamp();for(var r=[],i=0;i<n;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)r.push(A.charAt(o>>>6*(3-s)&63));var a=A.charAt(64);if(a)for(;r.length%4;)r.push(a);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var o=n.charAt(64);if(o){var s=e.indexOf(o);-1!==s&&(t=s)}return A(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)),IW.exports;var e}var uW,dW={exports:{}};function hW(){return uW||(uW=1,dW.exports=(e=tW(),function(){var t=e,n=t.lib.WordArray;function A(e,t,A){for(var r=[],i=0,o=0;o<t;o++)if(o%4){var s=A[e.charCodeAt(o-1)]<<o%4*2|A[e.charCodeAt(o)]>>>6-o%4*2;r[i>>>2]|=s<<24-i%4*8,i++}return n.create(r,i)}t.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var n=e.words,A=e.sigBytes,r=t?this._safe_map:this._map;e.clamp();for(var i=[],o=0;o<A;o+=3)for(var s=(n[o>>>2]>>>24-o%4*8&255)<<16|(n[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|n[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<A;a++)i.push(r.charAt(s>>>6*(3-a)&63));var g=r.charAt(64);if(g)for(;i.length%4;)i.push(g);return i.join("")},parse:function(e,t){void 0===t&&(t=!0);var n=e.length,r=t?this._safe_map:this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<r.length;o++)i[r.charCodeAt(o)]=o}var s=r.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(n=a)}return A(e,n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url)),dW.exports;var e}var mW,pW={exports:{}};function fW(){return mW||(mW=1,pW.exports=(e=tW(),function(t){var n=e,A=n.lib,r=A.WordArray,i=A.Hasher,o=n.algo,s=[];!function(){for(var e=0;e<64;e++)s[e]=4294967296*t.abs(t.sin(e+1))|0}();var a=o.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var A=t+n,r=e[A];e[A]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i=this._hash.words,o=e[t+0],a=e[t+1],C=e[t+2],u=e[t+3],d=e[t+4],h=e[t+5],m=e[t+6],p=e[t+7],f=e[t+8],b=e[t+9],B=e[t+10],y=e[t+11],w=e[t+12],Z=e[t+13],S=e[t+14],v=e[t+15],G=i[0],R=i[1],V=i[2],N=i[3];G=g(G,R,V,N,o,7,s[0]),N=g(N,G,R,V,a,12,s[1]),V=g(V,N,G,R,C,17,s[2]),R=g(R,V,N,G,u,22,s[3]),G=g(G,R,V,N,d,7,s[4]),N=g(N,G,R,V,h,12,s[5]),V=g(V,N,G,R,m,17,s[6]),R=g(R,V,N,G,p,22,s[7]),G=g(G,R,V,N,f,7,s[8]),N=g(N,G,R,V,b,12,s[9]),V=g(V,N,G,R,B,17,s[10]),R=g(R,V,N,G,y,22,s[11]),G=g(G,R,V,N,w,7,s[12]),N=g(N,G,R,V,Z,12,s[13]),V=g(V,N,G,R,S,17,s[14]),G=l(G,R=g(R,V,N,G,v,22,s[15]),V,N,a,5,s[16]),N=l(N,G,R,V,m,9,s[17]),V=l(V,N,G,R,y,14,s[18]),R=l(R,V,N,G,o,20,s[19]),G=l(G,R,V,N,h,5,s[20]),N=l(N,G,R,V,B,9,s[21]),V=l(V,N,G,R,v,14,s[22]),R=l(R,V,N,G,d,20,s[23]),G=l(G,R,V,N,b,5,s[24]),N=l(N,G,R,V,S,9,s[25]),V=l(V,N,G,R,u,14,s[26]),R=l(R,V,N,G,f,20,s[27]),G=l(G,R,V,N,Z,5,s[28]),N=l(N,G,R,V,C,9,s[29]),V=l(V,N,G,R,p,14,s[30]),G=c(G,R=l(R,V,N,G,w,20,s[31]),V,N,h,4,s[32]),N=c(N,G,R,V,f,11,s[33]),V=c(V,N,G,R,y,16,s[34]),R=c(R,V,N,G,S,23,s[35]),G=c(G,R,V,N,a,4,s[36]),N=c(N,G,R,V,d,11,s[37]),V=c(V,N,G,R,p,16,s[38]),R=c(R,V,N,G,B,23,s[39]),G=c(G,R,V,N,Z,4,s[40]),N=c(N,G,R,V,o,11,s[41]),V=c(V,N,G,R,u,16,s[42]),R=c(R,V,N,G,m,23,s[43]),G=c(G,R,V,N,b,4,s[44]),N=c(N,G,R,V,w,11,s[45]),V=c(V,N,G,R,v,16,s[46]),G=I(G,R=c(R,V,N,G,C,23,s[47]),V,N,o,6,s[48]),N=I(N,G,R,V,p,10,s[49]),V=I(V,N,G,R,S,15,s[50]),R=I(R,V,N,G,h,21,s[51]),G=I(G,R,V,N,w,6,s[52]),N=I(N,G,R,V,u,10,s[53]),V=I(V,N,G,R,B,15,s[54]),R=I(R,V,N,G,a,21,s[55]),G=I(G,R,V,N,f,6,s[56]),N=I(N,G,R,V,v,10,s[57]),V=I(V,N,G,R,m,15,s[58]),R=I(R,V,N,G,Z,21,s[59]),G=I(G,R,V,N,d,6,s[60]),N=I(N,G,R,V,y,10,s[61]),V=I(V,N,G,R,C,15,s[62]),R=I(R,V,N,G,b,21,s[63]),i[0]=i[0]+G|0,i[1]=i[1]+R|0,i[2]=i[2]+V|0,i[3]=i[3]+N|0},_doFinalize:function(){var e=this._data,n=e.words,A=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var i=t.floor(A/4294967296),o=A;n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,a=s.words,g=0;g<4;g++){var l=a[g];a[g]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function g(e,t,n,A,r,i,o){var s=e+(t&n|~t&A)+r+o;return(s<<i|s>>>32-i)+t}function l(e,t,n,A,r,i,o){var s=e+(t&A|n&~A)+r+o;return(s<<i|s>>>32-i)+t}function c(e,t,n,A,r,i,o){var s=e+(t^n^A)+r+o;return(s<<i|s>>>32-i)+t}function I(e,t,n,A,r,i,o){var s=e+(n^(t|~A))+r+o;return(s<<i|s>>>32-i)+t}n.MD5=i._createHelper(a),n.HmacMD5=i._createHmacHelper(a)}(Math),e.MD5)),pW.exports;var e}var bW,BW={exports:{}};function yW(){return bW||(bW=1,BW.exports=(s=tW(),t=(e=s).lib,n=t.WordArray,A=t.Hasher,r=e.algo,i=[],o=r.SHA1=A.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,A=n[0],r=n[1],o=n[2],s=n[3],a=n[4],g=0;g<80;g++){if(g<16)i[g]=0|e[t+g];else{var l=i[g-3]^i[g-8]^i[g-14]^i[g-16];i[g]=l<<1|l>>>31}var c=(A<<5|A>>>27)+a+i[g];c+=g<20?1518500249+(r&o|~r&s):g<40?1859775393+(r^o^s):g<60?(r&o|r&s|o&s)-1894007588:(r^o^s)-899497514,a=s,s=o,o=r<<30|r>>>2,r=A,A=c}n[0]=n[0]+A|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,A=8*e.sigBytes;return t[A>>>5]|=128<<24-A%32,t[14+(A+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(A+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=A.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=A._createHelper(o),e.HmacSHA1=A._createHmacHelper(o),s.SHA1)),BW.exports;var e,t,n,A,r,i,o,s}var wW,ZW={exports:{}};function SW(){return wW||(wW=1,ZW.exports=(e=tW(),function(t){var n=e,A=n.lib,r=A.WordArray,i=A.Hasher,o=n.algo,s=[],a=[];!function(){function e(e){for(var n=t.sqrt(e),A=2;A<=n;A++)if(!(e%A))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var A=2,r=0;r<64;)e(A)&&(r<8&&(s[r]=n(t.pow(A,.5))),a[r]=n(t.pow(A,1/3)),r++),A++}();var g=[],l=o.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,A=n[0],r=n[1],i=n[2],o=n[3],s=n[4],l=n[5],c=n[6],I=n[7],C=0;C<64;C++){if(C<16)g[C]=0|e[t+C];else{var u=g[C-15],d=(u<<25|u>>>7)^(u<<14|u>>>18)^u>>>3,h=g[C-2],m=(h<<15|h>>>17)^(h<<13|h>>>19)^h>>>10;g[C]=d+g[C-7]+m+g[C-16]}var p=A&r^A&i^r&i,f=(A<<30|A>>>2)^(A<<19|A>>>13)^(A<<10|A>>>22),b=I+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&c)+a[C]+g[C];I=c,c=l,l=s,s=o+b|0,o=i,i=r,r=A,A=b+(f+p)|0}n[0]=n[0]+A|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+I|0},_doFinalize:function(){var e=this._data,n=e.words,A=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(A/4294967296),n[15+(r+64>>>9<<4)]=A,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=i._createHelper(l),n.HmacSHA256=i._createHmacHelper(l)}(Math),e.SHA256)),ZW.exports;var e}var vW,GW={exports:{}};var RW,VW={exports:{}};function NW(){return RW||(RW=1,VW.exports=(e=tW(),rW(),function(){var t=e,n=t.lib.Hasher,A=t.x64,r=A.Word,i=A.WordArray,o=t.algo;function s(){return r.create.apply(r,arguments)}var a=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],g=[];!function(){for(var e=0;e<80;e++)g[e]=s()}();var l=o.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,A=n[0],r=n[1],i=n[2],o=n[3],s=n[4],l=n[5],c=n[6],I=n[7],C=A.high,u=A.low,d=r.high,h=r.low,m=i.high,p=i.low,f=o.high,b=o.low,B=s.high,y=s.low,w=l.high,Z=l.low,S=c.high,v=c.low,G=I.high,R=I.low,V=C,N=u,k=d,W=h,F=m,E=p,X=f,H=b,x=B,J=y,Y=w,U=Z,L=S,T=v,K=G,M=R,Q=0;Q<80;Q++){var D,z,O=g[Q];if(Q<16)z=O.high=0|e[t+2*Q],D=O.low=0|e[t+2*Q+1];else{var P=g[Q-15],_=P.high,j=P.low,q=(_>>>1|j<<31)^(_>>>8|j<<24)^_>>>7,$=(j>>>1|_<<31)^(j>>>8|_<<24)^(j>>>7|_<<25),ee=g[Q-2],te=ee.high,ne=ee.low,Ae=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,re=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=g[Q-7],oe=ie.high,se=ie.low,ae=g[Q-16],ge=ae.high,le=ae.low;z=(z=(z=q+oe+((D=$+se)>>>0<$>>>0?1:0))+Ae+((D+=re)>>>0<re>>>0?1:0))+ge+((D+=le)>>>0<le>>>0?1:0),O.high=z,O.low=D}var ce,Ie=x&Y^~x&L,Ce=J&U^~J&T,ue=V&k^V&F^k&F,de=N&W^N&E^W&E,he=(V>>>28|N<<4)^(V<<30|N>>>2)^(V<<25|N>>>7),me=(N>>>28|V<<4)^(N<<30|V>>>2)^(N<<25|V>>>7),pe=(x>>>14|J<<18)^(x>>>18|J<<14)^(x<<23|J>>>9),fe=(J>>>14|x<<18)^(J>>>18|x<<14)^(J<<23|x>>>9),be=a[Q],Be=be.high,ye=be.low,we=K+pe+((ce=M+fe)>>>0<M>>>0?1:0),Ze=me+de;K=L,M=T,L=Y,T=U,Y=x,U=J,x=X+(we=(we=(we=we+Ie+((ce+=Ce)>>>0<Ce>>>0?1:0))+Be+((ce+=ye)>>>0<ye>>>0?1:0))+z+((ce+=D)>>>0<D>>>0?1:0))+((J=H+ce|0)>>>0<H>>>0?1:0)|0,X=F,H=E,F=k,E=W,k=V,W=N,V=we+(he+ue+(Ze>>>0<me>>>0?1:0))+((N=ce+Ze|0)>>>0<ce>>>0?1:0)|0}u=A.low=u+N,A.high=C+V+(u>>>0<N>>>0?1:0),h=r.low=h+W,r.high=d+k+(h>>>0<W>>>0?1:0),p=i.low=p+E,i.high=m+F+(p>>>0<E>>>0?1:0),b=o.low=b+H,o.high=f+X+(b>>>0<H>>>0?1:0),y=s.low=y+J,s.high=B+x+(y>>>0<J>>>0?1:0),Z=l.low=Z+U,l.high=w+Y+(Z>>>0<U>>>0?1:0),v=c.low=v+T,c.high=S+L+(v>>>0<T>>>0?1:0),R=I.low=R+M,I.high=G+K+(R>>>0<M>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,A=8*e.sigBytes;return t[A>>>5]|=128<<24-A%32,t[30+(A+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(A+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=n._createHelper(l),t.HmacSHA512=n._createHmacHelper(l)}(),e.SHA512)),VW.exports;var e}var kW,WW={exports:{}};var FW,EW={exports:{}};function XW(){return FW||(FW=1,EW.exports=(e=tW(),rW(),function(t){var n=e,A=n.lib,r=A.WordArray,i=A.Hasher,o=n.x64.Word,s=n.algo,a=[],g=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){a[e+5*t]=(n+1)*(n+2)/2%64;var A=(2*e+3*t)%5;e=t%5,t=A}for(e=0;e<5;e++)for(t=0;t<5;t++)g[e+5*t]=t+(2*e+3*t)%5*5;for(var r=1,i=0;i<24;i++){for(var s=0,c=0,I=0;I<7;I++){if(1&r){var C=(1<<I)-1;C<32?c^=1<<C:s^=1<<C-32}128&r?r=r<<1^113:r<<=1}l[i]=o.create(s,c)}}();var c=[];!function(){for(var e=0;e<25;e++)c[e]=o.create()}();var I=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,A=this.blockSize/2,r=0;r<A;r++){var i=e[t+2*r],o=e[t+2*r+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(R=n[r]).high^=o,R.low^=i}for(var s=0;s<24;s++){for(var I=0;I<5;I++){for(var C=0,u=0,d=0;d<5;d++)C^=(R=n[I+5*d]).high,u^=R.low;var h=c[I];h.high=C,h.low=u}for(I=0;I<5;I++){var m=c[(I+4)%5],p=c[(I+1)%5],f=p.high,b=p.low;for(C=m.high^(f<<1|b>>>31),u=m.low^(b<<1|f>>>31),d=0;d<5;d++)(R=n[I+5*d]).high^=C,R.low^=u}for(var B=1;B<25;B++){var y=(R=n[B]).high,w=R.low,Z=a[B];Z<32?(C=y<<Z|w>>>32-Z,u=w<<Z|y>>>32-Z):(C=w<<Z-32|y>>>64-Z,u=y<<Z-32|w>>>64-Z);var S=c[g[B]];S.high=C,S.low=u}var v=c[0],G=n[0];for(v.high=G.high,v.low=G.low,I=0;I<5;I++)for(d=0;d<5;d++){var R=n[B=I+5*d],V=c[B],N=c[(I+1)%5+5*d],k=c[(I+2)%5+5*d];R.high=V.high^~N.high&k.high,R.low=V.low^~N.low&k.low}R=n[0];var W=l[s];R.high^=W.high,R.low^=W.low}},_doFinalize:function(){var e=this._data,n=e.words;this._nDataBytes;var A=8*e.sigBytes,i=32*this.blockSize;n[A>>>5]|=1<<24-A%32,n[(t.ceil((A+1)/i)*i>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var o=this._state,s=this.cfg.outputLength/8,a=s/8,g=[],l=0;l<a;l++){var c=o[l],I=c.high,C=c.low;I=16711935&(I<<8|I>>>24)|4278255360&(I<<24|I>>>8),C=16711935&(C<<8|C>>>24)|4278255360&(C<<24|C>>>8),g.push(C),g.push(I)}return new r.init(g,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=i._createHelper(I),n.HmacSHA3=i._createHmacHelper(I)}(Math),e.SHA3)),EW.exports;var e}var HW,xW={exports:{}};var JW,YW={exports:{}};function UW(){return JW||(JW=1,YW.exports=(e=tW(),n=(t=e).lib.Base,A=t.enc.Utf8,void(t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=A.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),s=i.words,a=o.words,g=0;g<n;g++)s[g]^=1549556828,a[g]^=909522486;i.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))),YW.exports;var e,t,n,A}var LW,TW={exports:{}};var KW,MW={exports:{}};function QW(){return KW||(KW=1,MW.exports=(s=tW(),yW(),UW(),t=(e=s).lib,n=t.Base,A=t.WordArray,r=e.algo,i=r.MD5,o=r.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,i=r.hasher.create(),o=A.create(),s=o.words,a=r.keySize,g=r.iterations;s.length<a;){n&&i.update(n),n=i.update(e).finalize(t),i.reset();for(var l=1;l<g;l++)n=i.finalize(n),i.reset();o.concat(n)}return o.sigBytes=4*a,o}}),e.EvpKDF=function(e,t,n){return o.create(n).compute(e,t)},s.EvpKDF)),MW.exports;var e,t,n,A,r,i,o,s}var DW,zW={exports:{}};function OW(){return DW||(DW=1,zW.exports=(e=tW(),QW(),void(e.lib.Cipher||function(t){var n=e,A=n.lib,r=A.Base,i=A.WordArray,o=A.BufferedBlockAlgorithm,s=n.enc;s.Utf8;var a=s.Base64,g=n.algo.EvpKDF,l=A.Cipher=o.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?f:m}return function(t){return{encrypt:function(n,A,r){return e(A).encrypt(t,n,A,r)},decrypt:function(n,A,r){return e(A).decrypt(t,n,A,r)}}}}()});A.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=n.mode={},I=A.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),C=c.CBC=function(){var e=I.extend();function n(e,n,A){var r,i=this._iv;i?(r=i,this._iv=t):r=this._prevBlock;for(var o=0;o<A;o++)e[n+o]^=r[o]}return e.Encryptor=e.extend({processBlock:function(e,t){var A=this._cipher,r=A.blockSize;n.call(this,e,t,r),A.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),e.Decryptor=e.extend({processBlock:function(e,t){var A=this._cipher,r=A.blockSize,i=e.slice(t,t+r);A.decryptBlock(e,t),n.call(this,e,t,r),this._prevBlock=i}}),e}(),u=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,A=n-e.sigBytes%n,r=A<<24|A<<16|A<<8|A,o=[],s=0;s<A;s+=4)o.push(r);var a=i.create(o,A);e.concat(a)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};A.BlockCipher=l.extend({cfg:l.cfg.extend({mode:C,padding:u}),reset:function(){var e;l.reset.call(this);var t=this.cfg,n=t.iv,A=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=A.createEncryptor:(e=A.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(A,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var d=A.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?i.create([1398893684,1701076831]).concat(n).concat(t):t).toString(a)},parse:function(e){var t,n=a.parse(e),A=n.words;return 1398893684==A[0]&&1701076831==A[1]&&(t=i.create(A.slice(2,4)),A.splice(0,4),n.sigBytes-=16),d.create({ciphertext:n,salt:t})}},m=A.SerializableCipher=r.extend({cfg:r.extend({format:h}),encrypt:function(e,t,n,A){A=this.cfg.extend(A);var r=e.createEncryptor(n,A),i=r.finalize(t),o=r.cfg;return d.create({ciphertext:i,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:A.format})},decrypt:function(e,t,n,A){return A=this.cfg.extend(A),t=this._parse(t,A.format),e.createDecryptor(n,A).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),p=(n.kdf={}).OpenSSL={execute:function(e,t,n,A,r){if(A||(A=i.random(8)),r)o=g.create({keySize:t+n,hasher:r}).compute(e,A);else var o=g.create({keySize:t+n}).compute(e,A);var s=i.create(o.words.slice(t),4*n);return o.sigBytes=4*t,d.create({key:o,iv:s,salt:A})}},f=A.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(e,t,n,A){var r=(A=this.cfg.extend(A)).kdf.execute(n,e.keySize,e.ivSize,A.salt,A.hasher);A.iv=r.iv;var i=m.encrypt.call(this,e,t,r.key,A);return i.mixIn(r),i},decrypt:function(e,t,n,A){A=this.cfg.extend(A),t=this._parse(t,A.format);var r=A.kdf.execute(n,e.keySize,e.ivSize,t.salt,A.hasher);return A.iv=r.iv,m.decrypt.call(this,e,t,r.key,A)}})}()))),zW.exports;var e}var PW,_W={exports:{}};var jW,qW={exports:{}};var $W,eF={exports:{}};function tF(){return $W||($W=1,eF.exports=(e=tW(),OW(),
/** @preserve
       * Counter block mode compatible with  Dr Brian Gladman fileenc.c
       * derived from CryptoJS.mode.CTR
       * Jan Hruby jhruby.web@gmail.com
       */
e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,A=255&e;255===t?(t=0,255===n?(n=0,255===A?A=0:++A):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=A}return e}function A(e){return 0===(e[0]=n(e[0]))&&(e[1]=n(e[1])),e}var r=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0),A(o);var s=o.slice(0);n.encryptBlock(s,0);for(var a=0;a<r;a++)e[t+a]^=s[a]}});return t.Decryptor=r,t}(),e.mode.CTRGladman)),eF.exports;var e}var nF,AF={exports:{}};var rF,iF={exports:{}};var oF,sF={exports:{}};var aF,gF={exports:{}};var lF,cF={exports:{}};var IF,CF={exports:{}};var uF,dF={exports:{}};var hF,mF={exports:{}};var pF,fF={exports:{}};var bF,BF={exports:{}};function yF(){return bF||(bF=1,BF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib,A=n.WordArray,r=n.BlockCipher,i=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],a=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],g=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],c=i.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var A=o[n]-1;t[n]=e[A>>>5]>>>31-A%32&1}for(var r=this._subKeys=[],i=0;i<16;i++){var g=r[i]=[],l=a[i];for(n=0;n<24;n++)g[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,g[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(g[0]=g[0]<<1|g[0]>>>31,n=1;n<7;n++)g[n]=g[n]>>>4*(n-1)+3;g[7]=g[7]<<5|g[7]>>>27}var c=this._invSubKeys=[];for(n=0;n<16;n++)c[n]=r[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],I.call(this,4,252645135),I.call(this,16,65535),C.call(this,2,858993459),C.call(this,8,16711935),I.call(this,1,1431655765);for(var A=0;A<16;A++){for(var r=n[A],i=this._lBlock,o=this._rBlock,s=0,a=0;a<8;a++)s|=g[a][((o^r[a])&l[a])>>>0];this._lBlock=o,this._rBlock=i^s}var c=this._lBlock;this._lBlock=this._rBlock,this._rBlock=c,I.call(this,1,1431655765),C.call(this,8,16711935),C.call(this,2,858993459),I.call(this,16,65535),I.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function I(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function C(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}t.DES=r._createHelper(c);var u=i.TripleDES=r.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),r=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=c.createEncryptor(A.create(t)),this._des2=c.createEncryptor(A.create(n)),this._des3=c.createEncryptor(A.create(r))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=r._createHelper(u)}(),e.TripleDES)),BF.exports;var e}var wF,ZF={exports:{}};var SF,vF={exports:{}};var GF,RF={exports:{}};var VF,NF,kF,WF,FF,EF,XF,HF={exports:{}};function xF(){return VF||(VF=1,HF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib.BlockCipher,A=t.algo;const r=16,i=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],o=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var s={pbox:[],sbox:[]};function a(e,t){let n=t>>24&255,A=t>>16&255,r=t>>8&255,i=255&t,o=e.sbox[0][n]+e.sbox[1][A];return o^=e.sbox[2][r],o+=e.sbox[3][i],o}function g(e,t,n){let A,i=t,o=n;for(let s=0;s<r;++s)i^=e.pbox[s],o=a(e,i)^o,A=i,i=o,o=A;return A=i,i=o,o=A,o^=e.pbox[r],i^=e.pbox[r+1],{left:i,right:o}}function l(e,t,n){let A,i=t,o=n;for(let s=r+1;s>1;--s)i^=e.pbox[s],o=a(e,i)^o,A=i,i=o,o=A;return A=i,i=o,o=A,o^=e.pbox[1],i^=e.pbox[0],{left:i,right:o}}function c(e,t,n){for(let r=0;r<4;r++){e.sbox[r]=[];for(let t=0;t<256;t++)e.sbox[r][t]=o[r][t]}let A=0;for(let o=0;o<r+2;o++)e.pbox[o]=i[o]^t[A],A++,A>=n&&(A=0);let s=0,a=0,l=0;for(let i=0;i<r+2;i+=2)l=g(e,s,a),s=l.left,a=l.right,e.pbox[i]=s,e.pbox[i+1]=a;for(let r=0;r<4;r++)for(let t=0;t<256;t+=2)l=g(e,s,a),s=l.left,a=l.right,e.sbox[r][t]=s,e.sbox[r][t+1]=a;return!0}var I=A.Blowfish=n.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4;c(s,t,n)}},encryptBlock:function(e,t){var n=g(s,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},decryptBlock:function(e,t){var n=l(s,e[t],e[t+1]);e[t]=n.left,e[t+1]=n.right},blockSize:2,keySize:4,ivSize:2});t.Blowfish=n._createHelper(I)}(),e.Blowfish)),HF.exports;var e}jk.exports=function(e){return e}(tW(),rW(),sW(),lW(),CW(),hW(),fW(),yW(),SW(),vW||(vW=1,GW.exports=(XF=tW(),SW(),kF=(NF=XF).lib.WordArray,WF=NF.algo,FF=WF.SHA256,EF=WF.SHA224=FF.extend({_doReset:function(){this._hash=new kF.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=FF._doFinalize.call(this);return e.sigBytes-=4,e}}),NF.SHA224=FF._createHelper(EF),NF.HmacSHA224=FF._createHmacHelper(EF),XF.SHA224)),NW(),function(){return kW?WW.exports:(kW=1,WW.exports=(s=tW(),rW(),NW(),t=(e=s).x64,n=t.Word,A=t.WordArray,r=e.algo,i=r.SHA512,o=r.SHA384=i.extend({_doReset:function(){this._hash=new A.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}}),e.SHA384=i._createHelper(o),e.HmacSHA384=i._createHmacHelper(o),s.SHA384));var e,t,n,A,r,i,o,s}(),XW(),function(){return HW||(HW=1,xW.exports=(e=tW(),
/** @preserve
      			(c) 2012 by Cédric Mesnil. All rights reserved.
      
      			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
      
      			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
      			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
      
      			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
      			*/
function(){var t=e,n=t.lib,A=n.WordArray,r=n.Hasher,i=t.algo,o=A.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=A.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=A.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=A.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=A.create([0,1518500249,1859775393,2400959708,2840853838]),c=A.create([1352829926,1548603684,1836072691,2053994217,0]),I=i.RIPEMD160=r.extend({_doReset:function(){this._hash=A.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var A=t+n,r=e[A];e[A]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i,I,f,b,B,y,w,Z,S,v,G,R=this._hash.words,V=l.words,N=c.words,k=o.words,W=s.words,F=a.words,E=g.words;for(y=i=R[0],w=I=R[1],Z=f=R[2],S=b=R[3],v=B=R[4],n=0;n<80;n+=1)G=i+e[t+k[n]]|0,G+=n<16?C(I,f,b)+V[0]:n<32?u(I,f,b)+V[1]:n<48?d(I,f,b)+V[2]:n<64?h(I,f,b)+V[3]:m(I,f,b)+V[4],G=(G=p(G|=0,F[n]))+B|0,i=B,B=b,b=p(f,10),f=I,I=G,G=y+e[t+W[n]]|0,G+=n<16?m(w,Z,S)+N[0]:n<32?h(w,Z,S)+N[1]:n<48?d(w,Z,S)+N[2]:n<64?u(w,Z,S)+N[3]:C(w,Z,S)+N[4],G=(G=p(G|=0,E[n]))+v|0,y=v,v=S,S=p(Z,10),Z=w,w=G;G=R[1]+f+S|0,R[1]=R[2]+b+v|0,R[2]=R[3]+B+y|0,R[3]=R[4]+i+w|0,R[4]=R[0]+I+Z|0,R[0]=G},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,A=8*e.sigBytes;t[A>>>5]|=128<<24-A%32,t[14+(A+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,i=r.words,o=0;o<5;o++){var s=i[o];i[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return r},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function C(e,t,n){return e^t^n}function u(e,t,n){return e&t|~e&n}function d(e,t,n){return(e|~t)^n}function h(e,t,n){return e&n|t&~n}function m(e,t,n){return e^(t|~n)}function p(e,t){return e<<t|e>>>32-t}t.RIPEMD160=r._createHelper(I),t.HmacRIPEMD160=r._createHmacHelper(I)}(),e.RIPEMD160)),xW.exports;var e}(),UW(),function(){return LW||(LW=1,TW.exports=(a=tW(),SW(),UW(),t=(e=a).lib,n=t.Base,A=t.WordArray,r=e.algo,i=r.SHA256,o=r.HMAC,s=r.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=o.create(n.hasher,e),i=A.create(),s=A.create([1]),a=i.words,g=s.words,l=n.keySize,c=n.iterations;a.length<l;){var I=r.update(t).finalize(s);r.reset();for(var C=I.words,u=C.length,d=I,h=1;h<c;h++){d=r.finalize(d),r.reset();for(var m=d.words,p=0;p<u;p++)C[p]^=m[p]}i.concat(I),g[0]++}return i.sigBytes=4*l,i}}),e.PBKDF2=function(e,t,n){return s.create(n).compute(e,t)},a.PBKDF2)),TW.exports;var e,t,n,A,r,i,o,s,a}(),QW(),OW(),function(){return PW||(PW=1,_W.exports=(e=tW(),OW(),e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function n(e,t,n,A){var r,i=this._iv;i?(r=i.slice(0),this._iv=void 0):r=this._prevBlock,A.encryptBlock(r,0);for(var o=0;o<n;o++)e[t+o]^=r[o]}return t.Encryptor=t.extend({processBlock:function(e,t){var A=this._cipher,r=A.blockSize;n.call(this,e,t,r,A),this._prevBlock=e.slice(t,t+r)}}),t.Decryptor=t.extend({processBlock:function(e,t){var A=this._cipher,r=A.blockSize,i=e.slice(t,t+r);n.call(this,e,t,r,A),this._prevBlock=i}}),t}(),e.mode.CFB)),_W.exports;var e}(),function(){return jW||(jW=1,qW.exports=(n=tW(),OW(),n.mode.CTR=(e=n.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,A=n.blockSize,r=this._iv,i=this._counter;r&&(i=this._counter=r.slice(0),this._iv=void 0);var o=i.slice(0);n.encryptBlock(o,0),i[A-1]=i[A-1]+1|0;for(var s=0;s<A;s++)e[t+s]^=o[s]}}),e.Decryptor=t,e),n.mode.CTR)),qW.exports;var e,t,n}(),tF(),function(){return nF||(nF=1,AF.exports=(n=tW(),OW(),n.mode.OFB=(e=n.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,A=n.blockSize,r=this._iv,i=this._keystream;r&&(i=this._keystream=r.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var o=0;o<A;o++)e[t+o]^=i[o]}}),e.Decryptor=t,e),n.mode.OFB)),AF.exports;var e,t,n}(),function(){return rF?iF.exports:(rF=1,iF.exports=(t=tW(),OW(),t.mode.ECB=((e=t.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e),t.mode.ECB));var e,t}(),function(){return oF?sF.exports:(oF=1,sF.exports=(e=tW(),OW(),e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,A=4*t,r=A-n%A,i=n+r-1;e.clamp(),e.words[i>>>2]|=r<<24-i%4*8,e.sigBytes+=r},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923));var e}(),function(){return aF?gF.exports:(aF=1,gF.exports=(e=tW(),OW(),e.pad.Iso10126={pad:function(t,n){var A=4*n,r=A-t.sigBytes%A;t.concat(e.lib.WordArray.random(r-1)).concat(e.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126));var e}(),function(){return lF?cF.exports:(lF=1,cF.exports=(e=tW(),OW(),e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971));var e}(),function(){return IF||(IF=1,CF.exports=(e=tW(),OW(),e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},e.pad.ZeroPadding)),CF.exports;var e}(),function(){return uF?dF.exports:(uF=1,dF.exports=(e=tW(),OW(),e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding));var e}(),function(){return hF?mF.exports:(hF=1,mF.exports=(A=tW(),OW(),t=(e=A).lib.CipherParams,n=e.enc.Hex,e.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var A=n.parse(e);return t.create({ciphertext:A})}},A.format.Hex));var e,t,n,A}(),function(){return pF||(pF=1,fF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib.BlockCipher,A=t.algo,r=[],i=[],o=[],s=[],a=[],g=[],l=[],c=[],I=[],C=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,A=0;for(t=0;t<256;t++){var u=A^A<<1^A<<2^A<<3^A<<4;u=u>>>8^255&u^99,r[n]=u,i[u]=n;var d=e[n],h=e[d],m=e[h],p=257*e[u]^16843008*u;o[n]=p<<24|p>>>8,s[n]=p<<16|p>>>16,a[n]=p<<8|p>>>24,g[n]=p,p=16843009*m^65537*h^257*d^16843008*n,l[u]=p<<24|p>>>8,c[u]=p<<16|p>>>16,I[u]=p<<8|p>>>24,C[u]=p,n?(n=d^e[e[e[m^d]]],A^=e[e[A]]):n=A=1}}();var u=[0,1,2,4,8,16,32,64,128,27,54],d=A.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,A=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],o=0;o<A;o++)o<n?i[o]=t[o]:(g=i[o-1],o%n?n>6&&o%n==4&&(g=r[g>>>24]<<24|r[g>>>16&255]<<16|r[g>>>8&255]<<8|r[255&g]):(g=r[(g=g<<8|g>>>24)>>>24]<<24|r[g>>>16&255]<<16|r[g>>>8&255]<<8|r[255&g],g^=u[o/n|0]<<24),i[o]=i[o-n]^g);for(var s=this._invKeySchedule=[],a=0;a<A;a++){if(o=A-a,a%4)var g=i[o];else g=i[o-4];s[a]=a<4||o<=4?g:l[r[g>>>24]]^c[r[g>>>16&255]]^I[r[g>>>8&255]]^C[r[255&g]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,a,g,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,c,I,C,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,A,r,i,o,s){for(var a=this._nRounds,g=e[t]^n[0],l=e[t+1]^n[1],c=e[t+2]^n[2],I=e[t+3]^n[3],C=4,u=1;u<a;u++){var d=A[g>>>24]^r[l>>>16&255]^i[c>>>8&255]^o[255&I]^n[C++],h=A[l>>>24]^r[c>>>16&255]^i[I>>>8&255]^o[255&g]^n[C++],m=A[c>>>24]^r[I>>>16&255]^i[g>>>8&255]^o[255&l]^n[C++],p=A[I>>>24]^r[g>>>16&255]^i[l>>>8&255]^o[255&c]^n[C++];g=d,l=h,c=m,I=p}d=(s[g>>>24]<<24|s[l>>>16&255]<<16|s[c>>>8&255]<<8|s[255&I])^n[C++],h=(s[l>>>24]<<24|s[c>>>16&255]<<16|s[I>>>8&255]<<8|s[255&g])^n[C++],m=(s[c>>>24]<<24|s[I>>>16&255]<<16|s[g>>>8&255]<<8|s[255&l])^n[C++],p=(s[I>>>24]<<24|s[g>>>16&255]<<16|s[l>>>8&255]<<8|s[255&c])^n[C++],e[t]=d,e[t+1]=h,e[t+2]=m,e[t+3]=p},keySize:8});t.AES=n._createHelper(d)}(),e.AES)),fF.exports;var e}(),yF(),function(){return wF||(wF=1,ZF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib.StreamCipher,A=t.algo,r=A.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,A=this._S=[],r=0;r<256;r++)A[r]=r;r=0;for(var i=0;r<256;r++){var o=r%n,s=t[o>>>2]>>>24-o%4*8&255;i=(i+A[r]+s)%256;var a=A[r];A[r]=A[i],A[i]=a}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,A=0,r=0;r<4;r++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,A|=e[(e[t]+e[n])%256]<<24-8*r}return this._i=t,this._j=n,A}t.RC4=n._createHelper(r);var o=A.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});t.RC4Drop=n._createHelper(o)}(),e.RC4)),ZF.exports;var e}(),function(){return SF||(SF=1,vF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib.StreamCipher,A=t.algo,r=[],i=[],o=[],s=A.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var A=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)a.call(this);for(n=0;n<8;n++)r[n]^=A[n+4&7];if(t){var i=t.words,o=i[0],s=i[1],g=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=g>>>16|4294901760&l,I=l<<16|65535&g;for(r[0]^=g,r[1]^=c,r[2]^=l,r[3]^=I,r[4]^=g,r[5]^=c,r[6]^=l,r[7]^=I,n=0;n<4;n++)a.call(this)}},_doProcessBlock:function(e,t){var n=this._X;a.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var A=0;A<4;A++)r[A]=16711935&(r[A]<<8|r[A]>>>24)|4278255360&(r[A]<<24|r[A]>>>8),e[t+A]^=r[A]},blockSize:4,ivSize:2});function a(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var A=e[n]+t[n],r=65535&A,s=A>>>16,a=((r*r>>>17)+r*s>>>15)+s*s,g=((4294901760&A)*A|0)+((65535&A)*A|0);o[n]=a^g}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.Rabbit=n._createHelper(s)}(),e.Rabbit)),vF.exports;var e}(),function(){return GF||(GF=1,RF.exports=(e=tW(),CW(),fW(),QW(),OW(),function(){var t=e,n=t.lib.StreamCipher,A=t.algo,r=[],i=[],o=[],s=A.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],A=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var r=0;r<4;r++)a.call(this);for(r=0;r<8;r++)A[r]^=n[r+4&7];if(t){var i=t.words,o=i[0],s=i[1],g=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=g>>>16|4294901760&l,I=l<<16|65535&g;for(A[0]^=g,A[1]^=c,A[2]^=l,A[3]^=I,A[4]^=g,A[5]^=c,A[6]^=l,A[7]^=I,r=0;r<4;r++)a.call(this)}},_doProcessBlock:function(e,t){var n=this._X;a.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var A=0;A<4;A++)r[A]=16711935&(r[A]<<8|r[A]>>>24)|4278255360&(r[A]<<24|r[A]>>>8),e[t+A]^=r[A]},blockSize:4,ivSize:2});function a(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var A=e[n]+t[n],r=65535&A,s=A>>>16,a=((r*r>>>17)+r*s>>>15)+s*s,g=((4294901760&A)*A|0)+((65535&A)*A|0);o[n]=a^g}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.RabbitLegacy=n._createHelper(s)}(),e.RabbitLegacy)),RF.exports;var e}(),xF());const JF=A(jk.exports),YF=(e="")=>JF.SHA256(`mariage_app_security_${e}`).toString(),UF="+243844270288",LF=e=>e===UF,TF=e=>((e,t=null)=>{try{const n=t||YF("admin"),A="string"==typeof e?e:JSON.stringify(e);return JF.AES.encrypt(A,n).toString()}catch(PWe){return JSON.stringify(e)}})(e),KF=e=>((e,t=null)=>{try{if(0===e.indexOf("{"))return JSON.parse(e);const n=t||YF("admin"),A=JF.AES.decrypt(e,n).toString(JF.enc.Utf8);if(!A)throw new Error("Décryptage a produit une chaîne vide");return JSON.parse(A)}catch(PWe){try{return JSON.parse(e)}catch{return null}}})(e),MF=()=>{const[t,n]=e.useState(""),[A,r]=e.useState(!1),[i,o]=e.useState(0),[s,a]=e.useState(!1),g=Ce();e.useEffect((()=>{const e=localStorage.getItem("adminAuth");if(e)try{const t=KF?KF(e):JSON.parse(e);if(t){const{isAuthenticated:e,timestamp:n}=t,A=Date.now();e&&A-n<864e5&&g("/admin")}}catch(n){localStorage.removeItem("adminAuth")}const t=localStorage.getItem("authBlocked");if(t){const e=3e5,n=Date.now()-parseInt(t,10);if(n<e){const t=Math.ceil((e-n)/6e4);r(`Trop de tentatives incorrectes. Veuillez réessayer dans ${t} minute(s).`),a(!0)}else localStorage.removeItem("authBlocked")}}),[g]);return f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-secondary p-4",children:f.jsxs("div",{className:"glass-card p-8 rounded-xl max-w-md w-full",children:[f.jsx("h1",{className:"font-elegant text-3xl text-primary-dark mb-6 text-center",children:"Espace Administrateur"}),A&&f.jsx("div",{className:"mb-6 p-3 bg-red-100 border-l-4 border-red-500 text-red-700 rounded",children:A}),f.jsxs("form",{onSubmit:e=>{e.preventDefault(),a(!0),setTimeout((()=>{if(LF(t)){const e={isAuthenticated:!0,timestamp:Date.now()},t=TF?TF(e):JSON.stringify(e);localStorage.setItem("adminAuth",t),g("/admin")}else{const e=i+1;o(e),e>=5?(r("Trop de tentatives incorrectes. Veuillez réessayer dans 5 minutes."),localStorage.setItem("authBlocked",Date.now().toString()),setTimeout((()=>{g("/")}),2e3)):r(`Mot de passe incorrect. Tentative ${e}/5.`),n(""),a(!1)}}),1e3)},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-primary-dark",children:"Mot de passe"}),f.jsx("input",{type:"password",id:"password",value:t,onChange:e=>n(e.target.value),className:"w-full p-3 border border-primary/20 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none",placeholder:"Entrez le mot de passe administrateur",autoComplete:"off",disabled:s,required:!0}),f.jsx("p",{className:"mt-1 text-xs text-muted",children:"Ce mot de passe n'est pas stocké dans votre navigateur"})]}),f.jsx("button",{type:"submit",className:"w-full px-6 py-3 bg-primary text-white rounded-lg shadow-elegant hover:bg-primary-dark transition-all transform hover:-translate-y-1 "+(s?"opacity-70 cursor-not-allowed":""),disabled:s,children:s?f.jsxs("span",{className:"flex items-center justify-center",children:[f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Vérification..."]}):"Se connecter"})]}),f.jsx("div",{className:"mt-8 text-center",children:f.jsx("a",{href:"/",className:"text-primary hover:text-primary-dark transition-colors",children:"Retour à l'accueil"})})]})})};function QF(){return QF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var A in n)({}).hasOwnProperty.call(n,A)&&(e[A]=n[A])}return e},QF.apply(null,arguments)}function DF(e){var t=function(e,t){if("object"!=Nf(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var A=n.call(e,t);if("object"!=Nf(A))return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nf(t)?t:t+""}function zF(e,t,n){return(t=DF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OF(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,A=Array(t);n<t;n++)A[n]=e[n];return A}function PF(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var A,r,i,o,s=[],a=!0,g=!1;try{if(i=(n=n.call(e)).next,0===t);else for(;!(a=(A=i.call(n)).done)&&(s.push(A.value),s.length!==t);a=!0);}catch(l){g=!0,r=l}finally{try{if(!a&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(g)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return OF(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OF(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _F={exports:{}},jF={},qF="function"==typeof Symbol&&Symbol.for,$F=qF?Symbol.for("react.element"):60103,eE=qF?Symbol.for("react.portal"):60106,tE=qF?Symbol.for("react.fragment"):60107,nE=qF?Symbol.for("react.strict_mode"):60108,AE=qF?Symbol.for("react.profiler"):60114,rE=qF?Symbol.for("react.provider"):60109,iE=qF?Symbol.for("react.context"):60110,oE=qF?Symbol.for("react.async_mode"):60111,sE=qF?Symbol.for("react.concurrent_mode"):60111,aE=qF?Symbol.for("react.forward_ref"):60112,gE=qF?Symbol.for("react.suspense"):60113,lE=qF?Symbol.for("react.suspense_list"):60120,cE=qF?Symbol.for("react.memo"):60115,IE=qF?Symbol.for("react.lazy"):60116,CE=qF?Symbol.for("react.block"):60121,uE=qF?Symbol.for("react.fundamental"):60117,dE=qF?Symbol.for("react.responder"):60118,hE=qF?Symbol.for("react.scope"):60119;function mE(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case $F:switch(e=e.type){case oE:case sE:case tE:case AE:case nE:case gE:return e;default:switch(e=e&&e.$$typeof){case iE:case aE:case IE:case cE:case rE:return e;default:return t}}case eE:return t}}}function pE(e){return mE(e)===sE}jF.AsyncMode=oE,jF.ConcurrentMode=sE,jF.ContextConsumer=iE,jF.ContextProvider=rE,jF.Element=$F,jF.ForwardRef=aE,jF.Fragment=tE,jF.Lazy=IE,jF.Memo=cE,jF.Portal=eE,jF.Profiler=AE,jF.StrictMode=nE,jF.Suspense=gE,jF.isAsyncMode=function(e){return pE(e)||mE(e)===oE},jF.isConcurrentMode=pE,jF.isContextConsumer=function(e){return mE(e)===iE},jF.isContextProvider=function(e){return mE(e)===rE},jF.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===$F},jF.isForwardRef=function(e){return mE(e)===aE},jF.isFragment=function(e){return mE(e)===tE},jF.isLazy=function(e){return mE(e)===IE},jF.isMemo=function(e){return mE(e)===cE},jF.isPortal=function(e){return mE(e)===eE},jF.isProfiler=function(e){return mE(e)===AE},jF.isStrictMode=function(e){return mE(e)===nE},jF.isSuspense=function(e){return mE(e)===gE},jF.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===tE||e===sE||e===AE||e===nE||e===gE||e===lE||"object"==typeof e&&null!==e&&(e.$$typeof===IE||e.$$typeof===cE||e.$$typeof===rE||e.$$typeof===iE||e.$$typeof===aE||e.$$typeof===uE||e.$$typeof===dE||e.$$typeof===hE||e.$$typeof===CE)},jF.typeOf=mE;
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;!function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach((function(e){A[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},A)).join("")}catch(r){return!1}}()||Object.assign;Function.call.bind(Object.prototype.hasOwnProperty);function fE(){}function bE(){}bE.resetWarningCache=fE;_F.exports=function(){function e(e,t,n,A,r,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:bE,resetWarningCache:fE};return n.PropTypes=n,n}();var BE=_F.exports;function yE(e,t,n){var A=function(e){return atob(e)}(e),r=A.indexOf("\n",10)+1,i=A.substring(r)+"",o=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(o)}var wE,ZE,SE=(wE="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",function(e){return ZE=ZE||yE(wE),new Worker(ZE,e)}),vE=["constraints","onError","onLoad","onScan","resolution","qrArea"];function GE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(e);t&&(A=A.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,A)}return n}function RE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?GE(Object(n),!0).forEach((function(t){zF(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var VE=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().forEach((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().forEach((function(t){e.removeTrack(t),t.stop()}))):e.stop())},NE=function(t){var n=t.constraints,A=t.onError,r=t.onLoad,i=t.onScan,o=t.resolution,s=t.qrArea,a=function(e,t){if(null==e)return{};var n,A,r=function(e,t){if(null==e)return{};var n={};for(var A in e)if({}.hasOwnProperty.call(e,A)){if(-1!==t.indexOf(A))continue;n[A]=e[A]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(A=0;A<i.length;A++)n=i[A],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(t,vE),g=e.useRef(null),l=e.useRef(null),c=e.useRef(document.createElement("canvas")),I=e.useRef(null),C=e.useRef(),u=PF(e.useState(null),2),d=u[0],h=u[1],m=e.useRef(!1),p=e.useRef();e.useEffect((function(){p.current=new SE;var e=p.current;return e.onmessage=function(e){i&&i(e.data?RE(RE({},e.data),{},{canvas:c.current}):null),m.current=!1},function(){e.terminate()}}),[i]);var f=JSON.stringify(s),b=e.useCallback((function(){var e=JSON.parse(f),t=p.current,n=l.current&&l.current.readyState===l.current.HAVE_ENOUGH_DATA;if(!m.current&&n){m.current=!0;var A,r=l.current.videoWidth,i=l.current.videoHeight,s=r>i?r:i,a=Math.floor(o/s*100)/100;i=Math.floor(a*i),r=Math.floor(a*r),c.current.width=r,c.current.height=i,I.current=c.current.getContext("2d"),I.current.drawImage(l.current,0,0,r,i),A=e&&2===e.length&&e[0]>0&&e[1]>0?I.current.getImageData(Math.floor((r-e[0])/2),Math.floor((i-e[1])/2),e[0],e[1]):I.current.getImageData(0,0,r,i),t.postMessage(A)}C.current=requestAnimationFrame(b)}),[o,f]),B=JSON.stringify(n);return e.useEffect((function(){var e=JSON.parse(B),t=!0;return navigator.mediaDevices.getUserMedia(e).then((function(e){if(t){g.current=e;try{l.current&&(l.current.srcObject=e,l.current.setAttribute("playsinline",!0))}catch(PWe){h(window.URL.createObjectURL(e))}r&&r(),C.current=requestAnimationFrame(b)}else VE(e)})).catch((function(e){return t?A(e):null})),function(){cancelAnimationFrame(C.current),t=!1,VE(g.current),d&&window.URL.revokeObjectURL(d)}}),[b,B,A,r,d]),e.createElement("video",QF({autoPlay:!0,playsInline:!0,src:d,ref:l},a))};NE.propTypes={constraints:BE.object,onError:BE.func.isRequired,onLoad:BE.func,onScan:BE.func.isRequired,resolution:BE.number,qrArea:BE.array},NE.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]};const kE=({onScanComplete:t})=>{const[n,A]=e.useState(!0),[r,i]=e.useState(null),[o,s]=e.useState(null),[a,g]=e.useState(null),[l,c]=e.useState(!1),I=e.useRef(null),C=()=>{A(!0),s(null),g(null),i(null)};return f.jsxs("div",{className:"w-full",children:[f.jsx(Nt,{variant:"elegant",className:"overflow-hidden",children:f.jsx(Nt.Body,{className:"p-0",children:n?f.jsxs("div",{className:"relative",children:[f.jsx(NE,{ref:I,onScan:async e=>{if(e&&e.text&&!l){A(!1),c(!0);try{const n=e.text;s(n);const A=await Gf.getGuestById(n);A?(g(A),await Gf.recordScan(n,{location:"Entrée",userAgent:navigator.userAgent,manual:!1}),t&&t(A)):i("Invité non trouvé. QR code invalide.")}catch(n){i("Erreur lors du scan. Veuillez réessayer.")}finally{c(!1)}}},onError:e=>{i("Erreur d'accès à la caméra. Vérifiez vos permissions.")},delay:300,constraints:{video:{facingMode:"environment"}},style:{width:"100%",height:"auto",borderRadius:"0.5rem"}}),f.jsx("div",{className:"absolute inset-0 border-2 border-primary pointer-events-none",style:{borderRadius:"0.25rem",boxShadow:"inset 0 0 0 3px rgba(139, 93, 51, 0.5)"}})]}):f.jsx("div",{className:"p-4",children:l?f.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),f.jsx("p",{className:"mt-4 text-primary",children:"Chargement des informations..."})]}):a?f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-primary/10 p-4 rounded-lg",children:[f.jsx("h3",{className:"text-xl font-elegant text-primary-dark",children:a.name}),f.jsxs("p",{className:"text-muted",children:["Groupe: ",a.group]}),f.jsxs("div",{className:"flex items-center mt-2",children:[f.jsxs("span",{className:"mr-2 text-sm",children:[a.count," personne(s)"]}),f.jsx("span",{className:"text-sm bg-primary/20 py-1 px-2 rounded-full ml-auto",children:a.scanCount>0?`Scannés ${a.scanCount} fois`:"Premier scan"})]})]}),f.jsxs("div",{className:"flex items-center justify-between bg-highlight p-3 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-3 h-3 rounded-full mr-2 "+(a.scanned?"bg-success":"bg-primary")}),f.jsx("span",{className:"text-sm",children:a.scanned?"Déjà scannés":"Première entrée"})]}),f.jsx("span",{className:"text-xs text-muted",children:a.lastScan?new Date(a.lastScan.toDate()).toLocaleString():"Jamais"})]}),f.jsx(je,{onClick:C,variant:"primary",className:"w-full",children:"Scanner un autre QR code"})]}):f.jsxs("div",{className:"text-center py-4",children:[r?f.jsx("div",{className:"text-danger mb-4",children:r}):f.jsx("div",{className:"text-muted",children:"Aucun résultat"}),f.jsx(je,{onClick:C,variant:"primary",className:"mt-4",children:"Réessayer"})]})})})}),n&&f.jsx("p",{className:"text-center text-sm text-muted mt-4",children:"Placez le QR code de l'invitation dans le cadre pour le scanner"})]})},WE=()=>{const[t,n]=e.useState({totalScanned:0,totalGuests:0,recentScans:[]}),[A,r]=e.useState(!0),[i,o]=e.useState(!1),[s,a]=e.useState(""),[g,l]=e.useState([]);e.useEffect((()=>{const e=async()=>{try{const e=await Gf.getAllGuests(),t=await Gf.getAllScans(),A=e.filter((e=>e.scanned)),r=e.reduce(((e,t)=>e+t.count),0),i=[...t].sort(((e,t)=>{var n,A;return(null==(n=t.timestamp)?void 0:n.toDate())-(null==(A=e.timestamp)?void 0:A.toDate())}));n({totalScanned:A.length,totalGuests:e.length,totalPersons:r,scannedPersons:A.reduce(((e,t)=>e+t.count),0),recentScans:i.slice(0,5)})}catch(PWe){}finally{r(!1)}};e();const t=setInterval(e,3e4);return()=>clearInterval(t)}),[]);const c=e=>{n((t=>({...t,totalScanned:t.totalScanned+(e.scanned?0:1),recentScans:[{guestId:e.id,timestamp:new Date,guest:e},...t.recentScans].slice(0,5)})))},I=async()=>{if(!(s.trim().length<2)){r(!0);try{const e=(await Gf.getAllGuests()).filter((e=>e.name.toLowerCase().includes(s.toLowerCase())||e.group.toLowerCase().includes(s.toLowerCase())));l(e)}catch(PWe){}finally{r(!1)}}};return f.jsxs("div",{className:"bg-secondary min-h-screen pb-10",children:[f.jsx("header",{className:"bg-primary text-white py-6 px-4",children:f.jsxs("div",{className:"max-w-4xl mx-auto",children:[f.jsx("h1",{className:"font-elegant text-3xl",children:"Scanner d'entrée"}),f.jsx("p",{className:"text-white/70 mt-2",children:"Scannez les invitations à l'entrée du mariage"})]})}),f.jsx("div",{className:"max-w-4xl mx-auto px-4 -mt-6",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(FE,{title:"Invités scannés",value:t.totalScanned||0,total:t.totalGuests||0,icon:f.jsx("svg",{className:"w-8 h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),f.jsx(FE,{title:"Personnes présentes",value:t.scannedPersons||0,total:t.totalPersons||0,icon:f.jsx("svg",{className:"w-8 h-8 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})}),f.jsx("div",{className:"max-w-4xl mx-auto px-4 mt-8",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h2",{className:"font-elegant text-2xl text-primary-dark",children:i?"Entrée manuelle":"Scanner QR Code"}),f.jsx(je,{variant:"outline",onClick:()=>o(!i),className:"text-sm",children:i?"Utiliser le scanner":"Entrée manuelle"})]}),i?f.jsx(Nt,{variant:"default",className:"p-4",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("input",{type:"text",className:"block w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-primary focus:border-primary bg-white text-primary-dark",placeholder:"Rechercher un invité...",value:s,onChange:e=>a(e.target.value),onKeyDown:e=>"Enter"===e.key&&I()}),f.jsx(je,{variant:"primary",onClick:I,disabled:A,children:"Rechercher"})]}),f.jsx("div",{className:"mt-4 space-y-2",children:g.length>0?g.map((e=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 flex justify-between items-center bg-white",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-primary-dark",children:e.name}),f.jsxs("div",{className:"text-sm text-muted",children:[f.jsx("span",{children:e.group}),f.jsx("span",{className:"mx-2",children:"•"}),f.jsxs("span",{children:[e.count," personne(s)"]})]})]}),f.jsx(je,{variant:e.scanned?"outline":"primary",onClick:()=>(async e=>{try{await Gf.recordScan(e.id,{location:"Entrée",manual:!0,userAgent:navigator.userAgent}),l((t=>t.map((t=>t.id===e.id?{...t,scanned:!0,scanCount:(t.scanCount||0)+1}:t)))),c(e)}catch(PWe){}})(e),className:"text-sm",disabled:A,children:e.scanned?`Rescan (${e.scanCount})`:"Enregistrer"})]},e.id))):s&&!A?f.jsx("div",{className:"text-center py-4 text-muted",children:"Aucun invité trouvé"}):null})]})}):f.jsx(kE,{onScanComplete:c})]}),f.jsxs("div",{children:[f.jsx("h2",{className:"font-elegant text-2xl text-primary-dark mb-4",children:"Derniers scans"}),f.jsx(Nt,{variant:"default",className:"p-4",children:t.recentScans&&t.recentScans.length>0?f.jsx("ul",{className:"divide-y divide-gray-100",children:t.recentScans.map(((e,t)=>{var n,A,r;const i=(null==(n=e.guest)?void 0:n.name)||e.guestId,o=(null==(A=e.guest)?void 0:A.group)||"",s=e.timestamp instanceof Date?e.timestamp:(null==(r=e.timestamp)?void 0:r.toDate)?e.timestamp.toDate():new Date;return f.jsx("li",{className:"py-3",children:f.jsxs("div",{className:"flex items-start",children:[f.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center mr-3",children:f.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-primary-dark",children:i}),f.jsx("p",{className:"text-sm text-muted",children:o}),f.jsxs("p",{className:"text-xs text-muted mt-1",children:[s.toLocaleTimeString(),f.jsx("span",{className:"ml-1",children:e.manual?"(Manuel)":""})]})]})]})},t)}))}):f.jsxs("div",{className:"text-center py-8 text-muted",children:[f.jsx("svg",{className:"w-10 h-10 mx-auto mb-2 text-muted/50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),f.jsx("p",{children:"Aucun scan récent"})]})})]})]})})]})},FE=({title:e,value:t,total:n,icon:A})=>{const r=n?Math.round(t/n*100):0;return f.jsx(Nt,{variant:"elegant",className:"transform hover:-translate-y-1 transition-transform duration-300",children:f.jsx(Nt.Body,{className:"p-5",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"mr-4 bg-primary/10 p-3 rounded-full",children:A}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium text-primary-dark",children:e}),f.jsxs("div",{className:"flex items-end",children:[f.jsxs("p",{className:"text-2xl font-semibold text-primary-dark",children:[t," ",f.jsxs("span",{className:"text-sm font-normal text-muted",children:["/ ",n]})]}),f.jsxs("span",{className:"ml-2 text-sm text-primary/80 mb-1",children:["(",r,"%)"]})]})]})]})})})};var EE,XE;(XE=EE||(EE={}))[XE.QR_CODE=0]="QR_CODE",XE[XE.AZTEC=1]="AZTEC",XE[XE.CODABAR=2]="CODABAR",XE[XE.CODE_39=3]="CODE_39",XE[XE.CODE_93=4]="CODE_93",XE[XE.CODE_128=5]="CODE_128",XE[XE.DATA_MATRIX=6]="DATA_MATRIX",XE[XE.MAXICODE=7]="MAXICODE",XE[XE.ITF=8]="ITF",XE[XE.EAN_13=9]="EAN_13",XE[XE.EAN_8=10]="EAN_8",XE[XE.PDF_417=11]="PDF_417",XE[XE.RSS_14=12]="RSS_14",XE[XE.RSS_EXPANDED=13]="RSS_EXPANDED",XE[XE.UPC_A=14]="UPC_A",XE[XE.UPC_E=15]="UPC_E",XE[XE.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var HE,xE,JE,YE,UE=new Map([[EE.QR_CODE,"QR_CODE"],[EE.AZTEC,"AZTEC"],[EE.CODABAR,"CODABAR"],[EE.CODE_39,"CODE_39"],[EE.CODE_93,"CODE_93"],[EE.CODE_128,"CODE_128"],[EE.DATA_MATRIX,"DATA_MATRIX"],[EE.MAXICODE,"MAXICODE"],[EE.ITF,"ITF"],[EE.EAN_13,"EAN_13"],[EE.EAN_8,"EAN_8"],[EE.PDF_417,"PDF_417"],[EE.RSS_14,"RSS_14"],[EE.RSS_EXPANDED,"RSS_EXPANDED"],[EE.UPC_A,"UPC_A"],[EE.UPC_E,"UPC_E"],[EE.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]);function LE(e){return Object.values(EE).includes(e)}(xE=HE||(HE={}))[xE.UNKNOWN=0]="UNKNOWN",xE[xE.URL=1]="URL",(YE=JE||(JE={}))[YE.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",YE[YE.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE";var TE,KE,ME=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[JE.SCAN_TYPE_CAMERA,JE.SCAN_TYPE_FILE],e}(),QE=function(){function e(e,t){this.format=e,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!UE.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,UE.get(t))},e}(),DE=function(){function e(){}return e.createFromText=function(e){return{decodedText:e,result:{text:e}}},e.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},e}();(KE=TE||(TE={}))[KE.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",KE[KE.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",KE[KE.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR";var zE=function(){function e(){}return e.createFrom=function(e){return{errorMessage:e,type:TE.UNKWOWN_ERROR}},e}(),OE=function(){function e(e){this.verbose=e}return e.prototype.log=function(e){this.verbose},e.prototype.warn=function(e){this.verbose},e.prototype.logError=function(e,t){this.verbose},e.prototype.logErrors=function(e){if(0===e.length)throw"Logger#logError called without arguments";this.verbose},e}();function PE(e){return null==e}var _E=function(){function e(){}return e.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},e.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),jE=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(e){return"Last Match: ".concat(e)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),qE=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),$E=function(){function e(){}return e.isMediaStreamConstraintsValid=function(e,t){if("object"!=typeof e){var n=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var A=new Set(["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"]),r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];if(A.has(o))return t.logError("".concat(o," is not supported videoConstaints."),!0),!1}return!0},e}(),eX={exports:{}};!function(e){function t(e){return null==e}var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function A(e,t){function A(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(A.prototype=t.prototype,new A)}function r(e,t){var n=Object.setPrototypeOf;n?n(e,t):e.__proto__=t}function i(e,t){void 0===t&&(t=e.constructor);var n=Error.captureStackTrace;n&&n(e,t)}var s,a,g=function(e){function t(t){var n=this.constructor,A=e.call(this,t)||this;return Object.defineProperty(A,"name",{value:n.name,enumerable:!1}),r(A,n.prototype),i(A),A}return A(t,e),t}(Error);class l extends g{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}l.kind="Exception";class c extends l{}c.kind="ArgumentException";class I extends l{}I.kind="IllegalArgumentException";class C{constructor(e){if(this.binarizer=e,null===e)throw new I("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,A){const r=this.binarizer.getLuminanceSource().crop(e,t,n,A);return new C(this.binarizer.createBinarizer(r))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new C(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new C(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch(Zf){return""}}}class u extends l{static getChecksumInstance(){return new u}}u.kind="ChecksumException";class d{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class h{static arraycopy(e,t,n,A,r){for(;r--;)n[A++]=e[t++]}static currentTimeMillis(){return Date.now()}}class m extends l{}m.kind="IndexOutOfBoundsException";class p extends m{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}p.kind="ArrayIndexOutOfBoundsException";class f{static fill(e,t){for(let n=0,A=e.length;n<A;n++)e[n]=t}static fillWithin(e,t,n,A){f.rangeCheck(e.length,t,n);for(let r=t;r<n;r++)e[r]=A}static rangeCheck(e,t,n){if(t>n)throw new I("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new p(t);if(n>e)throw new p(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map((e=>Array.from({length:t}).fill(n)))}static createInt32Array(e,t,n){return Array.from({length:e}).map((e=>Int32Array.from({length:t}).fill(n)))}static equals(e,t){if(!e)return!1;if(!t)return!1;if(!e.length)return!1;if(!t.length)return!1;if(e.length!==t.length)return!1;for(let n=0,A=e.length;n<A;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(null===e)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const A=n-t,r=new Int32Array(A);return h.arraycopy(e,t,r,0,A),r}static binarySearch(e,t,n){void 0===n&&(n=f.numberComparator);let A=0,r=e.length-1;for(;A<=r;){const i=r+A>>1,o=n(t,e[i]);if(o>0)A=i+1;else{if(!(o<0))return i;r=i-1}}return-A-1}static numberComparator(e,t){return e-t}}class b{static numberOfTrailingZeros(e){let t;if(0===e)return 32;let n=31;return t=e<<16,0!==t&&(n-=16,e=t),t=e<<8,0!==t&&(n-=8,e=t),t=e<<4,0!==t&&(n-=4,e=t),t=e<<2,0!==t&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(0===e)return 32;let t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}b.MIN_VALUE_32_BITS=-2147483648,b.MAX_VALUE=Number.MAX_SAFE_INTEGER;class B{constructor(e,t){void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=null==t?B.makeArray(e):t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>32*this.bits.length){const t=B.makeArray(e);h.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return!!(this.bits[Math.floor(e/32)]&1<<(31&e))}set(e){this.bits[Math.floor(e/32)]|=1<<(31&e)}flip(e){this.bits[Math.floor(e/32)]^=1<<(31&e)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let A=Math.floor(e/32),r=n[A];r&=~((1<<(31&e))-1);const i=n.length;for(;0===r;){if(++A===i)return t;r=n[A]}const o=32*A+b.numberOfTrailingZeros(r);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let A=Math.floor(e/32),r=~n[A];r&=~((1<<(31&e))-1);const i=n.length;for(;0===r;){if(++A===i)return t;r=~n[A]}const o=32*A+b.numberOfTrailingZeros(r);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new I;if(t===e)return;t--;const n=Math.floor(e/32),A=Math.floor(t/32),r=this.bits;for(let i=n;i<=A;i++){const o=(2<<(i<A?31:31&t))-(1<<(i>n?0:31&e));r[i]|=o}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new I;if(t===e)return!0;t--;const A=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let o=A;o<=r;o++){const s=(2<<(o<r?31:31&t))-(1<<(o>A?0:31&e))&4294967295;if((i[o]&s)!==(n?s:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(e,t){if(t<0||t>32)throw new I("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let n=t;n>0;n--)this.appendBit(1==(e>>n-1&1))}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new I("Sizes don't match");const t=this.bits;for(let n=0,A=t.length;n<A;n++)t[n]^=e.bits[n]}toBytes(e,t,n,A){for(let r=0;r<A;r++){let A=0;for(let t=0;t<8;t++)this.get(e)&&(A|=1<<7-t),e++;t[n+r]=A}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,A=this.bits;for(let r=0;r<n;r++){let n=A[r];n=n>>1&1431655765|(1431655765&n)<<1,n=n>>2&858993459|(858993459&n)<<2,n=n>>4&252645135|(252645135&n)<<4,n=n>>8&16711935|(16711935&n)<<8,n=n>>16&65535|(65535&n)<<16,e[t-r]=n}if(this.size!==32*n){const t=32*n-this.size;let A=e[0]>>>t;for(let r=1;r<n;r++){const n=e[r];A|=n<<32-t,e[r-1]=A,A=n>>>t}e[n-1]=A}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof B))return!1;const t=e;return this.size===t.size&&f.equals(this.bits,t.bits)}hashCode(){return 31*this.size+f.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)7&t||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new B(this.size,this.bits.slice())}}(a=s||(s={}))[a.OTHER=0]="OTHER",a[a.PURE_BARCODE=1]="PURE_BARCODE",a[a.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",a[a.TRY_HARDER=3]="TRY_HARDER",a[a.CHARACTER_SET=4]="CHARACTER_SET",a[a.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",a[a.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",a[a.ASSUME_GS1=7]="ASSUME_GS1",a[a.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",a[a.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",a[a.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS";var y,w,Z=s;class S extends l{static getFormatInstance(){return new S}}S.kind="FormatException",(w=y||(y={}))[w.Cp437=0]="Cp437",w[w.ISO8859_1=1]="ISO8859_1",w[w.ISO8859_2=2]="ISO8859_2",w[w.ISO8859_3=3]="ISO8859_3",w[w.ISO8859_4=4]="ISO8859_4",w[w.ISO8859_5=5]="ISO8859_5",w[w.ISO8859_6=6]="ISO8859_6",w[w.ISO8859_7=7]="ISO8859_7",w[w.ISO8859_8=8]="ISO8859_8",w[w.ISO8859_9=9]="ISO8859_9",w[w.ISO8859_10=10]="ISO8859_10",w[w.ISO8859_11=11]="ISO8859_11",w[w.ISO8859_13=12]="ISO8859_13",w[w.ISO8859_14=13]="ISO8859_14",w[w.ISO8859_15=14]="ISO8859_15",w[w.ISO8859_16=15]="ISO8859_16",w[w.SJIS=16]="SJIS",w[w.Cp1250=17]="Cp1250",w[w.Cp1251=18]="Cp1251",w[w.Cp1252=19]="Cp1252",w[w.Cp1256=20]="Cp1256",w[w.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",w[w.UTF8=22]="UTF8",w[w.ASCII=23]="ASCII",w[w.Big5=24]="Big5",w[w.GB18030=25]="GB18030",w[w.EUC_KR=26]="EUC_KR";class v{constructor(e,t,n,...A){this.valueIdentifier=e,this.name=n,this.values="number"==typeof t?Int32Array.from([t]):t,this.otherEncodingNames=A,v.VALUE_IDENTIFIER_TO_ECI.set(e,this),v.NAME_TO_ECI.set(n,this);const r=this.values;for(let i=0,o=r.length;i!==o;i++){const e=r[i];v.VALUES_TO_ECI.set(e,this)}for(const i of A)v.NAME_TO_ECI.set(i,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new S("incorect value");const t=v.VALUES_TO_ECI.get(e);if(void 0===t)throw new S("incorect value");return t}static getCharacterSetECIByName(e){const t=v.NAME_TO_ECI.get(e);if(void 0===t)throw new S("incorect value");return t}equals(e){if(!(e instanceof v))return!1;const t=e;return this.getName()===t.getName()}}v.VALUE_IDENTIFIER_TO_ECI=new Map,v.VALUES_TO_ECI=new Map,v.NAME_TO_ECI=new Map,v.Cp437=new v(y.Cp437,Int32Array.from([0,2]),"Cp437"),v.ISO8859_1=new v(y.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),v.ISO8859_2=new v(y.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),v.ISO8859_3=new v(y.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),v.ISO8859_4=new v(y.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),v.ISO8859_5=new v(y.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),v.ISO8859_6=new v(y.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),v.ISO8859_7=new v(y.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),v.ISO8859_8=new v(y.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),v.ISO8859_9=new v(y.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),v.ISO8859_10=new v(y.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),v.ISO8859_11=new v(y.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),v.ISO8859_13=new v(y.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),v.ISO8859_14=new v(y.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),v.ISO8859_15=new v(y.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),v.ISO8859_16=new v(y.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),v.SJIS=new v(y.SJIS,20,"SJIS","Shift_JIS"),v.Cp1250=new v(y.Cp1250,21,"Cp1250","windows-1250"),v.Cp1251=new v(y.Cp1251,22,"Cp1251","windows-1251"),v.Cp1252=new v(y.Cp1252,23,"Cp1252","windows-1252"),v.Cp1256=new v(y.Cp1256,24,"Cp1256","windows-1256"),v.UnicodeBigUnmarked=new v(y.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),v.UTF8=new v(y.UTF8,26,"UTF8","UTF-8"),v.ASCII=new v(y.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),v.Big5=new v(y.Big5,28,"Big5"),v.GB18030=new v(y.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),v.EUC_KR=new v(y.EUC_KR,30,"EUC_KR","EUC-KR");class G extends l{}G.kind="UnsupportedOperationException";class R{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!R.isBrowser()&&"ISO-8859-1"===e}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):"undefined"==typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(e){return"string"==typeof e?e:e.getName()}static encodingCharacterSet(e){return e instanceof v?e:v.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(R.isDecodeFallbackSupported(n)){let t="";for(let n=0,A=e.length;n<A;n++){let A=e[n].toString(16);A.length<2&&(A="0"+A),t+="%"+A}return decodeURIComponent(t)}if(n.equals(v.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new G(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(v.UTF8)||e.equals(v.ISO8859_1)||e.equals(v.ASCII)}static encodeFallback(e){const t=btoa(unescape(encodeURIComponent(e))).split(""),n=[];for(let A=0;A<t.length;A++)n.push(t[A].charCodeAt(0));return new Uint8Array(n)}}class V{static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return R.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(null!=t&&void 0!==t.get(Z.CHARACTER_SET))return t.get(Z.CHARACTER_SET).toString();const n=e.length;let A=!0,r=!0,i=!0,o=0,s=0,a=0,g=0,l=0,c=0,I=0,C=0,u=0,d=0,h=0;const m=e.length>3&&239===e[0]&&187===e[1]&&191===e[2];for(let p=0;p<n&&(A||r||i);p++){const t=255&e[p];i&&(o>0?128&t?o--:i=!1:128&t&&(64&t?(o++,32&t?(o++,16&t?(o++,8&t?i=!1:g++):a++):s++):i=!1)),A&&(t>127&&t<160?A=!1:t>159&&(t<192||215===t||247===t)&&h++),r&&(l>0?t<64||127===t||t>252?r=!1:l--:128===t||160===t||t>239?r=!1:t>160&&t<224?(c++,C=0,I++,I>u&&(u=I)):t>127?(l++,I=0,C++,C>d&&(d=C)):(I=0,C=0))}return i&&o>0&&(i=!1),r&&l>0&&(r=!1),i&&(m||s+a+g>0)?V.UTF8:r&&(V.ASSUME_SHIFT_JIS||u>=3||d>=3)?V.SHIFT_JIS:A&&r?2===u&&2===c||10*h>=n?V.SHIFT_JIS:V.ISO88591:A?V.ISO88591:r?V.SHIFT_JIS:i?V.UTF8:V.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;function A(e,A,r,i,o,s){if("%%"===e)return"%";if(void 0===t[++n])return;e=i?parseInt(i.substr(1)):void 0;let a,g=o?parseInt(o.substr(1)):void 0;switch(s){case"s":a=t[n];break;case"c":a=t[n][0];break;case"f":a=parseFloat(t[n]).toFixed(e);break;case"p":a=parseFloat(t[n]).toPrecision(e);break;case"e":a=parseFloat(t[n]).toExponential(e);break;case"x":a=parseInt(t[n]).toString(g||16);break;case"d":a=parseFloat(parseInt(t[n],g||10).toPrecision(e)).toFixed(0)}a="object"==typeof a?JSON.stringify(a):(+a).toString(g);let l=parseInt(r),c=r&&r[0]+""=="0"?"0":" ";for(;a.length<l;)a=void 0!==A?a+c:c+a;return a}let r=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(r,A)}static getBytes(e,t){return R.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}V.SHIFT_JIS=v.SJIS.getName(),V.GB2312="GB2312",V.ISO88591=v.ISO8859_1.getName(),V.EUC_JP="EUC_JP",V.UTF8=v.UTF8.getName(),V.PLATFORM_DEFAULT_ENCODING=V.UTF8,V.ASSUME_SHIFT_JIS=!1;class N{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return"string"==typeof e?this.value+=e.toString():this.encoding?this.value+=V.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,n){for(let A=t;t<t+n;A++)this.append(e[A]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class k{constructor(e,t,n,A){if(this.width=e,this.height=t,this.rowSize=n,this.bits=A,null==t&&(t=e),this.height=t,e<1||t<1)throw new I("Both dimensions must be greater than 0");null==n&&(n=Math.floor((e+31)/32)),this.rowSize=n,null==A&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,A=new k(n,t);for(let r=0;r<t;r++){const t=e[r];for(let e=0;e<n;e++)t[e]&&A.set(e,r)}return A}static parseFromString(e,t,n){if(null===e)throw new I("stringRepresentation cannot be null");const A=new Array(e.length);let r=0,i=0,o=-1,s=0,a=0;for(;a<e.length;)if("\n"===e.charAt(a)||"\r"===e.charAt(a)){if(r>i){if(-1===o)o=r-i;else if(r-i!==o)throw new I("row lengths do not match");i=r,s++}a++}else if(e.substring(a,a+t.length)===t)a+=t.length,A[r]=!0,r++;else{if(e.substring(a,a+n.length)!==n)throw new I("illegal character encountered: "+e.substring(a));a+=n.length,A[r]=!1,r++}if(r>i){if(-1===o)o=r-i;else if(r-i!==o)throw new I("row lengths do not match");s++}const g=new k(o,s);for(let l=0;l<r;l++)A[l]&&g.set(Math.floor(l%o),Math.floor(l/o));return g}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return!!(this.bits[n]>>>(31&e)&1)}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(31&e)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(31&e)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(31&e)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new I("input matrix dimensions do not match");const t=new B(Math.floor(this.width/32)+1),n=this.rowSize,A=this.bits;for(let r=0,i=this.height;r<i;r++){const i=r*n,o=e.getRow(r,t).getBitArray();for(let e=0;e<n;e++)A[i+e]^=o[e]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,A){if(t<0||e<0)throw new I("Left and top must be nonnegative");if(A<1||n<1)throw new I("Height and width must be at least 1");const r=e+n,i=t+A;if(i>this.height||r>this.width)throw new I("The region must fit inside the matrix");const o=this.rowSize,s=this.bits;for(let a=t;a<i;a++){const t=a*o;for(let n=e;n<r;n++)s[t+Math.floor(n/32)]|=1<<(31&n)&4294967295}}getRow(e,t){null==t||t.getSize()<this.width?t=new B(this.width):t.clear();const n=this.rowSize,A=this.bits,r=e*n;for(let i=0;i<n;i++)t.setBulk(32*i,A[r+i]);return t}setRow(e,t){h.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new B(e),A=new B(e);for(let r=0,i=Math.floor((t+1)/2);r<i;r++)n=this.getRow(r,n),A=this.getRow(t-1-r,A),n.reverse(),A.reverse(),this.setRow(r,A),this.setRow(t-1-r,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,A=this.bits;let r=e,i=t,o=-1,s=-1;for(let a=0;a<t;a++)for(let e=0;e<n;e++){const t=A[a*n+e];if(0!==t){if(a<i&&(i=a),a>s&&(s=a),32*e<r){let n=0;for(;!(t<<31-n&4294967295);)n++;32*e+n<r&&(r=32*e+n)}if(32*e+31>o){let n=31;for(;t>>>n==0;)n--;32*e+n>o&&(o=32*e+n)}}}return o<r||s<i?null:Int32Array.from([r,i,o-r+1,s-i+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&0===t[n];)n++;if(n===t.length)return null;const A=n/e;let r=n%e*32;const i=t[n];let o=0;for(;!(i<<31-o&4294967295);)o++;return r+=o,Int32Array.from([r,A])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&0===t[n];)n--;if(n<0)return null;const A=Math.floor(n/e);let r=32*Math.floor(n%e);const i=t[n];let o=31;for(;i>>>o==0;)o--;return r+=o,Int32Array.from([r,A])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof k))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&f.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+f.hashCode(this.bits),e}toString(e="X ",t="  ",n="\n"){return this.buildToString(e,t,n)}buildToString(e,t,n){let A=new N;for(let r=0,i=this.height;r<i;r++){for(let n=0,i=this.width;n<i;n++)A.append(this.get(n,r)?e:t);A.append(n)}return A.toString()}clone(){return new k(this.width,this.height,this.rowSize,this.bits.slice())}}class W extends l{static getNotFoundInstance(){return new W}}W.kind="NotFoundException";class F extends d{constructor(e){super(e),this.luminances=F.EMPTY,this.buckets=new Int32Array(F.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),A=n.getWidth();null==t||t.getSize()<A?t=new B(A):t.clear(),this.initArrays(A);const r=n.getRow(e,this.luminances),i=this.buckets;for(let s=0;s<A;s++)i[(255&r[s])>>F.LUMINANCE_SHIFT]++;const o=F.estimateBlackPoint(i);if(A<3)for(let s=0;s<A;s++)(255&r[s])<o&&t.set(s);else{let e=255&r[0],n=255&r[1];for(let i=1;i<A-1;i++){const A=255&r[i+1];(4*n-e-A)/2<o&&t.set(i),e=n,n=A}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),A=new k(t,n);this.initArrays(t);const r=this.buckets;for(let s=1;s<5;s++){const A=Math.floor(n*s/5),i=e.getRow(A,this.luminances),o=Math.floor(4*t/5);for(let e=Math.floor(t/5);e<o;e++)r[(255&i[e])>>F.LUMINANCE_SHIFT]++}const i=F.estimateBlackPoint(r),o=e.getMatrix();for(let s=0;s<n;s++){const e=s*t;for(let n=0;n<t;n++)(255&o[e+n])<i&&A.set(n,s)}return A}createBinarizer(e){return new F(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let n=0;n<F.LUMINANCE_BUCKETS;n++)t[n]=0}static estimateBlackPoint(e){const t=e.length;let n=0,A=0,r=0;for(let g=0;g<t;g++)e[g]>r&&(A=g,r=e[g]),e[g]>n&&(n=e[g]);let i=0,o=0;for(let g=0;g<t;g++){const t=g-A,n=e[g]*t*t;n>o&&(i=g,o=n)}if(A>i){const e=A;A=i,i=e}if(i-A<=t/16)throw new W;let s=i-1,a=-1;for(let g=i-1;g>A;g--){const t=g-A,r=t*t*(i-g)*(n-e[g]);r>a&&(s=g,a=r)}return s<<F.LUMINANCE_SHIFT}}F.LUMINANCE_BITS=5,F.LUMINANCE_SHIFT=8-F.LUMINANCE_BITS,F.LUMINANCE_BUCKETS=1<<F.LUMINANCE_BITS,F.EMPTY=Uint8ClampedArray.from([0]);class E extends F{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=E.MINIMUM_DIMENSION&&n>=E.MINIMUM_DIMENSION){const A=e.getMatrix();let r=t>>E.BLOCK_SIZE_POWER;t&E.BLOCK_SIZE_MASK&&r++;let i=n>>E.BLOCK_SIZE_POWER;n&E.BLOCK_SIZE_MASK&&i++;const o=E.calculateBlackPoints(A,r,i,t,n),s=new k(t,n);E.calculateThresholdForBlock(A,r,i,t,n,o,s),this.matrix=s}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new E(e)}static calculateThresholdForBlock(e,t,n,A,r,i,o){const s=r-E.BLOCK_SIZE,a=A-E.BLOCK_SIZE;for(let g=0;g<n;g++){let r=g<<E.BLOCK_SIZE_POWER;r>s&&(r=s);const l=E.cap(g,2,n-3);for(let n=0;n<t;n++){let s=n<<E.BLOCK_SIZE_POWER;s>a&&(s=a);const g=E.cap(n,2,t-3);let c=0;for(let e=-2;e<=2;e++){const t=i[l+e];c+=t[g-2]+t[g-1]+t[g]+t[g+1]+t[g+2]}const I=c/25;E.thresholdBlock(e,s,r,I,A,o)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,A,r,i){for(let o=0,s=n*r+t;o<E.BLOCK_SIZE;o++,s+=r)for(let r=0;r<E.BLOCK_SIZE;r++)(255&e[s+r])<=A&&i.set(t+r,n+o)}static calculateBlackPoints(e,t,n,A,r){const i=r-E.BLOCK_SIZE,o=A-E.BLOCK_SIZE,s=new Array(n);for(let a=0;a<n;a++){s[a]=new Int32Array(t);let n=a<<E.BLOCK_SIZE_POWER;n>i&&(n=i);for(let r=0;r<t;r++){let t=r<<E.BLOCK_SIZE_POWER;t>o&&(t=o);let i=0,g=255,l=0;for(let r=0,o=n*A+t;r<E.BLOCK_SIZE;r++,o+=A){for(let t=0;t<E.BLOCK_SIZE;t++){const n=255&e[o+t];i+=n,n<g&&(g=n),n>l&&(l=n)}if(l-g>E.MIN_DYNAMIC_RANGE)for(r++,o+=A;r<E.BLOCK_SIZE;r++,o+=A)for(let t=0;t<E.BLOCK_SIZE;t++)i+=255&e[o+t]}let c=i>>2*E.BLOCK_SIZE_POWER;if(l-g<=E.MIN_DYNAMIC_RANGE&&(c=g/2,a>0&&r>0)){const e=(s[a-1][r]+2*s[a][r-1]+s[a-1][r-1])/4;g<e&&(c=e)}s[a][r]=c}}return s}}E.BLOCK_SIZE_POWER=3,E.BLOCK_SIZE=1<<E.BLOCK_SIZE_POWER,E.BLOCK_SIZE_MASK=E.BLOCK_SIZE-1,E.MINIMUM_DIMENSION=5*E.BLOCK_SIZE,E.MIN_DYNAMIC_RANGE=24;class X{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,A){throw new G("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new G("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new G("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new N;for(let n=0;n<this.height;n++){const A=this.getRow(n,e);for(let e=0;e<this.width;e++){const n=255&A[e];let r;r=n<64?"#":n<128?"+":n<192?".":" ",t.append(r)}t.append("\n")}return t.toString()}}class H extends X{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),A=this.getWidth();for(let r=0;r<A;r++)n[r]=255-(255&n[r]);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let A=0;A<t;A++)n[A]=255-(255&e[A]);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,A){return new H(this.delegate.crop(e,t,n,A))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new H(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new H(this.delegate.rotateCounterClockwise45())}}class x extends X{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=x.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return x.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const A=new Uint8ClampedArray(t*n);for(let r=0,i=0,o=e.length;r<o;r+=4,i++){let t;t=0===e[r+3]?255:306*e[r]+601*e[r+1]+117*e[r+2]+512>>10,A[i]=t}return A}getRow(e,t){if(e<0||e>=this.getHeight())throw new I("Requested row is outside the image: "+e);const n=this.getWidth(),A=e*n;return null===t?t=this.buffer.slice(A,A+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(A,A+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,A){return super.crop(e,t,n,A),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),A=e*x.DEGREE_TO_RADIANS,r=this.canvas.width,i=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(A))*r+Math.abs(Math.sin(A))*i),s=Math.ceil(Math.abs(Math.sin(A))*r+Math.abs(Math.cos(A))*i);return t.width=o,t.height=s,n.translate(o/2,s/2),n.rotate(A),n.drawImage(this.canvas,r/-2,i/-2),this.buffer=x.makeBufferFromCanvasImageData(t),this}invert(){return new H(this)}}x.DEGREE_TO_RADIANS=Math.PI/180;class J{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Y,U,L=(globalThis||o||self||window?(globalThis||o||self||window||void 0).__awaiter:void 0)||function(e,t,n,A){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){e.done?n(e.value):r(e.value).then(o,s)}a((A=A.apply(e,t||[])).next())}))};class T{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return L(this,void 0,void 0,(function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const e="video"===n.kind?"videoinput":n.kind;if("videoinput"!==e)continue;const A={deviceId:n.deviceId||n.id,label:n.label||`Video device ${t.length+1}`,kind:e,groupId:n.groupId};t.push(A)}return t}))}getVideoInputDevices(){return L(this,void 0,void 0,(function*(){return(yield this.listVideoInputDevices()).map((e=>new J(e.deviceId,e.label)))}))}findDeviceById(e){return L(this,void 0,void 0,(function*(){const t=yield this.listVideoInputDevices();return t?t.find((t=>t.deviceId===e)):null}))}decodeFromInputVideoDevice(e,t){return L(this,void 0,void 0,(function*(){return yield this.decodeOnceFromVideoDevice(e,t)}))}decodeOnceFromVideoDevice(e,t){return L(this,void 0,void 0,(function*(){let n;this.reset(),n=e?{deviceId:{exact:e}}:{facingMode:"environment"};const A={video:n};return yield this.decodeOnceFromConstraints(A,t)}))}decodeOnceFromConstraints(e,t){return L(this,void 0,void 0,(function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)}))}decodeOnceFromStream(e,t){return L(this,void 0,void 0,(function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)}))}decodeFromInputVideoDeviceContinuously(e,t,n){return L(this,void 0,void 0,(function*(){return yield this.decodeFromVideoDevice(e,t,n)}))}decodeFromVideoDevice(e,t,n){return L(this,void 0,void 0,(function*(){let A;A=e?{deviceId:{exact:e}}:{facingMode:"environment"};const r={video:A};return yield this.decodeFromConstraints(r,t,n)}))}decodeFromConstraints(e,t,n){return L(this,void 0,void 0,(function*(){const A=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(A,t,n)}))}decodeFromStream(e,t,n){return L(this,void 0,void 0,(function*(){this.reset();const A=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(A,n)}))}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return L(this,void 0,void 0,(function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n}))}playVideoOnLoadAsync(e){return new Promise(((t,n)=>this.playVideoOnLoad(e,(()=>t()))))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return L(this,void 0,void 0,(function*(){if(!this.isVideoPlaying(e))try{yield e.play()}catch(t){}}))}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new c(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new c(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new c("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new c("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(void 0===e&&void 0===t)throw new c("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new c("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);let n;return this.imageElement=t,n=this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new c("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new c("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new c("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new c("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),A=this.decodeFromVideoElementContinuously(n,t);return n.src=e,A}_decodeOnLoadImage(e){return new Promise(((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)}))}_decodeOnLoadVideo(e){return L(this,void 0,void 0,(function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)}))}_decodeOnLoadVideoContinuously(e,t){return L(this,void 0,void 0,(function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)}))}isImageLoaded(e){return!!e.complete&&0!==e.naturalWidth}prepareImageElement(e){let t;return void 0===e&&(t=document.createElement("img"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return e||"undefined"==typeof document||(t=document.createElement("video"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const A=(r,i)=>{if(this._stopAsyncDecode)return i(new W("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{r(this.decode(e))}catch(Zf){if(t&&Zf instanceof W||(Zf instanceof u||Zf instanceof S)&&n)return setTimeout(A,this._timeBetweenDecodingAttempts,r,i);i(Zf)}};return new Promise(((e,t)=>A(e,t)))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const A=this.decode(e);t(A,null),setTimeout(n,this.timeBetweenScansMillis)}catch(Zf){t(null,Zf),(Zf instanceof u||Zf instanceof S||Zf instanceof W)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return 0!==e.videoWidth}drawFrameOnCanvas(e,t,n){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,n=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n||(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),n=new x(t),A=new E(n);return new C(A)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const t=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=t}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,A;return void 0!==e&&(e instanceof HTMLVideoElement?(n=e.videoWidth,A=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,A=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=A+"px",t.width=n,t.height=A,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach((e=>e.stop())),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch(n){e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")}}class K{constructor(e,t,n=(null==t?0:8*t.length),A,r,i=h.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=A,this.format=r,this.timestamp=i,this.text=e,this.rawBytes=t,this.numBits=null==n?null==t?0:8*t.length:n,this.resultPoints=A,this.format=r,this.resultMetadata=null,this.timestamp=null==i?h.currentTimeMillis():i}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){null!==e&&(null===this.resultMetadata?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(null===t)this.resultPoints=e;else if(null!==e&&e.length>0){const n=new Array(t.length+e.length);h.arraycopy(t,0,n,0,t.length),h.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}(U=Y||(Y={}))[U.AZTEC=0]="AZTEC",U[U.CODABAR=1]="CODABAR",U[U.CODE_39=2]="CODE_39",U[U.CODE_93=3]="CODE_93",U[U.CODE_128=4]="CODE_128",U[U.DATA_MATRIX=5]="DATA_MATRIX",U[U.EAN_8=6]="EAN_8",U[U.EAN_13=7]="EAN_13",U[U.ITF=8]="ITF",U[U.MAXICODE=9]="MAXICODE",U[U.PDF_417=10]="PDF_417",U[U.QR_CODE=11]="QR_CODE",U[U.RSS_14=12]="RSS_14",U[U.RSS_EXPANDED=13]="RSS_EXPANDED",U[U.UPC_A=14]="UPC_A",U[U.UPC_E=15]="UPC_E",U[U.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var M,Q,D=Y;(Q=M||(M={}))[Q.OTHER=0]="OTHER",Q[Q.ORIENTATION=1]="ORIENTATION",Q[Q.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",Q[Q.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",Q[Q.ISSUE_NUMBER=4]="ISSUE_NUMBER",Q[Q.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",Q[Q.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",Q[Q.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",Q[Q.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",Q[Q.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",Q[Q.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY";var z,O,P,_,j,q,$,ee,te,ne,Ae,re=M;class ie{constructor(e,t,n,A,r=-1,i=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=A,this.structuredAppendSequenceNumber=r,this.structuredAppendParity=i,this.numBits=null==e?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class oe{exp(e){return this.expTable[e]}log(e){if(0===e)throw new I;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class se{constructor(e,t){if(0===t.length)throw new I;this.field=e;const n=t.length;if(n>1&&0===t[0]){let e=1;for(;e<n&&0===t[e];)e++;e===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-e),h.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);const t=this.coefficients;let n;if(1===e){n=0;for(let e=0,A=t.length;e!==A;e++){const A=t[e];n=oe.addOrSubtract(n,A)}return n}n=t[0];const A=t.length,r=this.field;for(let i=1;i<A;i++)n=oe.addOrSubtract(r.multiply(e,n),t[i]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new I("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const e=t;t=n,n=e}let A=new Int32Array(n.length);const r=n.length-t.length;h.arraycopy(n,0,A,0,r);for(let i=r;i<n.length;i++)A[i]=oe.addOrSubtract(t[i-r],n[i]);return new se(this.field,A)}multiply(e){if(!this.field.equals(e.field))throw new I("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,A=e.coefficients,r=A.length,i=new Int32Array(n+r-1),o=this.field;for(let s=0;s<n;s++){const e=t[s];for(let t=0;t<r;t++)i[s+t]=oe.addOrSubtract(i[s+t],o.multiply(e,A[t]))}return new se(o,i)}multiplyScalar(e){if(0===e)return this.field.getZero();if(1===e)return this;const t=this.coefficients.length,n=this.field,A=new Int32Array(t),r=this.coefficients;for(let i=0;i<t;i++)A[i]=n.multiply(r[i],e);return new se(n,A)}multiplyByMonomial(e,t){if(e<0)throw new I;if(0===t)return this.field.getZero();const n=this.coefficients,A=n.length,r=new Int32Array(A+e),i=this.field;for(let o=0;o<A;o++)r[o]=i.multiply(n[o],t);return new se(i,r)}divide(e){if(!this.field.equals(e.field))throw new I("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new I("Divide by 0");const t=this.field;let n=t.getZero(),A=this;const r=e.getCoefficient(e.getDegree()),i=t.inverse(r);for(;A.getDegree()>=e.getDegree()&&!A.isZero();){const r=A.getDegree()-e.getDegree(),o=t.multiply(A.getCoefficient(A.getDegree()),i),s=e.multiplyByMonomial(r,o),a=t.buildMonomial(r,o);n=n.addOrSubtract(a),A=A.addOrSubtract(s)}return[n,A]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(0!==n){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),0===t||1!==n){const t=this.field.log(n);0===t?e+="1":1===t?e+="a":(e+="a^",e+=t)}0!==t&&(1===t?e+="x":(e+="x^",e+=t))}}return e}}class ae extends l{}ae.kind="ArithmeticException";class ge extends oe{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const A=new Int32Array(t);let r=1;for(let o=0;o<t;o++)A[o]=r,r*=2,r>=t&&(r^=e,r&=t-1);this.expTable=A;const i=new Int32Array(t);for(let o=0;o<t-1;o++)i[A[o]]=o;this.logTable=i,this.zero=new se(this,Int32Array.from([0])),this.one=new se(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new I;if(0===t)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new se(this,n)}inverse(e){if(0===e)throw new ae;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+b.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}ge.AZTEC_DATA_12=new ge(4201,4096,1),ge.AZTEC_DATA_10=new ge(1033,1024,1),ge.AZTEC_DATA_6=new ge(67,64,1),ge.AZTEC_PARAM=new ge(19,16,1),ge.QR_CODE_FIELD_256=new ge(285,256,0),ge.DATA_MATRIX_FIELD_256=new ge(301,256,1),ge.AZTEC_DATA_8=ge.DATA_MATRIX_FIELD_256,ge.MAXICODE_FIELD_64=ge.AZTEC_DATA_6;class le extends l{}le.kind="ReedSolomonException";class ce extends l{}ce.kind="IllegalStateException";class Ie{constructor(e){this.field=e}decode(e,t){const n=this.field,A=new se(n,e),r=new Int32Array(t);let i=!0;for(let I=0;I<t;I++){const e=A.evaluateAt(n.exp(I+n.getGeneratorBase()));r[r.length-1-I]=e,0!==e&&(i=!1)}if(i)return;const o=new se(n,r),s=this.runEuclideanAlgorithm(n.buildMonomial(t,1),o,t),a=s[0],g=s[1],l=this.findErrorLocations(a),c=this.findErrorMagnitudes(g,l);for(let I=0;I<l.length;I++){const t=e.length-1-n.log(l[I]);if(t<0)throw new le("Bad error location");e[t]=ge.addOrSubtract(e[t],c[I])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const n=e;e=t,t=n}const A=this.field;let r=e,i=t,o=A.getZero(),s=A.getOne();for(;i.getDegree()>=(n/2|0);){let e=r,t=o;if(r=i,o=s,r.isZero())throw new le("r_{i-1} was zero");i=e;let n=A.getZero();const a=r.getCoefficient(r.getDegree()),g=A.inverse(a);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){const e=i.getDegree()-r.getDegree(),t=A.multiply(i.getCoefficient(i.getDegree()),g);n=n.addOrSubtract(A.buildMonomial(e,t)),i=i.addOrSubtract(r.multiplyByMonomial(e,t))}if(s=n.multiply(o).addOrSubtract(t),i.getDegree()>=r.getDegree())throw new ce("Division algorithm failed to reduce polynomial?")}const a=s.getCoefficient(0);if(0===a)throw new le("sigmaTilde(0) was zero");const g=A.inverse(a);return[s.multiplyScalar(g),i.multiplyScalar(g)]}findErrorLocations(e){const t=e.getDegree();if(1===t)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let A=0;const r=this.field;for(let i=1;i<r.getSize()&&A<t;i++)0===e.evaluateAt(i)&&(n[A]=r.inverse(i),A++);if(A!==t)throw new le("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,A=new Int32Array(n),r=this.field;for(let i=0;i<n;i++){const o=r.inverse(t[i]);let s=1;for(let e=0;e<n;e++)if(i!==e){const n=r.multiply(t[e],o),A=1&n?-2&n:1|n;s=r.multiply(s,A)}A[i]=r.multiply(e.evaluateAt(o),r.inverse(s)),0!==r.getGeneratorBase()&&(A[i]=r.multiply(A[i],o))}return A}}($=z||(z={}))[$.UPPER=0]="UPPER",$[$.LOWER=1]="LOWER",$[$.MIXED=2]="MIXED",$[$.DIGIT=3]="DIGIT",$[$.PUNCT=4]="PUNCT",$[$.BINARY=5]="BINARY";class Ce{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),A=this.correctBits(n),r=Ce.convertBoolArrayToByteArray(A),i=Ce.getEncodedData(A),o=new ie(r,i,null,null);return o.setNumBits(A.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=z.UPPER,A=z.UPPER,r="",i=0;for(;i<t;)if(A===z.BINARY){if(t-i<5)break;let o=Ce.readCode(e,i,5);if(i+=5,0===o){if(t-i<11)break;o=Ce.readCode(e,i,11)+31,i+=11}for(let n=0;n<o;n++){if(t-i<8){i=t;break}const n=Ce.readCode(e,i,8);r+=V.castAsNonUtf8Char(n),i+=8}A=n}else{let o=A===z.DIGIT?4:5;if(t-i<o)break;let s=Ce.readCode(e,i,o);i+=o;let a=Ce.getCharacter(A,s);a.startsWith("CTRL_")?(n=A,A=Ce.getTable(a.charAt(5)),"L"===a.charAt(6)&&(n=A)):(r+=a,A=n)}return r}static getTable(e){switch(e){case"L":return z.LOWER;case"P":return z.PUNCT;case"M":return z.MIXED;case"D":return z.DIGIT;case"B":return z.BINARY;default:return z.UPPER}}static getCharacter(e,t){switch(e){case z.UPPER:return Ce.UPPER_TABLE[t];case z.LOWER:return Ce.LOWER_TABLE[t];case z.MIXED:return Ce.MIXED_TABLE[t];case z.PUNCT:return Ce.PUNCT_TABLE[t];case z.DIGIT:return Ce.DIGIT_TABLE[t];default:throw new ce("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=ge.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=ge.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=ge.AZTEC_DATA_10):(n=12,t=ge.AZTEC_DATA_12);let A=this.ddata.getNbDatablocks(),r=e.length/n;if(r<A)throw new S;let i=e.length%n,o=new Int32Array(r);for(let I=0;I<r;I++,i+=n)o[I]=Ce.readCode(e,i,n);try{new Ie(t).decode(o,r-A)}catch(c){throw new S(c)}let s=(1<<n)-1,a=0;for(let I=0;I<A;I++){let e=o[I];if(0===e||e===s)throw new S;1!==e&&e!==s-1||a++}let g=new Array(A*n-a),l=0;for(let I=0;I<A;I++){let e=o[I];if(1===e||e===s-1)g.fill(e>1,l,l+n-1),l+=n-1;else for(let t=n-1;t>=0;--t)g[l++]=!!(e&1<<t)}return g}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),A=(t?11:14)+4*n,r=new Int32Array(A),i=new Array(this.totalBitsInLayer(n,t));if(t)for(let o=0;o<r.length;o++)r[o]=o;else{let e=A+1+2*b.truncDivision(b.truncDivision(A,2)-1,15),t=A/2,n=b.truncDivision(e,2);for(let A=0;A<t;A++){let e=A+b.truncDivision(A,15);r[t-A-1]=n-e-1,r[t+A]=n+e+1}}for(let o=0,s=0;o<n;o++){let a=4*(n-o)+(t?9:12),g=2*o,l=A-1-g;for(let t=0;t<a;t++){let n=2*t;for(let A=0;A<2;A++)i[s+n+A]=e.get(r[g+A],r[g+t]),i[s+2*a+n+A]=e.get(r[g+t],r[l-A]),i[s+4*a+n+A]=e.get(r[l-A],r[l-t]),i[s+6*a+n+A]=e.get(r[l-t],r[g+A])}s+=8*a}return i}static readCode(e,t,n){let A=0;for(let r=t;r<t+n;r++)A<<=1,e[r]&&(A|=1);return A}static readByte(e,t){let n=e.length-t;return n>=8?Ce.readCode(e,t,8):Ce.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=Ce.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Ce.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ce.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ce.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ce.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ce.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ue{constructor(){}static round(e){return NaN===e?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,A){const r=e-n,i=t-A;return Math.sqrt(r*r+i*i)}static sum(e){let t=0;for(let n=0,A=e.length;n!==A;n++)t+=e[n];return t}}class de{static floatToIntBits(e){return e}}de.MAX_VALUE=Number.MAX_SAFE_INTEGER;class he{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof he){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*de.floatToIntBits(this.x)+de.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),A=this.distance(e[0],e[2]);let r,i,o;if(n>=t&&n>=A?(i=e[0],r=e[1],o=e[2]):A>=n&&A>=t?(i=e[1],r=e[0],o=e[2]):(i=e[2],r=e[0],o=e[1]),this.crossProductZ(r,i,o)<0){const e=r;r=o,o=e}e[0]=r,e[1]=i,e[2]=o}static distance(e,t){return ue.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const A=t.x,r=t.y;return(n.x-A)*(e.y-r)-(n.y-r)*(e.x-A)}}class me{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class pe extends me{constructor(e,t,n,A,r){super(e,t),this.compact=n,this.nbDatablocks=A,this.nbLayers=r}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class fe{constructor(e,t,n,A){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),null==t&&(t=fe.INIT_SIZE),null==n&&(n=e.getWidth()/2|0),null==A&&(A=e.getHeight()/2|0);const r=t/2|0;if(this.leftInit=n-r,this.rightInit=n+r,this.upInit=A-r,this.downInit=A+r,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new W}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,A=this.downInit,r=!1,i=!0,o=!1,s=!1,a=!1,g=!1,l=!1;const c=this.width,I=this.height;for(;i;){i=!1;let C=!0;for(;(C||!s)&&t<c;)C=this.containsBlackPoint(n,A,t,!1),C?(t++,i=!0,s=!0):s||t++;if(t>=c){r=!0;break}let u=!0;for(;(u||!a)&&A<I;)u=this.containsBlackPoint(e,t,A,!0),u?(A++,i=!0,a=!0):a||A++;if(A>=I){r=!0;break}let d=!0;for(;(d||!g)&&e>=0;)d=this.containsBlackPoint(n,A,e,!1),d?(e--,i=!0,g=!0):g||e--;if(e<0){r=!0;break}let h=!0;for(;(h||!l)&&n>=0;)h=this.containsBlackPoint(e,t,n,!0),h?(n--,i=!0,l=!0):l||n--;if(n<0){r=!0;break}i&&(o=!0)}if(!r&&o){const r=t-e;let i=null;for(let t=1;null===i&&t<r;t++)i=this.getBlackPointOnSegment(e,A-t,e+t,A);if(null==i)throw new W;let o=null;for(let t=1;null===o&&t<r;t++)o=this.getBlackPointOnSegment(e,n+t,e+t,n);if(null==o)throw new W;let s=null;for(let e=1;null===s&&e<r;e++)s=this.getBlackPointOnSegment(t,n+e,t-e,n);if(null==s)throw new W;let a=null;for(let e=1;null===a&&e<r;e++)a=this.getBlackPointOnSegment(t,A-e,t-e,A);if(null==a)throw new W;return this.centerEdges(a,i,s,o)}throw new W}getBlackPointOnSegment(e,t,n,A){const r=ue.round(ue.distance(e,t,n,A)),i=(n-e)/r,o=(A-t)/r,s=this.image;for(let a=0;a<r;a++){const n=ue.round(e+a*i),A=ue.round(t+a*o);if(s.get(n,A))return new he(n,A)}return null}centerEdges(e,t,n,A){const r=e.getX(),i=e.getY(),o=t.getX(),s=t.getY(),a=n.getX(),g=n.getY(),l=A.getX(),c=A.getY(),I=fe.CORR;return r<this.width/2?[new he(l-I,c+I),new he(o+I,s+I),new he(a-I,g-I),new he(r+I,i-I)]:[new he(l+I,c+I),new he(o+I,s-I),new he(a-I,g+I),new he(r-I,i-I)]}containsBlackPoint(e,t,n,A){const r=this.image;if(A){for(let i=e;i<=t;i++)if(r.get(i,n))return!0}else for(let i=e;i<=t;i++)if(r.get(n,i))return!0;return!1}}fe.INIT_SIZE=10,fe.CORR=1;class be{static checkAndNudgePoints(e,t){const n=e.getWidth(),A=e.getHeight();let r=!0;for(let i=0;i<t.length&&r;i+=2){const e=Math.floor(t[i]),o=Math.floor(t[i+1]);if(e<-1||e>n||o<-1||o>A)throw new W;r=!1,-1===e?(t[i]=0,r=!0):e===n&&(t[i]=n-1,r=!0),-1===o?(t[i+1]=0,r=!0):o===A&&(t[i+1]=A-1,r=!0)}r=!0;for(let i=t.length-2;i>=0&&r;i-=2){const e=Math.floor(t[i]),o=Math.floor(t[i+1]);if(e<-1||e>n||o<-1||o>A)throw new W;r=!1,-1===e?(t[i]=0,r=!0):e===n&&(t[i]=n-1,r=!0),-1===o?(t[i+1]=0,r=!0):o===A&&(t[i+1]=A-1,r=!0)}}}class Be{constructor(e,t,n,A,r,i,o,s,a){this.a11=e,this.a21=t,this.a31=n,this.a12=A,this.a22=r,this.a32=i,this.a13=o,this.a23=s,this.a33=a}static quadrilateralToQuadrilateral(e,t,n,A,r,i,o,s,a,g,l,c,I,C,u,d){const h=Be.quadrilateralToSquare(e,t,n,A,r,i,o,s);return Be.squareToQuadrilateral(a,g,l,c,I,C,u,d).times(h)}transformPoints(e){const t=e.length,n=this.a11,A=this.a12,r=this.a13,i=this.a21,o=this.a22,s=this.a23,a=this.a31,g=this.a32,l=this.a33;for(let c=0;c<t;c+=2){const t=e[c],I=e[c+1],C=r*t+s*I+l;e[c]=(n*t+i*I+a)/C,e[c+1]=(A*t+o*I+g)/C}}transformPointsWithValues(e,t){const n=this.a11,A=this.a12,r=this.a13,i=this.a21,o=this.a22,s=this.a23,a=this.a31,g=this.a32,l=this.a33,c=e.length;for(let I=0;I<c;I++){const c=e[I],C=t[I],u=r*c+s*C+l;e[I]=(n*c+i*C+a)/u,t[I]=(A*c+o*C+g)/u}}static squareToQuadrilateral(e,t,n,A,r,i,o,s){const a=e-n+r-o,g=t-A+i-s;if(0===a&&0===g)return new Be(n-e,r-n,e,A-t,i-A,t,0,0,1);{const l=n-r,c=o-r,I=A-i,C=s-i,u=l*C-c*I,d=(a*C-c*g)/u,h=(l*g-a*I)/u;return new Be(n-e+d*n,o-e+h*o,e,A-t+d*A,s-t+h*s,t,d,h,1)}}static quadrilateralToSquare(e,t,n,A,r,i,o,s){return Be.squareToQuadrilateral(e,t,n,A,r,i,o,s).buildAdjoint()}buildAdjoint(){return new Be(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Be(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class ye extends be{sampleGrid(e,t,n,A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p){const f=Be.quadrilateralToQuadrilateral(A,r,i,o,s,a,g,l,c,I,C,u,d,h,m,p);return this.sampleGridWithTransform(e,t,n,f)}sampleGridWithTransform(e,t,n,A){if(t<=0||n<=0)throw new W;const r=new k(t,n),i=new Float32Array(2*t);for(let s=0;s<n;s++){const t=i.length,n=s+.5;for(let e=0;e<t;e+=2)i[e]=e/2+.5,i[e+1]=n;A.transformPoints(i),be.checkAndNudgePoints(e,i);try{for(let n=0;n<t;n+=2)e.get(Math.floor(i[n]),Math.floor(i[n+1]))&&r.set(n/2,s)}catch(o){throw new W}}return r}}class we{static setGridSampler(e){we.gridSampler=e}static getInstance(){return we.gridSampler}}we.gridSampler=new ye;class Ze{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new he(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Se{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let e=n[0];n[0]=n[2],n[2]=e}this.extractParameters(n);let A=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),r=this.getMatrixCornerPoints(n);return new pe(A,r,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!(this.isValidPoint(e[0])&&this.isValidPoint(e[1])&&this.isValidPoint(e[2])&&this.isValidPoint(e[3])))throw new W;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let A=0;for(let i=0;i<4;i++){let e=n[(this.shift+i)%4];this.compact?(A<<=7,A+=e>>1&127):(A<<=10,A+=(e>>2&992)+(e>>1&31))}let r=this.getCorrectedParameterData(A,this.compact);this.compact?(this.nbLayers=1+(r>>6),this.nbDataBlocks=1+(63&r)):(this.nbLayers=1+(r>>11),this.nbDataBlocks=1+(2047&r))}getRotation(e,t){let n=0;e.forEach(((e,A,r)=>{n=(e>>t-2<<1)+(1&e)+(n<<3)})),n=((1&n)<<11)+(n>>1);for(let A=0;A<4;A++)if(b.bitCount(n^this.EXPECTED_CORNER_BITS[A])<=2)return A;throw new W}getCorrectedParameterData(e,t){let n,A;t?(n=7,A=2):(n=10,A=4);let r=n-A,i=new Int32Array(n);for(let a=n-1;a>=0;--a)i[a]=15&e,e>>=4;try{new Ie(ge.AZTEC_PARAM).decode(i,r)}catch(s){throw new W}let o=0;for(let a=0;a<A;a++)o=(o<<4)+i[a];return o}getBullsEyeCorners(e){let t=e,n=e,A=e,r=e,i=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let e=this.getFirstDifferent(t,i,1,-1),o=this.getFirstDifferent(n,i,1,1),s=this.getFirstDifferent(A,i,-1,1),a=this.getFirstDifferent(r,i,-1,-1);if(this.nbCenterLayers>2){let n=this.distancePoint(a,e)*this.nbCenterLayers/(this.distancePoint(r,t)*(this.nbCenterLayers+2));if(n<.75||n>1.25||!this.isWhiteOrBlackRectangle(e,o,s,a))break}t=e,n=o,A=s,r=a,i=!i}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new W;this.compact=5===this.nbCenterLayers;let o=new he(t.getX()+.5,t.getY()-.5),s=new he(n.getX()+.5,n.getY()+.5),a=new he(A.getX()-.5,A.getY()+.5),g=new he(r.getX()-.5,r.getY()-.5);return this.expandSquare([o,s,a,g],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,A;try{let r=new fe(this.image).detect();e=r[0],t=r[1],n=r[2],A=r[3]}catch(Zf){let i=this.image.getWidth()/2,o=this.image.getHeight()/2;e=this.getFirstDifferent(new Ze(i+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ze(i+7,o+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Ze(i-7,o+7),!1,-1,1).toResultPoint(),A=this.getFirstDifferent(new Ze(i-7,o-7),!1,-1,-1).toResultPoint()}let r=ue.round((e.getX()+A.getX()+t.getX()+n.getX())/4),i=ue.round((e.getY()+A.getY()+t.getY()+n.getY())/4);try{let o=new fe(this.image,15,r,i).detect();e=o[0],t=o[1],n=o[2],A=o[3]}catch(Zf){e=this.getFirstDifferent(new Ze(r+7,i-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ze(r+7,i+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Ze(r-7,i+7),!1,-1,1).toResultPoint(),A=this.getFirstDifferent(new Ze(r-7,i-7),!1,-1,-1).toResultPoint()}return r=ue.round((e.getX()+A.getX()+t.getX()+n.getX())/4),i=ue.round((e.getY()+A.getY()+t.getY()+n.getY())/4),new Ze(r,i)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,A,r){let i=we.getInstance(),o=this.getDimension(),s=o/2-this.nbCenterLayers,a=o/2+this.nbCenterLayers;return i.sampleGrid(e,o,o,s,s,a,s,a,a,s,a,t.getX(),t.getY(),n.getX(),n.getY(),A.getX(),A.getY(),r.getX(),r.getY())}sampleLine(e,t,n){let A=0,r=this.distanceResultPoint(e,t),i=r/n,o=e.getX(),s=e.getY(),a=i*(t.getX()-e.getX())/r,g=i*(t.getY()-e.getY())/r;for(let l=0;l<n;l++)this.image.get(ue.round(o+l*a),ue.round(s+l*g))&&(A|=1<<n-l-1);return A}isWhiteOrBlackRectangle(e,t,n,A){let r=3;e=new Ze(e.getX()-r,e.getY()+r),t=new Ze(t.getX()-r,t.getY()-r),n=new Ze(n.getX()+r,n.getY()-r),A=new Ze(A.getX()+r,A.getY()+r);let i=this.getColor(A,e);if(0===i)return!1;let o=this.getColor(e,t);return o===i&&(o=this.getColor(t,n),o===i&&(o=this.getColor(n,A),o===i))}getColor(e,t){let n=this.distancePoint(e,t),A=(t.getX()-e.getX())/n,r=(t.getY()-e.getY())/n,i=0,o=e.getX(),s=e.getY(),a=this.image.get(e.getX(),e.getY()),g=Math.ceil(n);for(let c=0;c<g;c++)o+=A,s+=r,this.image.get(ue.round(o),ue.round(s))!==a&&i++;let l=i/n;return l>.1&&l<.9?0:l<=.1===a?1:-1}getFirstDifferent(e,t,n,A){let r=e.getX()+n,i=e.getY()+A;for(;this.isValid(r,i)&&this.image.get(r,i)===t;)r+=n,i+=A;for(r-=n,i-=A;this.isValid(r,i)&&this.image.get(r,i)===t;)r+=n;for(r-=n;this.isValid(r,i)&&this.image.get(r,i)===t;)i+=A;return i-=A,new Ze(r,i)}expandSquare(e,t,n){let A=n/(2*t),r=e[0].getX()-e[2].getX(),i=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,s=(e[0].getY()+e[2].getY())/2,a=new he(o+A*r,s+A*i),g=new he(o-A*r,s-A*i);return r=e[1].getX()-e[3].getX(),i=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,s=(e[1].getY()+e[3].getY())/2,[a,new he(o+A*r,s+A*i),g,new he(o-A*r,s-A*i)]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=ue.round(e.getX()),n=ue.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return ue.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return ue.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(b.truncDivision(this.nbLayers-4,8)+1)+15}}class ve{decode(e,t=null){let n=null,A=new Se(e.getBlackMatrix()),r=null,i=null;try{let e=A.detectMirror(!1);r=e.getPoints(),this.reportFoundResultPoints(t,r),i=(new Ce).decode(e)}catch(Zf){n=Zf}if(null==i)try{let e=A.detectMirror(!0);r=e.getPoints(),this.reportFoundResultPoints(t,r),i=(new Ce).decode(e)}catch(Zf){if(null!=n)throw n;throw Zf}let o=new K(i.getText(),i.getRawBytes(),i.getNumBits(),r,D.AZTEC,h.currentTimeMillis()),s=i.getByteSegments();null!=s&&o.putMetadata(re.BYTE_SEGMENTS,s);let a=i.getECLevel();return null!=a&&o.putMetadata(re.ERROR_CORRECTION_LEVEL,a),o}reportFoundResultPoints(e,t){if(null!=e){let n=e.get(Z.NEED_RESULT_POINT_CALLBACK);null!=n&&t.forEach(((e,t,A)=>{n.foundPossibleResultPoint(e)}))}}reset(){}}class Ge extends T{constructor(e=500){super(new ve,e)}}class Re{decode(e,t){try{return this.doDecode(e,t)}catch(n){if(t&&!0===t.get(Z.TRY_HARDER)&&e.isRotateSupported()){const n=e.rotateCounterClockwise(),A=this.doDecode(n,t),r=A.getResultMetadata();let i=270;null!==r&&!0===r.get(re.ORIENTATION)&&(i+=r.get(re.ORIENTATION)%360),A.putMetadata(re.ORIENTATION,i);const o=A.getResultPoints();if(null!==o){const e=n.getHeight();for(let t=0;t<o.length;t++)o[t]=new he(e-o[t].getY()-1,o[t].getX())}return A}throw new W}}reset(){}doDecode(e,t){const n=e.getWidth(),A=e.getHeight();let r=new B(n);const i=t&&!0===t.get(Z.TRY_HARDER),o=Math.max(1,A>>(i?8:5));let s;s=i?A:15;const a=Math.trunc(A/2);for(let l=0;l<s;l++){const i=Math.trunc((l+1)/2),s=a+o*(1&l?-i:i);if(s<0||s>=A)break;try{r=e.getBlackRow(s,r)}catch(g){continue}for(let e=0;e<2;e++){if(1===e&&(r.reverse(),t&&!0===t.get(Z.NEED_RESULT_POINT_CALLBACK))){const e=new Map;t.forEach(((t,n)=>e.set(n,t))),e.delete(Z.NEED_RESULT_POINT_CALLBACK),t=e}try{const A=this.decodeRow(s,r,t);if(1===e){A.putMetadata(re.ORIENTATION,180);const e=A.getResultPoints();null!==e&&(e[0]=new he(n-e[0].getX()-1,e[0].getY()),e[1]=new he(n-e[1].getX()-1,e[1].getY()))}return A}catch(BIe){}}}throw new W}static recordPattern(e,t,n){const A=n.length;for(let a=0;a<A;a++)n[a]=0;const r=e.getSize();if(t>=r)throw new W;let i=!e.get(t),o=0,s=t;for(;s<r;){if(e.get(s)!==i)n[o]++;else{if(++o===A)break;n[o]=1,i=!i}s++}if(o!==A&&(o!==A-1||s!==r))throw new W}static recordPatternInReverse(e,t,n){let A=n.length,r=e.get(t);for(;t>0&&A>=0;)e.get(--t)!==r&&(A--,r=!r);if(A>=0)throw new W;Re.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const A=e.length;let r=0,i=0;for(let a=0;a<A;a++)r+=e[a],i+=t[a];if(r<i)return Number.POSITIVE_INFINITY;const o=r/i;n*=o;let s=0;for(let a=0;a<A;a++){const A=e[a],r=t[a]*o,i=A>r?A-r:r-A;if(i>n)return Number.POSITIVE_INFINITY;s+=i}return s/r}}class Ve extends Re{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let A=0,r=Int32Array.from([0,0,0,0,0,0]),i=n,o=!1;const s=6;for(let a=n;a<t;a++)if(e.get(a)!==o)r[A]++;else{if(A===s-1){let t=Ve.MAX_AVG_VARIANCE,n=-1;for(let e=Ve.CODE_START_A;e<=Ve.CODE_START_C;e++){const A=Re.patternMatchVariance(r,Ve.CODE_PATTERNS[e],Ve.MAX_INDIVIDUAL_VARIANCE);A<t&&(t=A,n=e)}if(n>=0&&e.isRange(Math.max(0,i-(a-i)/2),i,!1))return Int32Array.from([i,a,n]);i+=r[0]+r[1],r=r.slice(2,r.length-1),r[A-1]=0,r[A]=0,A--}else A++;r[A]=1,o=!o}throw new W}static decodeCode(e,t,n){Re.recordPattern(e,n,t);let A=Ve.MAX_AVG_VARIANCE,r=-1;for(let i=0;i<Ve.CODE_PATTERNS.length;i++){const e=Ve.CODE_PATTERNS[i],n=this.patternMatchVariance(t,e,Ve.MAX_INDIVIDUAL_VARIANCE);n<A&&(A=n,r=i)}if(r>=0)return r;throw new W}decodeRow(e,t,n){const A=n&&!0===n.get(Z.ASSUME_GS1),r=Ve.findStartPattern(t),i=r[2];let o=0;const s=new Uint8Array(20);let a;switch(s[o++]=i,i){case Ve.CODE_START_A:a=Ve.CODE_CODE_A;break;case Ve.CODE_START_B:a=Ve.CODE_CODE_B;break;case Ve.CODE_START_C:a=Ve.CODE_CODE_C;break;default:throw new S}let g=!1,l=!1,c="",I=r[0],C=r[1];const d=Int32Array.from([0,0,0,0,0,0]);let h=0,m=0,p=i,f=0,b=!0,B=!1,y=!1;for(;!g;){const e=l;switch(l=!1,h=m,m=Ve.decodeCode(t,d,C),s[o++]=m,m!==Ve.CODE_STOP&&(b=!0),m!==Ve.CODE_STOP&&(f++,p+=f*m),I=C,C+=d.reduce(((e,t)=>e+t),0),m){case Ve.CODE_START_A:case Ve.CODE_START_B:case Ve.CODE_START_C:throw new S}switch(a){case Ve.CODE_CODE_A:if(m<64)c+=y===B?String.fromCharCode(" ".charCodeAt(0)+m):String.fromCharCode(" ".charCodeAt(0)+m+128),y=!1;else if(m<96)c+=y===B?String.fromCharCode(m-64):String.fromCharCode(m+64),y=!1;else switch(m!==Ve.CODE_STOP&&(b=!1),m){case Ve.CODE_FNC_1:A&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case Ve.CODE_FNC_2:case Ve.CODE_FNC_3:break;case Ve.CODE_FNC_4_A:!B&&y?(B=!0,y=!1):B&&y?(B=!1,y=!1):y=!0;break;case Ve.CODE_SHIFT:l=!0,a=Ve.CODE_CODE_B;break;case Ve.CODE_CODE_B:a=Ve.CODE_CODE_B;break;case Ve.CODE_CODE_C:a=Ve.CODE_CODE_C;break;case Ve.CODE_STOP:g=!0}break;case Ve.CODE_CODE_B:if(m<96)c+=y===B?String.fromCharCode(" ".charCodeAt(0)+m):String.fromCharCode(" ".charCodeAt(0)+m+128),y=!1;else switch(m!==Ve.CODE_STOP&&(b=!1),m){case Ve.CODE_FNC_1:A&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case Ve.CODE_FNC_2:case Ve.CODE_FNC_3:break;case Ve.CODE_FNC_4_B:!B&&y?(B=!0,y=!1):B&&y?(B=!1,y=!1):y=!0;break;case Ve.CODE_SHIFT:l=!0,a=Ve.CODE_CODE_A;break;case Ve.CODE_CODE_A:a=Ve.CODE_CODE_A;break;case Ve.CODE_CODE_C:a=Ve.CODE_CODE_C;break;case Ve.CODE_STOP:g=!0}break;case Ve.CODE_CODE_C:if(m<100)m<10&&(c+="0"),c+=m;else switch(m!==Ve.CODE_STOP&&(b=!1),m){case Ve.CODE_FNC_1:A&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case Ve.CODE_CODE_A:a=Ve.CODE_CODE_A;break;case Ve.CODE_CODE_B:a=Ve.CODE_CODE_B;break;case Ve.CODE_STOP:g=!0}}e&&(a=a===Ve.CODE_CODE_A?Ve.CODE_CODE_B:Ve.CODE_CODE_A)}const w=C-I;if(C=t.getNextUnset(C),!t.isRange(C,Math.min(t.getSize(),C+(C-I)/2),!1))throw new W;if(p-=f*h,p%103!==h)throw new u;const v=c.length;if(0===v)throw new W;v>0&&b&&(c=a===Ve.CODE_CODE_C?c.substring(0,v-2):c.substring(0,v-1));const G=(r[1]+r[0])/2,R=I+w/2,V=s.length,N=new Uint8Array(V);for(let u=0;u<V;u++)N[u]=s[u];const k=[new he(G,e),new he(R,e)];return new K(c,N,0,k,D.CODE_128,(new Date).getTime())}}Ve.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ve.MAX_AVG_VARIANCE=.25,Ve.MAX_INDIVIDUAL_VARIANCE=.7,Ve.CODE_SHIFT=98,Ve.CODE_CODE_C=99,Ve.CODE_CODE_B=100,Ve.CODE_CODE_A=101,Ve.CODE_FNC_1=102,Ve.CODE_FNC_2=97,Ve.CODE_FNC_3=96,Ve.CODE_FNC_4_A=101,Ve.CODE_FNC_4_B=100,Ve.CODE_START_A=103,Ve.CODE_START_B=104,Ve.CODE_START_C=105,Ve.CODE_STOP=106;class Ne extends Re{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,n){let A=this.counters;A.fill(0),this.decodeRowResult="";let r,i,o=Ne.findAsteriskPattern(t,A),s=t.getNextSet(o[1]),a=t.getSize();do{Ne.recordPattern(t,s,A);let e=Ne.toNarrowWidePattern(A);if(e<0)throw new W;r=Ne.patternToChar(e),this.decodeRowResult+=r,i=s;for(let t of A)s+=t;s=t.getNextSet(s)}while("*"!==r);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let g,l=0;for(let C of A)l+=C;if(s!==a&&2*(s-i-l)<l)throw new W;if(this.usingCheckDigit){let e=this.decodeRowResult.length-1,t=0;for(let n=0;n<e;n++)t+=Ne.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(n));if(this.decodeRowResult.charAt(e)!==Ne.ALPHABET_STRING.charAt(t%43))throw new u;this.decodeRowResult=this.decodeRowResult.substring(0,e)}if(0===this.decodeRowResult.length)throw new W;g=this.extendedMode?Ne.decodeExtended(this.decodeRowResult):this.decodeRowResult;let c=(o[1]+o[0])/2,I=i+l/2;return new K(g,null,0,[new he(c,e),new he(I,e)],D.CODE_39,(new Date).getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),A=e.getNextSet(0),r=0,i=A,o=!1,s=t.length;for(let a=A;a<n;a++)if(e.get(a)!==o)t[r]++;else{if(r===s-1){if(this.toNarrowWidePattern(t)===Ne.ASTERISK_ENCODING&&e.isRange(Math.max(0,i-Math.floor((a-i)/2)),i,!1))return[i,a];i+=t[0]+t[1],t.copyWithin(0,2,2+r-1),t[r-1]=0,t[r]=0,r--}else r++;t[r]=1,o=!o}throw new W}static toNarrowWidePattern(e){let t,n=e.length,A=0;do{let r=2147483647;for(let t of e)t<r&&t>A&&(r=t);A=r,t=0;let i=0,o=0;for(let s=0;s<n;s++){let r=e[s];r>A&&(o|=1<<n-1-s,t++,i+=r)}if(3===t){for(let r=0;r<n&&t>0;r++){let n=e[r];if(n>A&&(t--,2*n>=i))return-1}return o}}while(t>3);return-1}static patternToChar(e){for(let t=0;t<Ne.CHARACTER_ENCODINGS.length;t++)if(Ne.CHARACTER_ENCODINGS[t]===e)return Ne.ALPHABET_STRING.charAt(t);if(e===Ne.ASTERISK_ENCODING)return"*";throw new W}static decodeExtended(e){let t=e.length,n="";for(let A=0;A<t;A++){let t=e.charAt(A);if("+"===t||"$"===t||"%"===t||"/"===t){let r=e.charAt(A+1),i="\0";switch(t){case"+":if(!(r>="A"&&r<="Z"))throw new S;i=String.fromCharCode(r.charCodeAt(0)+32);break;case"$":if(!(r>="A"&&r<="Z"))throw new S;i=String.fromCharCode(r.charCodeAt(0)-64);break;case"%":if(r>="A"&&r<="E")i=String.fromCharCode(r.charCodeAt(0)-38);else if(r>="F"&&r<="J")i=String.fromCharCode(r.charCodeAt(0)-11);else if(r>="K"&&r<="O")i=String.fromCharCode(r.charCodeAt(0)+16);else if(r>="P"&&r<="T")i=String.fromCharCode(r.charCodeAt(0)+43);else if("U"===r)i="\0";else if("V"===r)i="@";else if("W"===r)i="`";else{if("X"!==r&&"Y"!==r&&"Z"!==r)throw new S;i=""}break;case"/":if(r>="A"&&r<="O")i=String.fromCharCode(r.charCodeAt(0)-32);else{if("Z"!==r)throw new S;i=":"}}n+=i,A++}else n+=t}return n}}Ne.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ne.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ne.ASTERISK_ENCODING=148;class ke extends Re{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let A=this.decodeStart(t),r=this.decodeEnd(t),i=new N;ke.decodeMiddle(t,A[1],r[0],i);let o=i.toString(),s=null;null!=n&&(s=n.get(Z.ALLOWED_LENGTHS)),null==s&&(s=ke.DEFAULT_ALLOWED_LENGTHS);let a=o.length,g=!1,l=0;for(let I of s){if(a===I){g=!0;break}I>l&&(l=I)}if(!g&&a>l&&(g=!0),!g)throw new S;const c=[new he(A[1],e),new he(r[0],e)];return new K(o,null,0,c,D.ITF,(new Date).getTime())}static decodeMiddle(e,t,n,A){let r=new Int32Array(10),i=new Int32Array(5),o=new Int32Array(5);for(r.fill(0),i.fill(0),o.fill(0);t<n;){Re.recordPattern(e,t,r);for(let e=0;e<5;e++){let t=2*e;i[e]=r[t],o[e]=r[t+1]}let n=ke.decodeDigit(i);A.append(n.toString()),n=this.decodeDigit(o),A.append(n.toString()),r.forEach((function(e){t+=e}))}}decodeStart(e){let t=ke.skipWhiteSpace(e),n=ke.findGuardPattern(e,t,ke.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=10*this.narrowLineWidth;n=n<t?n:t;for(let A=t-1;n>0&&A>=0&&!e.get(A);A--)n--;if(0!==n)throw new W}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new W;return n}decodeEnd(e){e.reverse();try{let t,n=ke.skipWhiteSpace(e);try{t=ke.findGuardPattern(e,n,ke.END_PATTERN_REVERSED[0])}catch(PWe){PWe instanceof W&&(t=ke.findGuardPattern(e,n,ke.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,t[0]);let A=t[0];return t[0]=e.getSize()-t[1],t[1]=e.getSize()-A,t}finally{e.reverse()}}static findGuardPattern(e,t,n){let A=n.length,r=new Int32Array(A),i=e.getSize(),o=!1,s=0,a=t;r.fill(0);for(let g=t;g<i;g++)if(e.get(g)!==o)r[s]++;else{if(s===A-1){if(Re.patternMatchVariance(r,n,ke.MAX_INDIVIDUAL_VARIANCE)<ke.MAX_AVG_VARIANCE)return[a,g];a+=r[0]+r[1],h.arraycopy(r,2,r,0,s-1),r[s-1]=0,r[s]=0,s--}else s++;r[s]=1,o=!o}throw new W}static decodeDigit(e){let t=ke.MAX_AVG_VARIANCE,n=-1,A=ke.PATTERNS.length;for(let r=0;r<A;r++){let A=ke.PATTERNS[r],i=Re.patternMatchVariance(e,A,ke.MAX_INDIVIDUAL_VARIANCE);i<t?(t=i,n=r):i===t&&(n=-1)}if(n>=0)return n%10;throw new W}}ke.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ke.MAX_AVG_VARIANCE=.38,ke.MAX_INDIVIDUAL_VARIANCE=.5,ke.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ke.START_PATTERN=Int32Array.from([1,1,1,1]),ke.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class We extends Re{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t,n=!1,A=0,r=Int32Array.from([0,0,0]);for(;!n;){r=Int32Array.from([0,0,0]),t=We.findGuardPattern(e,A,!1,this.START_END_PATTERN,r);let i=t[0];A=t[1];let o=i-(A-i);o>=0&&(n=e.isRange(o,i,!1))}return t}static checkChecksum(e){return We.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let n=parseInt(e.charAt(t-1),10);return We.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let A=t-1;A>=0;A-=2){let t=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new S;n+=t}n*=3;for(let A=t-2;A>=0;A-=2){let t=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new S;n+=t}return(1e3-n)%10}static decodeEnd(e,t){return We.findGuardPattern(e,t,!1,We.START_END_PATTERN,new Int32Array(We.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,n,A){return this.findGuardPattern(e,t,n,A,new Int32Array(A.length))}static findGuardPattern(e,t,n,A,r){let i=e.getSize(),o=0,s=t=n?e.getNextUnset(t):e.getNextSet(t),a=A.length,g=n;for(let l=t;l<i;l++)if(e.get(l)!==g)r[o]++;else{if(o===a-1){if(Re.patternMatchVariance(r,A,We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE)return Int32Array.from([s,l]);s+=r[0]+r[1];let e=r.slice(2,r.length-1);for(let t=0;t<o-1;t++)r[t]=e[t];r[o-1]=0,r[o]=0,o--}else o++;r[o]=1,g=!g}throw new W}static decodeDigit(e,t,n,A){this.recordPattern(e,n,t);let r=this.MAX_AVG_VARIANCE,i=-1,o=A.length;for(let s=0;s<o;s++){let e=A[s],n=Re.patternMatchVariance(t,e,We.MAX_INDIVIDUAL_VARIANCE);n<r&&(r=n,i=s)}if(i>=0)return i;throw new W}}We.MAX_AVG_VARIANCE=.48,We.MAX_INDIVIDUAL_VARIANCE=.7,We.START_END_PATTERN=Int32Array.from([1,1,1]),We.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),We.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),We.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Fe{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let A=this.decodeRowStringBuffer,r=this.decodeMiddle(t,n,A),i=A.toString(),o=Fe.parseExtensionString(i),s=[new he((n[0]+n[1])/2,e),new he(r,e)],a=new K(i,null,0,s,D.UPC_EAN_EXTENSION,(new Date).getTime());return null!=o&&a.putAllMetadata(o),a}decodeMiddle(e,t,n){let A=this.decodeMiddleCounters;A[0]=0,A[1]=0,A[2]=0,A[3]=0;let r=e.getSize(),i=t[1],o=0;for(let a=0;a<5&&i<r;a++){let t=We.decodeDigit(e,A,i,We.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of A)i+=e;t>=10&&(o|=1<<4-a),4!==a&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(5!==n.length)throw new W;let s=this.determineCheckDigit(o);if(Fe.extensionChecksum(n.toString())!==s)throw new W;return i}static extensionChecksum(e){let t=e.length,n=0;for(let A=t-2;A>=0;A-=2)n+=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);n*=3;for(let A=t-1;A>=0;A-=2)n+=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new W}static parseExtensionString(e){if(5!==e.length)return null;let t=Fe.parseExtension5String(e);return null==t?null:new Map([[re.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t=""}let n=parseInt(e.substring(1)),A=n%100;return t+(n/100).toString()+"."+(A<10?"0"+A:A.toString())}}class Ee{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let A=this.decodeRowStringBuffer,r=this.decodeMiddle(t,n,A),i=A.toString(),o=Ee.parseExtensionString(i),s=[new he((n[0]+n[1])/2,e),new he(r,e)],a=new K(i,null,0,s,D.UPC_EAN_EXTENSION,(new Date).getTime());return null!=o&&a.putAllMetadata(o),a}decodeMiddle(e,t,n){let A=this.decodeMiddleCounters;A[0]=0,A[1]=0,A[2]=0,A[3]=0;let r=e.getSize(),i=t[1],o=0;for(let s=0;s<2&&i<r;s++){let t=We.decodeDigit(e,A,i,We.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of A)i+=e;t>=10&&(o|=1<<1-s),1!==s&&(i=e.getNextSet(i),i=e.getNextUnset(i))}if(2!==n.length)throw new W;if(parseInt(n.toString())%4!==o)throw new W;return i}static parseExtensionString(e){return 2!==e.length?null:new Map([[re.ISSUE_NUMBER,parseInt(e)]])}}class Xe{static decodeRow(e,t,n){let A=We.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new Fe).decodeRow(e,t,A)}catch(r){return(new Ee).decodeRow(e,t,A)}}}Xe.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class He extends We{constructor(){super(),this.decodeRowStringBuffer="",He.L_AND_G_PATTERNS=He.L_PATTERNS.map((e=>Int32Array.from(e)));for(let e=10;e<20;e++){let t=He.L_PATTERNS[e-10],n=new Int32Array(t.length);for(let e=0;e<t.length;e++)n[e]=t[t.length-e-1];He.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let A=He.findStartGuardPattern(t),r=null==n?null:n.get(Z.NEED_RESULT_POINT_CALLBACK);if(null!=r){const t=new he((A[0]+A[1])/2,e);r.foundPossibleResultPoint(t)}let i=this.decodeMiddle(t,A,this.decodeRowStringBuffer),o=i.rowOffset,s=i.resultString;if(null!=r){const t=new he(o,e);r.foundPossibleResultPoint(t)}let a=this.decodeEnd(t,o);if(null!=r){const t=new he((a[0]+a[1])/2,e);r.foundPossibleResultPoint(t)}let g=a[1],l=g+(g-a[0]);if(l>=t.getSize()||!t.isRange(g,l,!1))throw new W;let c=s.toString();if(c.length<8)throw new S;if(!He.checkChecksum(c))throw new u;let I=(A[1]+A[0])/2,C=(a[1]+a[0])/2,d=this.getBarcodeFormat(),h=[new he(I,e),new he(C,e)],m=new K(c,null,0,h,d,(new Date).getTime()),p=0;try{let n=Xe.decodeRow(e,t,a[1]);m.putMetadata(re.UPC_EAN_EXTENSION,n.getText()),m.putAllMetadata(n.getResultMetadata()),m.addResultPoints(n.getResultPoints()),p=n.getText().length}catch(b){}let f=null==n?null:n.get(Z.ALLOWED_EAN_EXTENSIONS);if(null!=f){let e=!1;for(let t in f)if(p.toString()===t){e=!0;break}if(!e)throw new W}return m}decodeEnd(e,t){return He.findGuardPattern(e,t,!1,He.START_END_PATTERN,new Int32Array(He.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return He.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let n=parseInt(e.charAt(t-1),10);return He.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let A=t-1;A>=0;A-=2){let t=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new S;n+=t}n*=3;for(let A=t-2;A>=0;A-=2){let t=e.charAt(A).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new S;n+=t}return(1e3-n)%10}}class xe extends He{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){let A=this.decodeMiddleCounters;A[0]=0,A[1]=0,A[2]=0,A[3]=0;let r=e.getSize(),i=t[1],o=0;for(let s=0;s<6&&i<r;s++){let t=He.decodeDigit(e,A,i,He.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of A)i+=e;t>=10&&(o|=1<<5-s)}n=xe.determineFirstDigit(n,o),i=He.findGuardPattern(e,i,!0,He.MIDDLE_PATTERN,new Int32Array(He.MIDDLE_PATTERN.length).fill(0))[1];for(let s=0;s<6&&i<r;s++){let t=He.decodeDigit(e,A,i,He.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of A)i+=e}return{rowOffset:i,resultString:n}}getBarcodeFormat(){return D.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode("0".charCodeAt(0)+n)+e;throw new W}}xe.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Je extends He{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){const A=this.decodeMiddleCounters;A[0]=0,A[1]=0,A[2]=0,A[3]=0;let r=e.getSize(),i=t[1];for(let o=0;o<4&&i<r;o++){let t=He.decodeDigit(e,A,i,He.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of A)i+=e}i=He.findGuardPattern(e,i,!0,He.MIDDLE_PATTERN,new Int32Array(He.MIDDLE_PATTERN.length).fill(0))[1];for(let o=0;o<4&&i<r;o++){let t=He.decodeDigit(e,A,i,He.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of A)i+=e}return{rowOffset:i,resultString:n}}getBarcodeFormat(){return D.EAN_8}}class Ye extends He{constructor(){super(...arguments),this.ean13Reader=new xe}getBarcodeFormat(){return D.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))}decodeMiddle(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)}maybeReturnResult(e){let t=e.getText();if("0"===t.charAt(0)){let n=new K(t.substring(1),null,null,e.getResultPoints(),D.UPC_A);return null!=e.getResultMetadata()&&n.putAllMetadata(e.getResultMetadata()),n}throw new W}reset(){this.ean13Reader.reset()}}class Ue extends He{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,n){const A=this.decodeMiddleCounters.map((e=>e));A[0]=0,A[1]=0,A[2]=0,A[3]=0;const r=e.getSize();let i=t[1],o=0;for(let s=0;s<6&&i<r;s++){const t=Ue.decodeDigit(e,A,i,Ue.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of A)i+=e;t>=10&&(o|=1<<5-s)}return{rowOffset:i,resultString:Ue.determineNumSysAndCheckDigit(n,o)}}decodeEnd(e,t){return Ue.findGuardPatternWithoutCounters(e,t,!0,Ue.MIDDLE_END_PATTERN)}checkChecksum(e){return He.checkChecksum(Ue.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let n=0;n<=1;n++)for(let A=0;A<10;A++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][A])return String.fromCharCode("0".charCodeAt(0)+n)+e+String.fromCharCode("0".charCodeAt(0)+A);throw W.getNotFoundInstance()}getBarcodeFormat(){return D.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map((e=>e.charCodeAt(0))),n=new N;n.append(e.charAt(0));let A=t[5];switch(A){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(A),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(A)}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}Ue.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ue.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Le extends Re{constructor(e){super();let n=null==e?null:e.get(Z.POSSIBLE_FORMATS),A=[];t(n)?(A.push(new xe),A.push(new Ye),A.push(new Je),A.push(new Ue)):(n.indexOf(D.EAN_13)>-1&&A.push(new xe),n.indexOf(D.UPC_A)>-1&&A.push(new Ye),n.indexOf(D.EAN_8)>-1&&A.push(new Je),n.indexOf(D.UPC_E)>-1&&A.push(new Ue)),this.readers=A}decodeRow(e,t,n){for(let r of this.readers)try{const A=r.decodeRow(e,t,n),i=A.getBarcodeFormat()===D.EAN_13&&"0"===A.getText().charAt(0),o=null==n?null:n.get(Z.POSSIBLE_FORMATS),s=null==o||o.includes(D.UPC_A);if(i&&s){const e=A.getRawBytes(),t=new K(A.getText().substring(1),e,e?e.length:null,A.getResultPoints(),D.UPC_A);return t.putAllMetadata(A.getResultMetadata()),t}return A}catch(A){}throw new W}reset(){for(let e of this.readers)e.reset()}}class Te extends Re{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(Re.patternMatchVariance(e,t[n],Te.MAX_INDIVIDUAL_VARIANCE)<Te.MAX_AVG_VARIANCE)return n;throw new W}static count(e){return ue.sum(new Int32Array(e))}static increment(e,t){let n=0,A=t[0];for(let r=1;r<e.length;r++)t[r]>A&&(A=t[r],n=r);e[n]++}static decrement(e,t){let n=0,A=t[0];for(let r=1;r<e.length;r++)t[r]<A&&(A=t[r],n=r);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t/(t+e[2]+e[3]);if(n>=Te.MIN_FINDER_PATTERN_RATIO&&n<=Te.MAX_FINDER_PATTERN_RATIO){let t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;for(let A of e)A>n&&(n=A),A<t&&(t=A);return n<10*t}return!1}}Te.MAX_AVG_VARIANCE=.2,Te.MAX_INDIVIDUAL_VARIANCE=.45,Te.MIN_FINDER_PATTERN_RATIO=9.5/12,Te.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ke{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof Ke))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Me{constructor(e,t,n,A,r){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new he(n,r)),this.resultPoints.push(new he(A,r))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Me))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Qe{constructor(){}static getRSSvalue(e,t,n){let A=0;for(let s of e)A+=s;let r=0,i=0,o=e.length;for(let s=0;s<o-1;s++){let a;for(a=1,i|=1<<s;a<e[s];a++,i&=~(1<<s)){let e=Qe.combins(A-a-1,o-s-2);if(n&&0===i&&A-a-(o-s-1)>=o-s-1&&(e-=Qe.combins(A-a-(o-s),o-s-2)),o-s-1>1){let n=0;for(let e=A-a-(o-s-2);e>t;e--)n+=Qe.combins(A-a-e-1,o-s-3);e-=n*(o-1-s)}else A-a>t&&e--;r+=e}A-=a}return r}static combins(e,t){let n,A;e-t>t?(A=t,n=e-t):(A=e-t,n=t);let r=1,i=1;for(let o=e;o>n;o--)r*=o,i<=A&&(r/=i,i++);for(;i<=A;)r/=i,i++;return r}}class De{static buildBitArray(e){let t=2*e.length-1;null==e[e.length-1].getRightChar()&&(t-=1);let n=new B(12*t),A=0,r=e[0].getRightChar().getValue();for(let i=11;i>=0;--i)r&1<<i&&n.set(A),A++;for(let i=1;i<e.length;++i){let t=e[i],r=t.getLeftChar().getValue();for(let e=11;e>=0;--e)r&1<<e&&n.set(A),A++;if(null!=t.getRightChar()){let e=t.getRightChar().getValue();for(let t=11;t>=0;--t)e&1<<t&&n.set(A),A++}}return n}}class ze{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Oe{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class Pe extends Oe{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===Pe.FNC1}}Pe.FNC1="$";class _e extends Oe{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class je extends Oe{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new S;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===je.FNC1}isSecondDigitFNC1(){return this.secondDigit===je.FNC1}isAnyFNC1(){return this.firstDigit===je.FNC1||this.secondDigit===je.FNC1}}je.FNC1=10;class qe{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new W;let t=e.substring(0,2);for(let r of qe.TWO_DIGIT_DATA_LENGTH)if(r[0]===t)return r[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(2,r[2],e):qe.processFixedAI(2,r[1],e);if(e.length<3)throw new W;let n=e.substring(0,3);for(let r of qe.THREE_DIGIT_DATA_LENGTH)if(r[0]===n)return r[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(3,r[2],e):qe.processFixedAI(3,r[1],e);for(let r of qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(r[0]===n)return r[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(4,r[2],e):qe.processFixedAI(4,r[1],e);if(e.length<4)throw new W;let A=e.substring(0,4);for(let r of qe.FOUR_DIGIT_DATA_LENGTH)if(r[0]===A)return r[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(4,r[2],e):qe.processFixedAI(4,r[1],e);throw new W}static processFixedAI(e,t,n){if(n.length<e)throw new W;let A=n.substring(0,e);if(n.length<e+t)throw new W;let r=n.substring(e,e+t),i=n.substring(e+t),o="("+A+")"+r,s=qe.parseFieldsInGeneralPurpose(i);return null==s?o:o+s}static processVariableAI(e,t,n){let A,r=n.substring(0,e);A=n.length<e+t?n.length:e+t;let i=n.substring(e,A),o=n.substring(A),s="("+r+")"+i,a=qe.parseFieldsInGeneralPurpose(o);return null==a?s:s+a}}qe.VARIABLE_LENGTH=[],qe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",qe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",qe.VARIABLE_LENGTH,20],["22",qe.VARIABLE_LENGTH,29],["30",qe.VARIABLE_LENGTH,8],["37",qe.VARIABLE_LENGTH,8],["90",qe.VARIABLE_LENGTH,30],["91",qe.VARIABLE_LENGTH,30],["92",qe.VARIABLE_LENGTH,30],["93",qe.VARIABLE_LENGTH,30],["94",qe.VARIABLE_LENGTH,30],["95",qe.VARIABLE_LENGTH,30],["96",qe.VARIABLE_LENGTH,30],["97",qe.VARIABLE_LENGTH,3],["98",qe.VARIABLE_LENGTH,30],["99",qe.VARIABLE_LENGTH,30]],qe.THREE_DIGIT_DATA_LENGTH=[["240",qe.VARIABLE_LENGTH,30],["241",qe.VARIABLE_LENGTH,30],["242",qe.VARIABLE_LENGTH,6],["250",qe.VARIABLE_LENGTH,30],["251",qe.VARIABLE_LENGTH,30],["253",qe.VARIABLE_LENGTH,17],["254",qe.VARIABLE_LENGTH,20],["400",qe.VARIABLE_LENGTH,30],["401",qe.VARIABLE_LENGTH,30],["402",17],["403",qe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",qe.VARIABLE_LENGTH,20],["421",qe.VARIABLE_LENGTH,15],["422",3],["423",qe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",qe.VARIABLE_LENGTH,15],["391",qe.VARIABLE_LENGTH,18],["392",qe.VARIABLE_LENGTH,15],["393",qe.VARIABLE_LENGTH,18],["703",qe.VARIABLE_LENGTH,30]],qe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",qe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",qe.VARIABLE_LENGTH,20],["8003",qe.VARIABLE_LENGTH,30],["8004",qe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",qe.VARIABLE_LENGTH,30],["8008",qe.VARIABLE_LENGTH,12],["8018",18],["8020",qe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",qe.VARIABLE_LENGTH,70],["8200",qe.VARIABLE_LENGTH,70]];class $e{constructor(e){this.buffer=new N,this.information=e}decodeAllCodes(e,t){let n=t,A=null;for(;;){let t=this.decodeGeneralPurposeField(n,A),r=qe.parseFieldsInGeneralPurpose(t.getNewString());if(null!=r&&e.append(r),A=t.isRemaining()?""+t.getRemainingValue():null,n===t.getNewPosition())break;n=t.getNewPosition()}return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let t=this.extractNumericValueFromBitArray(e,4);return new je(this.information.getSize(),0===t?je.FNC1:t-1,je.FNC1)}let t=this.extractNumericValueFromBitArray(e,7);return new je(e+7,(t-8)/11,(t-8)%11)}extractNumericValueFromBitArray(e,t){return $e.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let A=0;for(let r=0;r<n;++r)e.get(t+r)&&(A|=1<<n-r-1);return A}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),null!=t&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return null!=n&&n.isRemaining()?new _e(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new _e(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),n===this.current.getPosition()&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return t=e.isSecondDigitFNC1()?new _e(this.current.getPosition(),this.buffer.toString()):new _e(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new ze(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let e=new _e(this.current.getPosition(),this.buffer.toString());return new ze(!0,e)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ze(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new _e(this.current.getPosition(),this.buffer.toString());return new ze(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ze(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new _e(this.current.getPosition(),this.buffer.toString());return new ze(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ze(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let A=this.extractNumericValueFromBitArray(e,8);return A>=232&&A<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Pe(e+5,Pe.FNC1);if(t>=5&&t<15)return new Pe(e+5,"0"+(t-5));let n,A=this.extractNumericValueFromBitArray(e,7);if(A>=64&&A<90)return new Pe(e+7,""+(A+1));if(A>=90&&A<116)return new Pe(e+7,""+(A+7));switch(this.extractNumericValueFromBitArray(e,8)){case 232:n="!";break;case 233:n='"';break;case 234:n="%";break;case 235:n="&";break;case 236:n="'";break;case 237:n="(";break;case 238:n=")";break;case 239:n="*";break;case 240:n="+";break;case 241:n=",";break;case 242:n="-";break;case 243:n=".";break;case 244:n="/";break;case 245:n=":";break;case 246:n=";";break;case 247:n="<";break;case 248:n="=";break;case 249:n=">";break;case 250:n="?";break;case 251:n="_";break;case 252:n=" ";break;default:throw new S}return new Pe(e+8,n)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Pe(e+5,Pe.FNC1);if(t>=5&&t<15)return new Pe(e+5,"0"+(t-5));let n,A=this.extractNumericValueFromBitArray(e,6);if(A>=32&&A<58)return new Pe(e+6,""+(A+33));switch(A){case 58:n="*";break;case 59:n=",";break;case 60:n="-";break;case 61:n=".";break;case 62:n="/";break;default:throw new ce("Decoding invalid alphanumeric value: "+A)}return new Pe(e+6,n)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(2===t){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class et{constructor(e){this.information=e,this.generalDecoder=new $e(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class tt extends et{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let A=0;A<4;++A){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*A,10);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n)}tt.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let A=0;A<13;A++){let r=e.charAt(A+t).charCodeAt(0)-"0".charCodeAt(0);n+=1&A?r:3*r}n=10-n%10,10===n&&(n=0),e.append(n)}}tt.GTIN_SIZE=40;class nt extends tt{constructor(e){super(e)}parseInformation(){let e=new N;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(nt.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,nt.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,nt.HEADER_SIZE+44)}}nt.HEADER_SIZE=4;class At extends et{constructor(e){super(e)}parseInformation(){let e=new N;return this.getGeneralDecoder().decodeAllCodes(e,At.HEADER_SIZE)}}At.HEADER_SIZE=5;class rt extends tt{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let A=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,A);let r=this.checkWeight(A),i=1e5;for(let o=0;o<5;++o)r/i==0&&e.append("0"),i/=10;e.append(r)}}class it extends rt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=it.HEADER_SIZE+rt.GTIN_SIZE+it.WEIGHT_SIZE)throw new W;let e=new N;return this.encodeCompressedGtin(e,it.HEADER_SIZE),this.encodeCompressedWeight(e,it.HEADER_SIZE+rt.GTIN_SIZE,it.WEIGHT_SIZE),e.toString()}}it.HEADER_SIZE=5,it.WEIGHT_SIZE=15;class ot extends it{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class st extends it{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class at extends tt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<at.HEADER_SIZE+tt.GTIN_SIZE)throw new W;let e=new N;this.encodeCompressedGtin(e,at.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(at.HEADER_SIZE+tt.GTIN_SIZE,at.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(at.HEADER_SIZE+tt.GTIN_SIZE+at.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}at.HEADER_SIZE=8,at.LAST_DIGIT_SIZE=2;class gt extends tt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<gt.HEADER_SIZE+tt.GTIN_SIZE)throw new W;let e=new N;this.encodeCompressedGtin(e,gt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(gt.HEADER_SIZE+tt.GTIN_SIZE,gt.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(gt.HEADER_SIZE+tt.GTIN_SIZE+gt.LAST_DIGIT_SIZE,gt.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let A=this.getGeneralDecoder().decodeGeneralPurposeField(gt.HEADER_SIZE+tt.GTIN_SIZE+gt.LAST_DIGIT_SIZE+gt.FIRST_THREE_DIGITS_SIZE,null);return e.append(A.getNewString()),e.toString()}}gt.HEADER_SIZE=8,gt.LAST_DIGIT_SIZE=2,gt.FIRST_THREE_DIGITS_SIZE=10;class lt extends rt{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=lt.HEADER_SIZE+lt.GTIN_SIZE+lt.WEIGHT_SIZE+lt.DATE_SIZE)throw new W;let e=new N;return this.encodeCompressedGtin(e,lt.HEADER_SIZE),this.encodeCompressedWeight(e,lt.HEADER_SIZE+lt.GTIN_SIZE,lt.WEIGHT_SIZE),this.encodeCompressedDate(e,lt.HEADER_SIZE+lt.GTIN_SIZE+lt.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,lt.DATE_SIZE);if(38400==n)return;e.append("("),e.append(this.dateCode),e.append(")");let A=n%32;n/=32;let r=n%12+1;n/=12;let i=n;i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r),A/10==0&&e.append("0"),e.append(A)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}function ct(e){try{if(e.get(1))return new nt(e);if(!e.get(2))return new At(e);switch($e.extractNumericValueFromBitArray(e,1,4)){case 4:return new ot(e);case 5:return new st(e)}switch($e.extractNumericValueFromBitArray(e,1,5)){case 12:return new at(e);case 13:return new gt(e)}switch($e.extractNumericValueFromBitArray(e,1,7)){case 56:return new lt(e,"310","11");case 57:return new lt(e,"320","11");case 58:return new lt(e,"310","13");case 59:return new lt(e,"320","13");case 60:return new lt(e,"310","15");case 61:return new lt(e,"320","15");case 62:return new lt(e,"310","17");case 63:return new lt(e,"320","17")}}catch(Zf){throw new ce("unknown decoder: "+e)}}lt.HEADER_SIZE=8,lt.WEIGHT_SIZE=20,lt.DATE_SIZE=16;class It{constructor(e,t,n,A){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=A}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof It&&It.equalsOrNull(e.leftchar,t.leftchar)&&It.equalsOrNull(e.rightchar,t.rightchar)&&It.equalsOrNull(e.finderpattern,t.finderpattern)}static equalsOrNull(e,t){return null===e?null===t:It.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ct{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof Ct&&this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach(((e,A)=>{t.forEach((t=>{e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(n=!0)}))})),n}}class ut extends Te{constructor(e){super(...arguments),this.pairs=new Array(ut.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=!0===e}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return ut.constructResult(this.decodeRow2pairs(e,t))}catch(Zf){this.verbose}return this.pairs.length=0,this.startFromEven=!0,ut.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n,A=!1;for(;!A;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(PWe){if(PWe instanceof W){if(!this.pairs.length)throw new W;A=!0}}if(this.checkChecksum())return this.pairs;if(n=!!this.rows.length,this.storeRow(e,!1),n){let e=this.checkRowsBoolean(!1);if(null!=e)return e;if(e=this.checkRowsBoolean(!0),null!=e)return e}throw new W}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(Zf){this.verbose}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let t=this.rows[n];this.pairs.length=0;for(let n of e)this.pairs.push(n.getPairs());if(this.pairs.push(t.getPairs()),!ut.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let A=new Array(e);A.push(t);try{return this.checkRows(A,n+1)}catch(Zf){this.verbose}}throw new W}static isValidSequence(e){for(let t of ut.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let A=0;A<e.length;A++)if(e[A].getFinderPattern().getValue()!=t[A]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,A=!1,r=!1;for(;n<this.rows.length;){let t=this.rows[n];if(t.getRowNumber()>e){r=t.isEquivalent(this.pairs);break}A=t.isEquivalent(this.pairs),n++}r||A||ut.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new Ct(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t)if(n.getPairs().length!==e.length)for(let t of n.getPairs())for(let n of e)if(It.equals(t,n))break}static isPartialRow(e,t){for(let n of t){let t=!0;for(let A of e){let e=!1;for(let t of n.getPairs())if(A.equals(t)){e=!0;break}if(!e){t=!1;break}}if(t)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=ct(De.buildBitArray(e)).parseInformation(),n=e[0].getFinderPattern().getResultPoints(),A=e[e.length-1].getFinderPattern().getResultPoints(),r=[n[0],n[1],A[0],A[1]];return new K(t,null,null,r,D.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(null==n)return!1;let A=n.getChecksumPortion(),r=2;for(let i=1;i<this.pairs.size();++i){let e=this.pairs.get(i);A+=e.getLeftChar().getChecksumPortion(),r++;let t=e.getRightChar();null!=t&&(A+=t.getChecksumPortion(),r++)}return A%=211,211*(r-4)+A==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let A,r=t.length%2==0;this.startFromEven&&(r=!r);let i=!0,o=-1;do{this.findNextPair(e,t,o),A=this.parseFoundFinderPattern(e,n,r),null==A?o=ut.getNextSecondBar(e,this.startEnd[0]):i=!1}while(i);let s,a=this.decodeDataCharacter(e,A,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new W;try{s=this.decodeDataCharacter(e,A,r,!1)}catch(Zf){s=null,this.verbose}return new It(a,s,A,!0)}isEmptyPair(e){return 0===e.length}findNextPair(e,t,n){let A=this.getDecodeFinderCounters();A[0]=0,A[1]=0,A[2]=0,A[3]=0;let r,i=e.getSize();r=n>=0?n:this.isEmptyPair(t)?0:t[t.length-1].getFinderPattern().getStartEnd()[1];let o=t.length%2!=0;this.startFromEven&&(o=!o);let s=!1;for(;r<i&&(s=!e.get(r),s);)r++;let a=0,g=r;for(let l=r;l<i;l++)if(e.get(l)!=s)A[a]++;else{if(3==a){if(o&&ut.reverseCounters(A),ut.isFinderPattern(A))return this.startEnd[0]=g,void(this.startEnd[1]=l);o&&ut.reverseCounters(A),g+=A[0]+A[1],A[0]=A[2],A[1]=A[3],A[2]=0,A[3]=0,a--}else a++;A[a]=1,s=!s}throw new W}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let A=e[n];e[n]=e[t-n-1],e[t-n-1]=A}}parseFoundFinderPattern(e,t,n){let A,r,i;if(n){let t=this.startEnd[0]-1;for(;t>=0&&!e.get(t);)t--;t++,A=this.startEnd[0]-t,r=t,i=this.startEnd[1]}else r=this.startEnd[0],i=e.getNextUnset(this.startEnd[1]+1),A=i-this.startEnd[1];let o,s=this.getDecodeFinderCounters();h.arraycopy(s,0,s,1,s.length-1),s[0]=A;try{o=this.parseFinderValue(s,ut.FINDER_PATTERNS)}catch(Zf){return null}return new Me(o,[r,i],r,i,t)}decodeDataCharacter(e,t,n,A){let r=this.getDataCharacterCounters();for(let Z=0;Z<r.length;Z++)r[Z]=0;if(A)ut.recordPatternInReverse(e,t.getStartEnd()[0],r);else{ut.recordPattern(e,t.getStartEnd()[1],r);for(let e=0,t=r.length-1;e<t;e++,t--){let n=r[e];r[e]=r[t],r[t]=n}}let i=17,o=ue.sum(new Int32Array(r))/i,s=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(o-s)/s>.3)throw new W;let a=this.getOddCounts(),g=this.getEvenCounts(),l=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let Z=0;Z<r.length;Z++){let e=1*r[Z]/o,t=e+.5;if(t<1){if(e<.3)throw new W;t=1}else if(t>8){if(e>8.7)throw new W;t=8}let n=Z/2;1&Z?(g[n]=t,c[n]=e-t):(a[n]=t,l[n]=e-t)}this.adjustOddEvenCounts(i);let I=4*t.getValue()+(n?0:2)+(A?0:1)-1,C=0,u=0;for(let Z=a.length-1;Z>=0;Z--){if(ut.isNotA1left(t,n,A)){let e=ut.WEIGHTS[I][2*Z];u+=a[Z]*e}C+=a[Z]}let d=0;for(let Z=g.length-1;Z>=0;Z--)if(ut.isNotA1left(t,n,A)){let e=ut.WEIGHTS[I][2*Z+1];d+=g[Z]*e}let h=u+d;if(1&C||C>13||C<4)throw new W;let m=(13-C)/2,p=ut.SYMBOL_WIDEST[m],f=9-p,b=Qe.getRSSvalue(a,p,!0),B=Qe.getRSSvalue(g,f,!1),y=ut.EVEN_TOTAL_SUBSET[m],w=ut.GSUM[m];return new Ke(b*y+B+w,h)}static isNotA1left(e,t,n){return!(0==e.getValue()&&t&&n)}adjustOddEvenCounts(e){let t=ue.sum(new Int32Array(this.getOddCounts())),n=ue.sum(new Int32Array(this.getEvenCounts())),A=!1,r=!1;t>13?r=!0:t<4&&(A=!0);let i=!1,o=!1;n>13?o=!0:n<4&&(i=!0);let s=t+n-e,a=!(1&~t),g=!(1&n);if(1==s)if(a){if(g)throw new W;r=!0}else{if(!g)throw new W;o=!0}else if(-1==s)if(a){if(g)throw new W;A=!0}else{if(!g)throw new W;i=!0}else{if(0!=s)throw new W;if(a){if(!g)throw new W;t<n?(A=!0,o=!0):(r=!0,i=!0)}else if(g)throw new W}if(A){if(r)throw new W;ut.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(r&&ut.decrement(this.getOddCounts(),this.getOddRoundingErrors()),i){if(o)throw new W;ut.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&ut.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ut.SYMBOL_WIDEST=[7,5,4,3,1],ut.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ut.GSUM=[0,348,1388,2948,3988],ut.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ut.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ut.FINDER_PAT_A=0,ut.FINDER_PAT_B=1,ut.FINDER_PAT_C=2,ut.FINDER_PAT_D=3,ut.FINDER_PAT_E=4,ut.FINDER_PAT_F=5,ut.FINDER_PATTERN_SEQUENCES=[[ut.FINDER_PAT_A,ut.FINDER_PAT_A],[ut.FINDER_PAT_A,ut.FINDER_PAT_B,ut.FINDER_PAT_B],[ut.FINDER_PAT_A,ut.FINDER_PAT_C,ut.FINDER_PAT_B,ut.FINDER_PAT_D],[ut.FINDER_PAT_A,ut.FINDER_PAT_E,ut.FINDER_PAT_B,ut.FINDER_PAT_D,ut.FINDER_PAT_C],[ut.FINDER_PAT_A,ut.FINDER_PAT_E,ut.FINDER_PAT_B,ut.FINDER_PAT_D,ut.FINDER_PAT_D,ut.FINDER_PAT_F],[ut.FINDER_PAT_A,ut.FINDER_PAT_E,ut.FINDER_PAT_B,ut.FINDER_PAT_D,ut.FINDER_PAT_E,ut.FINDER_PAT_F,ut.FINDER_PAT_F],[ut.FINDER_PAT_A,ut.FINDER_PAT_A,ut.FINDER_PAT_B,ut.FINDER_PAT_B,ut.FINDER_PAT_C,ut.FINDER_PAT_C,ut.FINDER_PAT_D,ut.FINDER_PAT_D],[ut.FINDER_PAT_A,ut.FINDER_PAT_A,ut.FINDER_PAT_B,ut.FINDER_PAT_B,ut.FINDER_PAT_C,ut.FINDER_PAT_C,ut.FINDER_PAT_D,ut.FINDER_PAT_E,ut.FINDER_PAT_E],[ut.FINDER_PAT_A,ut.FINDER_PAT_A,ut.FINDER_PAT_B,ut.FINDER_PAT_B,ut.FINDER_PAT_C,ut.FINDER_PAT_C,ut.FINDER_PAT_D,ut.FINDER_PAT_E,ut.FINDER_PAT_F,ut.FINDER_PAT_F],[ut.FINDER_PAT_A,ut.FINDER_PAT_A,ut.FINDER_PAT_B,ut.FINDER_PAT_B,ut.FINDER_PAT_C,ut.FINDER_PAT_D,ut.FINDER_PAT_D,ut.FINDER_PAT_E,ut.FINDER_PAT_E,ut.FINDER_PAT_F,ut.FINDER_PAT_F]],ut.MAX_PAIRS=11;class dt extends Ke{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class ht extends Te{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const A=this.decodePair(t,!1,e,n);ht.addOrTally(this.possibleLeftPairs,A),t.reverse();let r=this.decodePair(t,!0,e,n);ht.addOrTally(this.possibleRightPairs,r),t.reverse();for(let i of this.possibleLeftPairs)if(i.getCount()>1)for(let e of this.possibleRightPairs)if(e.getCount()>1&&ht.checkChecksum(i,e))return ht.constructResult(i,e);throw new W}static addOrTally(e,t){if(null==t)return;let n=!1;for(let A of e)if(A.getValue()===t.getValue()){A.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),A=new String(n).toString(),r=new N;for(let a=13-A.length;a>0;a--)r.append("0");r.append(A);let i=0;for(let a=0;a<13;a++){let e=r.charAt(a).charCodeAt(0)-"0".charCodeAt(0);i+=1&a?e:3*e}i=10-i%10,10===i&&(i=0),r.append(i.toString());let o=e.getFinderPattern().getResultPoints(),s=t.getFinderPattern().getResultPoints();return new K(r.toString(),null,0,[o[0],o[1],s[0],s[1]],D.RSS_14,(new Date).getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,A=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return A>72&&A--,A>8&&A--,n===A}decodePair(e,t,n,A){try{let r=this.findFinderPattern(e,t),i=this.parseFoundFinderPattern(e,n,t,r),o=null==A?null:A.get(Z.NEED_RESULT_POINT_CALLBACK);if(null!=o){let A=(r[0]+r[1])/2;t&&(A=e.getSize()-1-A),o.foundPossibleResultPoint(new he(A,n))}let s=this.decodeDataCharacter(e,i,!0),a=this.decodeDataCharacter(e,i,!1);return new dt(1597*s.getValue()+a.getValue(),s.getChecksumPortion()+4*a.getChecksumPortion(),i)}catch(r){return null}}decodeDataCharacter(e,t,n){let A=this.getDataCharacterCounters();for(let d=0;d<A.length;d++)A[d]=0;if(n)Re.recordPatternInReverse(e,t.getStartEnd()[0],A);else{Re.recordPattern(e,t.getStartEnd()[1]+1,A);for(let e=0,t=A.length-1;e<t;e++,t--){let n=A[e];A[e]=A[t],A[t]=n}}let r=n?16:15,i=ue.sum(new Int32Array(A))/r,o=this.getOddCounts(),s=this.getEvenCounts(),a=this.getOddRoundingErrors(),g=this.getEvenRoundingErrors();for(let d=0;d<A.length;d++){let e=A[d]/i,t=Math.floor(e+.5);t<1?t=1:t>8&&(t=8);let n=Math.floor(d/2);1&d?(s[n]=t,g[n]=e-t):(o[n]=t,a[n]=e-t)}this.adjustOddEvenCounts(n,r);let l=0,c=0;for(let d=o.length-1;d>=0;d--)c*=9,c+=o[d],l+=o[d];let I=0,C=0;for(let d=s.length-1;d>=0;d--)I*=9,I+=s[d],C+=s[d];let u=c+3*I;if(n){if(1&l||l>12||l<4)throw new W;let e=(12-l)/2,t=ht.OUTSIDE_ODD_WIDEST[e],n=9-t,A=Qe.getRSSvalue(o,t,!1),r=Qe.getRSSvalue(s,n,!0),i=ht.OUTSIDE_EVEN_TOTAL_SUBSET[e],a=ht.OUTSIDE_GSUM[e];return new Ke(A*i+r+a,u)}{if(1&C||C>10||C<4)throw new W;let e=(10-C)/2,t=ht.INSIDE_ODD_WIDEST[e],n=9-t,A=Qe.getRSSvalue(o,t,!0),r=Qe.getRSSvalue(s,n,!1),i=ht.INSIDE_ODD_TOTAL_SUBSET[e],a=ht.INSIDE_GSUM[e];return new Ke(r*i+A+a,u)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let A=e.getSize(),r=!1,i=0;for(;i<A&&(r=!e.get(i),t!==r);)i++;let o=0,s=i;for(let a=i;a<A;a++)if(e.get(a)!==r)n[o]++;else{if(3===o){if(Te.isFinderPattern(n))return[s,a];s+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,o--}else o++;n[o]=1,r=!r}throw new W}parseFoundFinderPattern(e,t,n,A){let r=e.get(A[0]),i=A[0]-1;for(;i>=0&&r!==e.get(i);)i--;i++;const o=A[0]-i,s=this.getDecodeFinderCounters(),a=new Int32Array(s.length);h.arraycopy(s,0,a,1,s.length-1),a[0]=o;const g=this.parseFinderValue(a,ht.FINDER_PATTERNS);let l=i,c=A[1];return n&&(l=e.getSize()-1-l,c=e.getSize()-1-c),new Me(g,[i,A[1]],l,c,t)}adjustOddEvenCounts(e,t){let n=ue.sum(new Int32Array(this.getOddCounts())),A=ue.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1,o=!1,s=!1;e?(n>12?i=!0:n<4&&(r=!0),A>12?s=!0:A<4&&(o=!0)):(n>11?i=!0:n<5&&(r=!0),A>10?s=!0:A<4&&(o=!0));let a=n+A-t,g=(1&n)==(e?1:0),l=!(1&~A);if(1===a)if(g){if(l)throw new W;i=!0}else{if(!l)throw new W;s=!0}else if(-1===a)if(g){if(l)throw new W;r=!0}else{if(!l)throw new W;o=!0}else{if(0!==a)throw new W;if(g){if(!l)throw new W;n<A?(r=!0,s=!0):(i=!0,o=!0)}else if(l)throw new W}if(r){if(i)throw new W;Te.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&Te.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(s)throw new W;Te.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&Te.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ht.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],ht.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],ht.OUTSIDE_GSUM=[0,161,961,2015,2715],ht.INSIDE_GSUM=[0,336,1036,1516],ht.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],ht.INSIDE_ODD_WIDEST=[2,4,6,8],ht.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class mt extends Re{constructor(e,t){super(),this.readers=[],this.verbose=!0===t;const n=e?e.get(Z.POSSIBLE_FORMATS):null,A=e&&void 0!==e.get(Z.ASSUME_CODE_39_CHECK_DIGIT);n?((n.includes(D.EAN_13)||n.includes(D.UPC_A)||n.includes(D.EAN_8)||n.includes(D.UPC_E))&&this.readers.push(new Le(e)),n.includes(D.CODE_39)&&this.readers.push(new Ne(A)),n.includes(D.CODE_128)&&this.readers.push(new Ve),n.includes(D.ITF)&&this.readers.push(new ke),n.includes(D.RSS_14)&&this.readers.push(new ht),n.includes(D.RSS_EXPANDED)&&this.readers.push(new ut(this.verbose))):(this.readers.push(new Le(e)),this.readers.push(new Ne),this.readers.push(new Le(e)),this.readers.push(new Ve),this.readers.push(new ke),this.readers.push(new ht),this.readers.push(new ut(this.verbose)))}decodeRow(e,t,n){for(let A=0;A<this.readers.length;A++)try{return this.readers[A].decodeRow(e,t,n)}catch(BIe){}throw new W}reset(){this.readers.forEach((e=>e.reset()))}}class pt extends T{constructor(e=500,t){super(new mt(t),e,t)}}class ft{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class bt{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Bt{constructor(e,t,n,A,r,i){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=A,this.dataRegionSizeColumns=r,this.ecBlocks=i;let o=0;const s=i.getECCodewords(),a=i.getECBlocks();for(let g of a)o+=g.getCount()*(g.getDataCodewords()+s);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(1&e||1&t)throw new S;for(let n of Bt.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new S}toString(){return""+this.versionNumber}static buildVersions(){return[new Bt(1,10,10,8,8,new ft(5,new bt(1,3))),new Bt(2,12,12,10,10,new ft(7,new bt(1,5))),new Bt(3,14,14,12,12,new ft(10,new bt(1,8))),new Bt(4,16,16,14,14,new ft(12,new bt(1,12))),new Bt(5,18,18,16,16,new ft(14,new bt(1,18))),new Bt(6,20,20,18,18,new ft(18,new bt(1,22))),new Bt(7,22,22,20,20,new ft(20,new bt(1,30))),new Bt(8,24,24,22,22,new ft(24,new bt(1,36))),new Bt(9,26,26,24,24,new ft(28,new bt(1,44))),new Bt(10,32,32,14,14,new ft(36,new bt(1,62))),new Bt(11,36,36,16,16,new ft(42,new bt(1,86))),new Bt(12,40,40,18,18,new ft(48,new bt(1,114))),new Bt(13,44,44,20,20,new ft(56,new bt(1,144))),new Bt(14,48,48,22,22,new ft(68,new bt(1,174))),new Bt(15,52,52,24,24,new ft(42,new bt(2,102))),new Bt(16,64,64,14,14,new ft(56,new bt(2,140))),new Bt(17,72,72,16,16,new ft(36,new bt(4,92))),new Bt(18,80,80,18,18,new ft(48,new bt(4,114))),new Bt(19,88,88,20,20,new ft(56,new bt(4,144))),new Bt(20,96,96,22,22,new ft(68,new bt(4,174))),new Bt(21,104,104,24,24,new ft(56,new bt(6,136))),new Bt(22,120,120,18,18,new ft(68,new bt(6,175))),new Bt(23,132,132,20,20,new ft(62,new bt(8,163))),new Bt(24,144,144,22,22,new ft(62,new bt(8,156),new bt(2,155))),new Bt(25,8,18,6,16,new ft(7,new bt(1,5))),new Bt(26,8,32,6,14,new ft(11,new bt(1,10))),new Bt(27,12,26,10,24,new ft(14,new bt(1,16))),new Bt(28,12,36,10,16,new ft(18,new bt(1,22))),new Bt(29,16,36,14,16,new ft(24,new bt(1,32))),new Bt(30,16,48,14,22,new ft(28,new bt(1,49)))]}}Bt.VERSIONS=Bt.buildVersions();class yt{constructor(e){const t=e.getHeight();if(t<8||t>144||1&t)throw new S;this.version=yt.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new k(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return Bt.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,A=0;const r=this.mappingBitMatrix.getHeight(),i=this.mappingBitMatrix.getWidth();let o=!1,s=!1,a=!1,g=!1;do{if(n!==r||0!==A||o)if(n===r-2&&0===A&&3&i&&!s)e[t++]=255&this.readCorner2(r,i),n-=2,A+=2,s=!0;else if(n!==r+4||2!==A||7&i||a)if(n!==r-2||0!==A||4!=(7&i)||g){do{n<r&&A>=0&&!this.readMappingMatrix.get(A,n)&&(e[t++]=255&this.readUtah(n,A,r,i)),n-=2,A+=2}while(n>=0&&A<i);n+=1,A+=3;do{n>=0&&A<i&&!this.readMappingMatrix.get(A,n)&&(e[t++]=255&this.readUtah(n,A,r,i)),n+=2,A-=2}while(n<r&&A>=0);n+=3,A+=1}else e[t++]=255&this.readCorner4(r,i),n-=2,A+=2,g=!0;else e[t++]=255&this.readCorner3(r,i),n-=2,A+=2,a=!0;else e[t++]=255&this.readCorner1(r,i),n-=2,A+=2,o=!0}while(n<r||A<i);if(t!==this.version.getTotalCodewords())throw new S;return e}readModule(e,t,n,A){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=A,e+=4-(A+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,A){let r=0;return this.readModule(e-2,t-2,n,A)&&(r|=1),r<<=1,this.readModule(e-2,t-1,n,A)&&(r|=1),r<<=1,this.readModule(e-1,t-2,n,A)&&(r|=1),r<<=1,this.readModule(e-1,t-1,n,A)&&(r|=1),r<<=1,this.readModule(e-1,t,n,A)&&(r|=1),r<<=1,this.readModule(e,t-2,n,A)&&(r|=1),r<<=1,this.readModule(e,t-1,n,A)&&(r|=1),r<<=1,this.readModule(e,t,n,A)&&(r|=1),r}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new I("Dimension of bitMatrix must match the version size");const A=this.version.getDataRegionSizeRows(),r=this.version.getDataRegionSizeColumns(),i=t/A|0,o=n/r|0,s=new k(o*r,i*A);for(let a=0;a<i;++a){const t=a*A;for(let n=0;n<o;++n){const i=n*r;for(let o=0;o<A;++o){const g=a*(A+2)+1+o,l=t+o;for(let t=0;t<r;++t){const A=n*(r+2)+1+t;if(e.get(A,g)){const e=i+t;s.set(e,l)}}}}}return s}}class wt{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let A=0;const r=n.getECBlocks();for(let I of r)A+=I.getCount();const i=new Array(A);let o=0;for(let I of r)for(let e=0;e<I.getCount();e++){const e=I.getDataCodewords(),t=n.getECCodewords()+e;i[o++]=new wt(e,new Uint8Array(t))}const s=i[0].codewords.length-n.getECCodewords(),a=s-1;let g=0;for(let I=0;I<a;I++)for(let t=0;t<o;t++)i[t].codewords[I]=e[g++];const l=24===t.getVersionNumber(),c=l?8:o;for(let I=0;I<c;I++)i[I].codewords[s-1]=e[g++];const C=i[0].codewords.length;for(let I=s;I<C;I++)for(let t=0;t<o;t++){const n=l?(t+8)%o:t,A=l&&n>7?I-1:I;i[n].codewords[A]=e[g++]}if(g!==e.length)throw new I;return i}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Zt{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new I(""+e);let t=0,n=this.bitOffset,A=this.byteOffset;const r=this.bytes;if(n>0){const i=8-n,o=e<i?e:i,s=i-o,a=255>>8-o<<s;t=(r[A]&a)>>s,e-=o,n+=o,8===n&&(n=0,A++)}if(e>0){for(;e>=8;)t=t<<8|255&r[A],A++,e-=8;if(e>0){const i=8-e,o=255>>i<<i;t=t<<e|(r[A]&o)>>i,n+=e}}return this.bitOffset=n,this.byteOffset=A,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}(ee=O||(O={}))[ee.PAD_ENCODE=0]="PAD_ENCODE",ee[ee.ASCII_ENCODE=1]="ASCII_ENCODE",ee[ee.C40_ENCODE=2]="C40_ENCODE",ee[ee.TEXT_ENCODE=3]="TEXT_ENCODE",ee[ee.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",ee[ee.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",ee[ee.BASE256_ENCODE=6]="BASE256_ENCODE";class St{static decode(e){const t=new Zt(e),n=new N,A=new N,r=new Array;let i=O.ASCII_ENCODE;do{if(i===O.ASCII_ENCODE)i=this.decodeAsciiSegment(t,n,A);else{switch(i){case O.C40_ENCODE:this.decodeC40Segment(t,n);break;case O.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case O.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case O.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case O.BASE256_ENCODE:this.decodeBase256Segment(t,n,r);break;default:throw new S}i=O.ASCII_ENCODE}}while(i!==O.PAD_ENCODE&&t.available()>0);return A.length()>0&&n.append(A.toString()),new ie(e,n.toString(),0===r.length?null:r,null)}static decodeAsciiSegment(e,t,n){let A=!1;do{let r=e.readBits(8);if(0===r)throw new S;if(r<=128)return A&&(r+=128),t.append(String.fromCharCode(r-1)),O.ASCII_ENCODE;if(129===r)return O.PAD_ENCODE;if(r<=229){const e=r-130;e<10&&t.append("0"),t.append(""+e)}else switch(r){case 230:return O.C40_ENCODE;case 231:return O.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:case 241:break;case 235:A=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return O.ANSIX12_ENCODE;case 239:return O.TEXT_ENCODE;case 240:return O.EDIFACT_ENCODE;default:if(254!==r||0!==e.available())throw new S}}while(e.available()>0);return O.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const A=[];let r=0;do{if(8===e.available())return;const i=e.readBits(8);if(254===i)return;this.parseTwoBytes(i,e.readBits(8),A);for(let e=0;e<3;e++){const i=A[e];switch(r){case 0:if(i<3)r=i+1;else{if(!(i<this.C40_BASIC_SET_CHARS.length))throw new S;{const e=this.C40_BASIC_SET_CHARS[i];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}}break;case 1:n?(t.append(String.fromCharCode(i+128)),n=!1):t.append(String.fromCharCode(i)),r=0;break;case 2:if(i<this.C40_SHIFT2_SET_CHARS.length){const e=this.C40_SHIFT2_SET_CHARS[i];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}else switch(i){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new S}r=0;break;case 3:n?(t.append(String.fromCharCode(i+224)),n=!1):t.append(String.fromCharCode(i+96)),r=0;break;default:throw new S}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,A=[],r=0;do{if(8===e.available())return;const i=e.readBits(8);if(254===i)return;this.parseTwoBytes(i,e.readBits(8),A);for(let e=0;e<3;e++){const i=A[e];switch(r){case 0:if(i<3)r=i+1;else{if(!(i<this.TEXT_BASIC_SET_CHARS.length))throw new S;{const e=this.TEXT_BASIC_SET_CHARS[i];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}}break;case 1:n?(t.append(String.fromCharCode(i+128)),n=!1):t.append(String.fromCharCode(i)),r=0;break;case 2:if(i<this.TEXT_SHIFT2_SET_CHARS.length){const e=this.TEXT_SHIFT2_SET_CHARS[i];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e)}else switch(i){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new S}r=0;break;case 3:if(!(i<this.TEXT_SHIFT3_SET_CHARS.length))throw new S;{const e=this.TEXT_SHIFT3_SET_CHARS[i];n?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),n=!1):t.append(e),r=0}break;default:throw new S}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(8===e.available())return;const A=e.readBits(8);if(254===A)return;this.parseTwoBytes(A,e.readBits(8),n);for(let e=0;e<3;e++){const A=n[e];switch(A){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(A<14)t.append(String.fromCharCode(A+44));else{if(!(A<40))throw new S;t.append(String.fromCharCode(A+51))}}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let A=(e<<8)+t-1,r=Math.floor(A/1600);n[0]=r,A-=1600*r,r=Math.floor(A/40),n[1]=r,n[2]=A-40*r}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let n=e.readBits(6);if(31===n){const t=8-e.getBitOffset();return void(8!==t&&e.readBits(t))}32&n||(n|=64),t.append(String.fromCharCode(n))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let A=1+e.getByteOffset();const r=this.unrandomize255State(e.readBits(8),A++);let i;if(i=0===r?e.available()/8|0:r<250?r:250*(r-249)+this.unrandomize255State(e.readBits(8),A++),i<0)throw new S;const o=new Uint8Array(i);for(let a=0;a<i;a++){if(e.available()<8)throw new S;o[a]=this.unrandomize255State(e.readBits(8),A++)}n.push(o);try{t.append(R.decode(o,V.ISO88591))}catch(s){throw new ce("Platform does not support required encoding: "+s.message)}}static unrandomize255State(e,t){const n=e-(149*t%255+1);return n>=0?n:n+256}}St.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],St.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],St.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],St.TEXT_SHIFT2_SET_CHARS=St.C40_SHIFT2_SET_CHARS,St.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class vt{constructor(){this.rsDecoder=new Ie(ge.DATA_MATRIX_FIELD_256)}decode(e){const t=new yt(e),n=t.getVersion(),A=t.readCodewords(),r=wt.getDataBlocks(A,n);let i=0;for(let a of r)i+=a.getNumDataCodewords();const o=new Uint8Array(i),s=r.length;for(let a=0;a<s;a++){const e=r[a],t=e.getCodewords(),n=e.getNumDataCodewords();this.correctErrors(t,n);for(let A=0;A<n;A++)o[A*s+a]=t[A]}return St.decode(o)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(A){throw new u}for(let r=0;r<t;r++)e[r]=n[r]}}class Gt{constructor(e){this.image=e,this.rectangleDetector=new fe(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new W;t=this.shiftToModuleCenter(t);const n=t[0],A=t[1],r=t[2],i=t[3];let o=this.transitionsBetween(n,i)+1,s=this.transitionsBetween(r,i)+1;1&~o||(o+=1),1&~s||(s+=1),4*o<7*s&&4*s<7*o&&(o=s=Math.max(o,s));let a=Gt.sampleGrid(this.image,n,A,r,i,o,s);return new me(a,[n,A,r,i])}static shiftPoint(e,t,n){let A=(t.getX()-e.getX())/(n+1),r=(t.getY()-e.getY())/(n+1);return new he(e.getX()+A,e.getY()+r)}static moveAway(e,t,n){let A=e.getX(),r=e.getY();return A<t?A-=1:A+=1,r<n?r-=1:r+=1,new he(A,r)}detectSolid1(e){let t=e[0],n=e[1],A=e[3],r=e[2],i=this.transitionsBetween(t,n),o=this.transitionsBetween(n,A),s=this.transitionsBetween(A,r),a=this.transitionsBetween(r,t),g=i,l=[r,t,n,A];return g>o&&(g=o,l[0]=t,l[1]=n,l[2]=A,l[3]=r),g>s&&(g=s,l[0]=n,l[1]=A,l[2]=r,l[3]=t),g>a&&(l[0]=A,l[1]=r,l[2]=t,l[3]=n),l}detectSolid2(e){let t=e[0],n=e[1],A=e[2],r=e[3],i=this.transitionsBetween(t,r),o=Gt.shiftPoint(n,A,4*(i+1)),s=Gt.shiftPoint(A,n,4*(i+1));return this.transitionsBetween(o,t)<this.transitionsBetween(s,r)?(e[0]=t,e[1]=n,e[2]=A,e[3]=r):(e[0]=n,e[1]=A,e[2]=r,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],A=e[2],r=e[3],i=this.transitionsBetween(t,r),o=this.transitionsBetween(n,r),s=Gt.shiftPoint(t,n,4*(o+1)),a=Gt.shiftPoint(A,n,4*(i+1));i=this.transitionsBetween(s,r),o=this.transitionsBetween(a,r);let g=new he(r.getX()+(A.getX()-n.getX())/(i+1),r.getY()+(A.getY()-n.getY())/(i+1)),l=new he(r.getX()+(t.getX()-n.getX())/(o+1),r.getY()+(t.getY()-n.getY())/(o+1));return this.isValid(g)?this.isValid(l)?this.transitionsBetween(s,g)+this.transitionsBetween(a,g)>this.transitionsBetween(s,l)+this.transitionsBetween(a,l)?g:l:g:this.isValid(l)?l:null}shiftToModuleCenter(e){let t=e[0],n=e[1],A=e[2],r=e[3],i=this.transitionsBetween(t,r)+1,o=this.transitionsBetween(A,r)+1,s=Gt.shiftPoint(t,n,4*o),a=Gt.shiftPoint(A,n,4*i);i=this.transitionsBetween(s,r)+1,o=this.transitionsBetween(a,r)+1,1&~i||(i+=1),1&~o||(o+=1);let g,l,c=(t.getX()+n.getX()+A.getX()+r.getX())/4,I=(t.getY()+n.getY()+A.getY()+r.getY())/4;return t=Gt.moveAway(t,c,I),n=Gt.moveAway(n,c,I),A=Gt.moveAway(A,c,I),r=Gt.moveAway(r,c,I),s=Gt.shiftPoint(t,n,4*o),s=Gt.shiftPoint(s,r,4*i),g=Gt.shiftPoint(n,t,4*o),g=Gt.shiftPoint(g,A,4*i),a=Gt.shiftPoint(A,r,4*o),a=Gt.shiftPoint(a,n,4*i),l=Gt.shiftPoint(r,A,4*o),l=Gt.shiftPoint(l,t,4*i),[s,g,a,l]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,A,r,i,o){return we.getInstance().sampleGrid(e,i,o,.5,.5,i-.5,.5,i-.5,o-.5,.5,o-.5,t.getX(),t.getY(),r.getX(),r.getY(),A.getX(),A.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),A=Math.trunc(e.getY()),r=Math.trunc(t.getX()),i=Math.trunc(t.getY()),o=Math.abs(i-A)>Math.abs(r-n);if(o){let e=n;n=A,A=e,e=r,r=i,i=e}let s=Math.abs(r-n),a=Math.abs(i-A),g=-s/2,l=A<i?1:-1,c=n<r?1:-1,I=0,C=this.image.get(o?A:n,o?n:A);for(let u=n,d=A;u!==r;u+=c){let e=this.image.get(o?d:u,o?u:d);if(e!==C&&(I++,C=e),g+=a,g>0){if(d===i)break;d+=l,g-=s}}return I}}class Rt{constructor(){this.decoder=new vt}decode(e,t=null){let n,A;if(null!=t&&t.has(Z.PURE_BARCODE)){const t=Rt.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(t),A=Rt.NO_POINTS}else{const t=new Gt(e.getBlackMatrix()).detect();n=this.decoder.decode(t.getBits()),A=t.getPoints()}const r=n.getRawBytes(),i=new K(n.getText(),r,8*r.length,A,D.DATA_MATRIX,h.currentTimeMillis()),o=n.getByteSegments();null!=o&&i.putMetadata(re.BYTE_SEGMENTS,o);const s=n.getECLevel();return null!=s&&i.putMetadata(re.ERROR_CORRECTION_LEVEL,s),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null==t||null==n)throw new W;const A=this.moduleSize(t,e);let r=t[1];const i=n[1];let o=t[0];const s=(n[0]-o+1)/A,a=(i-r+1)/A;if(s<=0||a<=0)throw new W;const g=A/2;r+=g,o+=g;const l=new k(s,a);for(let c=0;c<a;c++){const t=r+c*A;for(let n=0;n<s;n++)e.get(o+n*A,t)&&l.set(n,c)}return l}static moduleSize(e,t){const n=t.getWidth();let A=e[0];const r=e[1];for(;A<n&&t.get(A,r);)A++;if(A===n)throw new W;const i=A-e[0];if(0===i)throw new W;return i}}Rt.NO_POINTS=[];class Vt extends T{constructor(e=500){super(new Rt,e)}}(te=P||(P={}))[te.L=0]="L",te[te.M=1]="M",te[te.Q=2]="Q",te[te.H=3]="H";class Nt{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,Nt.FOR_BITS.set(n,this),Nt.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Nt.L;case"M":return Nt.M;case"Q":return Nt.Q;case"H":return Nt.H;default:throw new c(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Nt))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=Nt.FOR_BITS.size)throw new I;return Nt.FOR_BITS.get(e)}}Nt.FOR_BITS=new Map,Nt.FOR_VALUE=new Map,Nt.L=new Nt(P.L,"L",1),Nt.M=new Nt(P.M,"M",0),Nt.Q=new Nt(P.Q,"Q",3),Nt.H=new Nt(P.H,"H",2);class kt{constructor(e){this.errorCorrectionLevel=Nt.forBits(e>>3&3),this.dataMask=7&e}static numBitsDiffering(e,t){return b.bitCount(e^t)}static decodeFormatInformation(e,t){const n=kt.doDecodeFormatInformation(e,t);return null!==n?n:kt.doDecodeFormatInformation(e^kt.FORMAT_INFO_MASK_QR,t^kt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,A=0;for(const r of kt.FORMAT_INFO_DECODE_LOOKUP){const i=r[0];if(i===e||i===t)return new kt(r[1]);let o=kt.numBitsDiffering(e,i);o<n&&(A=r[1],n=o),e!==t&&(o=kt.numBitsDiffering(t,i),o<n&&(A=r[1],n=o))}return n<=3?new kt(A):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof kt))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}kt.FORMAT_INFO_MASK_QR=21522,kt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Wt{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Ft{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Et{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let A=0;const r=n[0].getECCodewordsPerBlock(),i=n[0].getECBlocks();for(const o of i)A+=o.getCount()*(o.getDataCodewords()+r);this.totalCodewords=A}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!=1)throw new S;try{return this.getVersionForNumber((e-17)/4)}catch(t){throw new S}}static getVersionForNumber(e){if(e<1||e>40)throw new I;return Et.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let A=0;A<Et.VERSION_DECODE_INFO.length;A++){const r=Et.VERSION_DECODE_INFO[A];if(r===e)return Et.getVersionForNumber(A+7);const i=kt.numBitsDiffering(e,r);i<t&&(n=A+7,t=i)}return t<=3?Et.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new k(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let A=0;A<n;A++){const e=this.alignmentPatternCenters[A]-2;for(let r=0;r<n;r++)0===A&&(0===r||r===n-1)||A===n-1&&0===r||t.setRegion(this.alignmentPatternCenters[r]-2,e,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}Et.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Et.VERSIONS=[new Et(1,new Int32Array(0),new Wt(7,new Ft(1,19)),new Wt(10,new Ft(1,16)),new Wt(13,new Ft(1,13)),new Wt(17,new Ft(1,9))),new Et(2,Int32Array.from([6,18]),new Wt(10,new Ft(1,34)),new Wt(16,new Ft(1,28)),new Wt(22,new Ft(1,22)),new Wt(28,new Ft(1,16))),new Et(3,Int32Array.from([6,22]),new Wt(15,new Ft(1,55)),new Wt(26,new Ft(1,44)),new Wt(18,new Ft(2,17)),new Wt(22,new Ft(2,13))),new Et(4,Int32Array.from([6,26]),new Wt(20,new Ft(1,80)),new Wt(18,new Ft(2,32)),new Wt(26,new Ft(2,24)),new Wt(16,new Ft(4,9))),new Et(5,Int32Array.from([6,30]),new Wt(26,new Ft(1,108)),new Wt(24,new Ft(2,43)),new Wt(18,new Ft(2,15),new Ft(2,16)),new Wt(22,new Ft(2,11),new Ft(2,12))),new Et(6,Int32Array.from([6,34]),new Wt(18,new Ft(2,68)),new Wt(16,new Ft(4,27)),new Wt(24,new Ft(4,19)),new Wt(28,new Ft(4,15))),new Et(7,Int32Array.from([6,22,38]),new Wt(20,new Ft(2,78)),new Wt(18,new Ft(4,31)),new Wt(18,new Ft(2,14),new Ft(4,15)),new Wt(26,new Ft(4,13),new Ft(1,14))),new Et(8,Int32Array.from([6,24,42]),new Wt(24,new Ft(2,97)),new Wt(22,new Ft(2,38),new Ft(2,39)),new Wt(22,new Ft(4,18),new Ft(2,19)),new Wt(26,new Ft(4,14),new Ft(2,15))),new Et(9,Int32Array.from([6,26,46]),new Wt(30,new Ft(2,116)),new Wt(22,new Ft(3,36),new Ft(2,37)),new Wt(20,new Ft(4,16),new Ft(4,17)),new Wt(24,new Ft(4,12),new Ft(4,13))),new Et(10,Int32Array.from([6,28,50]),new Wt(18,new Ft(2,68),new Ft(2,69)),new Wt(26,new Ft(4,43),new Ft(1,44)),new Wt(24,new Ft(6,19),new Ft(2,20)),new Wt(28,new Ft(6,15),new Ft(2,16))),new Et(11,Int32Array.from([6,30,54]),new Wt(20,new Ft(4,81)),new Wt(30,new Ft(1,50),new Ft(4,51)),new Wt(28,new Ft(4,22),new Ft(4,23)),new Wt(24,new Ft(3,12),new Ft(8,13))),new Et(12,Int32Array.from([6,32,58]),new Wt(24,new Ft(2,92),new Ft(2,93)),new Wt(22,new Ft(6,36),new Ft(2,37)),new Wt(26,new Ft(4,20),new Ft(6,21)),new Wt(28,new Ft(7,14),new Ft(4,15))),new Et(13,Int32Array.from([6,34,62]),new Wt(26,new Ft(4,107)),new Wt(22,new Ft(8,37),new Ft(1,38)),new Wt(24,new Ft(8,20),new Ft(4,21)),new Wt(22,new Ft(12,11),new Ft(4,12))),new Et(14,Int32Array.from([6,26,46,66]),new Wt(30,new Ft(3,115),new Ft(1,116)),new Wt(24,new Ft(4,40),new Ft(5,41)),new Wt(20,new Ft(11,16),new Ft(5,17)),new Wt(24,new Ft(11,12),new Ft(5,13))),new Et(15,Int32Array.from([6,26,48,70]),new Wt(22,new Ft(5,87),new Ft(1,88)),new Wt(24,new Ft(5,41),new Ft(5,42)),new Wt(30,new Ft(5,24),new Ft(7,25)),new Wt(24,new Ft(11,12),new Ft(7,13))),new Et(16,Int32Array.from([6,26,50,74]),new Wt(24,new Ft(5,98),new Ft(1,99)),new Wt(28,new Ft(7,45),new Ft(3,46)),new Wt(24,new Ft(15,19),new Ft(2,20)),new Wt(30,new Ft(3,15),new Ft(13,16))),new Et(17,Int32Array.from([6,30,54,78]),new Wt(28,new Ft(1,107),new Ft(5,108)),new Wt(28,new Ft(10,46),new Ft(1,47)),new Wt(28,new Ft(1,22),new Ft(15,23)),new Wt(28,new Ft(2,14),new Ft(17,15))),new Et(18,Int32Array.from([6,30,56,82]),new Wt(30,new Ft(5,120),new Ft(1,121)),new Wt(26,new Ft(9,43),new Ft(4,44)),new Wt(28,new Ft(17,22),new Ft(1,23)),new Wt(28,new Ft(2,14),new Ft(19,15))),new Et(19,Int32Array.from([6,30,58,86]),new Wt(28,new Ft(3,113),new Ft(4,114)),new Wt(26,new Ft(3,44),new Ft(11,45)),new Wt(26,new Ft(17,21),new Ft(4,22)),new Wt(26,new Ft(9,13),new Ft(16,14))),new Et(20,Int32Array.from([6,34,62,90]),new Wt(28,new Ft(3,107),new Ft(5,108)),new Wt(26,new Ft(3,41),new Ft(13,42)),new Wt(30,new Ft(15,24),new Ft(5,25)),new Wt(28,new Ft(15,15),new Ft(10,16))),new Et(21,Int32Array.from([6,28,50,72,94]),new Wt(28,new Ft(4,116),new Ft(4,117)),new Wt(26,new Ft(17,42)),new Wt(28,new Ft(17,22),new Ft(6,23)),new Wt(30,new Ft(19,16),new Ft(6,17))),new Et(22,Int32Array.from([6,26,50,74,98]),new Wt(28,new Ft(2,111),new Ft(7,112)),new Wt(28,new Ft(17,46)),new Wt(30,new Ft(7,24),new Ft(16,25)),new Wt(24,new Ft(34,13))),new Et(23,Int32Array.from([6,30,54,78,102]),new Wt(30,new Ft(4,121),new Ft(5,122)),new Wt(28,new Ft(4,47),new Ft(14,48)),new Wt(30,new Ft(11,24),new Ft(14,25)),new Wt(30,new Ft(16,15),new Ft(14,16))),new Et(24,Int32Array.from([6,28,54,80,106]),new Wt(30,new Ft(6,117),new Ft(4,118)),new Wt(28,new Ft(6,45),new Ft(14,46)),new Wt(30,new Ft(11,24),new Ft(16,25)),new Wt(30,new Ft(30,16),new Ft(2,17))),new Et(25,Int32Array.from([6,32,58,84,110]),new Wt(26,new Ft(8,106),new Ft(4,107)),new Wt(28,new Ft(8,47),new Ft(13,48)),new Wt(30,new Ft(7,24),new Ft(22,25)),new Wt(30,new Ft(22,15),new Ft(13,16))),new Et(26,Int32Array.from([6,30,58,86,114]),new Wt(28,new Ft(10,114),new Ft(2,115)),new Wt(28,new Ft(19,46),new Ft(4,47)),new Wt(28,new Ft(28,22),new Ft(6,23)),new Wt(30,new Ft(33,16),new Ft(4,17))),new Et(27,Int32Array.from([6,34,62,90,118]),new Wt(30,new Ft(8,122),new Ft(4,123)),new Wt(28,new Ft(22,45),new Ft(3,46)),new Wt(30,new Ft(8,23),new Ft(26,24)),new Wt(30,new Ft(12,15),new Ft(28,16))),new Et(28,Int32Array.from([6,26,50,74,98,122]),new Wt(30,new Ft(3,117),new Ft(10,118)),new Wt(28,new Ft(3,45),new Ft(23,46)),new Wt(30,new Ft(4,24),new Ft(31,25)),new Wt(30,new Ft(11,15),new Ft(31,16))),new Et(29,Int32Array.from([6,30,54,78,102,126]),new Wt(30,new Ft(7,116),new Ft(7,117)),new Wt(28,new Ft(21,45),new Ft(7,46)),new Wt(30,new Ft(1,23),new Ft(37,24)),new Wt(30,new Ft(19,15),new Ft(26,16))),new Et(30,Int32Array.from([6,26,52,78,104,130]),new Wt(30,new Ft(5,115),new Ft(10,116)),new Wt(28,new Ft(19,47),new Ft(10,48)),new Wt(30,new Ft(15,24),new Ft(25,25)),new Wt(30,new Ft(23,15),new Ft(25,16))),new Et(31,Int32Array.from([6,30,56,82,108,134]),new Wt(30,new Ft(13,115),new Ft(3,116)),new Wt(28,new Ft(2,46),new Ft(29,47)),new Wt(30,new Ft(42,24),new Ft(1,25)),new Wt(30,new Ft(23,15),new Ft(28,16))),new Et(32,Int32Array.from([6,34,60,86,112,138]),new Wt(30,new Ft(17,115)),new Wt(28,new Ft(10,46),new Ft(23,47)),new Wt(30,new Ft(10,24),new Ft(35,25)),new Wt(30,new Ft(19,15),new Ft(35,16))),new Et(33,Int32Array.from([6,30,58,86,114,142]),new Wt(30,new Ft(17,115),new Ft(1,116)),new Wt(28,new Ft(14,46),new Ft(21,47)),new Wt(30,new Ft(29,24),new Ft(19,25)),new Wt(30,new Ft(11,15),new Ft(46,16))),new Et(34,Int32Array.from([6,34,62,90,118,146]),new Wt(30,new Ft(13,115),new Ft(6,116)),new Wt(28,new Ft(14,46),new Ft(23,47)),new Wt(30,new Ft(44,24),new Ft(7,25)),new Wt(30,new Ft(59,16),new Ft(1,17))),new Et(35,Int32Array.from([6,30,54,78,102,126,150]),new Wt(30,new Ft(12,121),new Ft(7,122)),new Wt(28,new Ft(12,47),new Ft(26,48)),new Wt(30,new Ft(39,24),new Ft(14,25)),new Wt(30,new Ft(22,15),new Ft(41,16))),new Et(36,Int32Array.from([6,24,50,76,102,128,154]),new Wt(30,new Ft(6,121),new Ft(14,122)),new Wt(28,new Ft(6,47),new Ft(34,48)),new Wt(30,new Ft(46,24),new Ft(10,25)),new Wt(30,new Ft(2,15),new Ft(64,16))),new Et(37,Int32Array.from([6,28,54,80,106,132,158]),new Wt(30,new Ft(17,122),new Ft(4,123)),new Wt(28,new Ft(29,46),new Ft(14,47)),new Wt(30,new Ft(49,24),new Ft(10,25)),new Wt(30,new Ft(24,15),new Ft(46,16))),new Et(38,Int32Array.from([6,32,58,84,110,136,162]),new Wt(30,new Ft(4,122),new Ft(18,123)),new Wt(28,new Ft(13,46),new Ft(32,47)),new Wt(30,new Ft(48,24),new Ft(14,25)),new Wt(30,new Ft(42,15),new Ft(32,16))),new Et(39,Int32Array.from([6,26,54,82,110,138,166]),new Wt(30,new Ft(20,117),new Ft(4,118)),new Wt(28,new Ft(40,47),new Ft(7,48)),new Wt(30,new Ft(43,24),new Ft(22,25)),new Wt(30,new Ft(10,15),new Ft(67,16))),new Et(40,Int32Array.from([6,30,58,86,114,142,170]),new Wt(30,new Ft(19,118),new Ft(6,119)),new Wt(28,new Ft(18,47),new Ft(31,48)),new Wt(30,new Ft(34,24),new Ft(34,25)),new Wt(30,new Ft(20,15),new Ft(61,16)))],(ne=_||(_={}))[ne.DATA_MASK_000=0]="DATA_MASK_000",ne[ne.DATA_MASK_001=1]="DATA_MASK_001",ne[ne.DATA_MASK_010=2]="DATA_MASK_010",ne[ne.DATA_MASK_011=3]="DATA_MASK_011",ne[ne.DATA_MASK_100=4]="DATA_MASK_100",ne[ne.DATA_MASK_101=5]="DATA_MASK_101",ne[ne.DATA_MASK_110=6]="DATA_MASK_110",ne[ne.DATA_MASK_111=7]="DATA_MASK_111";class Xt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let A=0;A<t;A++)this.isMasked(n,A)&&e.flip(A,n)}}Xt.values=new Map([[_.DATA_MASK_000,new Xt(_.DATA_MASK_000,((e,t)=>!(e+t&1)))],[_.DATA_MASK_001,new Xt(_.DATA_MASK_001,((e,t)=>!(1&e)))],[_.DATA_MASK_010,new Xt(_.DATA_MASK_010,((e,t)=>t%3==0))],[_.DATA_MASK_011,new Xt(_.DATA_MASK_011,((e,t)=>(e+t)%3==0))],[_.DATA_MASK_100,new Xt(_.DATA_MASK_100,((e,t)=>!(Math.floor(e/2)+Math.floor(t/3)&1)))],[_.DATA_MASK_101,new Xt(_.DATA_MASK_101,((e,t)=>e*t%6==0))],[_.DATA_MASK_110,new Xt(_.DATA_MASK_110,((e,t)=>e*t%6<3))],[_.DATA_MASK_111,new Xt(_.DATA_MASK_111,((e,t)=>!(e+t+e*t%3&1)))]]);class Ht{constructor(e){const t=e.getHeight();if(t<21||1!=(3&t))throw new S;this.bitMatrix=e}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let e=0;for(let r=0;r<6;r++)e=this.copyBit(r,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let r=5;r>=0;r--)e=this.copyBit(8,r,e);const t=this.bitMatrix.getHeight();let n=0;const A=t-7;for(let r=t-1;r>=A;r--)n=this.copyBit(8,r,n);for(let r=t-8;r<t;r++)n=this.copyBit(r,8,n);if(this.parsedFormatInfo=kt.decodeFormatInformation(e,n),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new S}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Et.getVersionForNumber(t);let n=0;const A=e-11;for(let i=5;i>=0;i--)for(let t=e-9;t>=A;t--)n=this.copyBit(t,i,n);let r=Et.decodeVersionInformation(n);if(null!==r&&r.getDimensionForVersion()===e)return this.parsedVersion=r,r;n=0;for(let i=5;i>=0;i--)for(let t=e-9;t>=A;t--)n=this.copyBit(i,t,n);if(r=Et.decodeVersionInformation(n),null!==r&&r.getDimensionForVersion()===e)return this.parsedVersion=r,r;throw new S}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=Xt.values.get(e.getDataMask()),A=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,A);const r=t.buildFunctionPattern();let i=!0;const o=new Uint8Array(t.getTotalCodewords());let s=0,a=0,g=0;for(let l=A-1;l>0;l-=2){6===l&&l--;for(let e=0;e<A;e++){const t=i?A-1-e:e;for(let e=0;e<2;e++)r.get(l-e,t)||(g++,a<<=1,this.bitMatrix.get(l-e,t)&&(a|=1),8===g&&(o[s++]=a,g=0,a=0))}i=!i}if(s!==t.getTotalCodewords())throw new S;return o}remask(){if(null===this.parsedFormatInfo)return;const e=Xt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let A=t+1,r=e.getHeight();A<r;A++)e.get(t,A)!==e.get(A,t)&&(e.flip(A,t),e.flip(t,A))}}class xt{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new I;const A=t.getECBlocksForLevel(n);let r=0;const i=A.getECBlocks();for(const I of i)r+=I.getCount();const o=new Array(r);let s=0;for(const I of i)for(let e=0;e<I.getCount();e++){const e=I.getDataCodewords(),t=A.getECCodewordsPerBlock()+e;o[s++]=new xt(e,new Uint8Array(t))}const a=o[0].codewords.length;let g=o.length-1;for(;g>=0&&o[g].codewords.length!==a;)g--;g++;const l=a-A.getECCodewordsPerBlock();let c=0;for(let I=0;I<l;I++)for(let t=0;t<s;t++)o[t].codewords[I]=e[c++];for(let I=g;I<s;I++)o[I].codewords[l]=e[c++];const C=o[0].codewords.length;for(let I=l;I<C;I++)for(let t=0;t<s;t++){const n=t<g?I:I+1;o[t].codewords[n]=e[c++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}(Ae=j||(j={}))[Ae.TERMINATOR=0]="TERMINATOR",Ae[Ae.NUMERIC=1]="NUMERIC",Ae[Ae.ALPHANUMERIC=2]="ALPHANUMERIC",Ae[Ae.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",Ae[Ae.BYTE=4]="BYTE",Ae[Ae.ECI=5]="ECI",Ae[Ae.KANJI=6]="KANJI",Ae[Ae.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",Ae[Ae.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",Ae[Ae.HANZI=9]="HANZI";class Jt{constructor(e,t,n,A){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=A,Jt.FOR_BITS.set(A,this),Jt.FOR_VALUE.set(e,this)}static forBits(e){const t=Jt.FOR_BITS.get(e);if(void 0===t)throw new I;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return n=t<=9?0:t<=26?1:2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof Jt))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}Jt.FOR_BITS=new Map,Jt.FOR_VALUE=new Map,Jt.TERMINATOR=new Jt(j.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Jt.NUMERIC=new Jt(j.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Jt.ALPHANUMERIC=new Jt(j.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Jt.STRUCTURED_APPEND=new Jt(j.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Jt.BYTE=new Jt(j.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Jt.ECI=new Jt(j.ECI,"ECI",Int32Array.from([0,0,0]),7),Jt.KANJI=new Jt(j.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Jt.FNC1_FIRST_POSITION=new Jt(j.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Jt.FNC1_SECOND_POSITION=new Jt(j.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Jt.HANZI=new Jt(j.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Yt{static decode(e,t,n,A){const r=new Zt(e);let i=new N;const o=new Array;let s=-1,a=-1;try{let e,n=null,g=!1;do{if(r.available()<4)e=Jt.TERMINATOR;else{const t=r.readBits(4);e=Jt.forBits(t)}switch(e){case Jt.TERMINATOR:break;case Jt.FNC1_FIRST_POSITION:case Jt.FNC1_SECOND_POSITION:g=!0;break;case Jt.STRUCTURED_APPEND:if(r.available()<16)throw new S;s=r.readBits(8),a=r.readBits(8);break;case Jt.ECI:const l=Yt.parseECIValue(r);if(n=v.getCharacterSetECIByValue(l),null===n)throw new S;break;case Jt.HANZI:const c=r.readBits(4),I=r.readBits(e.getCharacterCountBits(t));c===Yt.GB2312_SUBSET&&Yt.decodeHanziSegment(r,i,I);break;default:const C=r.readBits(e.getCharacterCountBits(t));switch(e){case Jt.NUMERIC:Yt.decodeNumericSegment(r,i,C);break;case Jt.ALPHANUMERIC:Yt.decodeAlphanumericSegment(r,i,C,g);break;case Jt.BYTE:Yt.decodeByteSegment(r,i,C,n,o,A);break;case Jt.KANJI:Yt.decodeKanjiSegment(r,i,C);break;default:throw new S}}}while(e!==Jt.TERMINATOR)}catch(g){throw new S}return new ie(e,i.toString(),0===o.length?null:o,null===n?null:n.toString(),s,a)}static decodeHanziSegment(e,t,n){if(13*n>e.available())throw new S;const A=new Uint8Array(2*n);let r=0;for(;n>0;){const t=e.readBits(13);let i=t/96<<8&4294967295|t%96;i+=i<959?41377:42657,A[r]=i>>8&255,A[r+1]=255&i,r+=2,n--}try{t.append(R.decode(A,V.GB2312))}catch(i){throw new S(i)}}static decodeKanjiSegment(e,t,n){if(13*n>e.available())throw new S;const A=new Uint8Array(2*n);let r=0;for(;n>0;){const t=e.readBits(13);let i=t/192<<8&4294967295|t%192;i+=i<7936?33088:49472,A[r]=i>>8,A[r+1]=i,r+=2,n--}try{t.append(R.decode(A,V.SHIFT_JIS))}catch(i){throw new S(i)}}static decodeByteSegment(e,t,n,A,r,i){if(8*n>e.available())throw new S;const o=new Uint8Array(n);for(let g=0;g<n;g++)o[g]=e.readBits(8);let s;s=null===A?V.guessEncoding(o,i):A.getName();try{t.append(R.decode(o,s))}catch(a){throw new S(a)}r.push(o)}static toAlphaNumericChar(e){if(e>=Yt.ALPHANUMERIC_CHARS.length)throw new S;return Yt.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,A){const r=t.length();for(;n>1;){if(e.available()<11)throw new S;const A=e.readBits(11);t.append(Yt.toAlphaNumericChar(Math.floor(A/45))),t.append(Yt.toAlphaNumericChar(A%45)),n-=2}if(1===n){if(e.available()<6)throw new S;t.append(Yt.toAlphaNumericChar(e.readBits(6)))}if(A)for(let i=r;i<t.length();i++)"%"===t.charAt(i)&&(i<t.length()-1&&"%"===t.charAt(i+1)?t.deleteCharAt(i+1):t.setCharAt(i,String.fromCharCode(29)))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new S;const A=e.readBits(10);if(A>=1e3)throw new S;t.append(Yt.toAlphaNumericChar(Math.floor(A/100))),t.append(Yt.toAlphaNumericChar(Math.floor(A/10)%10)),t.append(Yt.toAlphaNumericChar(A%10)),n-=3}if(2===n){if(e.available()<7)throw new S;const n=e.readBits(7);if(n>=100)throw new S;t.append(Yt.toAlphaNumericChar(Math.floor(n/10))),t.append(Yt.toAlphaNumericChar(n%10))}else if(1===n){if(e.available()<4)throw new S;const n=e.readBits(4);if(n>=10)throw new S;t.append(Yt.toAlphaNumericChar(n))}}static parseECIValue(e){const t=e.readBits(8);if(!(128&t))return 127&t;if(128==(192&t))return(63&t)<<8&4294967295|e.readBits(8);if(192==(224&t))return(31&t)<<16&4294967295|e.readBits(16);throw new S}}Yt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Yt.GB2312_SUBSET=1;class Ut{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||null===e||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Lt{constructor(){this.rsDecoder=new Ie(ge.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(k.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new Ht(e);let A=null;try{return this.decodeBitMatrixParser(n,t)}catch(Zf){A=Zf}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const e=this.decodeBitMatrixParser(n,t);return e.setOther(new Ut(!0)),e}catch(Zf){if(null!==A)throw A;throw Zf}}decodeBitMatrixParser(e,t){const n=e.readVersion(),A=e.readFormatInformation().getErrorCorrectionLevel(),r=e.readCodewords(),i=xt.getDataBlocks(r,n,A);let o=0;for(const g of i)o+=g.getNumDataCodewords();const s=new Uint8Array(o);let a=0;for(const g of i){const e=g.getCodewords(),t=g.getNumDataCodewords();this.correctErrors(e,t);for(let n=0;n<t;n++)s[a++]=e[n]}return Yt.decode(s,n,A,t)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch(A){throw new u}for(let r=0;r<t;r++)e[r]=n[r]}}class Tt extends he{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const A=(this.getX()+t)/2,r=(this.getY()+e)/2,i=(this.estimatedModuleSize+n)/2;return new Tt(A,r,i)}}class Kt{constructor(e,t,n,A,r,i,o){this.image=e,this.startX=t,this.startY=n,this.width=A,this.height=r,this.moduleSize=i,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=e+this.width,A=this.startY+t/2,r=new Int32Array(3),i=this.image;for(let o=0;o<t;o++){const t=A+(1&o?-Math.floor((o+1)/2):Math.floor((o+1)/2));r[0]=0,r[1]=0,r[2]=0;let s=e;for(;s<n&&!i.get(s,t);)s++;let a=0;for(;s<n;){if(i.get(s,t))if(1===a)r[1]++;else if(2===a){if(this.foundPatternCross(r)){const e=this.handlePossibleCenter(r,t,s);if(null!==e)return e}r[0]=r[2],r[1]=1,r[2]=0,a=1}else r[++a]++;else 1===a&&a++,r[a]++;s++}if(this.foundPatternCross(r)){const e=this.handlePossibleCenter(r,t,n);if(null!==e)return e}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new W}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let A=0;A<3;A++)if(Math.abs(t-e[A])>=n)return!1;return!0}crossCheckVertical(e,t,n,A){const r=this.image,i=r.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let s=e;for(;s>=0&&r.get(t,s)&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&!r.get(t,s)&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<i&&r.get(t,s)&&o[1]<=n;)o[1]++,s++;if(s===i||o[1]>n)return NaN;for(;s<i&&!r.get(t,s)&&o[2]<=n;)o[2]++,s++;if(o[2]>n)return NaN;const a=o[0]+o[1]+o[2];return 5*Math.abs(a-A)>=2*A?NaN:this.foundPatternCross(o)?Kt.centerFromEnd(o,s):NaN}handlePossibleCenter(e,t,n){const A=e[0]+e[1]+e[2],r=Kt.centerFromEnd(e,n),i=this.crossCheckVertical(t,r,2*e[1],A);if(!isNaN(i)){const t=(e[0]+e[1]+e[2])/3;for(const e of this.possibleCenters)if(e.aboutEquals(t,i,r))return e.combineEstimate(i,r,t);const n=new Tt(r,i,t);this.possibleCenters.push(n),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(n)}return null}}class Mt extends he{constructor(e,t,n,A){super(e,t),this.estimatedModuleSize=n,this.count=A,void 0===A&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const A=this.count+1,r=(this.count*this.getX()+t)/A,i=(this.count*this.getY()+e)/A,o=(this.count*this.estimatedModuleSize+n)/A;return new Mt(r,i,o,A)}}class Qt{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Dt{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=null!=e&&void 0!==e.get(Z.TRY_HARDER),n=null!=e&&void 0!==e.get(Z.PURE_BARCODE),A=this.image,r=A.getHeight(),i=A.getWidth();let o=Math.floor(3*r/(4*Dt.MAX_MODULES));(o<Dt.MIN_SKIP||t)&&(o=Dt.MIN_SKIP);let s=!1;const a=new Int32Array(5);for(let l=o-1;l<r&&!s;l+=o){a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0;let e=0;for(let t=0;t<i;t++)if(A.get(t,l))1&~e||e++,a[e]++;else if(1&e)a[e]++;else if(4===e)if(Dt.foundPatternCross(a)){if(!0!==this.handlePossibleCenter(a,l,t,n)){a[0]=a[2],a[1]=a[3],a[2]=a[4],a[3]=1,a[4]=0,e=3;continue}if(o=2,!0===this.hasSkipped)s=this.haveMultiplyConfirmedCenters();else{const e=this.findRowSkip();e>a[2]&&(l+=e-a[2]-o,t=i-1)}e=0,a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0}else a[0]=a[2],a[1]=a[3],a[2]=a[4],a[3]=1,a[4]=0,e=3;else a[++e]++;Dt.foundPatternCross(a)&&!0===this.handlePossibleCenter(a,l,i,n)&&(o=a[0],this.hasSkipped&&(s=this.haveMultiplyConfirmedCenters()))}const g=this.selectBestPatterns();return he.orderBestPatterns(g),new Qt(g)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let r=0;r<5;r++){const n=e[r];if(0===n)return!1;t+=n}if(t<7)return!1;const n=t/7,A=n/2;return Math.abs(n-e[0])<A&&Math.abs(n-e[1])<A&&Math.abs(3*n-e[2])<3*A&&Math.abs(n-e[3])<A&&Math.abs(n-e[4])<A}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,A){const r=this.getCrossCheckStateCount();let i=0;const o=this.image;for(;e>=i&&t>=i&&o.get(t-i,e-i);)r[2]++,i++;if(e<i||t<i)return!1;for(;e>=i&&t>=i&&!o.get(t-i,e-i)&&r[1]<=n;)r[1]++,i++;if(e<i||t<i||r[1]>n)return!1;for(;e>=i&&t>=i&&o.get(t-i,e-i)&&r[0]<=n;)r[0]++,i++;if(r[0]>n)return!1;const s=o.getHeight(),a=o.getWidth();for(i=1;e+i<s&&t+i<a&&o.get(t+i,e+i);)r[2]++,i++;if(e+i>=s||t+i>=a)return!1;for(;e+i<s&&t+i<a&&!o.get(t+i,e+i)&&r[3]<n;)r[3]++,i++;if(e+i>=s||t+i>=a||r[3]>=n)return!1;for(;e+i<s&&t+i<a&&o.get(t+i,e+i)&&r[4]<n;)r[4]++,i++;if(r[4]>=n)return!1;const g=r[0]+r[1]+r[2]+r[3]+r[4];return Math.abs(g-A)<2*A&&Dt.foundPatternCross(r)}crossCheckVertical(e,t,n,A){const r=this.image,i=r.getHeight(),o=this.getCrossCheckStateCount();let s=e;for(;s>=0&&r.get(t,s);)o[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.get(t,s)&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&r.get(t,s)&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<i&&r.get(t,s);)o[2]++,s++;if(s===i)return NaN;for(;s<i&&!r.get(t,s)&&o[3]<n;)o[3]++,s++;if(s===i||o[3]>=n)return NaN;for(;s<i&&r.get(t,s)&&o[4]<n;)o[4]++,s++;if(o[4]>=n)return NaN;const a=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(a-A)>=2*A?NaN:Dt.foundPatternCross(o)?Dt.centerFromEnd(o,s):NaN}crossCheckHorizontal(e,t,n,A){const r=this.image,i=r.getWidth(),o=this.getCrossCheckStateCount();let s=e;for(;s>=0&&r.get(s,t);)o[2]++,s--;if(s<0)return NaN;for(;s>=0&&!r.get(s,t)&&o[1]<=n;)o[1]++,s--;if(s<0||o[1]>n)return NaN;for(;s>=0&&r.get(s,t)&&o[0]<=n;)o[0]++,s--;if(o[0]>n)return NaN;for(s=e+1;s<i&&r.get(s,t);)o[2]++,s++;if(s===i)return NaN;for(;s<i&&!r.get(s,t)&&o[3]<n;)o[3]++,s++;if(s===i||o[3]>=n)return NaN;for(;s<i&&r.get(s,t)&&o[4]<n;)o[4]++,s++;if(o[4]>=n)return NaN;const a=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(a-A)>=A?NaN:Dt.foundPatternCross(o)?Dt.centerFromEnd(o,s):NaN}handlePossibleCenter(e,t,n,A){const r=e[0]+e[1]+e[2]+e[3]+e[4];let i=Dt.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],r),!isNaN(i)&&(!A||this.crossCheckDiagonal(Math.floor(o),Math.floor(i),e[2],r)))){const e=r/7;let t=!1;const n=this.possibleCenters;for(let A=0,r=n.length;A<r;A++){const r=n[A];if(r.aboutEquals(e,o,i)){n[A]=r.combineEstimate(o,i,e),t=!0;break}}if(!t){const t=new Mt(i,o,e);n.push(t),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(t)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let e=null;for(const t of this.possibleCenters)if(t.getCount()>=Dt.CENTER_QUORUM){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.getX()-t.getX())-Math.abs(e.getY()-t.getY()))/2);e=t}return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const i of this.possibleCenters)i.getCount()>=Dt.CENTER_QUORUM&&(e++,t+=i.getEstimatedModuleSize());if(e<3)return!1;const A=t/n;let r=0;for(const i of this.possibleCenters)r+=Math.abs(i.getEstimatedModuleSize()-A);return r<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new W;const t=this.possibleCenters;let n;if(e>3){let A=0,r=0;for(const e of this.possibleCenters){const t=e.getEstimatedModuleSize();A+=t,r+=t*t}n=A/e;let i=Math.sqrt(r/e-n*n);t.sort(((e,t)=>{const A=Math.abs(t.getEstimatedModuleSize()-n),r=Math.abs(e.getEstimatedModuleSize()-n);return A<r?-1:A>r?1:0}));const o=Math.max(.2*n,i);for(let e=0;e<t.length&&t.length>3;e++){const A=t[e];Math.abs(A.getEstimatedModuleSize()-n)>o&&(t.splice(e,1),e--)}}if(t.length>3){let e=0;for(const n of t)e+=n.getEstimatedModuleSize();n=e/t.length,t.sort(((e,t)=>{if(t.getCount()===e.getCount()){const A=Math.abs(t.getEstimatedModuleSize()-n),r=Math.abs(e.getEstimatedModuleSize()-n);return A<r?1:A>r?-1:0}return t.getCount()-e.getCount()})),t.splice(3)}return[t[0],t[1],t[2]]}}Dt.CENTER_QUORUM=2,Dt.MIN_SKIP=3,Dt.MAX_MODULES=57;class zt{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=null==e?null:e.get(Z.NEED_RESULT_POINT_CALLBACK);const t=new Dt(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),A=e.getBottomLeft(),r=this.calculateModuleSize(t,n,A);if(r<1)throw new W("No pattern found in proccess finder.");const i=zt.computeDimension(t,n,A,r),o=Et.getProvisionalVersionForDimension(i),s=o.getDimensionForVersion()-7;let a=null;if(o.getAlignmentPatternCenters().length>0){const e=n.getX()-t.getX()+A.getX(),i=n.getY()-t.getY()+A.getY(),o=1-3/s,g=Math.floor(t.getX()+o*(e-t.getX())),l=Math.floor(t.getY()+o*(i-t.getY()));for(let t=4;t<=16;t<<=1)try{a=this.findAlignmentInRegion(r,g,l,t);break}catch(BIe){if(!(BIe instanceof W))throw BIe}}const g=zt.createTransform(t,n,A,a,i),l=zt.sampleGrid(this.image,g,i);let c;return c=null===a?[A,t,n]:[A,t,n,a],new me(l,c)}static createTransform(e,t,n,A,r){const i=r-3.5;let o,s,a,g;return null!==A?(o=A.getX(),s=A.getY(),a=i-3,g=a):(o=t.getX()-e.getX()+n.getX(),s=t.getY()-e.getY()+n.getY(),a=i,g=i),Be.quadrilateralToQuadrilateral(3.5,3.5,i,3.5,a,g,3.5,i,e.getX(),e.getY(),t.getX(),t.getY(),o,s,n.getX(),n.getY())}static sampleGrid(e,t,n){return we.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,A){const r=ue.round(he.distance(e,t)/A),i=ue.round(he.distance(e,n)/A);let o=Math.floor((r+i)/2)+7;switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw new W("Dimensions could be not found.")}return o}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),A=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?A/7:isNaN(A)?n/7:(n+A)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,A){let r=this.sizeOfBlackWhiteBlackRun(e,t,n,A),i=1,o=e-(n-e);o<0?(i=e/(e-o),o=0):o>=this.image.getWidth()&&(i=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let s=Math.floor(t-(A-t)*i);return i=1,s<0?(i=t/(t-s),s=0):s>=this.image.getHeight()&&(i=(this.image.getHeight()-1-t)/(s-t),s=this.image.getHeight()-1),o=Math.floor(e+(o-e)*i),r+=this.sizeOfBlackWhiteBlackRun(e,t,o,s),r-1}sizeOfBlackWhiteBlackRun(e,t,n,A){const r=Math.abs(A-t)>Math.abs(n-e);if(r){let r=e;e=t,t=r,r=n,n=A,A=r}const i=Math.abs(n-e),o=Math.abs(A-t);let s=-i/2;const a=e<n?1:-1,g=t<A?1:-1;let l=0;const c=n+a;for(let I=e,C=t;I!==c;I+=a){const n=r?C:I,a=r?I:C;if(1===l===this.image.get(n,a)){if(2===l)return ue.distance(I,C,e,t);l++}if(s+=o,s>0){if(C===A)break;C+=g,s-=i}}return 2===l?ue.distance(n+a,A,e,t):NaN}findAlignmentInRegion(e,t,n,A){const r=Math.floor(A*e),i=Math.max(0,t-r),o=Math.min(this.image.getWidth()-1,t+r);if(o-i<3*e)throw new W("Alignment top exceeds estimated module size.");const s=Math.max(0,n-r),a=Math.min(this.image.getHeight()-1,n+r);if(a-s<3*e)throw new W("Alignment bottom exceeds estimated module size.");return new Kt(this.image,i,s,o-i,a-s,e,this.resultPointCallback).find()}}class Ot{constructor(){this.decoder=new Lt}getDecoder(){return this.decoder}decode(e,t){let n,A;if(null!=t&&void 0!==t.get(Z.PURE_BARCODE)){const r=Ot.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(r,t),A=Ot.NO_POINTS}else{const r=new zt(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(r.getBits(),t),A=r.getPoints()}n.getOther()instanceof Ut&&n.getOther().applyMirroredCorrection(A);const r=new K(n.getText(),n.getRawBytes(),void 0,A,D.QR_CODE,void 0),i=n.getByteSegments();null!==i&&r.putMetadata(re.BYTE_SEGMENTS,i);const o=n.getECLevel();return null!==o&&r.putMetadata(re.ERROR_CORRECTION_LEVEL,o),n.hasStructuredAppend()&&(r.putMetadata(re.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),r.putMetadata(re.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),r}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(null===t||null===n)throw new W;const A=this.moduleSize(t,e);let r=t[1],i=n[1],o=t[0],s=n[0];if(o>=s||r>=i)throw new W;if(i-r!=s-o&&(s=o+(i-r),s>=e.getWidth()))throw new W;const a=Math.round((s-o+1)/A),g=Math.round((i-r+1)/A);if(a<=0||g<=0)throw new W;if(g!==a)throw new W;const l=Math.floor(A/2);r+=l,o+=l;const c=o+Math.floor((a-1)*A)-s;if(c>0){if(c>l)throw new W;o-=c}const I=r+Math.floor((g-1)*A)-i;if(I>0){if(I>l)throw new W;r-=I}const C=new k(a,g);for(let u=0;u<g;u++){const t=r+Math.floor(u*A);for(let n=0;n<a;n++)e.get(o+Math.floor(n*A),t)&&C.set(n,u)}return C}static moduleSize(e,t){const n=t.getHeight(),A=t.getWidth();let r=e[0],i=e[1],o=!0,s=0;for(;r<A&&i<n;){if(o!==t.get(r,i)){if(5==++s)break;o=!o}r++,i++}if(r===A||i===n)throw new W;return(r-e[0])/7}}Ot.NO_POINTS=new Array;class Pt{PDF417Common(){}static getBitCountSum(e){return ue.sum(e)}static toIntArray(e){if(null==e||!e.length)return Pt.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const A of e)t[n++]=A;return t}static getCodeword(e){const t=f.binarySearch(Pt.SYMBOL_TABLE,262143&e);return t<0?-1:(Pt.CODEWORD_TABLE[t]-1)%Pt.NUMBER_OF_CODEWORDS}}Pt.NUMBER_OF_CODEWORDS=929,Pt.MAX_CODEWORDS_IN_BARCODE=Pt.NUMBER_OF_CODEWORDS-1,Pt.MIN_ROWS_IN_BARCODE=3,Pt.MAX_ROWS_IN_BARCODE=90,Pt.MODULES_IN_CODEWORD=17,Pt.MODULES_IN_STOP_PATTERN=18,Pt.BARS_IN_MODULE=8,Pt.EMPTY_INT_ARRAY=new Int32Array([]),Pt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Pt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class _t{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class jt{static detectMultiple(e,t,n){let A=e.getBlackMatrix(),r=jt.detect(n,A);return r.length||(A=A.clone(),A.rotate180(),r=jt.detect(n,A)),new _t(A,r)}static detect(e,t){const n=new Array;let A=0,r=0,i=!1;for(;A<t.getHeight();){const o=jt.findVertices(t,A,r);if(null!=o[0]||null!=o[3]){if(i=!0,n.push(o),!e)break;null!=o[2]?(r=Math.trunc(o[2].getX()),A=Math.trunc(o[2].getY())):(r=Math.trunc(o[4].getX()),A=Math.trunc(o[4].getY()))}else{if(!i)break;i=!1,r=0;for(const e of n)null!=e[1]&&(A=Math.trunc(Math.max(A,e[1].getY()))),null!=e[3]&&(A=Math.max(A,Math.trunc(e[3].getY())));A+=jt.ROW_STEP}}return n}static findVertices(e,t,n){const A=e.getHeight(),r=e.getWidth(),i=new Array(8);return jt.copyToResult(i,jt.findRowsWithPattern(e,A,r,t,n,jt.START_PATTERN),jt.INDEXES_START_PATTERN),null!=i[4]&&(n=Math.trunc(i[4].getX()),t=Math.trunc(i[4].getY())),jt.copyToResult(i,jt.findRowsWithPattern(e,A,r,t,n,jt.STOP_PATTERN),jt.INDEXES_STOP_PATTERN),i}static copyToResult(e,t,n){for(let A=0;A<n.length;A++)e[n[A]]=t[A]}static findRowsWithPattern(e,t,n,A,r,i){const o=new Array(4);let s=!1;const a=new Int32Array(i.length);for(;A<t;A+=jt.ROW_STEP){let t=jt.findGuardPattern(e,r,A,n,!1,i,a);if(null!=t){for(;A>0;){const o=jt.findGuardPattern(e,r,--A,n,!1,i,a);if(null==o){A++;break}t=o}o[0]=new he(t[0],A),o[1]=new he(t[1],A),s=!0;break}}let g=A+1;if(s){let A=0,r=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);for(;g<t;g++){const t=jt.findGuardPattern(e,r[0],g,n,!1,i,a);if(null!=t&&Math.abs(r[0]-t[0])<jt.MAX_PATTERN_DRIFT&&Math.abs(r[1]-t[1])<jt.MAX_PATTERN_DRIFT)r=t,A=0;else{if(A>jt.SKIPPED_ROW_COUNT_MAX)break;A++}}g-=A+1,o[2]=new he(r[0],g),o[3]=new he(r[1],g)}return g-A<jt.BARCODE_MIN_HEIGHT&&f.fill(o,null),o}static findGuardPattern(e,t,n,A,r,i,o){f.fillWithin(o,0,o.length,0);let s=t,a=0;for(;e.get(s,n)&&s>0&&a++<jt.MAX_PIXEL_DRIFT;)s--;let g=s,l=0,c=i.length;for(let I=r;g<A;g++)if(e.get(g,n)!==I)o[l]++;else{if(l===c-1){if(jt.patternMatchVariance(o,i,jt.MAX_INDIVIDUAL_VARIANCE)<jt.MAX_AVG_VARIANCE)return new Int32Array([s,g]);s+=o[0]+o[1],h.arraycopy(o,2,o,0,l-1),o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,I=!I}return l===c-1&&jt.patternMatchVariance(o,i,jt.MAX_INDIVIDUAL_VARIANCE)<jt.MAX_AVG_VARIANCE?new Int32Array([s,g-1]):null}static patternMatchVariance(e,t,n){let A=e.length,r=0,i=0;for(let a=0;a<A;a++)r+=e[a],i+=t[a];if(r<i)return 1/0;let o=r/i;n*=o;let s=0;for(let a=0;a<A;a++){let A=e[a],r=t[a]*o,i=A>r?A-r:r-A;if(i>n)return 1/0;s+=i}return s/r}}jt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),jt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),jt.MAX_AVG_VARIANCE=.42,jt.MAX_INDIVIDUAL_VARIANCE=.8,jt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),jt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),jt.MAX_PIXEL_DRIFT=3,jt.MAX_PATTERN_DRIFT=5,jt.SKIPPED_ROW_COUNT_MAX=25,jt.ROW_STEP=5,jt.BARCODE_MIN_HEIGHT=10;class qt{constructor(e,t){if(0===t.length)throw new I;this.field=e;let n=t.length;if(n>1&&0===t[0]){let e=1;for(;e<n&&0===t[e];)e++;e===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-e),h.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);if(1===e){let e=0;for(let t of this.coefficients)e=this.field.add(e,t);return e}let t=this.coefficients[0],n=this.coefficients.length;for(let A=1;A<n;A++)t=this.field.add(this.field.multiply(e,t),this.coefficients[A]);return t}add(e){if(!this.field.equals(e.field))throw new I("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let e=t;t=n,n=e}let A=new Int32Array(n.length),r=n.length-t.length;h.arraycopy(n,0,A,0,r);for(let i=r;i<n.length;i++)A[i]=this.field.add(t[i-r],n[i]);return new qt(this.field,A)}subtract(e){if(!this.field.equals(e.field))throw new I("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof qt?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new I("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new qt(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,A=e.coefficients,r=A.length,i=new Int32Array(n+r-1);for(let o=0;o<n;o++){let e=t[o];for(let t=0;t<r;t++)i[o+t]=this.field.add(i[o+t],this.field.multiply(e,A[t]))}return new qt(this.field,i)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new qt(this.field,t)}multiplyScalar(e){if(0===e)return new qt(this.field,new Int32Array([0]));if(1===e)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let A=0;A<t;A++)n[A]=this.field.multiply(this.coefficients[A],e);return new qt(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new I;if(0===t)return new qt(this.field,new Int32Array([0]));let n=this.coefficients.length,A=new Int32Array(n+e);for(let r=0;r<n;r++)A[r]=this.field.multiply(this.coefficients[r],t);return new qt(this.field,A)}toString(){let e=new N;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);0!==n&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),0!==t&&1===n||e.append(n),0!==t&&(1===t?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class $t{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(0===e)throw new I;return this.logTable[e]}inverse(e){if(0===e)throw new ae;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class en extends $t{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let A=0;A<e;A++)this.expTable[A]=n,n=n*t%e;for(let A=0;A<e-1;A++)this.logTable[this.expTable[A]]=A;this.zero=new qt(this,new Int32Array([0])),this.one=new qt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new I;if(0===t)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new qt(this,n)}}en.PDF417_GF=new en(Pt.NUMBER_OF_CODEWORDS,3);class tn{constructor(){this.field=en.PDF417_GF}decode(e,t,n){let A=new qt(this.field,e),r=new Int32Array(t),i=!1;for(let C=t;C>0;C--){let e=A.evaluateAt(this.field.exp(C));r[t-C]=e,0!==e&&(i=!0)}if(!i)return 0;let o=this.field.getOne();if(null!=n)for(const C of n){let t=this.field.exp(e.length-1-C),n=new qt(this.field,new Int32Array([this.field.subtract(0,t),1]));o=o.multiply(n)}let s=new qt(this.field,r),a=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),s,t),g=a[0],l=a[1],c=this.findErrorLocations(g),I=this.findErrorMagnitudes(l,g,c);for(let C=0;C<c.length;C++){let t=e.length-1-this.field.log(c[C]);if(t<0)throw u.getChecksumInstance();e[t]=this.field.subtract(e[t],I[C])}return c.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let n=e;e=t,t=n}let A=e,r=t,i=this.field.getZero(),o=this.field.getOne();for(;r.getDegree()>=Math.round(n/2);){let e=A,t=i;if(A=r,i=o,A.isZero())throw u.getChecksumInstance();r=e;let n=this.field.getZero(),s=A.getCoefficient(A.getDegree()),a=this.field.inverse(s);for(;r.getDegree()>=A.getDegree()&&!r.isZero();){let e=r.getDegree()-A.getDegree(),t=this.field.multiply(r.getCoefficient(r.getDegree()),a);n=n.add(this.field.buildMonomial(e,t)),r=r.subtract(A.multiplyByMonomial(e,t))}o=n.multiply(i).subtract(t).negative()}let s=o.getCoefficient(0);if(0===s)throw u.getChecksumInstance();let a=this.field.inverse(s);return[o.multiply(a),r.multiply(a)]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),A=0;for(let r=1;r<this.field.getSize()&&A<t;r++)0===e.evaluateAt(r)&&(n[A]=this.field.inverse(r),A++);if(A!==t)throw u.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let A=t.getDegree(),r=new Int32Array(A);for(let a=1;a<=A;a++)r[A-a]=this.field.multiply(a,t.getCoefficient(a));let i=new qt(this.field,r),o=n.length,s=new Int32Array(o);for(let a=0;a<o;a++){let t=this.field.inverse(n[a]),A=this.field.subtract(0,e.evaluateAt(t)),r=this.field.inverse(i.evaluateAt(t));s[a]=this.field.multiply(A,r)}return s}}class nn{constructor(e,t,n,A,r){e instanceof nn?this.constructor_2(e):this.constructor_1(e,t,n,A,r)}constructor_1(e,t,n,A,r){const i=null==t||null==n,o=null==A||null==r;if(i&&o)throw new W;i?(t=new he(0,A.getY()),n=new he(0,r.getY())):o&&(A=new he(e.getWidth()-1,t.getY()),r=new he(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=A,this.bottomRight=r,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(A.getX(),r.getX())),this.minY=Math.trunc(Math.min(t.getY(),A.getY())),this.maxY=Math.trunc(Math.max(n.getY(),r.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return null==e?t:null==t?e:new nn(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let A=this.topLeft,r=this.bottomLeft,i=this.topRight,o=this.bottomRight;if(e>0){let t=n?this.topLeft:this.topRight,r=Math.trunc(t.getY()-e);r<0&&(r=0);let o=new he(t.getX(),r);n?A=o:i=o}if(t>0){let e=n?this.bottomLeft:this.bottomRight,A=Math.trunc(e.getY()+t);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);let i=new he(e.getX(),A);n?r=i:o=i}return new nn(this.image,A,r,i,o)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class An{constructor(e,t,n,A){this.columnCount=e,this.errorCorrectionLevel=A,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class rn{constructor(){this.buffer=""}static form(e,t){let n=-1;function A(e,A,r,i,o,s){if("%%"===e)return"%";if(void 0===t[++n])return;e=i?parseInt(i.substr(1)):void 0;let a,g=o?parseInt(o.substr(1)):void 0;switch(s){case"s":a=t[n];break;case"c":a=t[n][0];break;case"f":a=parseFloat(t[n]).toFixed(e);break;case"p":a=parseFloat(t[n]).toPrecision(e);break;case"e":a=parseFloat(t[n]).toExponential(e);break;case"x":a=parseInt(t[n]).toString(g||16);break;case"d":a=parseFloat(parseInt(t[n],g||10).toPrecision(e)).toFixed(0)}a="object"==typeof a?JSON.stringify(a):(+a).toString(g);let l=parseInt(r),c=r&&r[0]+""=="0"?"0":" ";for(;a.length<l;)a=void 0!==A?a+c:c+a;return a}let r=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(r,A)}format(e,...t){this.buffer+=rn.form(e,t)}toString(){return this.buffer}}class on{constructor(e){this.boundingBox=new nn(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(null!=t)return t;for(let n=1;n<on.MAX_NEARBY_DISTANCE;n++){let A=this.imageRowToCodewordIndex(e)-n;if(A>=0&&(t=this.codewords[A],null!=t))return t;if(A=this.imageRowToCodewordIndex(e)+n,A<this.codewords.length&&(t=this.codewords[A],null!=t))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new rn;let t=0;for(const n of this.codewords)null!=n?e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue()):e.format("%3d:    |   %n",t++);return e.toString()}}on.MAX_NEARBY_DISTANCE=5;class sn{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);null==t&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,A]of this.values.entries()){const r={getKey:()=>n,getValue:()=>A};r.getValue()>e?(e=r.getValue(),t=[],t.push(r.getKey())):r.getValue()===e&&t.push(r.getKey())}return Pt.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class an extends on{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())null!=e&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),A=this._isLeft?n.getTopLeft():n.getTopRight(),r=this._isLeft?n.getBottomLeft():n.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(A.getY())),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),s=-1,a=1,g=0;for(let l=i;l<o;l++){if(null==t[l])continue;let n=t[l],A=n.getRowNumber()-s;if(0===A)g++;else if(1===A)a=Math.max(a,g),g=1,s=n.getRowNumber();else if(A<0||n.getRowNumber()>=e.getRowCount()||A>l)t[l]=null;else{let e;e=a>2?(a-2)*A:A;let r=e>=l;for(let n=1;n<=e&&!r;n++)r=null!=t[l-n];r?t[l]=null:(s=n.getRowNumber(),g=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(null==e)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(null!=n){let e=n.getRowNumber();if(e>=t.length)continue;t[e]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),A=this._isLeft?t.getBottomLeft():t.getBottomRight(),r=this.imageRowToCodewordIndex(Math.trunc(n.getY())),i=this.imageRowToCodewordIndex(Math.trunc(A.getY())),o=this.getCodewords(),s=-1;for(let a=r;a<i;a++){if(null==o[a])continue;let t=o[a];t.setRowNumberAsRowIndicatorColumn();let n=t.getRowNumber()-s;0===n||(1===n?s=t.getRowNumber():t.getRowNumber()>=e.getRowCount()?o[a]=null:s=t.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new sn,n=new sn,A=new sn,r=new sn;for(let o of e){if(null==o)continue;o.setRowNumberAsRowIndicatorColumn();let e=o.getValue()%30,i=o.getRowNumber();switch(this._isLeft||(i+=2),i%3){case 0:n.setValue(3*e+1);break;case 1:r.setValue(e/3),A.setValue(e%3);break;case 2:t.setValue(e+1)}}if(0===t.getValue().length||0===n.getValue().length||0===A.getValue().length||0===r.getValue().length||t.getValue()[0]<1||n.getValue()[0]+A.getValue()[0]<Pt.MIN_ROWS_IN_BARCODE||n.getValue()[0]+A.getValue()[0]>Pt.MAX_ROWS_IN_BARCODE)return null;let i=new An(t.getValue()[0],n.getValue()[0],A.getValue()[0],r.getValue()[0]);return this.removeIncorrectCodewords(e,i),i}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let A=e[n];if(null==e[n])continue;let r=A.getValue()%30,i=A.getRowNumber();if(i>t.getRowCount())e[n]=null;else switch(this._isLeft||(i+=2),i%3){case 0:3*r+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:Math.trunc(r/3)===t.getErrorCorrectionLevel()&&r%3===t.getRowCountLowerPart()||(e[n]=null);break;case 2:r+1!==t.getColumnCount()&&(e[n]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}class gn{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e,t=Pt.MAX_CODEWORDS_IN_BARCODE;do{e=t,t=this.adjustRowNumbersAndGetCount()}while(t>0&&t<e);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){null!=e&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(0===e)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let n=0;n<e.length;n++)null!=e[n]&&(e[n].hasValidRowNumber()||this.adjustRowNumbers(t,n,e))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(null!=e[n]&&null!=t[n]&&e[n].getRowNumber()===t[n].getRowNumber())for(let t=1;t<=this.barcodeColumnCount;t++){let A=this.detectionResultColumns[t].getCodewords()[n];null!=A&&(A.setRowNumber(e[n].getRowNumber()),A.hasValidRowNumber()||(this.detectionResultColumns[t].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(null==t[n])continue;let A=t[n].getRowNumber(),r=0;for(let t=this.barcodeColumnCount+1;t>0&&r<this.ADJUST_ROW_NUMBER_SKIP;t--){let i=this.detectionResultColumns[t].getCodewords()[n];null!=i&&(r=gn.adjustRowNumberIfValid(A,r,i),i.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(null==t[n])continue;let A=t[n].getRowNumber(),r=0;for(let t=1;t<this.barcodeColumnCount+1&&r<this.ADJUST_ROW_NUMBER_SKIP;t++){let i=this.detectionResultColumns[t].getCodewords()[n];null!=i&&(r=gn.adjustRowNumberIfValid(A,r,i),i.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return null==n||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){if(!this.detectionResultColumns[e-1])return;let A=n[t],r=this.detectionResultColumns[e-1].getCodewords(),i=r;null!=this.detectionResultColumns[e+1]&&(i=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=r[t],o[3]=i[t],t>0&&(o[0]=n[t-1],o[4]=r[t-1],o[5]=i[t-1]),t>1&&(o[8]=n[t-2],o[10]=r[t-2],o[11]=i[t-2]),t<n.length-1&&(o[1]=n[t+1],o[6]=r[t+1],o[7]=i[t+1]),t<n.length-2&&(o[9]=n[t+2],o[12]=r[t+2],o[13]=i[t+2]);for(let s of o)if(gn.adjustRowNumber(A,s))return}static adjustRowNumber(e,t){return!(null==t||!t.hasValidRowNumber()||t.getBucket()!==e.getBucket()||(e.setRowNumber(t.getRowNumber()),0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];null==e&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new rn;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let e=0;e<this.barcodeColumnCount+2;e++){if(null==this.detectionResultColumns[e]){t.format("    |   ");continue}let A=this.detectionResultColumns[e].getCodewords()[n];null!=A?t.format(" %3d|%3d",A.getRowNumber(),A.getValue()):t.format("    |   ")}t.format("%n")}return t.toString()}}class ln{constructor(e,t,n,A){this.rowNumber=ln.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(A)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==ln.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}ln.BARCODE_ROW_UNKNOWN=-1;class cn{static initialize(){for(let e=0;e<Pt.SYMBOL_TABLE.length;e++){let t=Pt.SYMBOL_TABLE[e],n=1&t;for(let A=0;A<Pt.BARS_IN_MODULE;A++){let r=0;for(;(1&t)===n;)r+=1,t>>=1;n=1&t,cn.RATIOS_TABLE[e]||(cn.RATIOS_TABLE[e]=new Array(Pt.BARS_IN_MODULE)),cn.RATIOS_TABLE[e][Pt.BARS_IN_MODULE-A-1]=Math.fround(r/Pt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=cn.getDecodedCodewordValue(cn.sampleBitCounts(e));return-1!==t?t:cn.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=ue.sum(e),n=new Int32Array(Pt.BARS_IN_MODULE),A=0,r=0;for(let i=0;i<Pt.MODULES_IN_CODEWORD;i++){let o=t/(2*Pt.MODULES_IN_CODEWORD)+i*t/Pt.MODULES_IN_CODEWORD;r+e[A]<=o&&(r+=e[A],A++),n[A]++}return n}static getDecodedCodewordValue(e){let t=cn.getBitValue(e);return-1===Pt.getCodeword(t)?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let A=0;A<e[n];A++)t=t<<1|(n%2==0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=ue.sum(e),n=new Array(Pt.BARS_IN_MODULE);if(t>1)for(let i=0;i<n.length;i++)n[i]=Math.fround(e[i]/t);let A=de.MAX_VALUE,r=-1;this.bSymbolTableReady||cn.initialize();for(let i=0;i<cn.RATIOS_TABLE.length;i++){let e=0,t=cn.RATIOS_TABLE[i];for(let r=0;r<Pt.BARS_IN_MODULE;r++){let i=Math.fround(t[r]-n[r]);if(e+=Math.fround(i*i),e>=A)break}e<A&&(A=e,r=Pt.SYMBOL_TABLE[i])}return r}}cn.bSymbolTableReady=!1,cn.RATIOS_TABLE=new Array(Pt.SYMBOL_TABLE.length).map((e=>new Array(Pt.BARS_IN_MODULE)));class In{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Cn{static parseLong(e,t=void 0){return parseInt(e,t)}}class un extends l{}un.kind="NullPointerException";class dn{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(null==e)throw new un;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new m;if(0!==n)for(let A=0;A<n;A++)this.write(e[t+A])}flush(){}close(){}}class hn extends l{}class mn extends dn{constructor(e=32){if(super(),this.count=0,e<0)throw new I("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let t=this.buf.length<<1;if(t-e<0&&(t=e),t<0){if(e<0)throw new hn;t=b.MAX_VALUE}this.buf=f.copyOfUint8Array(this.buf,t)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new m;this.ensureCapacity(this.count+n),h.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return f.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?"string"==typeof e?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}function pn(){if("undefined"!=typeof window)return window.BigInt||null;if(void 0!==o)return o.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let fn;function bn(e){if(void 0===fn&&(fn=pn()),null===fn)throw new Error("BigInt is not supported!");return fn(e)}function Bn(){let e=[];e[0]=bn(1);let t=bn(900);e[1]=t;for(let n=2;n<16;n++)e[n]=e[n-1]*t;return e}!function(e){e[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(q||(q={}));class yn{static decode(e,t){let n=new N(""),A=v.ISO8859_1;n.enableDecoding(A);let r=1,i=e[r++],o=new In;for(;r<e[0];){switch(i){case yn.TEXT_COMPACTION_MODE_LATCH:r=yn.textCompaction(e,r,n);break;case yn.BYTE_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH_6:r=yn.byteCompaction(i,e,A,r,n);break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[r++]);break;case yn.NUMERIC_COMPACTION_MODE_LATCH:r=yn.numericCompaction(e,r,n);break;case yn.ECI_CHARSET:v.getCharacterSetECIByValue(e[r++]);break;case yn.ECI_GENERAL_PURPOSE:r+=2;break;case yn.ECI_USER_DEFINED:r++;break;case yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK:r=yn.decodeMacroBlock(e,r,o);break;case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case yn.MACRO_PDF417_TERMINATOR:throw new S;default:r--,r=yn.textCompaction(e,r,n)}if(!(r<e.length))throw S.getFormatInstance();i=e[r++]}if(0===n.length())throw S.getFormatInstance();let s=new ie(null,n.toString(),null,t);return s.setOther(o),s}static decodeMacroBlock(e,t,n){if(t+yn.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw S.getFormatInstance();let A=new Int32Array(yn.NUMBER_OF_SEQUENCE_CODEWORDS);for(let o=0;o<yn.NUMBER_OF_SEQUENCE_CODEWORDS;o++,t++)A[o]=e[t];n.setSegmentIndex(b.parseInt(yn.decodeBase900toBase10(A,yn.NUMBER_OF_SEQUENCE_CODEWORDS)));let r=new N;t=yn.textCompaction(e,t,r),n.setFileId(r.toString());let i=-1;for(e[t]===yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(i=t+1);t<e[0];)switch(e[t]){case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(e[++t]){case yn.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let A=new N;t=yn.textCompaction(e,t+1,A),n.setFileName(A.toString());break;case yn.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let r=new N;t=yn.textCompaction(e,t+1,r),n.setSender(r.toString());break;case yn.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let i=new N;t=yn.textCompaction(e,t+1,i),n.setAddressee(i.toString());break;case yn.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let o=new N;t=yn.numericCompaction(e,t+1,o),n.setSegmentCount(b.parseInt(o.toString()));break;case yn.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let s=new N;t=yn.numericCompaction(e,t+1,s),n.setTimestamp(Cn.parseLong(s.toString()));break;case yn.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let a=new N;t=yn.numericCompaction(e,t+1,a),n.setChecksum(b.parseInt(a.toString()));break;case yn.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let g=new N;t=yn.numericCompaction(e,t+1,g),n.setFileSize(Cn.parseLong(g.toString()));break;default:throw S.getFormatInstance()}break;case yn.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw S.getFormatInstance()}if(-1!==i){let A=t-i;n.isLastSegment()&&A--,n.setOptionalData(f.copyOfRange(e,i,i+A))}return t}static textCompaction(e,t,n){let A=new Int32Array(2*(e[0]-t)),r=new Int32Array(2*(e[0]-t)),i=0,o=!1;for(;t<e[0]&&!o;){let n=e[t++];if(n<yn.TEXT_COMPACTION_MODE_LATCH)A[i]=n/30,A[i+1]=n%30,i+=2;else switch(n){case yn.TEXT_COMPACTION_MODE_LATCH:A[i++]=yn.TEXT_COMPACTION_MODE_LATCH;break;case yn.BYTE_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH_6:case yn.NUMERIC_COMPACTION_MODE_LATCH:case yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case yn.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A[i]=yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,n=e[t++],r[i]=n,i++}}return yn.decodeTextCompaction(A,r,i,n),t}static decodeTextCompaction(e,t,n,A){let r=q.ALPHA,i=q.ALPHA,o=0;for(;o<n;){let n=e[o],s="";switch(r){case q.ALPHA:if(n<26)s=String.fromCharCode(65+n);else switch(n){case 26:s=" ";break;case yn.LL:r=q.LOWER;break;case yn.ML:r=q.MIXED;break;case yn.PS:i=r,r=q.PUNCT_SHIFT;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(t[o]);break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}break;case q.LOWER:if(n<26)s=String.fromCharCode(97+n);else switch(n){case 26:s=" ";break;case yn.AS:i=r,r=q.ALPHA_SHIFT;break;case yn.ML:r=q.MIXED;break;case yn.PS:i=r,r=q.PUNCT_SHIFT;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(t[o]);break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}break;case q.MIXED:if(n<yn.PL)s=yn.MIXED_CHARS[n];else switch(n){case yn.PL:r=q.PUNCT;break;case 26:s=" ";break;case yn.LL:r=q.LOWER;break;case yn.AL:r=q.ALPHA;break;case yn.PS:i=r,r=q.PUNCT_SHIFT;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(t[o]);break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}break;case q.PUNCT:if(n<yn.PAL)s=yn.PUNCT_CHARS[n];else switch(n){case yn.PAL:r=q.ALPHA;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(t[o]);break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}break;case q.ALPHA_SHIFT:if(r=i,n<26)s=String.fromCharCode(65+n);else switch(n){case 26:s=" ";break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}break;case q.PUNCT_SHIFT:if(r=i,n<yn.PAL)s=yn.PUNCT_CHARS[n];else switch(n){case yn.PAL:r=q.ALPHA;break;case yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(t[o]);break;case yn.TEXT_COMPACTION_MODE_LATCH:r=q.ALPHA}}""!==s&&A.append(s),o++}}static byteCompaction(e,t,n,A,r){let i=new mn,o=0,s=0,a=!1;switch(e){case yn.BYTE_COMPACTION_MODE_LATCH:let e=new Int32Array(6),n=t[A++];for(;A<t[0]&&!a;)switch(e[o++]=n,s=900*s+n,n=t[A++],n){case yn.TEXT_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH:case yn.NUMERIC_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH_6:case yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case yn.MACRO_PDF417_TERMINATOR:A--,a=!0;break;default:if(o%5==0&&o>0){for(let e=0;e<6;++e)i.write(Number(bn(s)>>bn(8*(5-e))));s=0,o=0}}A===t[0]&&n<yn.TEXT_COMPACTION_MODE_LATCH&&(e[o++]=n);for(let t=0;t<o;t++)i.write(e[t]);break;case yn.BYTE_COMPACTION_MODE_LATCH_6:for(;A<t[0]&&!a;){let e=t[A++];if(e<yn.TEXT_COMPACTION_MODE_LATCH)o++,s=900*s+e;else switch(e){case yn.TEXT_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH:case yn.NUMERIC_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH_6:case yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case yn.MACRO_PDF417_TERMINATOR:A--,a=!0}if(o%5==0&&o>0){for(let e=0;e<6;++e)i.write(Number(bn(s)>>bn(8*(5-e))));s=0,o=0}}}return r.append(R.decode(i.toByteArray(),n)),A}static numericCompaction(e,t,n){let A=0,r=!1,i=new Int32Array(yn.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!r;){let o=e[t++];if(t===e[0]&&(r=!0),o<yn.TEXT_COMPACTION_MODE_LATCH)i[A]=o,A++;else switch(o){case yn.TEXT_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH:case yn.BYTE_COMPACTION_MODE_LATCH_6:case yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case yn.MACRO_PDF417_TERMINATOR:t--,r=!0}(A%yn.MAX_NUMERIC_CODEWORDS==0||o===yn.NUMERIC_COMPACTION_MODE_LATCH||r)&&A>0&&(n.append(yn.decodeBase900toBase10(i,A)),A=0)}return t}static decodeBase900toBase10(e,t){let n=bn(0);for(let r=0;r<t;r++)n+=yn.EXP900[t-r-1]*bn(e[r]);let A=n.toString();if("1"!==A.charAt(0))throw new S;return A.substring(1)}}yn.TEXT_COMPACTION_MODE_LATCH=900,yn.BYTE_COMPACTION_MODE_LATCH=901,yn.NUMERIC_COMPACTION_MODE_LATCH=902,yn.BYTE_COMPACTION_MODE_LATCH_6=924,yn.ECI_USER_DEFINED=925,yn.ECI_GENERAL_PURPOSE=926,yn.ECI_CHARSET=927,yn.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,yn.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,yn.MACRO_PDF417_TERMINATOR=922,yn.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,yn.MAX_NUMERIC_CODEWORDS=15,yn.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,yn.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,yn.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,yn.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,yn.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,yn.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,yn.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,yn.PL=25,yn.LL=27,yn.AS=27,yn.ML=28,yn.AL=28,yn.PS=29,yn.PAL=29,yn.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",yn.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",yn.EXP900=pn()?Bn():[],yn.NUMBER_OF_SEQUENCE_CODEWORDS=2;class wn{constructor(){}static decode(e,t,n,A,r,i,o){let s,a=new nn(e,t,n,A,r),g=null,l=null;for(let C=!0;;C=!1){if(null!=t&&(g=wn.getRowIndicatorColumn(e,a,t,!0,i,o)),null!=A&&(l=wn.getRowIndicatorColumn(e,a,A,!1,i,o)),s=wn.merge(g,l),null==s)throw W.getNotFoundInstance();let n=s.getBoundingBox();if(!C||null==n||!(n.getMinY()<a.getMinY()||n.getMaxY()>a.getMaxY()))break;a=n}s.setBoundingBox(a);let c=s.getBarcodeColumnCount()+1;s.setDetectionResultColumn(0,g),s.setDetectionResultColumn(c,l);let I=null!=g;for(let C=1;C<=c;C++){let t,n=I?C:c-C;if(void 0!==s.getDetectionResultColumn(n))continue;t=0===n||n===c?new an(a,0===n):new on(a),s.setDetectionResultColumn(n,t);let A=-1,r=A;for(let g=a.getMinY();g<=a.getMaxY();g++){if(A=wn.getStartColumn(s,n,g,I),A<0||A>a.getMaxX()){if(-1===r)continue;A=r}let l=wn.detectCodeword(e,a.getMinX(),a.getMaxX(),I,A,g,i,o);null!=l&&(t.setCodeword(g,l),r=A,i=Math.min(i,l.getWidth()),o=Math.max(o,l.getWidth()))}}return wn.createDecoderResult(s)}static merge(e,t){if(null==e&&null==t)return null;let n=wn.getBarcodeMetadata(e,t);if(null==n)return null;let A=nn.merge(wn.adjustBoundingBox(e),wn.adjustBoundingBox(t));return new gn(n,A)}static adjustBoundingBox(e){if(null==e)return null;let t=e.getRowHeights();if(null==t)return null;let n=wn.getMax(t),A=0;for(let o of t)if(A+=n-o,o>0)break;let r=e.getCodewords();for(let o=0;A>0&&null==r[o];o++)A--;let i=0;for(let o=t.length-1;o>=0&&(i+=n-t[o],!(t[o]>0));o--);for(let o=r.length-1;i>0&&null==r[o];o--)i--;return e.getBoundingBox().addMissingRows(A,i,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n,A;return null==e||null==(n=e.getBarcodeMetadata())?null==t?null:t.getBarcodeMetadata():null==t||null==(A=t.getBarcodeMetadata())?n:n.getColumnCount()!==A.getColumnCount()&&n.getErrorCorrectionLevel()!==A.getErrorCorrectionLevel()&&n.getRowCount()!==A.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,A,r,i){let o=new an(t,A);for(let s=0;s<2;s++){let a=0===s?1:-1,g=Math.trunc(Math.trunc(n.getX()));for(let s=Math.trunc(Math.trunc(n.getY()));s<=t.getMaxY()&&s>=t.getMinY();s+=a){let t=wn.detectCodeword(e,0,e.getWidth(),A,g,s,r,i);null!=t&&(o.setCodeword(s,t),g=A?t.getStartX():t.getEndX())}}return o}static adjustCodewordCount(e,t){let n=t[0][1],A=n.getValue(),r=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-wn.getNumberOfECCodeWords(e.getBarcodeECLevel());if(0===A.length){if(r<1||r>Pt.MAX_CODEWORDS_IN_BARCODE)throw W.getNotFoundInstance();n.setValue(r)}else A[0]!==r&&n.setValue(r)}static createDecoderResult(e){let t=wn.createBarcodeMatrix(e);wn.adjustCodewordCount(e,t);let n=new Array,A=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),r=[],i=new Array;for(let s=0;s<e.getBarcodeRowCount();s++)for(let o=0;o<e.getBarcodeColumnCount();o++){let a=t[s][o+1].getValue(),g=s*e.getBarcodeColumnCount()+o;0===a.length?n.push(g):1===a.length?A[g]=a[0]:(i.push(g),r.push(a))}let o=new Array(r.length);for(let s=0;s<o.length;s++)o[s]=r[s];return wn.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),A,Pt.toIntArray(n),Pt.toIntArray(i),o)}static createDecoderResultFromAmbiguousValues(e,t,n,A,r){let i=new Int32Array(A.length),o=100;for(;o-- >0;){for(let e=0;e<i.length;e++)t[A[e]]=r[e][i[e]];try{return wn.decodeCodewords(t,e,n)}catch(s){if(!(s instanceof u))throw s}if(0===i.length)throw u.getChecksumInstance();for(let e=0;e<i.length;e++){if(i[e]<r[e].length-1){i[e]++;break}if(i[e]=0,e===i.length-1)throw u.getChecksumInstance()}}throw u.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},(()=>new Array(e.getBarcodeColumnCount()+2)));for(let A=0;A<t.length;A++)for(let e=0;e<t[A].length;e++)t[A][e]=new sn;let n=0;for(let A of e.getDetectionResultColumns()){if(null!=A)for(let e of A.getCodewords())if(null!=e){let A=e.getRowNumber();if(A>=0){if(A>=t.length)continue;t[A][n].setValue(e.getValue())}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,A){let r=A?1:-1,i=null;if(wn.isValidBarcodeColumn(e,t-r)&&(i=e.getDetectionResultColumn(t-r).getCodeword(n)),null!=i)return A?i.getEndX():i.getStartX();if(i=e.getDetectionResultColumn(t).getCodewordNearby(n),null!=i)return A?i.getStartX():i.getEndX();if(wn.isValidBarcodeColumn(e,t-r)&&(i=e.getDetectionResultColumn(t-r).getCodewordNearby(n)),null!=i)return A?i.getEndX():i.getStartX();let o=0;for(;wn.isValidBarcodeColumn(e,t-r);){t-=r;for(let n of e.getDetectionResultColumn(t).getCodewords())if(null!=n)return(A?n.getEndX():n.getStartX())+r*o*(n.getEndX()-n.getStartX());o++}return A?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,A,r,i,o,s){r=wn.adjustCodewordStartColumn(e,t,n,A,r,i);let a,g=wn.getModuleBitCount(e,t,n,A,r,i);if(null==g)return null;let l=ue.sum(g);if(A)a=r+l;else{for(let e=0;e<g.length/2;e++){let t=g[e];g[e]=g[g.length-1-e],g[g.length-1-e]=t}a=r,r=a-l}if(!wn.checkCodewordSkew(l,o,s))return null;let c=cn.getDecodedValue(g),I=Pt.getCodeword(c);return-1===I?null:new ln(r,a,wn.getCodewordBucketNumber(c),I)}static getModuleBitCount(e,t,n,A,r,i){let o=r,s=new Int32Array(8),a=0,g=A?1:-1,l=A;for(;(A?o<n:o>=t)&&a<s.length;)e.get(o,i)===l?(s[a]++,o+=g):(a++,l=!l);return a===s.length||o===(A?n:t)&&a===s.length-1?s:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,A,r,i){let o=r,s=A?-1:1;for(let a=0;a<2;a++){for(;(A?o>=t:o<n)&&A===e.get(o,i);){if(Math.abs(r-o)>wn.CODEWORD_SKEW_SIZE)return r;o+=s}s=-s,A=!A}return o}static checkCodewordSkew(e,t,n){return t-wn.CODEWORD_SKEW_SIZE<=e&&e<=n+wn.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(0===e.length)throw S.getFormatInstance();let A=1<<t+1,r=wn.correctErrors(e,n,A);wn.verifyCodewordCount(e,A);let i=yn.decode(e,""+t);return i.setErrorsCorrected(r),i.setErasures(n.length),i}static correctErrors(e,t,n){if(null!=t&&t.length>n/2+wn.MAX_ERRORS||n<0||n>wn.MAX_EC_CODEWORDS)throw u.getChecksumInstance();return wn.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw S.getFormatInstance();let n=e[0];if(n>e.length)throw S.getFormatInstance();if(0===n){if(!(t<e.length))throw S.getFormatInstance();e[0]=e.length-t}}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,A=t.length-1;for(;!((1&e)!==n&&(n=1&e,A--,A<0));)t[A]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return wn.getCodewordBucketNumber(wn.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new rn;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let A=0;A<e[n].length;A++){let r=e[n][A];0===r.getValue().length?t.format("        ",null):t.format("%4d(%2d)",r.getValue()[0],r.getConfidence(r.getValue()[0]))}t.format("%n")}return t.toString()}}wn.CODEWORD_SKEW_SIZE=2,wn.MAX_ERRORS=3,wn.MAX_EC_CODEWORDS=512,wn.errorCorrection=new tn;class Zn{decode(e,t=null){let n=Zn.decode(e,t,!1);if(null==n||0===n.length||null==n[0])throw W.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return Zn.decode(e,t,!0)}catch(n){if(n instanceof S||n instanceof u)throw W.getNotFoundInstance();throw n}}static decode(e,t,n){const A=new Array,r=jt.detectMultiple(e,t,n);for(const i of r.getPoints()){const e=wn.decode(r.getBits(),i[4],i[5],i[6],i[7],Zn.getMinCodewordWidth(i),Zn.getMaxCodewordWidth(i)),t=new K(e.getText(),e.getRawBytes(),void 0,i,D.PDF_417);t.putMetadata(re.ERROR_CORRECTION_LEVEL,e.getECLevel());const n=e.getOther();null!=n&&t.putMetadata(re.PDF417_EXTRA_METADATA,n),A.push(t)}return A.map((e=>e))}static getMaxWidth(e,t){return null==e||null==t?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return null==e||null==t?b.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(Zn.getMaxWidth(e[0],e[4]),Zn.getMaxWidth(e[6],e[2])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN),Math.max(Zn.getMaxWidth(e[1],e[5]),Zn.getMaxWidth(e[7],e[3])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(Zn.getMinWidth(e[0],e[4]),Zn.getMinWidth(e[6],e[2])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN),Math.min(Zn.getMinWidth(e[1],e[5]),Zn.getMinWidth(e[7],e[3])*Pt.MODULES_IN_CODEWORD/Pt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Sn extends l{}Sn.kind="ReaderException";class vn{constructor(e,t){this.verbose=!0===e,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const n=!t(e)&&!0===e.get(Z.TRY_HARDER),A=t(e)?null:e.get(Z.POSSIBLE_FORMATS),r=new Array;if(!t(A)){const t=A.some((e=>e===D.UPC_A||e===D.UPC_E||e===D.EAN_13||e===D.EAN_8||e===D.CODABAR||e===D.CODE_39||e===D.CODE_93||e===D.CODE_128||e===D.ITF||e===D.RSS_14||e===D.RSS_EXPANDED));t&&!n&&r.push(new mt(e,this.verbose)),A.includes(D.QR_CODE)&&r.push(new Ot),A.includes(D.DATA_MATRIX)&&r.push(new Rt),A.includes(D.AZTEC)&&r.push(new ve),A.includes(D.PDF_417)&&r.push(new Zn),t&&n&&r.push(new mt(e,this.verbose))}0===r.length&&(n||r.push(new mt(e,this.verbose)),r.push(new Ot),r.push(new Rt),r.push(new ve),r.push(new Zn),n&&r.push(new mt(e,this.verbose))),this.readers=r}reset(){if(null!==this.readers)for(const e of this.readers)e.reset()}decodeInternal(e){if(null===this.readers)throw new Sn("No readers where selected, nothing can be read.");for(const n of this.readers)try{return n.decode(e,this.hints)}catch(t){if(t instanceof Sn)continue}throw new W("No MultiFormat Readers were able to detect the code.")}}class Gn extends T{constructor(e=null,t=500){const n=new vn;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class Rn extends T{constructor(e=500){super(new Zn,e)}}class Vn extends T{constructor(e=500){super(new Ot,e)}}var Nn,kn;(kn=Nn||(Nn={}))[kn.ERROR_CORRECTION=0]="ERROR_CORRECTION",kn[kn.CHARACTER_SET=1]="CHARACTER_SET",kn[kn.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",kn[kn.MIN_SIZE=3]="MIN_SIZE",kn[kn.MAX_SIZE=4]="MAX_SIZE",kn[kn.MARGIN=5]="MARGIN",kn[kn.PDF417_COMPACT=6]="PDF417_COMPACT",kn[kn.PDF417_COMPACTION=7]="PDF417_COMPACTION",kn[kn.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",kn[kn.AZTEC_LAYERS=9]="AZTEC_LAYERS",kn[kn.QR_VERSION=10]="QR_VERSION";var Wn=Nn;class Fn{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new se(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const A=this.field;for(let r=t.length;r<=e;r++){const e=n.multiply(new se(A,Int32Array.from([1,A.exp(r-1+A.getGeneratorBase())])));t.push(e),n=e}}return t[e]}encode(e,t){if(0===t)throw new I("No error correction bytes");const n=e.length-t;if(n<=0)throw new I("No data bytes provided");const A=this.buildGenerator(t),r=new Int32Array(n);h.arraycopy(e,0,r,0,n);let i=new se(this.field,r);i=i.multiplyByMonomial(t,1);const o=i.divide(A)[1].getCoefficients(),s=t-o.length;for(let a=0;a<s;a++)e[n+a]=0;h.arraycopy(o,0,e,n+s,o.length)}}class En{constructor(){}static applyMaskPenaltyRule1(e){return En.applyMaskPenaltyRule1Internal(e,!0)+En.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),A=e.getWidth(),r=e.getHeight();for(let i=0;i<r-1;i++){const e=n[i];for(let r=0;r<A-1;r++){const A=e[r];A===e[r+1]&&A===n[i+1][r]&&A===n[i+1][r+1]&&t++}}return En.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),A=e.getWidth(),r=e.getHeight();for(let i=0;i<r;i++)for(let e=0;e<A;e++){const o=n[i];e+6<A&&1===o[e]&&0===o[e+1]&&1===o[e+2]&&1===o[e+3]&&1===o[e+4]&&0===o[e+5]&&1===o[e+6]&&(En.isWhiteHorizontal(o,e-4,e)||En.isWhiteHorizontal(o,e+7,e+11))&&t++,i+6<r&&1===n[i][e]&&0===n[i+1][e]&&1===n[i+2][e]&&1===n[i+3][e]&&1===n[i+4][e]&&0===n[i+5][e]&&1===n[i+6][e]&&(En.isWhiteVertical(n,e,i-4,i)||En.isWhiteVertical(n,e,i+7,i+11))&&t++}return t*En.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let A=t;A<n;A++)if(1===e[A])return!1;return!0}static isWhiteVertical(e,t,n,A){n=Math.max(n,0),A=Math.min(A,e.length);for(let r=n;r<A;r++)if(1===e[r][t])return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),A=e.getWidth(),r=e.getHeight();for(let o=0;o<r;o++){const e=n[o];for(let n=0;n<A;n++)1===e[n]&&t++}const i=e.getHeight()*e.getWidth();return Math.floor(10*Math.abs(2*t-i)/i)*En.N4}static getDataMaskBit(e,t,n){let A,r;switch(e){case 0:A=n+t&1;break;case 1:A=1&n;break;case 2:A=t%3;break;case 3:A=(n+t)%3;break;case 4:A=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:r=n*t,A=(1&r)+r%3;break;case 6:r=n*t,A=(1&r)+r%3&1;break;case 7:r=n*t,A=r%3+(n+t&1)&1;break;default:throw new I("Invalid mask pattern: "+e)}return 0===A}static applyMaskPenaltyRule1Internal(e,t){let n=0;const A=t?e.getHeight():e.getWidth(),r=t?e.getWidth():e.getHeight(),i=e.getArray();for(let o=0;o<A;o++){let e=0,A=-1;for(let s=0;s<r;s++){const r=t?i[o][s]:i[s][o];r===A?e++:(e>=5&&(n+=En.N1+(e-5)),e=1,A=r)}e>=5&&(n+=En.N1+(e-5))}return n}}En.N1=3,En.N2=3,En.N3=40,En.N4=10;class Xn{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let A=0;A!==t;A++)n[A]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)f.fill(t,e)}equals(e){if(!(e instanceof Xn))return!1;const t=e;if(this.width!==t.width)return!1;if(this.height!==t.height)return!1;for(let n=0,A=this.height;n<A;++n){const e=this.bytes[n],A=t.bytes[n];for(let t=0,n=this.width;t<n;++t)if(e[t]!==A[t])return!1}return!0}toString(){const e=new N;for(let t=0,n=this.height;t<n;++t){const n=this.bytes[t];for(let t=0,A=this.width;t<A;++t)switch(n[t]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ")}e.append("\n")}return e.toString()}}class Hn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new N;return e.append("<<\n"),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append("\n ecLevel: "),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append("\n version: "),e.append(this.version?this.version.toString():"null"),e.append("\n maskPattern: "),e.append(this.maskPattern.toString()),this.matrix?(e.append("\n matrix:\n"),e.append(this.matrix.toString())):e.append("\n matrix: null\n"),e.append(">>\n"),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<Hn.NUM_MASK_PATTERNS}}Hn.NUM_MASK_PATTERNS=8;class xn extends l{}xn.kind="WriterException";class Jn{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,A,r){Jn.clearMatrix(r),Jn.embedBasicPatterns(n,r),Jn.embedTypeInfo(t,A,r),Jn.maybeEmbedVersionInfo(n,r),Jn.embedDataBits(e,A,r)}static embedBasicPatterns(e,t){Jn.embedPositionDetectionPatternsAndSeparators(t),Jn.embedDarkDotAtLeftBottomCorner(t),Jn.maybeEmbedPositionAdjustmentPatterns(e,t),Jn.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const A=new B;Jn.makeTypeInfoBits(e,t,A);for(let r=0,i=A.getSize();r<i;++r){const e=A.get(A.getSize()-1-r),t=Jn.TYPE_INFO_COORDINATES[r],i=t[0],o=t[1];if(n.setBoolean(i,o,e),r<8){const t=n.getWidth()-r-1,A=8;n.setBoolean(t,A,e)}else{const t=8,A=n.getHeight()-7+(r-8);n.setBoolean(t,A,e)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new B;Jn.makeVersionInfoBits(e,n);let A=17;for(let r=0;r<6;++r)for(let e=0;e<3;++e){const i=n.get(A);A--,t.setBoolean(r,t.getHeight()-11+e,i),t.setBoolean(t.getHeight()-11+e,r,i)}}static embedDataBits(e,t,n){let A=0,r=-1,i=n.getWidth()-1,o=n.getHeight()-1;for(;i>0;){for(6===i&&(i-=1);o>=0&&o<n.getHeight();){for(let r=0;r<2;++r){const s=i-r;if(!Jn.isEmpty(n.get(s,o)))continue;let a;A<e.getSize()?(a=e.get(A),++A):a=!1,255!==t&&En.getDataMaskBit(t,s,o)&&(a=!a),n.setBoolean(s,o,a)}o+=r}r=-r,o+=r,i-=2}if(A!==e.getSize())throw new xn("Not all bits consumed: "+A+"/"+e.getSize())}static findMSBSet(e){return 32-b.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(0===t)throw new I("0 polynomial");const n=Jn.findMSBSet(t);for(e<<=n-1;Jn.findMSBSet(e)>=n;)e^=t<<Jn.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!Hn.isValidMaskPattern(t))throw new xn("Invalid mask pattern");const A=e.getBits()<<3|t;n.appendBits(A,5);const r=Jn.calculateBCHCode(A,Jn.TYPE_INFO_POLY);n.appendBits(r,10);const i=new B;if(i.appendBits(Jn.TYPE_INFO_MASK_PATTERN,15),n.xor(i),15!==n.getSize())throw new xn("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=Jn.calculateBCHCode(e.getVersionNumber(),Jn.VERSION_INFO_POLY);if(t.appendBits(n,12),18!==t.getSize())throw new xn("should not happen but we got: "+t.getSize())}static isEmpty(e){return 255===e}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;Jn.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),Jn.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(0===e.get(8,e.getHeight()-8))throw new xn;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let A=0;A<8;++A){if(!Jn.isEmpty(n.get(e+A,t)))throw new xn;n.setNumber(e+A,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let A=0;A<7;++A){if(!Jn.isEmpty(n.get(e,t+A)))throw new xn;n.setNumber(e,t+A,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let A=0;A<5;++A){const r=Jn.POSITION_ADJUSTMENT_PATTERN[A];for(let i=0;i<5;++i)n.setNumber(e+i,t+A,r[i])}}static embedPositionDetectionPattern(e,t,n){for(let A=0;A<7;++A){const r=Jn.POSITION_DETECTION_PATTERN[A];for(let i=0;i<7;++i)n.setNumber(e+i,t+A,r[i])}}static embedPositionDetectionPatternsAndSeparators(e){const t=Jn.POSITION_DETECTION_PATTERN[0].length;Jn.embedPositionDetectionPattern(0,0,e),Jn.embedPositionDetectionPattern(e.getWidth()-t,0,e),Jn.embedPositionDetectionPattern(0,e.getWidth()-t,e);const n=8;Jn.embedHorizontalSeparationPattern(0,n-1,e),Jn.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),Jn.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const A=7;Jn.embedVerticalSeparationPattern(A,0,e),Jn.embedVerticalSeparationPattern(e.getHeight()-A-1,0,e),Jn.embedVerticalSeparationPattern(A,e.getHeight()-A,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,A=Jn.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let r=0,i=A.length;r!==i;r++){const e=A[r];if(e>=0)for(let n=0;n!==i;n++){const r=A[n];r>=0&&Jn.isEmpty(t.get(r,e))&&Jn.embedPositionAdjustmentPattern(r-2,e-2,t)}}}}Jn.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Jn.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Jn.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Jn.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Jn.VERSION_INFO_POLY=7973,Jn.TYPE_INFO_POLY=1335,Jn.TYPE_INFO_MASK_PATTERN=21522;class Yn{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Un{constructor(){}static calculateMaskPenalty(e){return En.applyMaskPenaltyRule1(e)+En.applyMaskPenaltyRule2(e)+En.applyMaskPenaltyRule3(e)+En.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let A=Un.DEFAULT_BYTE_MODE_ENCODING;const r=null!==n&&void 0!==n.get(Wn.CHARACTER_SET);r&&(A=n.get(Wn.CHARACTER_SET).toString());const i=this.chooseMode(e,A),o=new B;if(i===Jt.BYTE&&(r||Un.DEFAULT_BYTE_MODE_ENCODING!==A)){const e=v.getCharacterSetECIByName(A);void 0!==e&&this.appendECI(e,o)}this.appendModeInfo(i,o);const s=new B;let a;if(this.appendBytes(e,i,s,A),null!==n&&void 0!==n.get(Wn.QR_VERSION)){const e=Number.parseInt(n.get(Wn.QR_VERSION).toString(),10);a=Et.getVersionForNumber(e);const A=this.calculateBitsNeeded(i,o,s,a);if(!this.willFit(A,a,t))throw new xn("Data too big for requested version")}else a=this.recommendVersion(t,i,o,s);const g=new B;g.appendBitArray(o);const l=i===Jt.BYTE?s.getSizeInBytes():e.length;this.appendLengthInfo(l,a,i,g),g.appendBitArray(s);const c=a.getECBlocksForLevel(t),I=a.getTotalCodewords()-c.getTotalECCodewords();this.terminateBits(I,g);const C=this.interleaveWithECBytes(g,a.getTotalCodewords(),I,c.getNumBlocks()),u=new Hn;u.setECLevel(t),u.setMode(i),u.setVersion(a);const d=a.getDimensionForVersion(),h=new Xn(d,d),m=this.chooseMaskPattern(C,t,a,h);return u.setMaskPattern(m),Jn.buildMatrix(C,t,a,m,h),u.setMatrix(h),u}static recommendVersion(e,t,n,A){const r=this.calculateBitsNeeded(t,n,A,Et.getVersionForNumber(1)),i=this.chooseVersion(r,e),o=this.calculateBitsNeeded(t,n,A,i);return this.chooseVersion(o,e)}static calculateBitsNeeded(e,t,n,A){return t.getSize()+e.getCharacterCountBits(A)+n.getSize()}static getAlphanumericCode(e){return e<Un.ALPHANUMERIC_TABLE.length?Un.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(v.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return Jt.KANJI;let n=!1,A=!1;for(let r=0,i=e.length;r<i;++r){const t=e.charAt(r);if(Un.isDigit(t))n=!0;else{if(-1===this.getAlphanumericCode(t.charCodeAt(0)))return Jt.BYTE;A=!0}}return A?Jt.ALPHANUMERIC:n?Jt.NUMERIC:Jt.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=R.encode(e,v.SJIS)}catch(A){return!1}const n=t.length;if(n%2!=0)return!1;for(let r=0;r<n;r+=2){const e=255&t[r];if((e<129||e>159)&&(e<224||e>235))return!1}return!0}static chooseMaskPattern(e,t,n,A){let r=Number.MAX_SAFE_INTEGER,i=-1;for(let o=0;o<Hn.NUM_MASK_PATTERNS;o++){Jn.buildMatrix(e,t,n,o,A);let s=this.calculateMaskPenalty(A);s<r&&(r=s,i=o)}return i}static chooseVersion(e,t){for(let n=1;n<=40;n++){const A=Et.getVersionForNumber(n);if(Un.willFit(e,A,t))return A}throw new xn("Data too big")}static willFit(e,t,n){return t.getTotalCodewords()-t.getECBlocksForLevel(n).getTotalECCodewords()>=(e+7)/8}static terminateBits(e,t){const n=8*e;if(t.getSize()>n)throw new xn("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let i=0;i<4&&t.getSize()<n;++i)t.appendBit(!1);const A=7&t.getSize();if(A>0)for(let i=A;i<8;i++)t.appendBit(!1);const r=e-t.getSizeInBytes();for(let i=0;i<r;++i)t.appendBits(1&i?17:236,8);if(t.getSize()!==n)throw new xn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,A,r,i){if(A>=n)throw new xn("Block ID too large");const o=e%n,s=n-o,a=Math.floor(e/n),g=a+1,l=Math.floor(t/n),c=l+1,I=a-l,C=g-c;if(I!==C)throw new xn("EC bytes mismatch");if(n!==s+o)throw new xn("RS blocks mismatch");if(e!==(l+I)*s+(c+C)*o)throw new xn("Total bytes mismatch");A<s?(r[0]=l,i[0]=I):(r[0]=c,i[0]=C)}static interleaveWithECBytes(e,t,n,A){if(e.getSizeInBytes()!==n)throw new xn("Number of bits and data bytes does not match");let r=0,i=0,o=0;const s=new Array;for(let g=0;g<A;++g){const a=new Int32Array(1),l=new Int32Array(1);Un.getNumDataBytesAndNumECBytesForBlockID(t,n,A,g,a,l);const c=a[0],I=new Uint8Array(c);e.toBytes(8*r,I,0,c);const C=Un.generateECBytes(I,l[0]);s.push(new Yn(I,C)),i=Math.max(i,c),o=Math.max(o,C.length),r+=a[0]}if(n!==r)throw new xn("Data bytes does not match offset");const a=new B;for(let g=0;g<i;++g)for(const e of s){const t=e.getDataBytes();g<t.length&&a.appendBits(t[g],8)}for(let g=0;g<o;++g)for(const e of s){const t=e.getErrorCorrectionBytes();g<t.length&&a.appendBits(t[g],8)}if(t!==a.getSizeInBytes())throw new xn("Interleaving error: "+t+" and "+a.getSizeInBytes()+" differ.");return a}static generateECBytes(e,t){const n=e.length,A=new Int32Array(n+t);for(let i=0;i<n;i++)A[i]=255&e[i];new Fn(ge.QR_CODE_FIELD_256).encode(A,t);const r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=A[n+i];return r}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,A){const r=n.getCharacterCountBits(t);if(e>=1<<r)throw new xn(e+" is bigger than "+((1<<r)-1));A.appendBits(e,r)}static appendBytes(e,t,n,A){switch(t){case Jt.NUMERIC:Un.appendNumericBytes(e,n);break;case Jt.ALPHANUMERIC:Un.appendAlphanumericBytes(e,n);break;case Jt.BYTE:Un.append8BitBytes(e,n,A);break;case Jt.KANJI:Un.appendKanjiBytes(e,n);break;default:throw new xn("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Un.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let A=0;for(;A<n;){const r=Un.getDigit(e.charAt(A));if(A+2<n){const n=Un.getDigit(e.charAt(A+1)),i=Un.getDigit(e.charAt(A+2));t.appendBits(100*r+10*n+i,10),A+=3}else if(A+1<n){const n=Un.getDigit(e.charAt(A+1));t.appendBits(10*r+n,7),A+=2}else t.appendBits(r,4),A++}}static appendAlphanumericBytes(e,t){const n=e.length;let A=0;for(;A<n;){const r=Un.getAlphanumericCode(e.charCodeAt(A));if(-1===r)throw new xn;if(A+1<n){const n=Un.getAlphanumericCode(e.charCodeAt(A+1));if(-1===n)throw new xn;t.appendBits(45*r+n,11),A+=2}else t.appendBits(r,6),A++}}static append8BitBytes(e,t,n){let A;try{A=R.encode(e,n)}catch(r){throw new xn(r)}for(let i=0,o=A.length;i!==o;i++){const e=A[i];t.appendBits(e,8)}}static appendKanjiBytes(e,t){let n;try{n=R.encode(e,v.SJIS)}catch(r){throw new xn(r)}const A=n.length;for(let i=0;i<A;i+=2){const e=(255&n[i])<<8&4294967295|255&n[i+1];let A=-1;if(e>=33088&&e<=40956?A=e-33088:e>=57408&&e<=60351&&(A=e-49472),-1===A)throw new xn("Invalid byte sequence");const r=192*(A>>8)+(255&A);t.appendBits(r,13)}}static appendECI(e,t){t.appendBits(Jt.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Un.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Un.DEFAULT_BYTE_MODE_ENCODING=v.UTF8.getName();class Ln{write(e,t,n,A=null){if(0===e.length)throw new I("Found empty contents");if(t<0||n<0)throw new I("Requested dimensions are too small: "+t+"x"+n);let r=Nt.L,i=Ln.QUIET_ZONE_SIZE;null!==A&&(void 0!==A.get(Wn.ERROR_CORRECTION)&&(r=Nt.fromString(A.get(Wn.ERROR_CORRECTION).toString())),void 0!==A.get(Wn.MARGIN)&&(i=Number.parseInt(A.get(Wn.MARGIN).toString(),10)));const o=Un.encode(e,r,A);return this.renderResult(o,t,n,i)}writeToDom(e,t,n,A,r=null){"string"==typeof e&&(e=document.querySelector(e));const i=this.write(t,n,A,r);e&&e.appendChild(i)}renderResult(e,t,n,A){const r=e.getMatrix();if(null===r)throw new ce;const i=r.getWidth(),o=r.getHeight(),s=i+2*A,a=o+2*A,g=Math.max(t,s),l=Math.max(n,a),c=Math.min(Math.floor(g/s),Math.floor(l/a)),I=Math.floor((g-i*c)/2),C=Math.floor((l-o*c)/2),u=this.createSVGElement(g,l);for(let d=0,h=C;d<o;d++,h+=c)for(let e=0,t=I;e<i;e++,t+=c)if(1===r.get(e,d)){const e=this.createSvgRectElement(t,h,c,c);u.appendChild(e)}return u}createSVGElement(e,t){const n=document.createElementNS(Ln.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,A){const r=document.createElementNS(Ln.SVG_NS,"rect");return r.setAttributeNS(null,"x",e.toString()),r.setAttributeNS(null,"y",t.toString()),r.setAttributeNS(null,"height",n.toString()),r.setAttributeNS(null,"width",A.toString()),r.setAttributeNS(null,"fill","#000000"),r}}Ln.QUIET_ZONE_SIZE=4,Ln.SVG_NS="http://www.w3.org/2000/svg";class Tn{encode(e,t,n,A,r){if(0===e.length)throw new I("Found empty contents");if(t!==D.QR_CODE)throw new I("Can only encode QR_CODE, but got "+t);if(n<0||A<0)throw new I(`Requested dimensions are too small: ${n}x${A}`);let i=Nt.L,o=Tn.QUIET_ZONE_SIZE;null!==r&&(void 0!==r.get(Wn.ERROR_CORRECTION)&&(i=Nt.fromString(r.get(Wn.ERROR_CORRECTION).toString())),void 0!==r.get(Wn.MARGIN)&&(o=Number.parseInt(r.get(Wn.MARGIN).toString(),10)));const s=Un.encode(e,i,r);return Tn.renderResult(s,n,A,o)}static renderResult(e,t,n,A){const r=e.getMatrix();if(null===r)throw new ce;const i=r.getWidth(),o=r.getHeight(),s=i+2*A,a=o+2*A,g=Math.max(t,s),l=Math.max(n,a),c=Math.min(Math.floor(g/s),Math.floor(l/a)),I=Math.floor((g-i*c)/2),C=Math.floor((l-o*c)/2),u=new k(g,l);for(let d=0,h=C;d<o;d++,h+=c)for(let e=0,t=I;e<i;e++,t+=c)1===r.get(e,d)&&u.setRegion(t,h,c,c);return u}}Tn.QUIET_ZONE_SIZE=4;class Kn{encode(e,t,n,A,r){let i;if(t!==D.QR_CODE)throw new I("No encoder available for format "+t);return i=new Tn,i.encode(e,t,n,A,r)}}class Mn extends X{constructor(e,t,n,A,r,i,o,s){if(super(i,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=A,this.top=r,A+i>t||r+o>n)throw new I("Crop rectangle does not fit within image data.");s&&this.reverseHorizontal(i,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new I("Requested row is outside the image: "+e);const n=this.getWidth();(null==t||t.length<n)&&(t=new Uint8ClampedArray(n));const A=(e+this.top)*this.dataWidth+this.left;return h.arraycopy(this.yuvData,A,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,A=new Uint8ClampedArray(n);let r=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return h.arraycopy(this.yuvData,r,A,0,n),A;for(let i=0;i<t;i++){const t=i*e;h.arraycopy(this.yuvData,r,A,t,e),r+=this.dataWidth}return A}isCropSupported(){return!0}crop(e,t,n,A){return new Mn(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,A,!1)}renderThumbnail(){const e=this.getWidth()/Mn.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/Mn.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),A=this.yuvData;let r=this.top*this.dataWidth+this.left;for(let i=0;i<t;i++){const t=i*e;for(let i=0;i<e;i++){const e=255&A[r+i*Mn.THUMBNAIL_SCALE_FACTOR];n[t+i]=4278190080|65793*e}r+=this.dataWidth*Mn.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/Mn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Mn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let A=0,r=this.top*this.dataWidth+this.left;A<t;A++,r+=this.dataWidth){const t=r+e/2;for(let A=r,i=r+e-1;A<t;A++,i--){const e=n[A];n[A]=n[i],n[i]=e}}}invert(){return new H(this)}}Mn.THUMBNAIL_SCALE_FACTOR=2;class Qn extends X{constructor(e,t,n,A,r,i,o){if(super(t,n),this.dataWidth=A,this.dataHeight=r,this.left=i,this.top=o,4===e.BYTES_PER_ELEMENT){const A=t*n,r=new Uint8ClampedArray(A);for(let t=0;t<A;t++){const n=e[t],A=n>>16&255,i=n>>7&510,o=255&n;r[t]=(A+i+o)/4&255}this.luminances=r}else this.luminances=e;if(void 0===A&&(this.dataWidth=t),void 0===r&&(this.dataHeight=n),void 0===i&&(this.left=0),void 0===o&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new I("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new I("Requested row is outside the image: "+e);const n=this.getWidth();(null==t||t.length<n)&&(t=new Uint8ClampedArray(n));const A=(e+this.top)*this.dataWidth+this.left;return h.arraycopy(this.luminances,A,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,A=new Uint8ClampedArray(n);let r=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return h.arraycopy(this.luminances,r,A,0,n),A;for(let i=0;i<t;i++){const t=i*e;h.arraycopy(this.luminances,r,A,t,e),r+=this.dataWidth}return A}isCropSupported(){return!0}crop(e,t,n,A){return new Qn(this.luminances,n,A,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new H(this)}}class Dn extends v{static forName(e){return this.getCharacterSetECIByName(e)}}class zn{}zn.ISO_8859_1=v.ISO8859_1;class On{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Pn{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class _n{constructor(e){this.previous=e}getPrevious(){return this.previous}}class jn extends _n{constructor(e,t,n){super(e),this.value=t,this.bitCount=n}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new jn(this,e,t)}addBinaryShift(e,t){return new jn(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+b.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class qn extends jn{constructor(e,t,n){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=n}appendTo(e,t){for(let n=0;n<this.binaryShiftByteCount;n++)(0===n||31===n&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):0===n?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)}addBinaryShift(e,t){return new qn(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function $n(e,t,n){return new qn(e,t,n)}function eA(e,t,n){return new jn(e,t,n)}const tA=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],nA=0,AA=1,rA=2,iA=3,oA=4,sA=new jn(null,0,0),aA=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];function gA(e){for(let t of e)f.fill(t,-1);return e[nA][oA]=0,e[AA][oA]=0,e[AA][nA]=28,e[iA][oA]=0,e[rA][oA]=0,e[rA][nA]=15,e}const lA=gA(f.createInt32Array(6,6));class cA{constructor(e,t,n,A){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=A}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let n=this.bitCount,A=this.token;if(e!==this.mode){let t=aA[this.mode][e];A=eA(A,65535&t,t>>16),n+=t>>16}let r=e===rA?4:5;return A=eA(A,t,r),new cA(A,e,0,n+r)}shiftAndAppend(e,t){let n=this.token,A=this.mode===rA?4:5;return n=eA(n,lA[this.mode][e],A),n=eA(n,t,5),new cA(n,this.mode,0,this.bitCount+A+5)}addBinaryShiftChar(e){let t=this.token,n=this.mode,A=this.bitCount;if(this.mode===oA||this.mode===rA){let e=aA[n][nA];t=eA(t,65535&e,e>>16),A+=e>>16,n=nA}let r=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,i=new cA(t,n,this.binaryShiftByteCount+1,A+r);return 2078===i.binaryShiftByteCount&&(i=i.endBinaryShift(e+1)),i}endBinaryShift(e){if(0===this.binaryShiftByteCount)return this;let t=this.token;return t=$n(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new cA(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(aA[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=cA.calculateBinaryShiftCost(e)-cA.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let A=this.endBinaryShift(e.length).token;null!==A;A=A.getPrevious())t.unshift(A);let n=new B;for(const A of t)A.appendTo(n,e);return n}toString(){return V.format("%s bits=%d bytes=%d",tA[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}function IA(e){const t=V.getCharCode(" "),n=V.getCharCode("."),A=V.getCharCode(",");e[nA][t]=1;const r=V.getCharCode("Z"),i=V.getCharCode("A");for(let I=i;I<=r;I++)e[nA][I]=I-i+2;e[AA][t]=1;const o=V.getCharCode("z"),s=V.getCharCode("a");for(let I=s;I<=o;I++)e[AA][I]=I-s+2;e[rA][t]=1;const a=V.getCharCode("9"),g=V.getCharCode("0");for(let I=g;I<=a;I++)e[rA][I]=I-g+2;e[rA][A]=12,e[rA][n]=13;const l=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let I=0;I<l.length;I++)e[iA][V.getCharCode(l[I])]=I;const c=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let I=0;I<c.length;I++)V.getCharCode(c[I])>0&&(e[oA][V.getCharCode(c[I])]=I);return e}cA.INITIAL_STATE=new cA(sA,nA,0,0);const CA=IA(f.createInt32Array(5,256));class uA{constructor(e){this.text=e}encode(){const e=V.getCharCode(" "),t=V.getCharCode("\n");let n=Pn.singletonList(cA.INITIAL_STATE);for(let A=0;A<this.text.length;A++){let r,i=A+1<this.text.length?this.text[A+1]:0;switch(this.text[A]){case V.getCharCode("\r"):r=i===t?2:0;break;case V.getCharCode("."):r=i===e?3:0;break;case V.getCharCode(","):r=i===e?4:0;break;case V.getCharCode(":"):r=i===e?5:0;break;default:r=0}r>0?(n=uA.updateStateListForPair(n,A,r),A++):n=this.updateStateListForChar(n,A)}return Pn.min(n,((e,t)=>e.getBitCount()-t.getBitCount())).toBitArray(this.text)}updateStateListForChar(e,t){const n=[];for(let A of e)this.updateStateForChar(A,t,n);return uA.simplifyStates(n)}updateStateForChar(e,t,n){let A=255&this.text[t],r=CA[e.getMode()][A]>0,i=null;for(let o=0;o<=oA;o++){let s=CA[o][A];if(s>0){if(null==i&&(i=e.endBinaryShift(t)),!r||o===e.getMode()||o===rA){const e=i.latchAndAppend(o,s);n.push(e)}if(!r&&lA[e.getMode()][o]>=0){const e=i.shiftAndAppend(o,s);n.push(e)}}}if(e.getBinaryShiftByteCount()>0||0===CA[e.getMode()][A]){let A=e.addBinaryShiftChar(t);n.push(A)}}static updateStateListForPair(e,t,n){const A=[];for(let r of e)this.updateStateForPair(r,t,n,A);return this.simplifyStates(A)}static updateStateForPair(e,t,n,A){let r=e.endBinaryShift(t);if(A.push(r.latchAndAppend(oA,n)),e.getMode()!==oA&&A.push(r.shiftAndAppend(oA,n)),3===n||4===n){let e=r.latchAndAppend(rA,16-n).latchAndAppend(rA,1);A.push(e)}if(e.getBinaryShiftByteCount()>0){let n=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);A.push(n)}}static simplifyStates(e){let t=[];for(const n of e){let e=!0;for(const A of t){if(A.isBetterThanOrEqualTo(n)){e=!1;break}n.isBetterThanOrEqualTo(A)&&(t=t.filter((e=>e!==A)))}e&&t.push(n)}return t}}class dA{constructor(){}static encodeBytes(e){return dA.encode(e,dA.DEFAULT_EC_PERCENT,dA.DEFAULT_AZTEC_LAYERS)}static encode(e,t,n){let A,r,i,o,s,a=new uA(e).encode(),g=b.truncDivision(a.getSize()*t,100)+11,l=a.getSize()+g;if(n!==dA.DEFAULT_AZTEC_LAYERS){if(A=n<0,r=Math.abs(n),r>(A?dA.MAX_NB_BITS_COMPACT:dA.MAX_NB_BITS))throw new I(V.format("Illegal value %s for layers",n));i=dA.totalBitsInLayer(r,A),o=dA.WORD_SIZE[r];let e=i-i%o;if(s=dA.stuffBits(a,o),s.getSize()+g>e)throw new I("Data to large for user specified layer");if(A&&s.getSize()>64*o)throw new I("Data to large for user specified layer")}else{o=0,s=null;for(let e=0;;e++){if(e>dA.MAX_NB_BITS)throw new I("Data too large for an Aztec code");if(A=e<=3,r=A?e+1:e,i=dA.totalBitsInLayer(r,A),l>i)continue;null!=s&&o===dA.WORD_SIZE[r]||(o=dA.WORD_SIZE[r],s=dA.stuffBits(a,o));let t=i-i%o;if(!(A&&s.getSize()>64*o)&&s.getSize()+g<=t)break}}let c,C=dA.generateCheckWords(s,i,o),u=s.getSize()/o,d=dA.generateModeMessage(A,r,u),h=(A?11:14)+4*r,m=new Int32Array(h);if(A){c=h;for(let e=0;e<m.length;e++)m[e]=e}else{c=h+1+2*b.truncDivision(b.truncDivision(h,2)-1,15);let e=b.truncDivision(h,2),t=b.truncDivision(c,2);for(let n=0;n<e;n++){let A=n+b.truncDivision(n,15);m[e-n-1]=t-A-1,m[e+n]=t+A+1}}let p=new k(c);for(let I=0,b=0;I<r;I++){let e=4*(r-I)+(A?9:12);for(let t=0;t<e;t++){let n=2*t;for(let A=0;A<2;A++)C.get(b+n+A)&&p.set(m[2*I+A],m[2*I+t]),C.get(b+2*e+n+A)&&p.set(m[2*I+t],m[h-1-2*I-A]),C.get(b+4*e+n+A)&&p.set(m[h-1-2*I-A],m[h-1-2*I-t]),C.get(b+6*e+n+A)&&p.set(m[h-1-2*I-t],m[2*I+A])}b+=8*e}if(dA.drawModeMessage(p,A,c,d),A)dA.drawBullsEye(p,b.truncDivision(c,2),5);else{dA.drawBullsEye(p,b.truncDivision(c,2),7);for(let e=0,t=0;e<b.truncDivision(h,2)-1;e+=15,t+=16)for(let n=1&b.truncDivision(c,2);n<c;n+=2)p.set(b.truncDivision(c,2)-t,n),p.set(b.truncDivision(c,2)+t,n),p.set(n,b.truncDivision(c,2)-t),p.set(n,b.truncDivision(c,2)+t)}let f=new On;return f.setCompact(A),f.setSize(c),f.setLayers(r),f.setCodeWords(u),f.setMatrix(p),f}static drawBullsEye(e,t,n){for(let A=0;A<n;A+=2)for(let n=t-A;n<=t+A;n++)e.set(n,t-A),e.set(n,t+A),e.set(t-A,n),e.set(t+A,n);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)}static generateModeMessage(e,t,n){let A=new B;return e?(A.appendBits(t-1,2),A.appendBits(n-1,6),A=dA.generateCheckWords(A,28,4)):(A.appendBits(t-1,5),A.appendBits(n-1,11),A=dA.generateCheckWords(A,40,4)),A}static drawModeMessage(e,t,n,A){let r=b.truncDivision(n,2);if(t)for(let i=0;i<7;i++){let t=r-3+i;A.get(i)&&e.set(t,r-5),A.get(i+7)&&e.set(r+5,t),A.get(20-i)&&e.set(t,r+5),A.get(27-i)&&e.set(r-5,t)}else for(let i=0;i<10;i++){let t=r-5+i+b.truncDivision(i,5);A.get(i)&&e.set(t,r-7),A.get(i+10)&&e.set(r+7,t),A.get(29-i)&&e.set(t,r+7),A.get(39-i)&&e.set(r-7,t)}}static generateCheckWords(e,t,n){let A=e.getSize()/n,r=new Fn(dA.getGF(n)),i=b.truncDivision(t,n),o=dA.bitsToWords(e,n,i);r.encode(o,i-A);let s=t%n,a=new B;a.appendBits(0,s);for(const g of Array.from(o))a.appendBits(g,n);return a}static bitsToWords(e,t,n){let A,r,i=new Int32Array(n);for(A=0,r=e.getSize()/t;A<r;A++){let n=0;for(let r=0;r<t;r++)n|=e.get(A*t+r)?1<<t-r-1:0;i[A]=n}return i}static getGF(e){switch(e){case 4:return ge.AZTEC_PARAM;case 6:return ge.AZTEC_DATA_6;case 8:return ge.AZTEC_DATA_8;case 10:return ge.AZTEC_DATA_10;case 12:return ge.AZTEC_DATA_12;default:throw new I("Unsupported word size "+e)}}static stuffBits(e,t){let n=new B,A=e.getSize(),r=(1<<t)-2;for(let i=0;i<A;i+=t){let o=0;for(let n=0;n<t;n++)(i+n>=A||e.get(i+n))&&(o|=1<<t-1-n);(o&r)===r?(n.appendBits(o&r,t),i--):o&r?n.appendBits(o,t):(n.appendBits(1|o,t),i--)}return n}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}dA.DEFAULT_EC_PERCENT=33,dA.DEFAULT_AZTEC_LAYERS=0,dA.MAX_NB_BITS=32,dA.MAX_NB_BITS_COMPACT=4,dA.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class hA{encode(e,t,n,A){return this.encodeWithHints(e,t,n,A,null)}encodeWithHints(e,t,n,A,r){let i=zn.ISO_8859_1,o=dA.DEFAULT_EC_PERCENT,s=dA.DEFAULT_AZTEC_LAYERS;return null!=r&&(r.has(Wn.CHARACTER_SET)&&(i=Dn.forName(r.get(Wn.CHARACTER_SET).toString())),r.has(Wn.ERROR_CORRECTION)&&(o=b.parseInt(r.get(Wn.ERROR_CORRECTION).toString())),r.has(Wn.AZTEC_LAYERS)&&(s=b.parseInt(r.get(Wn.AZTEC_LAYERS).toString()))),hA.encodeLayers(e,t,n,A,i,o,s)}static encodeLayers(e,t,n,A,r,i,o){if(t!==D.AZTEC)throw new I("Can only encode AZTEC, but got "+t);let s=dA.encode(V.getBytes(e,r),i,o);return hA.renderResult(s,n,A)}static renderResult(e,t,n){let A=e.getMatrix();if(null==A)throw new ce;let r=A.getWidth(),i=A.getHeight(),o=Math.max(t,r),s=Math.max(n,i),a=Math.min(o/r,s/i),g=(o-r*a)/2,l=(s-i*a)/2,c=new k(o,s);for(let I=0,C=l;I<i;I++,C+=a)for(let e=0,t=g;e<r;e++,t+=a)A.get(e,I)&&c.setRegion(t,C,a,a);return c}}e.AbstractExpandedDecoder=et,e.ArgumentException=c,e.ArithmeticException=ae,e.AztecCode=On,e.AztecCodeReader=ve,e.AztecCodeWriter=hA,e.AztecDecoder=Ce,e.AztecDetector=Se,e.AztecDetectorResult=pe,e.AztecEncoder=dA,e.AztecHighLevelEncoder=uA,e.AztecPoint=Ze,e.BarcodeFormat=D,e.Binarizer=d,e.BinaryBitmap=C,e.BitArray=B,e.BitMatrix=k,e.BitSource=Zt,e.BrowserAztecCodeReader=Ge,e.BrowserBarcodeReader=pt,e.BrowserCodeReader=T,e.BrowserDatamatrixCodeReader=Vt,e.BrowserMultiFormatReader=Gn,e.BrowserPDF417Reader=Rn,e.BrowserQRCodeReader=Vn,e.BrowserQRCodeSvgWriter=Ln,e.CharacterSetECI=v,e.ChecksumException=u,e.Code128Reader=Ve,e.Code39Reader=Ne,e.DataMatrixDecodedBitStreamParser=St,e.DataMatrixReader=Rt,e.DecodeHintType=Z,e.DecoderResult=ie,e.DefaultGridSampler=ye,e.DetectorResult=me,e.EAN13Reader=xe,e.EncodeHintType=Wn,e.Exception=l,e.FormatException=S,e.GenericGF=ge,e.GenericGFPoly=se,e.GlobalHistogramBinarizer=F,e.GridSampler=be,e.GridSamplerInstance=we,e.HTMLCanvasElementLuminanceSource=x,e.HybridBinarizer=E,e.ITFReader=ke,e.IllegalArgumentException=I,e.IllegalStateException=ce,e.InvertedLuminanceSource=H,e.LuminanceSource=X,e.MathUtils=ue,e.MultiFormatOneDReader=mt,e.MultiFormatReader=vn,e.MultiFormatWriter=Kn,e.NotFoundException=W,e.OneDReader=Re,e.PDF417DecodedBitStreamParser=yn,e.PDF417DecoderErrorCorrection=tn,e.PDF417Reader=Zn,e.PDF417ResultMetadata=In,e.PerspectiveTransform=Be,e.PlanarYUVLuminanceSource=Mn,e.QRCodeByteMatrix=Xn,e.QRCodeDataMask=Xt,e.QRCodeDecodedBitStreamParser=Yt,e.QRCodeDecoderErrorCorrectionLevel=Nt,e.QRCodeDecoderFormatInformation=kt,e.QRCodeEncoder=Un,e.QRCodeEncoderQRCode=Hn,e.QRCodeMaskUtil=En,e.QRCodeMatrixUtil=Jn,e.QRCodeMode=Jt,e.QRCodeReader=Ot,e.QRCodeVersion=Et,e.QRCodeWriter=Tn,e.RGBLuminanceSource=Qn,e.RSS14Reader=ht,e.RSSExpandedReader=ut,e.ReaderException=Sn,e.ReedSolomonDecoder=Ie,e.ReedSolomonEncoder=Fn,e.ReedSolomonException=le,e.Result=K,e.ResultMetadataType=re,e.ResultPoint=he,e.StringUtils=V,e.UnsupportedOperationException=G,e.VideoInputDevice=J,e.WhiteRectangleDetector=fe,e.WriterException=xn,e.ZXingArrays=f,e.ZXingCharset=Dn,e.ZXingInteger=b,e.ZXingStandardCharsets=zn,e.ZXingStringBuilder=N,e.ZXingStringEncoding=R,e.ZXingSystem=h,e.createAbstractExpandedDecoder=ct,Object.defineProperty(e,"__esModule",{value:!0})}(eX.exports);var tX=eX.exports;const nX=s({__proto__:null,default:A(tX)},[tX]);var AX,rX,iX=function(){function e(e,t,n){if(this.formatMap=new Map([[EE.QR_CODE,tX.BarcodeFormat.QR_CODE],[EE.AZTEC,tX.BarcodeFormat.AZTEC],[EE.CODABAR,tX.BarcodeFormat.CODABAR],[EE.CODE_39,tX.BarcodeFormat.CODE_39],[EE.CODE_93,tX.BarcodeFormat.CODE_93],[EE.CODE_128,tX.BarcodeFormat.CODE_128],[EE.DATA_MATRIX,tX.BarcodeFormat.DATA_MATRIX],[EE.MAXICODE,tX.BarcodeFormat.MAXICODE],[EE.ITF,tX.BarcodeFormat.ITF],[EE.EAN_13,tX.BarcodeFormat.EAN_13],[EE.EAN_8,tX.BarcodeFormat.EAN_8],[EE.PDF_417,tX.BarcodeFormat.PDF_417],[EE.RSS_14,tX.BarcodeFormat.RSS_14],[EE.RSS_EXPANDED,tX.BarcodeFormat.RSS_EXPANDED],[EE.UPC_A,tX.BarcodeFormat.UPC_A],[EE.UPC_E,tX.BarcodeFormat.UPC_E],[EE.UPC_EAN_EXTENSION,tX.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!nX)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=n;var A=this.createZXingFormats(e),r=new Map;r.set(tX.DecodeHintType.POSSIBLE_FORMATS,A),r.set(tX.DecodeHintType.TRY_HARDER,!1),this.hints=r}return e.prototype.decodeAsync=function(e){var t=this;return new Promise((function(n,A){try{n(t.decode(e))}catch(PWe){A(PWe)}}))},e.prototype.decode=function(e){var t=new tX.MultiFormatReader(this.verbose,this.hints),n=new tX.HTMLCanvasElementLuminanceSource(e),A=new tX.BinaryBitmap(new tX.HybridBinarizer(n)),r=t.decode(A);return{text:r.text,format:QE.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach((function(t,n,A){e.set(t,n)})),e},e.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},e.prototype.createZXingFormats=function(e){for(var t=[],n=0,A=e;n<A.length;n++){var r=A[n];this.formatMap.has(r)?t.push(this.formatMap.get(r)):this.logger.logError("".concat(r," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),oX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},sX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},aX=function(){function e(t,n,A){if(this.formatMap=new Map([[EE.QR_CODE,"qr_code"],[EE.AZTEC,"aztec"],[EE.CODABAR,"codabar"],[EE.CODE_39,"code_39"],[EE.CODE_93,"code_93"],[EE.CODE_128,"code_128"],[EE.DATA_MATRIX,"data_matrix"],[EE.ITF,"itf"],[EE.EAN_13,"ean_13"],[EE.EAN_8,"ean_8"],[EE.PDF_417,"pdf417"],[EE.UPC_A,"upc_a"],[EE.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=A;var r=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(r),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){return"BarcodeDetector"in window&&void 0!==new BarcodeDetector({formats:["qr_code"]})},e.prototype.decodeAsync=function(e){return oX(this,void 0,void 0,(function(){var t,n;return sX(this,(function(A){switch(A.label){case 0:return[4,this.detector.detect(e)];case 1:if(!(t=A.sent())||0===t.length)throw"No barcode or QR code detected.";return[2,{text:(n=this.selectLargestBarcode(t)).rawValue,format:QE.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}}))}))},e.prototype.selectLargestBarcode=function(e){for(var t=null,n=0,A=0,r=e;A<r.length;A++){var i=r[A],o=i.boundingBox.width*i.boundingBox.height;o>n&&(n=o,t=i)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],n=0,A=e;n<A.length;n++){var r=A[n];this.formatMap.has(r)?t.push(this.formatMap.get(r)):this.logger.warn("".concat(r," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},e.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach((function(t,n,A){e.set(t,n)})),e},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),gX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},lX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},cX=function(){function e(e,t,n,A){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,t&&aX.isSupported()?(this.primaryDecoder=new aX(e,n,A),this.secondaryDecoder=new iX(e,n,A)):this.primaryDecoder=new iX(e,n,A)}return e.prototype.decodeAsync=function(e){return gX(this,void 0,void 0,(function(){var t;return lX(this,(function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}}))}))},e.prototype.decodeRobustlyAsync=function(e){return gX(this,void 0,void 0,(function(){var t,n;return lX(this,(function(A){switch(A.label){case 0:t=performance.now(),A.label=1;case 1:return A.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,A.sent()];case 3:if(n=A.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw n;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}}))}))},e.prototype.getDecoder=function(){return this.secondaryDecoder?!1===this.wasPrimaryDecoderUsedInLastDecode?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,n=this.executionResults;t<n.length;t++){e+=n[t]}this.executionResults.length;this.executions=0,this.executionResults=[]}},e}(),IX=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function A(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(A.prototype=n.prototype,new A)}}(),CX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},uX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},dX=function(){function e(e,t){this.name=e,this.track=t}return e.prototype.isSupported=function(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()},e.prototype.apply=function(e){var t={};t[this.name]=e;var n={advanced:[t]};return this.track.applyConstraints(n)},e.prototype.value=function(){var e=this.track.getSettings();return this.name in e?e[this.name]:null},e}(),hX=function(e){function t(t){return e.call(this,"zoom",t)||this}return IX(t,e),t}(function(e){function t(t,n){return e.call(this,t,n)||this}return IX(t,e),t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(e){var t={};t[this.name]=e;var n={advanced:[t]};return this.track.applyConstraints(n)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities()[this.name];return{min:e.min,max:e.max,step:e.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(dX)),mX=function(e){function t(t){return e.call(this,"torch",t)||this}return IX(t,e),t}(dX),pX=function(){function e(e){this.track=e}return e.prototype.zoomFeature=function(){return new hX(this.track)},e.prototype.torchFeature=function(){return new mX(this.track)},e}(),fX=function(){function e(e,t,n){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return e.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var n=e.surface.clientWidth,A=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(n,A),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,n,A,r){return CX(this,void 0,void 0,(function(){var i,o;return uX(this,(function(s){switch(s.label){case 0:return i=new e(t,n,r),A.aspectRatio?(o={aspectRatio:A.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:s.sent(),s.label=2;case 2:return i.setupSurface(),[2,i]}}))}))},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(e){this.failIfClosed();var t=this,n=function(){setTimeout(e,200),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(e){return CX(this,void 0,void 0,(function(){return uX(this,(function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]}))}))},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise((function(t,n){var A=e.mediaStream.getVideoTracks().length,r=0;e.mediaStream.getVideoTracks().forEach((function(n){e.mediaStream.removeTrack(n),n.stop(),++r>=A&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())}))}))},e.prototype.getCapabilities=function(){return new pX(this.getFirstTrackOrFail())},e}(),bX=function(){function e(e){this.mediaStream=e}return e.prototype.render=function(e,t,n){return CX(this,void 0,void 0,(function(){return uX(this,(function(A){return[2,fX.create(e,this.mediaStream,t,n)]}))}))},e.create=function(t){return CX(this,void 0,void 0,(function(){var n;return uX(this,(function(A){switch(A.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return[2,new e(A.sent())]}}))}))},e}(),BX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},yX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},wX=function(){function e(){}return e.failIfNotSupported=function(){return BX(this,void 0,void 0,(function(){return yX(this,(function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]}))}))},e.prototype.create=function(e){return BX(this,void 0,void 0,(function(){return yX(this,(function(t){return[2,bX.create(e)]}))}))},e}(),ZX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},SX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},vX=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=_E.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=_E.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if("https:"===location.protocol)return!0;var e=location.host.split(":")[0];return"127.0.0.1"===e||"localhost"===e},e.getCamerasFromMediaDevices=function(){return ZX(this,void 0,void 0,(function(){var e,t,n,A,r,i,o;return SX(this,(function(s){switch(s.label){case 0:return e=function(e){for(var t=0,n=e.getVideoTracks();t<n.length;t++){var A=n[t];A.enabled=!1,A.stop(),e.removeTrack(A)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=s.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=s.sent(),A=[],r=0,i=n;r<i.length;r++)"videoinput"===(o=i[r]).kind&&A.push({id:o.deviceId,label:o.label});return e(t),[2,A]}}))}))},e.getCamerasFromMediaStreamTrack=function(){return new Promise((function(e,t){MediaStreamTrack.getSources((function(t){for(var n=[],A=0,r=t;A<r.length;A++){var i=r[A];"video"===i.kind&&n.push({id:i.id,label:i.label})}e(n)}))}))},e}();(rX=AX||(AX={}))[rX.UNKNOWN=0]="UNKNOWN",rX[rX.NOT_STARTED=1]="NOT_STARTED",rX[rX.SCANNING=2]="SCANNING",rX[rX.PAUSED=3]="PAUSED";var GX,RX,VX=function(){function e(){this.state=AX.NOT_STARTED,this.onGoingTransactionNewState=AX.UNKNOWN}return e.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},e.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===AX.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=AX.UNKNOWN,this.directTransition(e)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===AX.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=AX.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==AX.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(e){switch(this.state){case AX.UNKNOWN:throw"Transition from unknown is not allowed";case AX.NOT_STARTED:this.failIfNewStateIs(e,[AX.PAUSED]);case AX.SCANNING:case AX.PAUSED:}},e.prototype.failIfNewStateIs=function(e,t){for(var n=0,A=t;n<A.length;n++){if(e===A[n])throw"Cannot transition from ".concat(this.state," to ").concat(e)}},e}(),NX=function(){function e(e){this.stateManager=e}return e.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},e.prototype.directTransition=function(e){this.stateManager.directTransition(e)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===AX.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==AX.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===AX.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===AX.PAUSED},e}(),kX=function(){function e(){}return e.create=function(){return new NX(new VX)},e}(),WX=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function A(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(A.prototype=n.prototype,new A)}}(),FX=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return WX(t,e),t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(ME),EX=function(){function e(e,t){this.logger=t,this.fps=FX.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=!0===e.disableFlip,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=FX.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?$E.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!PE(this.qrbox)},e.create=function(t,n){return new e(t,n)},e}(),XX=function(){function e(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");var n;this.elementId=e,this.verbose=!1,"boolean"==typeof t?this.verbose=!0===t:t&&(n=t,this.verbose=!0===n.verbose,n.experimentalFeatures),this.logger=new OE(this.verbose),this.qrcode=new cX(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=kX.create()}return e.prototype.start=function(e,t,n,A){var r,i=this;if(!e)throw"cameraIdOrConfig is required";if(!n||"function"!=typeof n)throw"qrCodeSuccessCallback is required and should be a function.";r=A||(this.verbose?this.logger.log:function(){});var o=EX.create(t,this.logger);this.clearElement();var s=!1;o.videoConstraints&&(o.isMediaStreamConstraintsValid()?s=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var a=s,g=document.getElementById(this.elementId);g.clientWidth?g.clientWidth:FX.DEFAULT_WIDTH,g.style.position="relative",this.shouldScan=!0,this.element=g;var l=this,c=this.stateManagerProxy.startTransition(AX.SCANNING);return new Promise((function(t,A){var s=a?o.videoConstraints:l.createVideoConstraints(e);if(!s)return c.cancel(),void A("videoConstraints should be defined");var g={};a&&!o.aspectRatio||(g.aspectRatio=o.aspectRatio);var I={onRenderSurfaceReady:function(e,t){l.setupUi(e,t,o),l.isScanning=!0,l.foreverScan(o,n,r)}};wX.failIfNotSupported().then((function(e){e.create(s).then((function(e){return e.render(i.element,g,I).then((function(e){l.renderedCamera=e,c.execute(),t(null)})).catch((function(e){c.cancel(),A(e)}))})).catch((function(e){c.cancel(),A(_E.errorGettingUserMedia(e))}))})).catch((function(e){c.cancel(),A(_E.cameraStreamingNotSupported())}))}))},e.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(AX.PAUSED),this.showPausedState(),(PE(e)||!0!==e)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(AX.SCANNING),e.hidePausedState()};this.renderedCamera.isPaused()?this.renderedCamera.resume((function(){t()})):t()},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(AX.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=this;return this.renderedCamera.close().then((function(){return n.renderedCamera=null,n.element&&(n.element.removeChild(n.canvasElement),n.canvasElement=null),function(){if(e.element){var t=document.getElementById(FX.SHADED_REGION_ELEMENT_ID);t&&e.element.removeChild(t)}}(),n.qrRegion&&(n.qrRegion=null),n.context&&(n.context=null),t.execute(),n.hidePausedState(),n.isScanning=!1,Promise.resolve()}))},e.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then((function(e){return e.decodedText}))},e.prototype.scanFileV2=function(e,t){var n=this;if(!(e&&e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(PE(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise((function(A,r){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(e);var i=new Image;i.onload=function(){var e=i.width,o=i.height,s=document.getElementById(n.elementId),a=s.clientWidth?s.clientWidth:FX.DEFAULT_WIDTH,g=Math.max(s.clientHeight?s.clientHeight:o,FX.FILE_SCAN_MIN_HEIGHT),l=n.computeCanvasDrawConfig(e,o,a,g);if(t){var c=n.createCanvasElement(a,g,"qr-canvas-visible");c.style.display="inline-block",s.appendChild(c);var I=c.getContext("2d");if(!I)throw"Unable to get 2d context from canvas";I.canvas.width=a,I.canvas.height=g,I.drawImage(i,0,0,e,o,l.x,l.y,l.width,l.height)}var C=FX.FILE_SCAN_HIDDEN_CANVAS_PADDING,u=Math.max(i.width,l.width),d=Math.max(i.height,l.height),h=u+2*C,m=d+2*C,p=n.createCanvasElement(h,m);s.appendChild(p);var f=p.getContext("2d");if(!f)throw"Unable to get 2d context from canvas";f.canvas.width=h,f.canvas.height=m,f.drawImage(i,0,0,e,o,C,C,u,d);try{n.qrcode.decodeRobustlyAsync(p).then((function(e){A(DE.createFromQrcodeResult(e))})).catch(r)}catch(b){r("QR code parse error, error = ".concat(b))}},i.onerror=r,i.onabort=r,i.onstalled=r,i.onsuspend=r,i.src=URL.createObjectURL(e)}))},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return vX.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(e){if(!e)throw"videoConstaints is required argument.";if(!$E.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},e.prototype.getRenderedCameraOrFail=function(){if(null==this.renderedCamera)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(e){var t=[EE.QR_CODE,EE.AZTEC,EE.CODABAR,EE.CODE_39,EE.CODE_93,EE.CODE_128,EE.DATA_MATRIX,EE.MAXICODE,EE.ITF,EE.EAN_13,EE.EAN_8,EE.PDF_417,EE.RSS_14,EE.RSS_EXPANDED,EE.UPC_A,EE.UPC_E,EE.UPC_EAN_EXTENSION];if(!e||"boolean"==typeof e)return t;if(!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(0===e.formatsToSupport.length)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],A=0,r=e.formatsToSupport;A<r.length;A++){var i=r[A];LE(i)?n.push(i):this.logger.warn("Invalid format: ".concat(i," passed in config, ignoring."))}if(0===n.length)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(e){if(PE(e))return!0;if(!PE(e.useBarCodeDetectorIfSupported))return!1!==e.useBarCodeDetectorIfSupported;if(PE(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return!!PE(t.useBarCodeDetectorIfSupported)||!1!==t.useBarCodeDetectorIfSupported},e.prototype.validateQrboxSize=function(e,t,n){var A=this,r=n.qrbox;this.validateQrboxConfig(r);var i,o=this.toQrdimensions(e,t,r),s=function(e){if(e<FX.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(FX.MIN_QR_BOX_SIZE,"px.")};s(o.width),s(o.height),o.width=((i=o.width)>e&&(A.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),i=e),i)},e.prototype.validateQrboxConfig=function(e){if("number"!=typeof e&&"function"!=typeof e&&(void 0===e.width||void 0===e.height))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(e,t,n){if("number"==typeof n)return{width:n,height:n};if("function"==typeof n)try{return n(e,t)}catch(PWe){throw new Error("qrbox config was passed as a function but it failed with unknown error"+PWe)}return n},e.prototype.setupUi=function(e,t,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,n);var A=PE(n.qrbox)?{width:e,height:t}:n.qrbox;this.validateQrboxConfig(A);var r=this.toQrdimensions(e,t,A);r.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var i=n.isShadedBoxEnabled()&&r.height<=t,o={x:0,y:0,width:e,height:t},s=i?this.getShadedRegionBounds(e,t,r):o,a=this.createCanvasElement(s.width,s.height),g=a.getContext("2d",{willReadFrequently:!0});g.canvas.width=s.width,g.canvas.height=s.height,this.element.append(a),i&&this.possiblyInsertShadingElement(this.element,e,t,r),this.createScannerPausedUiElement(this.element),this.qrRegion=s,this.context=g,this.canvasElement=a},e.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=_E.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(e,t){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then((function(t){return e(t.text,DE.createFromQrcodeResult(t)),n.possiblyUpdateShaders(!0),!0})).catch((function(e){n.possiblyUpdateShaders(!1);var A=_E.codeParseError(e);return t(A,zE.createFrom(A)),!1}))},e.prototype.foreverScan=function(e,t,n){var A=this;if(this.shouldScan&&this.renderedCamera){var r=this.renderedCamera.getSurface(),i=r.videoWidth/r.clientWidth,o=r.videoHeight/r.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var s=this.qrRegion.width*i,a=this.qrRegion.height*o,g=this.qrRegion.x*i,l=this.qrRegion.y*o;this.context.drawImage(r,g,l,s,a,0,0,this.qrRegion.width,this.qrRegion.height);var c=function(){A.foreverScanTimeout=setTimeout((function(){A.foreverScan(e,t,n)}),A.getTimeoutFps(e.fps))};this.scanContext(t,n).then((function(r){r||!0===e.disableFlip?c():(A.context.translate(A.context.canvas.width,0),A.context.scale(-1,1),A.scanContext(t,n).finally((function(){c()})))})).catch((function(e){A.logger.logError("Error happend while scanning context",e),c()}))}},e.prototype.createVideoConstraints=function(e){if("string"==typeof e)return{deviceId:{exact:e}};if("object"==typeof e){var t="facingMode",n="deviceId",A={user:!0,environment:!0},r="exact",i=function(e){if(e in A)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(e,"'")},o=Object.keys(e);if(1!==o.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(o.length," keys");var s=Object.keys(e)[0];if(s!==t&&s!==n)throw"Only '".concat(t,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(s!==t){var a=e.deviceId;if("string"==typeof a)return{deviceId:a};if("object"==typeof a){if(r in a)return{deviceId:{exact:a["".concat(r)]}};throw"'deviceId' should be string or object with"+" ".concat(r," as key.")}throw"Invalid type of 'deviceId' = ".concat(typeof a)}var g=e.facingMode;if("string"==typeof g){if(i(g))return{facingMode:g}}else{if("object"!=typeof g)throw"Invalid type of 'facingMode' = ".concat(typeof g);if(!(r in g))throw"'facingMode' should be string or object with"+" ".concat(r," as key.");if(i(g["".concat(r)]))return{facingMode:{exact:g["".concat(r)]}}}}throw"Invalid type of 'cameraIdOrConfig' = ".concat(typeof e)},e.prototype.computeCanvasDrawConfig=function(e,t,n,A){if(e<=n&&t<=A)return{x:(n-e)/2,y:(A-t)/2,width:e,height:t};var r=e,i=t;return e>n&&(t*=n/e,e=n),t>A&&(e*=A/t,t=A),this.logger.log("Image downsampled from "+"".concat(r,"X").concat(i)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,n,A)},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},e.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach((function(t){t.style.backgroundColor=e?FX.BORDER_SHADER_MATCH_COLOR:FX.BORDER_SHADER_DEFAULT_COLOR})),this.qrMatch=e)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(e,t,n){var A=e,r=t,i=document.createElement("canvas");return i.style.width="".concat(A,"px"),i.style.height="".concat(r,"px"),i.style.display="none",i.id=PE(n)?"qr-canvas":n,i},e.prototype.getShadedRegionBounds=function(e,t,n){if(n.width>e||n.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-n.width)/2,y:(t-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(e,t,n,A){if(!(t-A.width<1||n-A.height<1)){var r=document.createElement("div");r.style.position="absolute";var i=(t-A.width)/2,o=(n-A.height)/2;if(r.style.borderLeft="".concat(i,"px solid rgba(0, 0, 0, 0.48)"),r.style.borderRight="".concat(i,"px solid rgba(0, 0, 0, 0.48)"),r.style.borderTop="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),r.style.borderBottom="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),r.style.boxSizing="border-box",r.style.top="0px",r.style.bottom="0px",r.style.left="0px",r.style.right="0px",r.id="".concat(FX.SHADED_REGION_ELEMENT_ID),t-A.width<11||n-A.height<11)this.hasBorderShaders=!1;else{var s=40;this.insertShaderBorders(r,s,5,-5,null,0,!0),this.insertShaderBorders(r,s,5,-5,null,0,!1),this.insertShaderBorders(r,s,5,null,-5,0,!0),this.insertShaderBorders(r,s,5,null,-5,0,!1),this.insertShaderBorders(r,5,45,-5,null,-5,!0),this.insertShaderBorders(r,5,45,null,-5,-5,!0),this.insertShaderBorders(r,5,45,-5,null,-5,!1),this.insertShaderBorders(r,5,45,null,-5,-5,!1),this.hasBorderShaders=!0}e.append(r)}},e.prototype.insertShaderBorders=function(e,t,n,A,r,i,o){var s=document.createElement("div");s.style.position="absolute",s.style.backgroundColor=FX.BORDER_SHADER_DEFAULT_COLOR,s.style.width="".concat(t,"px"),s.style.height="".concat(n,"px"),null!==A&&(s.style.top="".concat(A,"px")),null!==r&&(s.style.bottom="".concat(r,"px")),o?s.style.left="".concat(i,"px"):s.style.right="".concat(i,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(s),e.appendChild(s)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(e){return 1e3/e},e}(),HX="data:image/svg+xml;base64,",xX=HX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",JX=HX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",YX=HX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",UX=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),LX=function(){function e(){this.data=UX.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(e){this.data.hasPermission=e,this.flush()},e.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=UX.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),TX=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(e){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=qE.poweredBy();var t=document.createElement("a");t.innerText="ScanApp",t.href="https://scanapp.org",t.target="new",t.style.color="white",this.infoDiv.appendChild(t);var n=document.createElement("br"),A=document.createElement("br");this.infoDiv.appendChild(n),this.infoDiv.appendChild(A);var r=document.createElement("a");r.innerText=qE.reportIssues(),r.href="https://github.com/mebjas/html5-qrcode/issues",r.target="new",r.style.color="white",this.infoDiv.appendChild(r),e.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),KX=function(){function e(e,t){this.isShowingInfoIcon=!0,this.onTapIn=e,this.onTapOut=t,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(e){var t=this;this.infoIcon.alt="Info icon",this.infoIcon.src=YX,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(e){return t.onHoverIn()},this.infoIcon.onmouseout=function(e){return t.onHoverOut()},this.infoIcon.onclick=function(e){return t.onClick()},e.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=YX,this.infoIcon.style.opacity="0.6")},e}(),MX=function(){function e(){var e=this;this.infoDiv=new TX,this.infoIcon=new KX((function(){e.infoDiv.show()}),(function(){e.infoDiv.hide()}))}return e.prototype.renderInto=function(e){this.infoDiv.renderInto(e),this.infoIcon.renderInto(e)},e}(),QX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},DX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},zX=function(){function e(){}return e.hasPermissions=function(){return QX(this,void 0,void 0,(function(){var e,t,n,A;return DX(this,(function(r){switch(r.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(e=r.sent(),t=0,n=e;t<n.length;t++)if("videoinput"===(A=n[t]).kind&&A.label)return[2,!0];return[2,!1]}}))}))},e}(),OX=function(){function e(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,n=this.supportedScanTypes;t<n.length;t++){var A=n[t];if(e.isCameraScanType(A))return!0}return!1},e.isCameraScanType=function(e){return e===JE.SCAN_TYPE_CAMERA},e.isFileScanType=function(e){return e===JE.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(e){if(!e||0===e.length)return ME.DEFAULT_SUPPORTED_SCAN_TYPE;var t=ME.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>t)throw"Max ".concat(t," values expected for ")+"supportedScanTypes";for(var n=0,A=e;n<A.length;n++){var r=A[n];if(!ME.DEFAULT_SUPPORTED_SCAN_TYPE.includes(r))throw"Unsupported scan type ".concat(r)}return e},e}(),PX=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),_X=function(){function e(){}return e.createElement=function(e,t){var n=document.createElement(e);return n.id=t,n.classList.add(PX.ALL_ELEMENT_CLASS),"button"===e&&n.setAttribute("type","button"),n},e}(),jX=function(e,t,n,A){return new(n||(n=Promise))((function(r,i){function o(e){try{a(A.next(e))}catch(Zf){i(Zf)}}function s(e){try{a(A.throw(e))}catch(Zf){i(Zf)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}a((A=A.apply(e,t||[])).next())}))},qX=function(e,t){var n,A,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(o=0)),o;)try{if(n=1,A&&(r=2&s[0]?A.return:s[0]?A.throw||((r=A.return)&&r.call(A),0):A.next)&&!(r=r.call(A,s[1])).done)return r;switch(A=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,A=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(Zf){s=[6,Zf],A=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},$X=function(){function e(e,t,n){this.isTorchOn=!1,this.torchCapability=e,this.buttonController=t,this.onTorchActionFailureCallback=n}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return jX(this,void 0,void 0,(function(){var e,t;return qX(this,(function(n){switch(n.label){case 0:this.buttonController.disable(),e=!this.isTorchOn,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.torchCapability.apply(e)];case 2:return n.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e),[3,4];case 3:return t=n.sent(),this.propagateFailure(e,t),this.buttonController.enable(),[3,4];case 4:return[2]}}))}))},e.prototype.updateUiBasedOnLatestSettings=function(e,t){e===t?(this.buttonController.setText(t?jE.torchOffButton():jE.torchOnButton()),this.isTorchOn=t):this.propagateFailure(t),this.buttonController.enable()},e.prototype.propagateFailure=function(e,t){var n=e?jE.torchOnFailedMessage():jE.torchOffFailedMessage();t&&(n+="; Error = "+t),this.onTorchActionFailureCallback(n)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),eH=function(){function e(e,t){this.onTorchActionFailureCallback=t,this.torchButton=_X.createElement("button",PX.TORCH_BUTTON_ID),this.torchController=new $X(e,this,t)}return e.prototype.render=function(e,t){var n=this;this.torchButton.innerText=jE.torchOnButton(),this.torchButton.style.display=t.display,this.torchButton.style.marginLeft=t.marginLeft;var A=this;this.torchButton.addEventListener("click",(function(e){return jX(n,void 0,void 0,(function(){return qX(this,(function(e){switch(e.label){case 0:return[4,A.torchController.flipState()];case 1:return e.sent(),A.torchController.isTorchEnabled()?(A.torchButton.classList.remove(PX.TORCH_BUTTON_CLASS_TORCH_OFF),A.torchButton.classList.add(PX.TORCH_BUTTON_CLASS_TORCH_ON)):(A.torchButton.classList.remove(PX.TORCH_BUTTON_CLASS_TORCH_ON),A.torchButton.classList.add(PX.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}}))}))})),e.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(e){this.torchController=new $X(e,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(e){this.torchButton.innerText=e},e.prototype.reset=function(){this.torchButton.innerText=jE.torchOnButton(),this.torchController.reset()},e.create=function(t,n,A,r){var i=new e(n,r);return i.render(t,A),i},e}(),tH=function(){function e(e,t,n){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=t?"block":"none",e.appendChild(this.fileBasedScanRegion);var A=document.createElement("label");A.setAttribute("for",this.getFileScanInputId()),A.style.display="inline-block",this.fileBasedScanRegion.appendChild(A),this.fileSelectionButton=_X.createElement("button",PX.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",(function(e){A.click()})),A.append(this.fileSelectionButton),this.fileScanInput=_X.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",A.appendChild(this.fileScanInput);var r=this;this.fileScanInput.addEventListener("change",(function(e){if(null!=e&&null!=e.target){var t=e.target;if(!t.files||0!==t.files.length){var A=t.files[0],i=A.name;r.setImageNameToButton(i),n(A)}}}));var i=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(i),this.fileBasedScanRegion.addEventListener("dragenter",(function(e){r.fileBasedScanRegion.style.border=r.fileBasedScanRegionActiveBorder(),e.stopPropagation(),e.preventDefault()})),this.fileBasedScanRegion.addEventListener("dragleave",(function(e){r.fileBasedScanRegion.style.border=r.fileBasedScanRegionDefaultBorder(),e.stopPropagation(),e.preventDefault()})),this.fileBasedScanRegion.addEventListener("dragover",(function(e){r.fileBasedScanRegion.style.border=r.fileBasedScanRegionActiveBorder(),e.stopPropagation(),e.preventDefault()})),this.fileBasedScanRegion.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault(),r.fileBasedScanRegion.style.border=r.fileBasedScanRegionDefaultBorder();var t=e.dataTransfer;if(t){var A=t.files;if(!A||0===A.length)return;for(var o=!1,s=0;s<A.length;++s){var a=A.item(s);if(a){if(a.type.match(/image.*/)){o=!0;var g=a.name;r.setImageNameToButton(g),n(a),i.innerText=jE.dragAndDropMessage();break}}}o||(i.innerText=jE.dragAndDropMessageOnlyImages())}}))}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return"block"===this.fileBasedScanRegion.style.display},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");return e.style.textAlign="center",e.style.margin="auto",e.style.width="80%",e.style.maxWidth="600px",e.style.border=this.fileBasedScanRegionDefaultBorder(),e.style.padding="10px",e.style.marginBottom="10px",e},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");return e.innerText=jE.dragAndDropMessage(),e.style.fontWeight="400",e},e.prototype.setImageNameToButton=function(e){if(e.length>20){var t=e.substring(0,8),n=e.length,A=e.substring(n-8,n);e="".concat(t,"....").concat(A)}var r=jE.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=r},e.prototype.setInitialValueToButton=function(){var e=jE.fileSelectionChooseImage()+" - "+jE.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,n,A){return new e(t,n,A)},e}(),nH=function(){function e(e){this.selectElement=_X.createElement("select",PX.CAMERA_SELECTION_SELECT_ID),this.cameras=e,this.options=[]}return e.prototype.render=function(e){var t=document.createElement("span");t.style.marginRight="10px";var n=this.cameras.length;if(0===n)throw new Error("No cameras found");if(1===n)t.style.display="none";else{var A=jE.selectCamera();t.innerText="".concat(A," (").concat(this.cameras.length,")  ")}for(var r=1,i=0,o=this.cameras;i<o.length;i++){var s=o[i],a=s.id,g=null==s.label?a:s.label;g&&""!==g||(g=[jE.anonymousCameraPrefix(),r++].join(" "));var l=document.createElement("option");l.value=a,l.innerText=g,this.options.push(l),this.selectElement.appendChild(l)}t.appendChild(this.selectElement),e.appendChild(t)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return!0===this.selectElement.disabled},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(e){for(var t=0,n=this.options;t<n.length;t++){if(n[t].value===e)return!0}return!1},e.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e},e.prototype.hasSingleItem=function(){return 1===this.cameras.length},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,n){var A=new e(n);return A.render(t),A},e}(),AH=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=_X.createElement("input",PX.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(e,t){this.zoomElementContainer.style.display=t?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",e.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var n=jE.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.rangeText.style.marginRight="10px";var A=this;this.rangeInput.addEventListener("input",(function(){return A.onValueChange()})),this.rangeInput.addEventListener("change",(function(){return A.onValueChange()})),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var e=jE.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(e,t,n,A){this.rangeInput.min=e.toString(),this.rangeInput.max=t.toString(),this.rangeInput.step=A.toString(),this.rangeInput.value=n.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,n){var A=new e;return A.render(t,n),A},e}();(RX=GX||(GX={}))[RX.STATUS_DEFAULT=0]="STATUS_DEFAULT",RX[RX.STATUS_SUCCESS=1]="STATUS_SUCCESS",RX[RX.STATUS_WARNING=2]="STATUS_WARNING",RX[RX.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION";var rH=function(){function e(e,t,n){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=e,this.config=this.createConfig(t),this.verbose=!0===n,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new OX(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new OE(this.verbose),this.persistedDataManager=new LX,!0!==t.rememberLastUsedCamera&&this.persistedDataManager.reset()}return e.prototype.render=function(e,t){var n=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(t,A){if(e)e(t,A);else{if(n.lastMatchFound===t)return;n.lastMatchFound=t,n.setHeaderMessage(jE.lastMatch(t),GX.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(e,n){t&&t(e,n)};var A,r,i=document.getElementById(this.elementId);if(!i)throw"HTML Element with id=".concat(this.elementId," not found");i.innerHTML="",this.createBasicLayout(i),this.html5Qrcode=new XX(this.getScanRegionId(),(A=this.config,r=this.verbose,{formatsToSupport:A.formatsToSupport,useBarCodeDetectorIfSupported:A.useBarCodeDetectorIfSupported,experimentalFeatures:A.experimentalFeatures,verbose:r}))},e.prototype.pause=function(e){(PE(e)||!0!==e)&&(e=!1),this.getHtml5QrcodeOrFail().pause(e)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var e=this,t=function(){var t=document.getElementById(e.elementId);t&&(t.innerHTML="",e.resetBasicLayout(t))};return this.html5Qrcode?new Promise((function(n,A){e.html5Qrcode?e.html5Qrcode.isScanning?e.html5Qrcode.stop().then((function(A){e.html5Qrcode?(e.html5Qrcode.clear(),t(),n()):n()})).catch((function(t){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",t),A(t)})):(e.html5Qrcode.clear(),t(),n()):n()})):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(e){return e?(e.fps||(e.fps=ME.SCAN_DEFAULT_FPS),e.rememberLastUsedCamera!==!ME.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=ME.DEFAULT_REMEMBER_LAST_CAMERA_USED),e.supportedScanTypes||(e.supportedScanTypes=ME.DEFAULT_SUPPORTED_SCAN_TYPE),e):{fps:ME.SCAN_DEFAULT_FPS,rememberLastUsedCamera:ME.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:ME.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(e){e.style.position="relative",e.style.padding="0px",e.style.border="1px solid silver",this.createHeader(e);var t=document.createElement("div"),n=this.getScanRegionId();t.id=n,t.style.width="100%",t.style.minHeight="100px",t.style.textAlign="center",e.appendChild(t),OX.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var A=document.createElement("div"),r=this.getDashboardId();A.id=r,A.style.width="100%",e.appendChild(A),this.setupInitialDashboard(A)},e.prototype.resetBasicLayout=function(e){e.style.border="none"},e.prototype.setupInitialDashboard=function(e){this.createSection(e),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(e){var t=document.createElement("div");t.style.textAlign="left",t.style.margin="0px",e.appendChild(t),(new MX).renderInto(t);var n=document.createElement("div");n.id=this.getHeaderMessageContainerId(),n.style.display="none",n.style.textAlign="center",n.style.fontSize="14px",n.style.padding="2px 10px",n.style.margin="4px",n.style.borderTop="1px solid #f6f6f6",t.appendChild(n)},e.prototype.createSection=function(e){var t=document.createElement("div");t.id=this.getDashboardSectionId(),t.style.width="100%",t.style.padding="10px 0px 10px 0px",t.style.textAlign="left",e.appendChild(t)},e.prototype.createCameraListUi=function(e,t,n){var A=this;A.showHideScanTypeSwapLink(!1),A.setHeaderMessage(jE.cameraPermissionRequesting());var r=function(){n||A.createPermissionButton(e,t)};XX.getCameras().then((function(n){A.persistedDataManager.setHasPermission(!0),A.showHideScanTypeSwapLink(!0),A.resetHeaderMessage(),n&&n.length>0?(e.removeChild(t),A.renderCameraSelection(n)):(A.setHeaderMessage(jE.noCameraFound(),GX.STATUS_WARNING),r())})).catch((function(e){A.persistedDataManager.setHasPermission(!1),n?n.disabled=!1:r(),A.setHeaderMessage(e,GX.STATUS_WARNING),A.showHideScanTypeSwapLink(!0)}))},e.prototype.createPermissionButton=function(e,t){var n=this,A=_X.createElement("button",this.getCameraPermissionButtonId());A.innerText=jE.cameraPermissionTitle(),A.addEventListener("click",(function(){A.disabled=!0,n.createCameraListUi(e,t,A)})),t.appendChild(A)},e.prototype.createPermissionsUi=function(e,t){var n=this;OX.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()?zX.hasPermissions().then((function(A){A?n.createCameraListUi(e,t):(n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(e,t))})).catch((function(A){n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(e,t)})):this.createPermissionButton(e,t)},e.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId()),t=document.createElement("div");e.appendChild(t);var n=document.createElement("div");n.id=this.getDashboardSectionCameraScanRegionId(),n.style.display=OX.isCameraScanType(this.currentScanType)?"block":"none",t.appendChild(n);var A=document.createElement("div");A.style.textAlign="center",n.appendChild(A),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(n,A),this.renderFileScanUi(t)},e.prototype.renderFileScanUi=function(e){var t=OX.isFileScanType(this.currentScanType),n=this;this.fileSelectionUi=tH.create(e,t,(function(e){if(!n.html5Qrcode)throw"html5Qrcode not defined";OX.isFileScanType(n.currentScanType)&&(n.setHeaderMessage(jE.loadingImage()),n.html5Qrcode.scanFileV2(e,!0).then((function(e){n.resetHeaderMessage(),n.qrCodeSuccessCallback(e.decodedText,e)})).catch((function(e){n.setHeaderMessage(e,GX.STATUS_WARNING),n.qrCodeErrorCallback(e,zE.createFrom(e))})))}))},e.prototype.renderCameraSelection=function(e){var t=this,n=this,A=document.getElementById(this.getDashboardSectionCameraScanRegionId());A.style.textAlign="center";var r=AH.create(A,!1),i=nH.create(A,e),o=document.createElement("span"),s=_X.createElement("button",PX.CAMERA_START_BUTTON_ID);s.innerText=jE.scanButtonStartScanningText(),o.appendChild(s);var a,g=_X.createElement("button",PX.CAMERA_STOP_BUTTON_ID);g.innerText=jE.scanButtonStopScanningText(),g.style.display="none",g.disabled=!0,o.appendChild(g);A.appendChild(o);var l=function(e){e||(s.style.display="none"),s.innerText=jE.scanButtonStartScanningText(),s.style.opacity="1",s.disabled=!1,e&&(s.style.display="inline-block")};if(s.addEventListener("click",(function(e){s.innerText=jE.scanButtonScanningStarting(),i.disable(),s.disabled=!0,s.style.opacity="0.5",t.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!1),n.resetHeaderMessage();var A,c=i.getValue();n.persistedDataManager.setLastUsedCameraId(c),n.html5Qrcode.start(c,(A=n.config,{fps:A.fps,qrbox:A.qrbox,aspectRatio:A.aspectRatio,disableFlip:A.disableFlip,videoConstraints:A.videoConstraints}),n.qrCodeSuccessCallback,n.qrCodeErrorCallback).then((function(e){g.disabled=!1,g.style.display="inline-block",l(!1);var A=n.html5Qrcode.getRunningTrackCameraCapabilities();!0===t.config.showTorchButtonIfSupported&&function(e){e.torchFeature().isSupported()?(a?a.updateTorchCapability(e.torchFeature()):a=eH.create(o,e.torchFeature(),{display:"none",marginLeft:"5px"},(function(e){n.setHeaderMessage(e,GX.STATUS_WARNING)})),a.show()):a&&a.hide()}(A),!0===t.config.showZoomSliderIfSupported&&function(e){var n=e.zoomFeature();if(n.isSupported()){r.setOnCameraZoomValueChangeCallback((function(e){n.apply(e)}));var A,i,o,s=1;t.config.defaultZoomValueIfSupported&&(s=t.config.defaultZoomValueIfSupported),A=s,i=n.min(),s=A>(o=n.max())?o:A<i?i:A,r.setValues(n.min(),n.max(),s,n.step()),r.show()}}(A)})).catch((function(e){n.showHideScanTypeSwapLink(!0),i.enable(),l(!0),n.setHeaderMessage(e,GX.STATUS_WARNING)}))})),i.hasSingleItem()&&s.click(),g.addEventListener("click",(function(e){if(!n.html5Qrcode)throw"html5Qrcode not defined";g.disabled=!0,n.html5Qrcode.stop().then((function(e){t.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!0),i.enable(),s.disabled=!1,g.style.display="none",s.style.display="inline-block",a&&(a.reset(),a.hide()),r.removeOnCameraZoomValueChangeCallback(),r.hide(),n.insertCameraScanImageToScanRegion()})).catch((function(e){g.disabled=!1,n.setHeaderMessage(e,GX.STATUS_WARNING)}))})),n.persistedDataManager.getLastUsedCameraId()){var c=n.persistedDataManager.getLastUsedCameraId();i.hasValue(c)?(i.setValue(c),s.click()):n.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var e=this,t=jE.textIfCameraScanSelected(),n=jE.textIfFileScanSelected(),A=document.getElementById(this.getDashboardSectionId()),r=document.createElement("div");r.style.textAlign="center";var i=_X.createElement("span",this.getDashboardSectionSwapLinkId());i.style.textDecoration="underline",i.style.cursor="pointer",i.innerText=OX.isCameraScanType(this.currentScanType)?t:n,i.addEventListener("click",(function(){e.sectionSwapAllowed?(e.resetHeaderMessage(),e.fileSelectionUi.resetValue(),e.sectionSwapAllowed=!1,OX.isCameraScanType(e.currentScanType)?(e.clearScanRegion(),e.getCameraScanRegion().style.display="none",e.fileSelectionUi.show(),i.innerText=n,e.currentScanType=JE.SCAN_TYPE_FILE,e.insertFileScanImageToScanRegion()):(e.clearScanRegion(),e.getCameraScanRegion().style.display="block",e.fileSelectionUi.hide(),i.innerText=t,e.currentScanType=JE.SCAN_TYPE_CAMERA,e.insertCameraScanImageToScanRegion(),e.startCameraScanIfPermissionExistsOnSwap()),e.sectionSwapAllowed=!0):e.verbose&&e.logger.logError("Section swap called when not allowed")})),r.appendChild(i),A.appendChild(r)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this,t=this;this.persistedDataManager.hasCameraPermissions()&&zX.hasPermissions().then((function(n){if(n){var A=document.getElementById(t.getCameraPermissionButtonId());if(!A)throw e.logger.logError("Permission button not found, fail;"),"Permission button not found";A.click()}else t.persistedDataManager.setHasPermission(!1)})).catch((function(e){t.persistedDataManager.setHasPermission(!1)}))},e.prototype.resetHeaderMessage=function(){document.getElementById(this.getHeaderMessageContainerId()).style.display="none"},e.prototype.setHeaderMessage=function(e,t){t||(t=GX.STATUS_DEFAULT);var n=this.getHeaderMessageDiv();switch(n.innerText=e,n.style.display="block",t){case GX.STATUS_SUCCESS:n.style.background="rgba(106, 175, 80, 0.26)",n.style.color="#477735";break;case GX.STATUS_WARNING:n.style.background="rgba(203, 36, 49, 0.14)",n.style.color="#cb2431";break;case GX.STATUS_DEFAULT:default:n.style.background="rgba(0, 0, 0, 0)",n.style.color="rgb(17, 17, 17)"}},e.prototype.showHideScanTypeSwapLink=function(e){this.scanTypeSelector.hasMoreThanOneScanType()&&(!0!==e&&(e=!1),this.sectionSwapAllowed=e,this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.cameraScanImage)return t.innerHTML="<br>",void t.appendChild(this.cameraScanImage);this.cameraScanImage=new Image,this.cameraScanImage.onload=function(n){t.innerHTML="<br>",t.appendChild(e.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=xX,this.cameraScanImage.alt=jE.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.fileScanImage)return t.innerHTML="<br>",void t.appendChild(this.fileScanImage);this.fileScanImage=new Image,this.fileScanImage.onload=function(n){t.innerHTML="<br>",t.appendChild(e.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=JX,this.fileScanImage.alt=jE.fileScanAltText()},e.prototype.clearScanRegion=function(){document.getElementById(this.getScanRegionId()).innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return PX.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return PX.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();const iH=()=>{const[t,n]=e.useState(!0),[A,r]=e.useState(null),[i,o]=e.useState(!1),[s,a]=e.useState(""),[g,l]=e.useState("#4CAF50"),c=e.useCallback((async e=>{try{o(!0),a("");let t=null;if(e.includes("?id=")){t=new URL(e).searchParams.get("id")}else if(e.includes("/invitation/")){const n=e.split("/invitation/");n.length>1&&(t=n[1].split("?")[0])}else t=e;if(!t)throw new Error("Format de QR code invalide. Aucun ID trouvé.");const n=await Gf.recordScan(t,{scannedBy:"admin",deviceInfo:navigator.userAgent}),A=await Gf.getGuestById(t);if(!A)throw new Error("Invité non trouvé avec cet ID: "+t);const i=await Gf.getGuestScans(t);let s=null;const g=t.split("_")[0];s=Te.tables.find((e=>e.name.toLowerCase()===g.toLowerCase())),s&&l(s.color),r({...A,scanHistory:i,lastScanId:n,tableName:s?s.name:"Table inconnue",tableColor:s?s.color:"#4CAF50"})}catch(t){a(t.message||"Erreur lors du traitement du QR code")}finally{o(!1)}}),[]);e.useEffect((()=>{let e=null;if(t){e=new rH("qr-reader",{fps:5,qrbox:{width:250,height:250},rememberLastUsedCamera:!0,aspectRatio:1,disableFlip:!0,formatsToSupport:[0]},!1);const t=async t=>{e&&(e.clear(),e=null),n(!1),await c(t)},A=()=>{};e.render(t,A)}return()=>{e&&(e.clear(),e=null)}}),[t,c]);const I=e.useCallback((()=>{r(null),a(""),n(!0),l("#4CAF50")}),[]);return f.jsxs("div",{className:"bg-secondary min-h-screen pb-10",children:[f.jsx("header",{className:"bg-primary text-white py-6 sm:py-8 px-3 sm:px-4",children:f.jsx("div",{className:"max-w-7xl mx-auto",children:f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"font-elegant text-2xl sm:text-3xl",children:"Scanner d'Invitations"}),f.jsx("p",{className:"text-white/70 mt-1 sm:mt-2 text-sm sm:text-base",children:"Scannez les QR codes des invitations pour enregistrer les arrivées"})]}),f.jsx("div",{className:"w-full sm:w-auto",children:f.jsxs("a",{href:"/guest-management",className:"inline-flex items-center justify-center w-full sm:w-auto px-4 py-2 bg-white text-primary rounded-md shadow hover:bg-primary/10 transition-colors",children:[f.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour à la gestion"]})})]})})}),f.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 -mt-4 sm:-mt-6",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-6",children:[f.jsxs(Nt,{variant:"elegant",className:"p-3 sm:p-6 lg:col-span-2",children:[f.jsxs("div",{className:"text-center mb-3 sm:mb-4",children:[f.jsx("h2",{className:"font-elegant text-xl sm:text-2xl text-primary-dark mb-1 sm:mb-2",children:t?"Scannez un QR code":"Résultat du scan"}),f.jsx("p",{className:"text-muted text-sm",children:t?"Placez le QR code devant la caméra":"Détails de l&apos;invitation scannée"})]}),t?f.jsx("div",{id:"qr-reader",className:"w-full max-w-sm mx-auto h-[280px] sm:h-[320px]"}):f.jsx("div",{className:"text-center",children:i?f.jsxs("div",{className:"py-6 sm:py-8",children:[f.jsx("div",{className:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-primary mx-auto"}),f.jsx("p",{className:"mt-4 text-muted",children:"Traitement du QR code..."})]}):s?f.jsxs("div",{className:"py-6 sm:py-8",children:[f.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded relative",role:"alert",children:[f.jsx("strong",{className:"font-bold",children:"Erreur!"}),f.jsx("span",{className:"block sm:inline sm:ml-2",children:s})]}),f.jsx(je,{variant:"primary",className:"mt-5 sm:mt-6 w-full sm:w-auto",onClick:I,children:"Réessayer"})]}):A?f.jsxs("div",{className:"py-3 sm:py-4",children:[f.jsx("div",{className:"border rounded mb-4 sm:mb-6 shadow-md overflow-hidden",style:{backgroundColor:`${A.tableColor}10`,borderColor:A.tableColor},children:f.jsx("div",{className:"p-3 sm:p-4",children:f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[f.jsxs("div",{className:"text-center sm:text-left",children:[f.jsx("span",{className:"text-lg sm:text-xl font-semibold block mb-1",children:A.name}),f.jsxs("div",{className:"flex flex-col xs:flex-row xs:items-center gap-1 xs:gap-3 justify-center sm:justify-start",children:[f.jsxs("span",{className:"text-sm",children:[f.jsx("span",{className:"font-medium",children:"Table:"})," ",A.tableName]}),f.jsx("span",{className:"hidden xs:inline text-primary/20",children:"•"}),f.jsxs("span",{className:"text-sm",children:[f.jsx("span",{className:"font-medium",children:"Groupe:"})," ",A.group]})]}),f.jsx("span",{className:"block mt-1 text-sm",children:A.count>1?`${A.count} personnes`:"1 personne"})]}),f.jsxs("div",{className:"text-center sm:text-right px-3 sm:px-4 py-2 sm:py-3 rounded-full mx-auto sm:mx-0",style:{backgroundColor:`${A.tableColor}30`},children:[f.jsx("span",{className:"block font-bold text-xl sm:text-2xl",children:A.scanCount||1}),f.jsx("span",{className:"text-xs sm:text-sm",children:A.scanCount>1?"scans":"scan"})]})]})})}),A.scanHistory&&A.scanHistory.length>0&&f.jsxs("div",{className:"mb-4 sm:mb-6",children:[f.jsx("h3",{className:"font-semibold text-base sm:text-lg text-primary-dark mb-2 sm:mb-3",children:"Historique des scans"}),f.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),f.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Heure"}),f.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scanné par"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.scanHistory.map(((e,t)=>{let n=null;e.timestamp&&e.timestamp.toDate&&(n=e.timestamp.toDate());const r=n?new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(n):"N/A",i=n?new Intl.DateTimeFormat("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(n):"N/A";return f.jsxs("tr",{className:e.id===A.lastScanId?"bg-opacity-20":"",style:e.id===A.lastScanId?{backgroundColor:`${A.tableColor}20`}:{},children:[f.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:r}),f.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:i}),f.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:e.scannedBy||"Admin"})]},e.id||t)}))})]})})]}),f.jsxs(je,{variant:"primary",className:"mt-3 sm:mt-4 w-full sm:w-auto",onClick:I,style:{backgroundColor:A.tableColor,borderColor:A.tableColor},children:[f.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Scanner un autre QR code"]})]}):f.jsxs("div",{className:"py-6 sm:py-8",children:[f.jsx("p",{className:"text-muted",children:"Aucun résultat de scan disponible"}),f.jsx(je,{variant:"primary",className:"mt-4 w-full sm:w-auto",onClick:I,children:"Réessayer"})]})})]}),f.jsxs(Nt,{variant:"flat",className:"p-3 sm:p-6",children:[f.jsx("h3",{className:"font-elegant text-lg sm:text-xl text-primary-dark mb-2 sm:mb-3",children:"Comment ça marche?"}),f.jsxs("ul",{className:"list-disc pl-5 sm:pl-6 space-y-2 text-muted text-sm sm:text-base",children:[f.jsx("li",{children:"Autorisez l'accès à la caméra lorsque le navigateur vous le demande"}),f.jsx("li",{children:"Présentez le QR code de l'invitation face à la caméra"}),f.jsx("li",{children:"Le système détectera automatiquement le code et affichera les informations"}),f.jsx("li",{children:"Chaque scan est enregistré dans la base de données avec horodatage"}),f.jsx("li",{children:"Si un invité présente plusieurs fois son QR code, tous les scans seront enregistrés"})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[f.jsx("h4",{className:"font-medium text-primary-dark mb-2",children:"Conseils pour un meilleur scan:"}),f.jsxs("ul",{className:"list-disc pl-5 sm:pl-6 space-y-2 text-muted text-sm",children:[f.jsx("li",{children:"Assurez-vous que l'éclairage est suffisant"}),f.jsx("li",{children:"Tenez le QR code stable et droit"}),f.jsx("li",{children:"Évitez les reflets sur le QR code"}),f.jsx("li",{children:"Placez le QR code à environ 15-20 cm de la caméra"})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[f.jsx("h4",{className:"font-medium text-primary-dark mb-2",children:"Tables et couleurs:"}),f.jsx("div",{className:"grid grid-cols-2 xs:grid-cols-3 gap-2",children:Te.tables.slice(0,9).map((e=>f.jsx("div",{className:"p-2 rounded text-center text-white text-xs",style:{backgroundColor:e.color},children:e.name},e.name)))})]})]})]})})]})},oH=()=>{const{tableName:t}=ue(),[n,A]=e.useState(null),[r,i]=e.useState(!0),[o,s]=e.useState(null);return e.useEffect((()=>{i(!0);try{const e=Te.tables.find((e=>e.name.toLowerCase().replace(/\s+/g,"-")===t));e?A(e):s("Table non trouvée")}catch(e){s("Erreur lors du chargement des données de la table")}finally{i(!1)}}),[t]),r?f.jsx("div",{className:"min-h-screen bg-secondary flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),f.jsx("p",{className:"mt-4 text-primary-dark",children:"Chargement des informations..."})]})}):o||!n?f.jsx("div",{className:"min-h-screen bg-secondary flex items-center justify-center p-4",children:f.jsx(Nt,{variant:"flat",className:"max-w-md w-full p-6",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"bg-danger/10 p-3 rounded-full inline-block mb-4",children:f.jsx("svg",{className:"w-8 h-8 text-danger",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),f.jsx("h1",{className:"text-xl font-semibold text-primary-dark mb-2",children:o||"Table non trouvée"}),f.jsx("p",{className:"text-muted mb-4",children:"La table que vous recherchez n'existe pas ou n'est plus disponible."}),f.jsx(He,{to:"/",children:f.jsx(je,{variant:"primary",className:"w-full",children:"Retourner à l'accueil"})})]})})}):f.jsxs("div",{className:"min-h-screen bg-secondary pb-16",children:[f.jsx("header",{className:"bg-primary text-white py-8 px-4",children:f.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[f.jsxs("h1",{className:"font-elegant text-3xl sm:text-4xl md:text-5xl",style:{color:n.color},children:["Table ",n.name]}),f.jsxs("p",{className:"mt-2 text-white/90",children:[Te.couple.groom," & ",Te.couple.bride]})]})}),f.jsx("div",{className:"max-w-4xl mx-auto px-4 mt-8",children:f.jsxs(Nt,{variant:"elegant",className:"p-6 sm:p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h2",{className:"font-elegant text-2xl sm:text-3xl text-primary-dark mb-3",children:"Bienvenue à votre table"}),f.jsx("p",{className:"text-muted",children:"Nous sommes ravis de vous accueillir à notre célébration. Voici les personnes qui partageront cette table avec vous."})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-soft",children:[f.jsxs("h3",{className:"font-elegant text-xl text-primary-dark mb-4 flex items-center",children:[f.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Invités à cette table (",n.count," personnes)"]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:n.invites.map(((e,t)=>f.jsxs("div",{className:"border border-gray-100 rounded-lg p-4 hover:shadow-soft transition-shadow",style:{borderLeft:`4px solid ${n.color}`},children:[f.jsx("div",{className:"font-medium text-primary-dark",children:e.name}),f.jsx("div",{className:"text-sm text-muted mt-1",children:e.count>1?`${e.count} personnes`:"1 personne"})]},t)))})]}),f.jsxs("div",{className:"mt-8 p-6 border-t border-gray-100",children:[f.jsx("h3",{className:"font-elegant text-xl text-primary-dark mb-4",children:"Détails de l'événement"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-start mb-4",children:[f.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:f.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-primary-dark",children:"Date"}),f.jsx("p",{className:"text-muted",children:Te.event.date})]})]}),f.jsxs("div",{className:"flex items-start mb-4",children:[f.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:f.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-primary-dark",children:"Heure"}),f.jsx("p",{className:"text-muted",children:Te.event.time})]})]})]}),f.jsx("div",{children:f.jsxs("div",{className:"flex items-start mb-4",children:[f.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:f.jsxs("svg",{className:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-primary-dark",children:"Lieu"}),f.jsx("p",{className:"text-muted",children:Te.event.venue}),f.jsx("p",{className:"text-muted",children:Te.event.address}),f.jsx("p",{className:"text-muted",children:Te.event.location})]})]})})]})]}),f.jsx("div",{className:"mt-8 text-center",children:f.jsx(He,{to:"/",children:f.jsx(je,{variant:"primary",className:"px-6",style:{backgroundColor:n.color,borderColor:n.color},children:"Voir l'invitation complète"})})})]})})]})},sH=({children:e})=>{const t=(()=>{const e=localStorage.getItem("authBlocked");if(e){const t=3e5,n=Date.now()-parseInt(e,10);return n<t?Math.ceil((t-n)/6e4):(localStorage.removeItem("authBlocked"),0)}return 0})();return t>0?(localStorage.setItem("authMessage",`Accès temporairement bloqué. Réessayez dans ${t} minute(s).`),f.jsx(Se,{to:"/",replace:!0})):(()=>{const e=localStorage.getItem("adminAuth");if(!e)return!1;try{const t=KF?KF(e):JSON.parse(e);if(!t)return!1;const{isAuthenticated:n,timestamp:A}=t,r=Date.now();return n&&r-A<864e5}catch(PWe){return!1}})()?e:f.jsx(Se,{to:"/admin-login",replace:!0})},aH=()=>(e.useEffect((()=>{["https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap","https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap"].forEach((e=>{const t=document.createElement("link");t.rel="preload",t.as="style",t.href=e,document.head.appendChild(t)}))}),[]),f.jsx(Fe,{children:f.jsxs(Re,{children:[f.jsx(ve,{path:"/",element:f.jsx(_k,{})}),f.jsx(ve,{path:"/admin-login",element:f.jsx(MF,{})}),f.jsx(ve,{path:"/admin",element:f.jsx(sH,{children:f.jsx(Ok,{})})}),f.jsx(ve,{path:"/scanner",element:f.jsx(sH,{children:f.jsx(WE,{})})}),f.jsx(ve,{path:"/qr-scanner",element:f.jsx(sH,{children:f.jsx(iH,{})})}),f.jsx(ve,{path:"/invitation/:guestId",element:f.jsx(it,{})}),f.jsx(ve,{path:"/table/:tableName",element:f.jsx(oH,{})}),f.jsx(ve,{path:"*",element:f.jsx(Se,{to:"/",replace:!0})})]})}));var gH=function(e){return e&&e.Math===Math&&e},lH=gH("object"==typeof globalThis&&globalThis)||gH("object"==typeof window&&window)||gH("object"==typeof self&&self)||gH("object"==typeof o&&o)||gH("object"==typeof o&&o)||function(){return this}()||Function("return this")(),cH={},IH=function(e){try{return!!e()}catch(PWe){return!0}},CH=!IH((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),uH=!IH((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),dH=uH,hH=Function.prototype.call,mH=dH?hH.bind(hH):function(){return hH.apply(hH,arguments)},pH={},fH={}.propertyIsEnumerable,bH=Object.getOwnPropertyDescriptor,BH=bH&&!fH.call({1:2},1);pH.f=BH?function(e){var t=bH(this,e);return!!t&&t.enumerable}:fH;var yH,wH,ZH=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},SH=uH,vH=Function.prototype,GH=vH.call,RH=SH&&vH.bind.bind(GH,GH),VH=SH?RH:function(e){return function(){return GH.apply(e,arguments)}},NH=VH,kH=NH({}.toString),WH=NH("".slice),FH=function(e){return WH(kH(e),8,-1)},EH=IH,XH=FH,HH=Object,xH=VH("".split),JH=EH((function(){return!HH("z").propertyIsEnumerable(0)}))?function(e){return"String"===XH(e)?xH(e,""):HH(e)}:HH,YH=function(e){return null==e},UH=YH,LH=TypeError,TH=function(e){if(UH(e))throw new LH("Can't call method on "+e);return e},KH=JH,MH=TH,QH=function(e){return KH(MH(e))},DH="object"==typeof document&&document.all,zH=void 0===DH&&void 0!==DH?function(e){return"function"==typeof e||e===DH}:function(e){return"function"==typeof e},OH=zH,PH=function(e){return"object"==typeof e?null!==e:OH(e)},_H=lH,jH=zH,qH=function(e,t){return arguments.length<2?(n=_H[e],jH(n)?n:void 0):_H[e]&&_H[e][t];var n},$H=VH({}.isPrototypeOf),ex=lH.navigator,tx=ex&&ex.userAgent,nx=tx?String(tx):"",Ax=lH,rx=nx,ix=Ax.process,ox=Ax.Deno,sx=ix&&ix.versions||ox&&ox.version,ax=sx&&sx.v8;ax&&(wH=(yH=ax.split("."))[0]>0&&yH[0]<4?1:+(yH[0]+yH[1])),!wH&&rx&&(!(yH=rx.match(/Edge\/(\d+)/))||yH[1]>=74)&&(yH=rx.match(/Chrome\/(\d+)/))&&(wH=+yH[1]);var gx=wH,lx=gx,cx=IH,Ix=lH.String,Cx=!!Object.getOwnPropertySymbols&&!cx((function(){var e=Symbol("symbol detection");return!Ix(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&lx&&lx<41})),ux=Cx&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,dx=qH,hx=zH,mx=$H,px=Object,fx=ux?function(e){return"symbol"==typeof e}:function(e){var t=dx("Symbol");return hx(t)&&mx(t.prototype,px(e))},bx=String,Bx=function(e){try{return bx(e)}catch(PWe){return"Object"}},yx=zH,wx=Bx,Zx=TypeError,Sx=function(e){if(yx(e))return e;throw new Zx(wx(e)+" is not a function")},vx=Sx,Gx=YH,Rx=function(e,t){var n=e[t];return Gx(n)?void 0:vx(n)},Vx=mH,Nx=zH,kx=PH,Wx=TypeError,Fx=function(e,t){var n,A;if("string"===t&&Nx(n=e.toString)&&!kx(A=Vx(n,e)))return A;if(Nx(n=e.valueOf)&&!kx(A=Vx(n,e)))return A;if("string"!==t&&Nx(n=e.toString)&&!kx(A=Vx(n,e)))return A;throw new Wx("Can't convert object to primitive value")},Ex={exports:{}},Xx=lH,Hx=Object.defineProperty,xx=function(e,t){try{Hx(Xx,e,{value:t,configurable:!0,writable:!0})}catch(PWe){Xx[e]=t}return t},Jx=lH,Yx=xx,Ux="__core-js_shared__",Lx=Ex.exports=Jx[Ux]||Yx(Ux,{});(Lx.versions||(Lx.versions=[])).push({version:"3.42.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Tx=Ex.exports,Kx=Tx,Mx=function(e,t){return Kx[e]||(Kx[e]=t||{})},Qx=TH,Dx=Object,zx=function(e){return Dx(Qx(e))},Ox=zx,Px=VH({}.hasOwnProperty),_x=Object.hasOwn||function(e,t){return Px(Ox(e),t)},jx=VH,qx=0,$x=Math.random(),eJ=jx(1..toString),tJ=function(e){return"Symbol("+(void 0===e?"":e)+")_"+eJ(++qx+$x,36)},nJ=Mx,AJ=_x,rJ=tJ,iJ=Cx,oJ=ux,sJ=lH.Symbol,aJ=nJ("wks"),gJ=oJ?sJ.for||sJ:sJ&&sJ.withoutSetter||rJ,lJ=function(e){return AJ(aJ,e)||(aJ[e]=iJ&&AJ(sJ,e)?sJ[e]:gJ("Symbol."+e)),aJ[e]},cJ=mH,IJ=PH,CJ=fx,uJ=Rx,dJ=Fx,hJ=TypeError,mJ=lJ("toPrimitive"),pJ=function(e,t){if(!IJ(e)||CJ(e))return e;var n,A=uJ(e,mJ);if(A){if(void 0===t&&(t="default"),n=cJ(A,e,t),!IJ(n)||CJ(n))return n;throw new hJ("Can't convert object to primitive value")}return void 0===t&&(t="number"),dJ(e,t)},fJ=pJ,bJ=fx,BJ=function(e){var t=fJ(e,"string");return bJ(t)?t:t+""},yJ=PH,wJ=lH.document,ZJ=yJ(wJ)&&yJ(wJ.createElement),SJ=function(e){return ZJ?wJ.createElement(e):{}},vJ=SJ,GJ=!CH&&!IH((function(){return 7!==Object.defineProperty(vJ("div"),"a",{get:function(){return 7}}).a})),RJ=CH,VJ=mH,NJ=pH,kJ=ZH,WJ=QH,FJ=BJ,EJ=_x,XJ=GJ,HJ=Object.getOwnPropertyDescriptor;cH.f=RJ?HJ:function(e,t){if(e=WJ(e),t=FJ(t),XJ)try{return HJ(e,t)}catch(PWe){}if(EJ(e,t))return kJ(!VJ(NJ.f,e,t),e[t])};var xJ={},JJ=CH&&IH((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),YJ=PH,UJ=String,LJ=TypeError,TJ=function(e){if(YJ(e))return e;throw new LJ(UJ(e)+" is not an object")},KJ=CH,MJ=GJ,QJ=JJ,DJ=TJ,zJ=BJ,OJ=TypeError,PJ=Object.defineProperty,_J=Object.getOwnPropertyDescriptor,jJ="enumerable",qJ="configurable",$J="writable";xJ.f=KJ?QJ?function(e,t,n){if(DJ(e),t=zJ(t),DJ(n),"function"==typeof e&&"prototype"===t&&"value"in n&&$J in n&&!n[$J]){var A=_J(e,t);A&&A[$J]&&(e[t]=n.value,n={configurable:qJ in n?n[qJ]:A[qJ],enumerable:jJ in n?n[jJ]:A[jJ],writable:!1})}return PJ(e,t,n)}:PJ:function(e,t,n){if(DJ(e),t=zJ(t),DJ(n),MJ)try{return PJ(e,t,n)}catch(PWe){}if("get"in n||"set"in n)throw new OJ("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var eY=xJ,tY=ZH,nY=CH?function(e,t,n){return eY.f(e,t,tY(1,n))}:function(e,t,n){return e[t]=n,e},AY={exports:{}},rY=CH,iY=_x,oY=Function.prototype,sY=rY&&Object.getOwnPropertyDescriptor,aY=iY(oY,"name"),gY={EXISTS:aY,PROPER:aY&&"something"===function(){}.name,CONFIGURABLE:aY&&(!rY||rY&&sY(oY,"name").configurable)},lY=zH,cY=Tx,IY=VH(Function.toString);lY(cY.inspectSource)||(cY.inspectSource=function(e){return IY(e)});var CY,uY,dY,hY=cY.inspectSource,mY=zH,pY=lH.WeakMap,fY=mY(pY)&&/native code/.test(String(pY)),bY=tJ,BY=Mx("keys"),yY=function(e){return BY[e]||(BY[e]=bY(e))},wY={},ZY=fY,SY=lH,vY=PH,GY=nY,RY=_x,VY=Tx,NY=yY,kY=wY,WY="Object already initialized",FY=SY.TypeError,EY=SY.WeakMap;if(ZY||VY.state){var XY=VY.state||(VY.state=new EY);XY.get=XY.get,XY.has=XY.has,XY.set=XY.set,CY=function(e,t){if(XY.has(e))throw new FY(WY);return t.facade=e,XY.set(e,t),t},uY=function(e){return XY.get(e)||{}},dY=function(e){return XY.has(e)}}else{var HY=NY("state");kY[HY]=!0,CY=function(e,t){if(RY(e,HY))throw new FY(WY);return t.facade=e,GY(e,HY,t),t},uY=function(e){return RY(e,HY)?e[HY]:{}},dY=function(e){return RY(e,HY)}}var xY={set:CY,get:uY,has:dY,enforce:function(e){return dY(e)?uY(e):CY(e,{})},getterFor:function(e){return function(t){var n;if(!vY(t)||(n=uY(t)).type!==e)throw new FY("Incompatible receiver, "+e+" required");return n}}},JY=VH,YY=IH,UY=zH,LY=_x,TY=CH,KY=gY.CONFIGURABLE,MY=hY,QY=xY.enforce,DY=xY.get,zY=String,OY=Object.defineProperty,PY=JY("".slice),_Y=JY("".replace),jY=JY([].join),qY=TY&&!YY((function(){return 8!==OY((function(){}),"length",{value:8}).length})),$Y=String(String).split("String"),eU=AY.exports=function(e,t,n){"Symbol("===PY(zY(t),0,7)&&(t="["+_Y(zY(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!LY(e,"name")||KY&&e.name!==t)&&(TY?OY(e,"name",{value:t,configurable:!0}):e.name=t),qY&&n&&LY(n,"arity")&&e.length!==n.arity&&OY(e,"length",{value:n.arity});try{n&&LY(n,"constructor")&&n.constructor?TY&&OY(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(PWe){}var A=QY(e);return LY(A,"source")||(A.source=jY($Y,"string"==typeof t?t:"")),e};Function.prototype.toString=eU((function(){return UY(this)&&DY(this).source||MY(this)}),"toString");var tU=AY.exports,nU=zH,AU=xJ,rU=tU,iU=xx,oU=function(e,t,n,A){A||(A={});var r=A.enumerable,i=void 0!==A.name?A.name:t;if(nU(n)&&rU(n,i,A),A.global)r?e[t]=n:iU(t,n);else{try{A.unsafe?e[t]&&(r=!0):delete e[t]}catch(PWe){}r?e[t]=n:AU.f(e,t,{value:n,enumerable:!1,configurable:!A.nonConfigurable,writable:!A.nonWritable})}return e},sU={},aU=Math.ceil,gU=Math.floor,lU=Math.trunc||function(e){var t=+e;return(t>0?gU:aU)(t)},cU=lU,IU=function(e){var t=+e;return t!=t||0===t?0:cU(t)},CU=IU,uU=Math.max,dU=Math.min,hU=function(e,t){var n=CU(e);return n<0?uU(n+t,0):dU(n,t)},mU=IU,pU=Math.min,fU=function(e){var t=mU(e);return t>0?pU(t,9007199254740991):0},bU=fU,BU=function(e){return bU(e.length)},yU=QH,wU=hU,ZU=BU,SU=function(e){return function(t,n,A){var r=yU(t),i=ZU(r);if(0===i)return!e&&-1;var o,s=wU(A,i);if(e&&n!=n){for(;i>s;)if((o=r[s++])!=o)return!0}else for(;i>s;s++)if((e||s in r)&&r[s]===n)return e||s||0;return!e&&-1}},vU={includes:SU(!0),indexOf:SU(!1)},GU=_x,RU=QH,VU=vU.indexOf,NU=wY,kU=VH([].push),WU=function(e,t){var n,A=RU(e),r=0,i=[];for(n in A)!GU(NU,n)&&GU(A,n)&&kU(i,n);for(;t.length>r;)GU(A,n=t[r++])&&(~VU(i,n)||kU(i,n));return i},FU=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],EU=WU,XU=FU.concat("length","prototype");sU.f=Object.getOwnPropertyNames||function(e){return EU(e,XU)};var HU={};HU.f=Object.getOwnPropertySymbols;var xU=qH,JU=sU,YU=HU,UU=TJ,LU=VH([].concat),TU=xU("Reflect","ownKeys")||function(e){var t=JU.f(UU(e)),n=YU.f;return n?LU(t,n(e)):t},KU=_x,MU=TU,QU=cH,DU=xJ,zU=function(e,t,n){for(var A=MU(t),r=DU.f,i=QU.f,o=0;o<A.length;o++){var s=A[o];KU(e,s)||n&&KU(n,s)||r(e,s,i(t,s))}},OU=IH,PU=zH,_U=/#|\.prototype\./,jU=function(e,t){var n=$U[qU(e)];return n===tL||n!==eL&&(PU(t)?OU(t):!!t)},qU=jU.normalize=function(e){return String(e).replace(_U,".").toLowerCase()},$U=jU.data={},eL=jU.NATIVE="N",tL=jU.POLYFILL="P",nL=jU,AL=lH,rL=cH.f,iL=nY,oL=oU,sL=xx,aL=zU,gL=nL,lL=function(e,t){var n,A,r,i,o,s=e.target,a=e.global,g=e.stat;if(n=a?AL:g?AL[s]||sL(s,{}):AL[s]&&AL[s].prototype)for(A in t){if(i=t[A],r=e.dontCallGetSet?(o=rL(n,A))&&o.value:n[A],!gL(a?A:s+(g?".":"#")+A,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;aL(i,r)}(e.sham||r&&r.sham)&&iL(i,"sham",!0),oL(n,A,i,e)}},cL={};cL[lJ("toStringTag")]="z";var IL="[object z]"===String(cL),CL=IL,uL=zH,dL=FH,hL=lJ("toStringTag"),mL=Object,pL="Arguments"===dL(function(){return arguments}()),fL=CL?dL:function(e){var t,n,A;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(PWe){}}(t=mL(e),hL))?n:pL?dL(t):"Object"===(A=dL(t))&&uL(t.callee)?"Arguments":A},bL=fL,BL=String,yL=function(e){if("Symbol"===bL(e))throw new TypeError("Cannot convert a Symbol value to a string");return BL(e)},wL={},ZL=WU,SL=FU,vL=Object.keys||function(e){return ZL(e,SL)},GL=CH,RL=JJ,VL=xJ,NL=TJ,kL=QH,WL=vL;wL.f=GL&&!RL?Object.defineProperties:function(e,t){NL(e);for(var n,A=kL(t),r=WL(t),i=r.length,o=0;i>o;)VL.f(e,n=r[o++],A[n]);return e};var FL,EL=qH("document","documentElement"),XL=TJ,HL=wL,xL=FU,JL=wY,YL=EL,UL=SJ,LL="prototype",TL="script",KL=yY("IE_PROTO"),ML=function(){},QL=function(e){return"<"+TL+">"+e+"</"+TL+">"},DL=function(e){e.write(QL("")),e.close();var t=e.parentWindow.Object;return e=null,t},zL=function(){try{FL=new ActiveXObject("htmlfile")}catch(PWe){}var e,t,n;zL="undefined"!=typeof document?document.domain&&FL?DL(FL):(t=UL("iframe"),n="java"+TL+":",t.style.display="none",YL.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(QL("document.F=Object")),e.close(),e.F):DL(FL);for(var A=xL.length;A--;)delete zL[LL][xL[A]];return zL()};JL[KL]=!0;var OL=Object.create||function(e,t){var n;return null!==e?(ML[LL]=XL(e),n=new ML,ML[LL]=null,n[KL]=e):n=zL(),void 0===t?n:HL.f(n,t)},PL={},_L=VH([].slice),jL=FH,qL=QH,$L=sU.f,eT=_L,tT="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];PL.f=function(e){return tT&&"Window"===jL(e)?function(e){try{return $L(e)}catch(PWe){return eT(tT)}}(e):$L(qL(e))};var nT=tU,AT=xJ,rT=function(e,t,n){return n.get&&nT(n.get,t,{getter:!0}),n.set&&nT(n.set,t,{setter:!0}),AT.f(e,t,n)},iT={},oT=lJ;iT.f=oT;var sT=lH,aT=sT,gT=_x,lT=iT,cT=xJ.f,IT=function(e){var t=aT.Symbol||(aT.Symbol={});gT(t,e)||cT(t,e,{value:lT.f(e)})},CT=mH,uT=qH,dT=lJ,hT=oU,mT=function(){var e=uT("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,A=dT("toPrimitive");t&&!t[A]&&hT(t,A,(function(e){return CT(n,this)}),{arity:1})},pT=xJ.f,fT=_x,bT=lJ("toStringTag"),BT=function(e,t,n){e&&!n&&(e=e.prototype),e&&!fT(e,bT)&&pT(e,bT,{configurable:!0,value:t})},yT=FH,wT=VH,ZT=function(e){if("Function"===yT(e))return wT(e)},ST=Sx,vT=uH,GT=ZT(ZT.bind),RT=function(e,t){return ST(e),void 0===t?e:vT?GT(e,t):function(){return e.apply(t,arguments)}},VT=FH,NT=Array.isArray||function(e){return"Array"===VT(e)},kT=VH,WT=IH,FT=zH,ET=fL,XT=hY,HT=function(){},xT=qH("Reflect","construct"),JT=/^\s*(?:class|function)\b/,YT=kT(JT.exec),UT=!JT.test(HT),LT=function(e){if(!FT(e))return!1;try{return xT(HT,[],e),!0}catch(PWe){return!1}},TT=function(e){if(!FT(e))return!1;switch(ET(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return UT||!!YT(JT,XT(e))}catch(PWe){return!0}};TT.sham=!0;var KT=!xT||WT((function(){var e;return LT(LT.call)||!LT(Object)||!LT((function(){e=!0}))||e}))?TT:LT,MT=NT,QT=KT,DT=PH,zT=lJ("species"),OT=Array,PT=function(e){var t;return MT(e)&&(t=e.constructor,(QT(t)&&(t===OT||MT(t.prototype))||DT(t)&&null===(t=t[zT]))&&(t=void 0)),void 0===t?OT:t},_T=function(e,t){return new(PT(e))(0===t?0:t)},jT=RT,qT=JH,$T=zx,eK=BU,tK=_T,nK=VH([].push),AK=function(e){var t=1===e,n=2===e,A=3===e,r=4===e,i=6===e,o=7===e,s=5===e||i;return function(a,g,l,c){for(var I,C,u=$T(a),d=qT(u),h=eK(d),m=jT(g,l),p=0,f=c||tK,b=t?f(a,h):n||o?f(a,0):void 0;h>p;p++)if((s||p in d)&&(C=m(I=d[p],p,u),e))if(t)b[p]=C;else if(C)switch(e){case 3:return!0;case 5:return I;case 6:return p;case 2:nK(b,I)}else switch(e){case 4:return!1;case 7:nK(b,I)}return i?-1:A||r?r:b}},rK={forEach:AK(0),map:AK(1),filter:AK(2),some:AK(3),every:AK(4),find:AK(5),findIndex:AK(6)},iK=lL,oK=lH,sK=mH,aK=VH,gK=CH,lK=Cx,cK=IH,IK=_x,CK=$H,uK=TJ,dK=QH,hK=BJ,mK=yL,pK=ZH,fK=OL,bK=vL,BK=sU,yK=PL,wK=HU,ZK=cH,SK=xJ,vK=wL,GK=pH,RK=oU,VK=rT,NK=Mx,kK=wY,WK=tJ,FK=lJ,EK=iT,XK=IT,HK=mT,xK=BT,JK=xY,YK=rK.forEach,UK=yY("hidden"),LK="Symbol",TK="prototype",KK=JK.set,MK=JK.getterFor(LK),QK=Object[TK],DK=oK.Symbol,zK=DK&&DK[TK],OK=oK.RangeError,PK=oK.TypeError,_K=oK.QObject,jK=ZK.f,qK=SK.f,$K=yK.f,eM=GK.f,tM=aK([].push),nM=NK("symbols"),AM=NK("op-symbols"),rM=NK("wks"),iM=!_K||!_K[TK]||!_K[TK].findChild,oM=function(e,t,n){var A=jK(QK,t);A&&delete QK[t],qK(e,t,n),A&&e!==QK&&qK(QK,t,A)},sM=gK&&cK((function(){return 7!==fK(qK({},"a",{get:function(){return qK(this,"a",{value:7}).a}})).a}))?oM:qK,aM=function(e,t){var n=nM[e]=fK(zK);return KK(n,{type:LK,tag:e,description:t}),gK||(n.description=t),n},gM=function(e,t,n){e===QK&&gM(AM,t,n),uK(e);var A=hK(t);return uK(n),IK(nM,A)?(n.enumerable?(IK(e,UK)&&e[UK][A]&&(e[UK][A]=!1),n=fK(n,{enumerable:pK(0,!1)})):(IK(e,UK)||qK(e,UK,pK(1,fK(null))),e[UK][A]=!0),sM(e,A,n)):qK(e,A,n)},lM=function(e,t){uK(e);var n=dK(t),A=bK(n).concat(uM(n));return YK(A,(function(t){gK&&!sK(cM,n,t)||gM(e,t,n[t])})),e},cM=function(e){var t=hK(e),n=sK(eM,this,t);return!(this===QK&&IK(nM,t)&&!IK(AM,t))&&(!(n||!IK(this,t)||!IK(nM,t)||IK(this,UK)&&this[UK][t])||n)},IM=function(e,t){var n=dK(e),A=hK(t);if(n!==QK||!IK(nM,A)||IK(AM,A)){var r=jK(n,A);return!r||!IK(nM,A)||IK(n,UK)&&n[UK][A]||(r.enumerable=!0),r}},CM=function(e){var t=$K(dK(e)),n=[];return YK(t,(function(e){IK(nM,e)||IK(kK,e)||tM(n,e)})),n},uM=function(e){var t=e===QK,n=$K(t?AM:dK(e)),A=[];return YK(n,(function(e){!IK(nM,e)||t&&!IK(QK,e)||tM(A,nM[e])})),A};lK||(DK=function(){if(CK(zK,this))throw new PK("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?mK(arguments[0]):void 0,t=WK(e),n=function(e){var A=void 0===this?oK:this;A===QK&&sK(n,AM,e),IK(A,UK)&&IK(A[UK],t)&&(A[UK][t]=!1);var r=pK(1,e);try{sM(A,t,r)}catch(PWe){if(!(PWe instanceof OK))throw PWe;oM(A,t,r)}};return gK&&iM&&sM(QK,t,{configurable:!0,set:n}),aM(t,e)},RK(zK=DK[TK],"toString",(function(){return MK(this).tag})),RK(DK,"withoutSetter",(function(e){return aM(WK(e),e)})),GK.f=cM,SK.f=gM,vK.f=lM,ZK.f=IM,BK.f=yK.f=CM,wK.f=uM,EK.f=function(e){return aM(FK(e),e)},gK&&(VK(zK,"description",{configurable:!0,get:function(){return MK(this).description}}),RK(QK,"propertyIsEnumerable",cM,{unsafe:!0}))),iK({global:!0,constructor:!0,wrap:!0,forced:!lK,sham:!lK},{Symbol:DK}),YK(bK(rM),(function(e){XK(e)})),iK({target:LK,stat:!0,forced:!lK},{useSetter:function(){iM=!0},useSimple:function(){iM=!1}}),iK({target:"Object",stat:!0,forced:!lK,sham:!gK},{create:function(e,t){return void 0===t?fK(e):lM(fK(e),t)},defineProperty:gM,defineProperties:lM,getOwnPropertyDescriptor:IM}),iK({target:"Object",stat:!0,forced:!lK},{getOwnPropertyNames:CM}),HK(),xK(DK,LK),kK[UK]=!0;var dM=Cx&&!!Symbol.for&&!!Symbol.keyFor,hM=lL,mM=qH,pM=_x,fM=yL,bM=Mx,BM=dM,yM=bM("string-to-symbol-registry"),wM=bM("symbol-to-string-registry");hM({target:"Symbol",stat:!0,forced:!BM},{for:function(e){var t=fM(e);if(pM(yM,t))return yM[t];var n=mM("Symbol")(t);return yM[t]=n,wM[n]=t,n}});var ZM=lL,SM=_x,vM=fx,GM=Bx,RM=dM,VM=Mx("symbol-to-string-registry");ZM({target:"Symbol",stat:!0,forced:!RM},{keyFor:function(e){if(!vM(e))throw new TypeError(GM(e)+" is not a symbol");if(SM(VM,e))return VM[e]}});var NM=uH,kM=Function.prototype,WM=kM.apply,FM=kM.call,EM="object"==typeof Reflect&&Reflect.apply||(NM?FM.bind(WM):function(){return FM.apply(WM,arguments)}),XM=NT,HM=zH,xM=FH,JM=yL,YM=VH([].push),UM=lL,LM=qH,TM=EM,KM=mH,MM=VH,QM=IH,DM=zH,zM=fx,OM=_L,PM=function(e){if(HM(e))return e;if(XM(e)){for(var t=e.length,n=[],A=0;A<t;A++){var r=e[A];"string"==typeof r?YM(n,r):"number"!=typeof r&&"Number"!==xM(r)&&"String"!==xM(r)||YM(n,JM(r))}var i=n.length,o=!0;return function(e,t){if(o)return o=!1,t;if(XM(this))return t;for(var A=0;A<i;A++)if(n[A]===e)return t}}},_M=Cx,jM=String,qM=LM("JSON","stringify"),$M=MM(/./.exec),eQ=MM("".charAt),tQ=MM("".charCodeAt),nQ=MM("".replace),AQ=MM(1..toString),rQ=/[\uD800-\uDFFF]/g,iQ=/^[\uD800-\uDBFF]$/,oQ=/^[\uDC00-\uDFFF]$/,sQ=!_M||QM((function(){var e=LM("Symbol")("stringify detection");return"[null]"!==qM([e])||"{}"!==qM({a:e})||"{}"!==qM(Object(e))})),aQ=QM((function(){return'"\\udf06\\ud834"'!==qM("\udf06\ud834")||'"\\udead"'!==qM("\udead")})),gQ=function(e,t){var n=OM(arguments),A=PM(t);if(DM(A)||void 0!==e&&!zM(e))return n[1]=function(e,t){if(DM(A)&&(t=KM(A,this,jM(e),t)),!zM(t))return t},TM(qM,null,n)},lQ=function(e,t,n){var A=eQ(n,t-1),r=eQ(n,t+1);return $M(iQ,e)&&!$M(oQ,r)||$M(oQ,e)&&!$M(iQ,A)?"\\u"+AQ(tQ(e,0),16):e};qM&&UM({target:"JSON",stat:!0,arity:3,forced:sQ||aQ},{stringify:function(e,t,n){var A=OM(arguments),r=TM(sQ?gQ:qM,null,A);return aQ&&"string"==typeof r?nQ(r,rQ,lQ):r}});var cQ=HU,IQ=zx;lL({target:"Object",stat:!0,forced:!Cx||IH((function(){cQ.f(1)}))},{getOwnPropertySymbols:function(e){var t=cQ.f;return t?t(IQ(e)):[]}});var CQ=lL,uQ=CH,dQ=VH,hQ=_x,mQ=zH,pQ=$H,fQ=yL,bQ=rT,BQ=zU,yQ=lH.Symbol,wQ=yQ&&yQ.prototype;if(uQ&&mQ(yQ)&&(!("description"in wQ)||void 0!==yQ().description)){var ZQ={},SQ=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:fQ(arguments[0]),t=pQ(wQ,this)?new yQ(e):void 0===e?yQ():yQ(e);return""===e&&(ZQ[t]=!0),t};BQ(SQ,yQ),SQ.prototype=wQ,wQ.constructor=SQ;var vQ="Symbol(description detection)"===String(yQ("description detection")),GQ=dQ(wQ.valueOf),RQ=dQ(wQ.toString),VQ=/^Symbol\((.*)\)[^)]+$/,NQ=dQ("".replace),kQ=dQ("".slice);bQ(wQ,"description",{configurable:!0,get:function(){var e=GQ(this);if(hQ(ZQ,e))return"";var t=RQ(e),n=vQ?kQ(t,7,-1):NQ(t,VQ,"$1");return""===n?void 0:n}}),CQ({global:!0,constructor:!0,forced:!0},{Symbol:SQ})}IT("asyncIterator"),IT("hasInstance"),IT("isConcatSpreadable"),IT("iterator"),IT("match"),IT("matchAll"),IT("replace"),IT("search"),IT("species"),IT("split");var WQ=mT;IT("toPrimitive"),WQ();var FQ=qH,EQ=BT;IT("toStringTag"),EQ(FQ("Symbol"),"Symbol"),IT("unscopables");var XQ=VH,HQ=Sx,xQ=function(e,t,n){try{return XQ(HQ(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(PWe){}},JQ=PH,YQ=function(e){return JQ(e)||null===e},UQ=YQ,LQ=String,TQ=TypeError,KQ=function(e){if(UQ(e))return e;throw new TQ("Can't set "+LQ(e)+" as a prototype")},MQ=xQ,QQ=PH,DQ=TH,zQ=KQ,OQ=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=MQ(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(PWe){}return function(n,A){return DQ(n),zQ(A),QQ(n)?(t?e(n,A):n.__proto__=A,n):n}}():void 0),PQ=xJ.f,_Q=function(e,t,n){n in e||PQ(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},jQ=zH,qQ=PH,$Q=OQ,eD=function(e,t,n){var A,r;return $Q&&jQ(A=t.constructor)&&A!==n&&qQ(r=A.prototype)&&r!==n.prototype&&$Q(e,r),e},tD=yL,nD=function(e,t){return void 0===e?arguments.length<2?"":t:tD(e)},AD=PH,rD=nY,iD=function(e,t){AD(t)&&"cause"in t&&rD(e,"cause",t.cause)},oD=Error,sD=VH("".replace),aD=String(new oD("zxcasd").stack),gD=/\n\s*at [^:]*:[^\n]*/,lD=gD.test(aD),cD=function(e,t){if(lD&&"string"==typeof e&&!oD.prepareStackTrace)for(;t--;)e=sD(e,gD,"");return e},ID=ZH,CD=!IH((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",ID(1,7)),7!==e.stack)})),uD=nY,dD=cD,hD=CD,mD=Error.captureStackTrace,pD=function(e,t,n,A){hD&&(mD?mD(e,t):uD(e,"stack",dD(n,A)))},fD=qH,bD=_x,BD=nY,yD=$H,wD=OQ,ZD=zU,SD=_Q,vD=eD,GD=nD,RD=iD,VD=pD,ND=CH,kD=function(e,t,n,A){var r="stackTraceLimit",i=A?2:1,o=e.split("."),s=o[o.length-1],a=fD.apply(null,o);if(a){var g=a.prototype;if(bD(g,"cause")&&delete g.cause,!n)return a;var l=fD("Error"),c=t((function(e,t){var n=GD(A?t:e,void 0),r=A?new a(e):new a;return void 0!==n&&BD(r,"message",n),VD(r,c,r.stack,2),this&&yD(g,this)&&vD(r,this,c),arguments.length>i&&RD(r,arguments[i]),r}));c.prototype=g,"Error"!==s?wD?wD(c,l):ZD(c,l,{name:!0}):ND&&r in a&&(SD(c,a,r),SD(c,a,"prepareStackTrace")),ZD(c,a);try{g.name!==s&&BD(g,"name",s),g.constructor=c}catch(PWe){}return c}},WD=lL,FD=EM,ED=kD,XD="WebAssembly",HD=lH[XD],xD=7!==new Error("e",{cause:7}).cause,JD=function(e,t){var n={};n[e]=ED(e,t,xD),WD({global:!0,constructor:!0,arity:1,forced:xD},n)},YD=function(e,t){if(HD&&HD[e]){var n={};n[e]=ED(XD+"."+e,t,xD),WD({target:XD,stat:!0,constructor:!0,arity:1,forced:xD},n)}};JD("Error",(function(e){return function(t){return FD(e,this,arguments)}})),JD("EvalError",(function(e){return function(t){return FD(e,this,arguments)}})),JD("RangeError",(function(e){return function(t){return FD(e,this,arguments)}})),JD("ReferenceError",(function(e){return function(t){return FD(e,this,arguments)}})),JD("SyntaxError",(function(e){return function(t){return FD(e,this,arguments)}})),JD("TypeError",(function(e){return function(t){return FD(e,this,arguments)}})),JD("URIError",(function(e){return function(t){return FD(e,this,arguments)}})),YD("CompileError",(function(e){return function(t){return FD(e,this,arguments)}})),YD("LinkError",(function(e){return function(t){return FD(e,this,arguments)}})),YD("RuntimeError",(function(e){return function(t){return FD(e,this,arguments)}}));var UD=CH,LD=IH,TD=TJ,KD=nD,MD=Error.prototype.toString,QD=LD((function(){if(UD){var e=Object.create(Object.defineProperty({},"name",{get:function(){return this===e}}));if("true"!==MD.call(e))return!0}return"2: 1"!==MD.call({message:1,name:2})||"Error"!==MD.call({})}))?function(){var e=TD(this),t=KD(e.name,"Error"),n=KD(e.message);return t?n?t+": "+n:t:n}:MD,DD=oU,zD=QD,OD=Error.prototype;OD.toString!==zD&&DD(OD,"toString",zD);var PD=!IH((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),_D=_x,jD=zH,qD=zx,$D=PD,ez=yY("IE_PROTO"),tz=Object,nz=tz.prototype,Az=$D?tz.getPrototypeOf:function(e){var t=qD(e);if(_D(t,ez))return t[ez];var n=t.constructor;return jD(n)&&t instanceof n?n.prototype:t instanceof tz?nz:null},rz={},iz=rz,oz=lJ("iterator"),sz=Array.prototype,az=function(e){return void 0!==e&&(iz.Array===e||sz[oz]===e)},gz=fL,lz=Rx,cz=YH,Iz=rz,Cz=lJ("iterator"),uz=function(e){if(!cz(e))return lz(e,Cz)||lz(e,"@@iterator")||Iz[gz(e)]},dz=mH,hz=Sx,mz=TJ,pz=Bx,fz=uz,bz=TypeError,Bz=function(e,t){var n=arguments.length<2?fz(e):t;if(hz(n))return mz(dz(n,e));throw new bz(pz(e)+" is not iterable")},yz=mH,wz=TJ,Zz=Rx,Sz=function(e,t,n){var A,r;wz(e);try{if(!(A=Zz(e,"return"))){if("throw"===t)throw n;return n}A=yz(A,e)}catch(PWe){r=!0,A=PWe}if("throw"===t)throw n;if(r)throw A;return wz(A),n},vz=RT,Gz=mH,Rz=TJ,Vz=Bx,Nz=az,kz=BU,Wz=$H,Fz=Bz,Ez=uz,Xz=Sz,Hz=TypeError,xz=function(e,t){this.stopped=e,this.result=t},Jz=xz.prototype,Yz=function(e,t,n){var A,r,i,o,s,a,g,l=n&&n.that,c=!(!n||!n.AS_ENTRIES),I=!(!n||!n.IS_RECORD),C=!(!n||!n.IS_ITERATOR),u=!(!n||!n.INTERRUPTED),d=vz(t,l),h=function(e){return A&&Xz(A,"normal",e),new xz(!0,e)},m=function(e){return c?(Rz(e),u?d(e[0],e[1],h):d(e[0],e[1])):u?d(e,h):d(e)};if(I)A=e.iterator;else if(C)A=e;else{if(!(r=Ez(e)))throw new Hz(Vz(e)+" is not iterable");if(Nz(r)){for(i=0,o=kz(e);o>i;i++)if((s=m(e[i]))&&Wz(Jz,s))return s;return new xz(!1)}A=Fz(e,r)}for(a=I?e.next:A.next;!(g=Gz(a,A)).done;){try{s=m(g.value)}catch(PWe){Xz(A,"throw",PWe)}if("object"==typeof s&&s&&Wz(Jz,s))return s}return new xz(!1)},Uz=lL,Lz=$H,Tz=Az,Kz=OQ,Mz=zU,Qz=OL,Dz=nY,zz=ZH,Oz=iD,Pz=pD,_z=Yz,jz=nD,qz=lJ("toStringTag"),$z=Error,eO=[].push,tO=function(e,t){var n,A=Lz(nO,this);Kz?n=Kz(new $z,A?Tz(this):nO):(n=A?this:Qz(nO),Dz(n,qz,"Error")),void 0!==t&&Dz(n,"message",jz(t)),Pz(n,tO,n.stack,1),arguments.length>2&&Oz(n,arguments[2]);var r=[];return _z(e,eO,{that:r}),Dz(n,"errors",r),n};Kz?Kz(tO,$z):Mz(tO,$z,{name:!0});var nO=tO.prototype=Qz($z.prototype,{constructor:zz(1,tO),message:zz(1,""),name:zz(1,"AggregateError")});Uz({global:!0,constructor:!0,arity:2},{AggregateError:tO});var AO=lL,rO=EM,iO=IH,oO=kD,sO="AggregateError",aO=qH(sO),gO=!iO((function(){return 1!==aO([1]).errors[0]}))&&iO((function(){return 7!==aO([1],sO,{cause:7}).cause}));AO({global:!0,constructor:!0,arity:2,forced:gO},{AggregateError:oO(sO,(function(e){return function(t,n){return rO(e,this,arguments)}}),gO,!0)});var lO=lJ,cO=OL,IO=xJ.f,CO=lO("unscopables"),uO=Array.prototype;void 0===uO[CO]&&IO(uO,CO,{configurable:!0,value:cO(null)});var dO=function(e){uO[CO][e]=!0},hO=zx,mO=BU,pO=IU,fO=dO;lL({target:"Array",proto:!0},{at:function(e){var t=hO(this),n=mO(t),A=pO(e),r=A>=0?A:n+A;return r<0||r>=n?void 0:t[r]}}),fO("at");var bO=TypeError,BO=function(e){if(e>9007199254740991)throw bO("Maximum allowed index exceeded");return e},yO=CH,wO=xJ,ZO=ZH,SO=function(e,t,n){yO?wO.f(e,t,ZO(0,n)):e[t]=n},vO=IH,GO=gx,RO=lJ("species"),VO=function(e){return GO>=51||!vO((function(){var t=[];return(t.constructor={})[RO]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},NO=lL,kO=IH,WO=NT,FO=PH,EO=zx,XO=BU,HO=BO,xO=SO,JO=_T,YO=VO,UO=gx,LO=lJ("isConcatSpreadable"),TO=UO>=51||!kO((function(){var e=[];return e[LO]=!1,e.concat()[0]!==e})),KO=function(e){if(!FO(e))return!1;var t=e[LO];return void 0!==t?!!t:WO(e)};NO({target:"Array",proto:!0,arity:1,forced:!TO||!YO("concat")},{concat:function(e){var t,n,A,r,i,o=EO(this),s=JO(o,0),a=0;for(t=-1,A=arguments.length;t<A;t++)if(KO(i=-1===t?o:arguments[t]))for(r=XO(i),HO(a+r),n=0;n<r;n++,a++)n in i&&xO(s,a,i[n]);else HO(a+1),xO(s,a++,i);return s.length=a,s}});var MO=Bx,QO=TypeError,DO=function(e,t){if(!delete e[t])throw new QO("Cannot delete property "+MO(t)+" of "+MO(e))},zO=zx,OO=hU,PO=BU,_O=DO,jO=Math.min,qO=[].copyWithin||function(e,t){var n=zO(this),A=PO(n),r=OO(e,A),i=OO(t,A),o=arguments.length>2?arguments[2]:void 0,s=jO((void 0===o?A:OO(o,A))-i,A-r),a=1;for(i<r&&r<i+s&&(a=-1,i+=s-1,r+=s-1);s-- >0;)i in n?n[r]=n[i]:_O(n,r),r+=a,i+=a;return n},$O=dO;lL({target:"Array",proto:!0},{copyWithin:qO}),$O("copyWithin");var eP=IH,tP=function(e,t){var n=[][e];return!!n&&eP((function(){n.call(null,t||function(){return 1},1)}))},nP=rK.every;lL({target:"Array",proto:!0,forced:!tP("every")},{every:function(e){return nP(this,e,arguments.length>1?arguments[1]:void 0)}});var AP=zx,rP=hU,iP=BU,oP=function(e){for(var t=AP(this),n=iP(t),A=arguments.length,r=rP(A>1?arguments[1]:void 0,n),i=A>2?arguments[2]:void 0,o=void 0===i?n:rP(i,n);o>r;)t[r++]=e;return t},sP=dO;lL({target:"Array",proto:!0},{fill:oP}),sP("fill");var aP=rK.filter;lL({target:"Array",proto:!0,forced:!VO("filter")},{filter:function(e){return aP(this,e,arguments.length>1?arguments[1]:void 0)}});var gP=lL,lP=rK.find,cP=dO,IP="find",CP=!0;IP in[]&&Array(1)[IP]((function(){CP=!1})),gP({target:"Array",proto:!0,forced:CP},{find:function(e){return lP(this,e,arguments.length>1?arguments[1]:void 0)}}),cP(IP);var uP=lL,dP=rK.findIndex,hP=dO,mP="findIndex",pP=!0;mP in[]&&Array(1)[mP]((function(){pP=!1})),uP({target:"Array",proto:!0,forced:pP},{findIndex:function(e){return dP(this,e,arguments.length>1?arguments[1]:void 0)}}),hP(mP);var fP=RT,bP=JH,BP=zx,yP=BU,wP=function(e){var t=1===e;return function(n,A,r){for(var i,o=BP(n),s=bP(o),a=yP(s),g=fP(A,r);a-- >0;)if(g(i=s[a],a,o))switch(e){case 0:return i;case 1:return a}return t?-1:void 0}},ZP={findLast:wP(0),findLastIndex:wP(1)},SP=ZP.findLast,vP=dO;lL({target:"Array",proto:!0},{findLast:function(e){return SP(this,e,arguments.length>1?arguments[1]:void 0)}}),vP("findLast");var GP=ZP.findLastIndex,RP=dO;lL({target:"Array",proto:!0},{findLastIndex:function(e){return GP(this,e,arguments.length>1?arguments[1]:void 0)}}),RP("findLastIndex");var VP=NT,NP=BU,kP=BO,WP=RT,FP=function(e,t,n,A,r,i,o,s){for(var a,g,l=r,c=0,I=!!o&&WP(o,s);c<A;)c in n&&(a=I?I(n[c],c,t):n[c],i>0&&VP(a)?(g=NP(a),l=FP(e,t,a,g,l,i-1)-1):(kP(l+1),e[l]=a),l++),c++;return l},EP=FP,XP=EP,HP=zx,xP=BU,JP=IU,YP=_T;lL({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=HP(this),n=xP(t),A=YP(t,0);return A.length=XP(A,t,t,n,0,void 0===e?1:JP(e)),A}});var UP=EP,LP=Sx,TP=zx,KP=BU,MP=_T;lL({target:"Array",proto:!0},{flatMap:function(e){var t,n=TP(this),A=KP(n);return LP(e),(t=MP(n,0)).length=UP(t,n,n,A,0,1,e,arguments.length>1?arguments[1]:void 0),t}});var QP=rK.forEach,DP=tP("forEach")?[].forEach:function(e){return QP(this,e,arguments.length>1?arguments[1]:void 0)};lL({target:"Array",proto:!0,forced:[].forEach!==DP},{forEach:DP});var zP=TJ,OP=Sz,PP=function(e,t,n,A){try{return A?t(zP(n)[0],n[1]):t(n)}catch(PWe){OP(e,"throw",PWe)}},_P=RT,jP=mH,qP=zx,$P=PP,e_=az,t_=KT,n_=BU,A_=SO,r_=Bz,i_=uz,o_=Array,s_=function(e){var t=qP(e),n=t_(this),A=arguments.length,r=A>1?arguments[1]:void 0,i=void 0!==r;i&&(r=_P(r,A>2?arguments[2]:void 0));var o,s,a,g,l,c,I=i_(t),C=0;if(!I||this===o_&&e_(I))for(o=n_(t),s=n?new this(o):o_(o);o>C;C++)c=i?r(t[C],C):t[C],A_(s,C,c);else for(s=n?new this:[],l=(g=r_(t,I)).next;!(a=jP(l,g)).done;C++)c=i?$P(g,r,[a.value,C],!0):a.value,A_(s,C,c);return s.length=C,s},a_=lJ("iterator"),g_=!1;try{var l_=0,c_={next:function(){return{done:!!l_++}},return:function(){g_=!0}};c_[a_]=function(){return this},Array.from(c_,(function(){throw 2}))}catch(PWe){}var I_=function(e,t){try{if(!t&&!g_)return!1}catch(PWe){return!1}var n=!1;try{var A={};A[a_]=function(){return{next:function(){return{done:n=!0}}}},e(A)}catch(PWe){}return n},C_=s_;lL({target:"Array",stat:!0,forced:!I_((function(e){Array.from(e)}))},{from:C_});var u_=vU.includes,d_=dO;lL({target:"Array",proto:!0,forced:IH((function(){return!Array(1).includes()}))},{includes:function(e){return u_(this,e,arguments.length>1?arguments[1]:void 0)}}),d_("includes");var h_=lL,m_=vU.indexOf,p_=tP,f_=ZT([].indexOf),b_=!!f_&&1/f_([1],1,-0)<0;h_({target:"Array",proto:!0,forced:b_||!p_("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return b_?f_(this,e,t)||0:m_(this,e,t)}}),lL({target:"Array",stat:!0},{isArray:NT});var B_,y_,w_,Z_=IH,S_=zH,v_=PH,G_=Az,R_=oU,V_=lJ("iterator"),N_=!1;[].keys&&("next"in(w_=[].keys())?(y_=G_(G_(w_)))!==Object.prototype&&(B_=y_):N_=!0),(!v_(B_)||Z_((function(){var e={};return B_[V_].call(e)!==e})))&&(B_={}),S_(B_[V_])||R_(B_,V_,(function(){return this}));var k_={IteratorPrototype:B_,BUGGY_SAFARI_ITERATORS:N_},W_=k_.IteratorPrototype,F_=OL,E_=ZH,X_=BT,H_=rz,x_=function(){return this},J_=function(e,t,n,A){var r=t+" Iterator";return e.prototype=F_(W_,{next:E_(+!A,n)}),X_(e,r,!1),H_[r]=x_,e},Y_=lL,U_=mH,L_=zH,T_=J_,K_=Az,M_=OQ,Q_=BT,D_=nY,z_=oU,O_=rz,P_=gY.PROPER,__=gY.CONFIGURABLE,j_=k_.IteratorPrototype,q_=k_.BUGGY_SAFARI_ITERATORS,$_=lJ("iterator"),ej="keys",tj="values",nj="entries",Aj=function(){return this},rj=function(e,t,n,A,r,i,o){T_(n,t,A);var s,a,g,l=function(e){if(e===r&&d)return d;if(!q_&&e&&e in C)return C[e];switch(e){case ej:case tj:case nj:return function(){return new n(this,e)}}return function(){return new n(this)}},c=t+" Iterator",I=!1,C=e.prototype,u=C[$_]||C["@@iterator"]||r&&C[r],d=!q_&&u||l(r),h="Array"===t&&C.entries||u;if(h&&(s=K_(h.call(new e)))!==Object.prototype&&s.next&&(K_(s)!==j_&&(M_?M_(s,j_):L_(s[$_])||z_(s,$_,Aj)),Q_(s,c,!0)),P_&&r===tj&&u&&u.name!==tj&&(__?D_(C,"name",tj):(I=!0,d=function(){return U_(u,this)})),r)if(a={values:l(tj),keys:i?d:l(ej),entries:l(nj)},o)for(g in a)(q_||I||!(g in C))&&z_(C,g,a[g]);else Y_({target:t,proto:!0,forced:q_||I},a);return C[$_]!==d&&z_(C,$_,d,{name:r}),O_[t]=d,a},ij=function(e,t){return{value:e,done:t}},oj=QH,sj=dO,aj=rz,gj=xY,lj=xJ.f,cj=rj,Ij=ij,Cj=CH,uj="Array Iterator",dj=gj.set,hj=gj.getterFor(uj),mj=cj(Array,"Array",(function(e,t){dj(this,{type:uj,target:oj(e),index:0,kind:t})}),(function(){var e=hj(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,Ij(void 0,!0);switch(e.kind){case"keys":return Ij(n,!1);case"values":return Ij(t[n],!1)}return Ij([n,t[n]],!1)}),"values"),pj=aj.Arguments=aj.Array;if(sj("keys"),sj("values"),sj("entries"),Cj&&"values"!==pj.name)try{lj(pj,"name",{value:"values"})}catch(PWe){}var fj=lL,bj=JH,Bj=QH,yj=tP,wj=VH([].join);fj({target:"Array",proto:!0,forced:bj!==Object||!yj("join",",")},{join:function(e){return wj(Bj(this),void 0===e?",":e)}});var Zj=EM,Sj=QH,vj=IU,Gj=BU,Rj=tP,Vj=Math.min,Nj=[].lastIndexOf,kj=!!Nj&&1/[1].lastIndexOf(1,-0)<0,Wj=Rj("lastIndexOf"),Fj=kj||!Wj?function(e){if(kj)return Zj(Nj,this,arguments)||0;var t=Sj(this),n=Gj(t);if(0===n)return-1;var A=n-1;for(arguments.length>1&&(A=Vj(A,vj(arguments[1]))),A<0&&(A=n+A);A>=0;A--)if(A in t&&t[A]===e)return A||0;return-1}:Nj;lL({target:"Array",proto:!0,forced:Fj!==[].lastIndexOf},{lastIndexOf:Fj});var Ej=rK.map;lL({target:"Array",proto:!0,forced:!VO("map")},{map:function(e){return Ej(this,e,arguments.length>1?arguments[1]:void 0)}});var Xj=KT,Hj=SO,xj=Array;lL({target:"Array",stat:!0,forced:IH((function(){function e(){}return!(xj.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new(Xj(this)?this:xj)(t);t>e;)Hj(n,e,arguments[e++]);return n.length=t,n}});var Jj=CH,Yj=NT,Uj=TypeError,Lj=Object.getOwnPropertyDescriptor,Tj=Jj&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(PWe){return PWe instanceof TypeError}}()?function(e,t){if(Yj(e)&&!Lj(e,"length").writable)throw new Uj("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Kj=zx,Mj=BU,Qj=Tj,Dj=BO;lL({target:"Array",proto:!0,arity:1,forced:IH((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(PWe){return PWe instanceof TypeError}}()},{push:function(e){var t=Kj(this),n=Mj(t),A=arguments.length;Dj(n+A);for(var r=0;r<A;r++)t[n]=arguments[r],n++;return Qj(t,n),n}});var zj=Sx,Oj=zx,Pj=JH,_j=BU,jj=TypeError,qj="Reduce of empty array with no initial value",$j=function(e){return function(t,n,A,r){var i=Oj(t),o=Pj(i),s=_j(i);if(zj(n),0===s&&A<2)throw new jj(qj);var a=e?s-1:0,g=e?-1:1;if(A<2)for(;;){if(a in o){r=o[a],a+=g;break}if(a+=g,e?a<0:s<=a)throw new jj(qj)}for(;e?a>=0:s>a;a+=g)a in o&&(r=n(r,o[a],a,i));return r}},eq={left:$j(!1),right:$j(!0)},tq=lH,nq=nx,Aq=FH,rq=function(e){return nq.slice(0,e.length)===e},iq=rq("Bun/")?"BUN":rq("Cloudflare-Workers")?"CLOUDFLARE":rq("Deno/")?"DENO":rq("Node.js/")?"NODE":tq.Bun&&"string"==typeof Bun.version?"BUN":tq.Deno&&"object"==typeof Deno.version?"DENO":"process"===Aq(tq.process)?"NODE":tq.window&&tq.document?"BROWSER":"REST",oq="NODE"===iq,sq=eq.left;lL({target:"Array",proto:!0,forced:!oq&&gx>79&&gx<83||!tP("reduce")},{reduce:function(e){var t=arguments.length;return sq(this,e,t,t>1?arguments[1]:void 0)}});var aq=eq.right;lL({target:"Array",proto:!0,forced:!oq&&gx>79&&gx<83||!tP("reduceRight")},{reduceRight:function(e){return aq(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var gq=lL,lq=NT,cq=VH([].reverse),Iq=[1,2];gq({target:"Array",proto:!0,forced:String(Iq)===String(Iq.reverse())},{reverse:function(){return lq(this)&&(this.length=this.length),cq(this)}});var Cq=lL,uq=NT,dq=KT,hq=PH,mq=hU,pq=BU,fq=QH,bq=SO,Bq=lJ,yq=_L,wq=VO("slice"),Zq=Bq("species"),Sq=Array,vq=Math.max;Cq({target:"Array",proto:!0,forced:!wq},{slice:function(e,t){var n,A,r,i=fq(this),o=pq(i),s=mq(e,o),a=mq(void 0===t?o:t,o);if(uq(i)&&(n=i.constructor,(dq(n)&&(n===Sq||uq(n.prototype))||hq(n)&&null===(n=n[Zq]))&&(n=void 0),n===Sq||void 0===n))return yq(i,s,a);for(A=new(void 0===n?Sq:n)(vq(a-s,0)),r=0;s<a;s++,r++)s in i&&bq(A,r,i[s]);return A.length=r,A}});var Gq=rK.some;lL({target:"Array",proto:!0,forced:!tP("some")},{some:function(e){return Gq(this,e,arguments.length>1?arguments[1]:void 0)}});var Rq=_L,Vq=Math.floor,Nq=function(e,t){var n=e.length;if(n<8)for(var A,r,i=1;i<n;){for(r=i,A=e[i];r&&t(e[r-1],A)>0;)e[r]=e[--r];r!==i++&&(e[r]=A)}else for(var o=Vq(n/2),s=Nq(Rq(e,0,o),t),a=Nq(Rq(e,o),t),g=s.length,l=a.length,c=0,I=0;c<g||I<l;)e[c+I]=c<g&&I<l?t(s[c],a[I])<=0?s[c++]:a[I++]:c<g?s[c++]:a[I++];return e},kq=Nq,Wq=nx.match(/firefox\/(\d+)/i),Fq=!!Wq&&+Wq[1],Eq=/MSIE|Trident/.test(nx),Xq=nx.match(/AppleWebKit\/(\d+)\./),Hq=!!Xq&&+Xq[1],xq=lL,Jq=VH,Yq=Sx,Uq=zx,Lq=BU,Tq=DO,Kq=yL,Mq=IH,Qq=kq,Dq=tP,zq=Fq,Oq=Eq,Pq=gx,_q=Hq,jq=[],qq=Jq(jq.sort),$q=Jq(jq.push),e$=Mq((function(){jq.sort(void 0)})),t$=Mq((function(){jq.sort(null)})),n$=Dq("sort"),A$=!Mq((function(){if(Pq)return Pq<70;if(!(zq&&zq>3)){if(Oq)return!0;if(_q)return _q<603;var e,t,n,A,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(A=0;A<47;A++)jq.push({k:t+A,v:n})}for(jq.sort((function(e,t){return t.v-e.v})),A=0;A<jq.length;A++)t=jq[A].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));xq({target:"Array",proto:!0,forced:e$||!t$||!n$||!A$},{sort:function(e){void 0!==e&&Yq(e);var t=Uq(this);if(A$)return void 0===e?qq(t):qq(t,e);var n,A,r=[],i=Lq(t);for(A=0;A<i;A++)A in t&&$q(r,t[A]);for(Qq(r,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:Kq(t)>Kq(n)?1:-1}}(e)),n=Lq(r),A=0;A<n;)t[A]=r[A++];for(;A<i;)Tq(t,A++);return t}});var r$=qH,i$=rT,o$=CH,s$=lJ("species"),a$=function(e){var t=r$(e);o$&&t&&!t[s$]&&i$(t,s$,{configurable:!0,get:function(){return this}})};a$("Array");var g$=lL,l$=zx,c$=hU,I$=IU,C$=BU,u$=Tj,d$=BO,h$=_T,m$=SO,p$=DO,f$=VO("splice"),b$=Math.max,B$=Math.min;g$({target:"Array",proto:!0,forced:!f$},{splice:function(e,t){var n,A,r,i,o,s,a=l$(this),g=C$(a),l=c$(e,g),c=arguments.length;for(0===c?n=A=0:1===c?(n=0,A=g-l):(n=c-2,A=B$(b$(I$(t),0),g-l)),d$(g+n-A),r=h$(a,A),i=0;i<A;i++)(o=l+i)in a&&m$(r,i,a[o]);if(r.length=A,n<A){for(i=l;i<g-A;i++)s=i+n,(o=i+A)in a?a[s]=a[o]:p$(a,s);for(i=g;i>g-A+n;i--)p$(a,i-1)}else if(n>A)for(i=g-A;i>l;i--)s=i+n-1,(o=i+A-1)in a?a[s]=a[o]:p$(a,s);for(i=0;i<n;i++)a[i+l]=arguments[i+2];return u$(a,g-A+n),r}});var y$=BU,w$=function(e,t){for(var n=y$(e),A=new t(n),r=0;r<n;r++)A[r]=e[n-r-1];return A},Z$=w$,S$=QH,v$=dO,G$=Array;lL({target:"Array",proto:!0},{toReversed:function(){return Z$(S$(this),G$)}}),v$("toReversed");var R$=BU,V$=function(e,t,n){for(var A=0,r=arguments.length>2?n:R$(t),i=new e(r);r>A;)i[A]=t[A++];return i},N$=lH,k$=lL,W$=Sx,F$=QH,E$=V$,X$=dO,H$=Array,x$=VH(function(e,t){var n=N$[e],A=n&&n.prototype;return A&&A[t]}("Array","sort"));k$({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&W$(e);var t=F$(this),n=E$(H$,t);return x$(n,e)}}),X$("toSorted");var J$=lL,Y$=dO,U$=BO,L$=BU,T$=hU,K$=QH,M$=IU,Q$=Array,D$=Math.max,z$=Math.min;J$({target:"Array",proto:!0},{toSpliced:function(e,t){var n,A,r,i,o=K$(this),s=L$(o),a=T$(e,s),g=arguments.length,l=0;for(0===g?n=A=0:1===g?(n=0,A=s-a):(n=g-2,A=z$(D$(M$(t),0),s-a)),r=U$(s+n-A),i=Q$(r);l<a;l++)i[l]=o[l];for(;l<a+n;l++)i[l]=arguments[l-a+2];for(;l<r;l++)i[l]=o[l+A-n];return i}}),Y$("toSpliced"),dO("flat"),dO("flatMap");var O$=zx,P$=BU,_$=Tj,j$=DO,q$=BO;lL({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(PWe){return PWe instanceof TypeError}}()},{unshift:function(e){var t=O$(this),n=P$(t),A=arguments.length;if(A){q$(n+A);for(var r=n;r--;){var i=r+A;r in t?t[i]=t[r]:j$(t,i)}for(var o=0;o<A;o++)t[o]=arguments[o]}return _$(t,n+A)}});var $$=BU,e0=IU,t0=RangeError,n0=function(e,t,n,A){var r=$$(e),i=e0(n),o=i<0?r+i:i;if(o>=r||o<0)throw new t0("Incorrect index");for(var s=new t(r),a=0;a<r;a++)s[a]=a===o?A:e[a];return s},A0=n0,r0=QH,i0=Array;lL({target:"Array",proto:!0},{with:function(e,t){return A0(r0(this),i0,e,t)}});var o0="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,s0=oU,a0=function(e,t,n){for(var A in t)s0(e,A,t[A],n);return e},g0=$H,l0=TypeError,c0=function(e,t){if(g0(t,e))return e;throw new l0("Incorrect invocation")},I0=IU,C0=fU,u0=RangeError,d0=function(e){if(void 0===e)return 0;var t=I0(e),n=C0(t);if(t!==n)throw new u0("Wrong length or index");return n},h0=Math.sign||function(e){var t=+e;return 0===t||t!=t?t:t<0?-1:1},m0=4503599627370496,p0=function(e){return e+m0-m0},f0=h0,b0=p0,B0=Math.abs,y0=function(e,t,n,A){var r=+e,i=B0(r),o=f0(r);if(i<A)return o*b0(i/A/t)*A*t;var s=(1+t/2220446049250313e-31)*i,a=s-(s-i);return a>n||a!=a?o*(1/0):o*a},w0=y0,Z0=Math.fround||function(e){return w0(e,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)},S0=Array,v0=Math.abs,G0=Math.pow,R0=Math.floor,V0=Math.log,N0=Math.LN2,k0={pack:function(e,t,n){var A,r,i,o=S0(n),s=8*n-t-1,a=(1<<s)-1,g=a>>1,l=23===t?G0(2,-24)-G0(2,-77):0,c=e<0||0===e&&1/e<0?1:0,I=0;for((e=v0(e))!=e||e===1/0?(r=e!=e?1:0,A=a):(A=R0(V0(e)/N0),e*(i=G0(2,-A))<1&&(A--,i*=2),(e+=A+g>=1?l/i:l*G0(2,1-g))*i>=2&&(A++,i/=2),A+g>=a?(r=0,A=a):A+g>=1?(r=(e*i-1)*G0(2,t),A+=g):(r=e*G0(2,g-1)*G0(2,t),A=0));t>=8;)o[I++]=255&r,r/=256,t-=8;for(A=A<<t|r,s+=t;s>0;)o[I++]=255&A,A/=256,s-=8;return o[I-1]|=128*c,o},unpack:function(e,t){var n,A=e.length,r=8*A-t-1,i=(1<<r)-1,o=i>>1,s=r-7,a=A-1,g=e[a--],l=127&g;for(g>>=7;s>0;)l=256*l+e[a--],s-=8;for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)n=256*n+e[a--],s-=8;if(0===l)l=1-o;else{if(l===i)return n?NaN:g?-1/0:1/0;n+=G0(2,t),l-=o}return(g?-1:1)*n*G0(2,l-t)}},W0=lH,F0=VH,E0=CH,X0=o0,H0=nY,x0=rT,J0=a0,Y0=IH,U0=c0,L0=IU,T0=fU,K0=d0,M0=Z0,Q0=k0,D0=Az,z0=OQ,O0=oP,P0=_L,_0=eD,j0=zU,q0=BT,$0=xY,e1=gY.PROPER,t1=gY.CONFIGURABLE,n1="ArrayBuffer",A1="DataView",r1="prototype",i1="Wrong index",o1=$0.getterFor(n1),s1=$0.getterFor(A1),a1=$0.set,g1=W0[n1],l1=g1,c1=l1&&l1[r1],I1=W0[A1],C1=I1&&I1[r1],u1=Object.prototype,d1=W0.Array,h1=W0.RangeError,m1=F0(O0),p1=F0([].reverse),f1=Q0.pack,b1=Q0.unpack,B1=function(e){return[255&e]},y1=function(e){return[255&e,e>>8&255]},w1=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Z1=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},S1=function(e){return f1(M0(e),23,4)},v1=function(e){return f1(e,52,8)},G1=function(e,t,n){x0(e[r1],t,{configurable:!0,get:function(){return n(this)[t]}})},R1=function(e,t,n,A){var r=s1(e),i=K0(n),o=!!A;if(i+t>r.byteLength)throw new h1(i1);var s=r.bytes,a=i+r.byteOffset,g=P0(s,a,a+t);return o?g:p1(g)},V1=function(e,t,n,A,r,i){var o=s1(e),s=K0(n),a=A(+r),g=!!i;if(s+t>o.byteLength)throw new h1(i1);for(var l=o.bytes,c=s+o.byteOffset,I=0;I<t;I++)l[c+I]=a[g?I:t-I-1]};if(X0){var N1=e1&&g1.name!==n1;Y0((function(){g1(1)}))&&Y0((function(){new g1(-1)}))&&!Y0((function(){return new g1,new g1(1.5),new g1(NaN),1!==g1.length||N1&&!t1}))?N1&&t1&&H0(g1,"name",n1):((l1=function(e){return U0(this,c1),_0(new g1(K0(e)),this,l1)})[r1]=c1,c1.constructor=l1,j0(l1,g1)),z0&&D0(C1)!==u1&&z0(C1,u1);var k1=new I1(new l1(2)),W1=F0(C1.setInt8);k1.setInt8(0,2147483648),k1.setInt8(1,2147483649),!k1.getInt8(0)&&k1.getInt8(1)||J0(C1,{setInt8:function(e,t){W1(this,e,t<<24>>24)},setUint8:function(e,t){W1(this,e,t<<24>>24)}},{unsafe:!0})}else c1=(l1=function(e){U0(this,c1);var t=K0(e);a1(this,{type:n1,bytes:m1(d1(t),0),byteLength:t}),E0||(this.byteLength=t,this.detached=!1)})[r1],C1=(I1=function(e,t,n){U0(this,C1),U0(e,c1);var A=o1(e),r=A.byteLength,i=L0(t);if(i<0||i>r)throw new h1("Wrong offset");if(i+(n=void 0===n?r-i:T0(n))>r)throw new h1("Wrong length");a1(this,{type:A1,buffer:e,byteLength:n,byteOffset:i,bytes:A.bytes}),E0||(this.buffer=e,this.byteLength=n,this.byteOffset=i)})[r1],E0&&(G1(l1,"byteLength",o1),G1(I1,"buffer",s1),G1(I1,"byteLength",s1),G1(I1,"byteOffset",s1)),J0(C1,{getInt8:function(e){return R1(this,1,e)[0]<<24>>24},getUint8:function(e){return R1(this,1,e)[0]},getInt16:function(e){var t=R1(this,2,e,arguments.length>1&&arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=R1(this,2,e,arguments.length>1&&arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return Z1(R1(this,4,e,arguments.length>1&&arguments[1]))},getUint32:function(e){return Z1(R1(this,4,e,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(e){return b1(R1(this,4,e,arguments.length>1&&arguments[1]),23)},getFloat64:function(e){return b1(R1(this,8,e,arguments.length>1&&arguments[1]),52)},setInt8:function(e,t){V1(this,1,e,B1,t)},setUint8:function(e,t){V1(this,1,e,B1,t)},setInt16:function(e,t){V1(this,2,e,y1,t,arguments.length>2&&arguments[2])},setUint16:function(e,t){V1(this,2,e,y1,t,arguments.length>2&&arguments[2])},setInt32:function(e,t){V1(this,4,e,w1,t,arguments.length>2&&arguments[2])},setUint32:function(e,t){V1(this,4,e,w1,t,arguments.length>2&&arguments[2])},setFloat32:function(e,t){V1(this,4,e,S1,t,arguments.length>2&&arguments[2])},setFloat64:function(e,t){V1(this,8,e,v1,t,arguments.length>2&&arguments[2])}});q0(l1,n1),q0(I1,A1);var F1={ArrayBuffer:l1,DataView:I1},E1=a$,X1="ArrayBuffer",H1=F1[X1];lL({global:!0,constructor:!0,forced:lH[X1]!==H1},{ArrayBuffer:H1}),E1(X1);var x1,J1,Y1,U1=o0,L1=CH,T1=lH,K1=zH,M1=PH,Q1=_x,D1=fL,z1=Bx,O1=nY,P1=oU,_1=rT,j1=$H,q1=Az,$1=OQ,e2=lJ,t2=tJ,n2=xY.enforce,A2=xY.get,r2=T1.Int8Array,i2=r2&&r2.prototype,o2=T1.Uint8ClampedArray,s2=o2&&o2.prototype,a2=r2&&q1(r2),g2=i2&&q1(i2),l2=Object.prototype,c2=T1.TypeError,I2=e2("toStringTag"),C2=t2("TYPED_ARRAY_TAG"),u2="TypedArrayConstructor",d2=U1&&!!$1&&"Opera"!==D1(T1.opera),h2=!1,m2={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},p2={BigInt64Array:8,BigUint64Array:8},f2=function(e){var t=q1(e);if(M1(t)){var n=A2(t);return n&&Q1(n,u2)?n[u2]:f2(t)}},b2=function(e){if(!M1(e))return!1;var t=D1(e);return Q1(m2,t)||Q1(p2,t)};for(x1 in m2)(Y1=(J1=T1[x1])&&J1.prototype)?n2(Y1)[u2]=J1:d2=!1;for(x1 in p2)(Y1=(J1=T1[x1])&&J1.prototype)&&(n2(Y1)[u2]=J1);if((!d2||!K1(a2)||a2===Function.prototype)&&(a2=function(){throw new c2("Incorrect invocation")},d2))for(x1 in m2)T1[x1]&&$1(T1[x1],a2);if((!d2||!g2||g2===l2)&&(g2=a2.prototype,d2))for(x1 in m2)T1[x1]&&$1(T1[x1].prototype,g2);if(d2&&q1(s2)!==g2&&$1(s2,g2),L1&&!Q1(g2,I2))for(x1 in h2=!0,_1(g2,I2,{configurable:!0,get:function(){return M1(this)?this[C2]:void 0}}),m2)T1[x1]&&O1(T1[x1],C2,x1);var B2={NATIVE_ARRAY_BUFFER_VIEWS:d2,TYPED_ARRAY_TAG:h2&&C2,aTypedArray:function(e){if(b2(e))return e;throw new c2("Target is not a typed array")},aTypedArrayConstructor:function(e){if(K1(e)&&(!$1||j1(a2,e)))return e;throw new c2(z1(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,A){if(L1){if(n)for(var r in m2){var i=T1[r];if(i&&Q1(i.prototype,e))try{delete i.prototype[e]}catch(PWe){try{i.prototype[e]=t}catch(o){}}}g2[e]&&!n||P1(g2,e,n?t:d2&&i2[e]||t,A)}},exportTypedArrayStaticMethod:function(e,t,n){var A,r;if(L1){if($1){if(n)for(A in m2)if((r=T1[A])&&Q1(r,e))try{delete r[e]}catch(PWe){}if(a2[e]&&!n)return;try{return P1(a2,e,n?t:d2&&a2[e]||t)}catch(PWe){}}for(A in m2)!(r=T1[A])||r[e]&&!n||P1(r,e,t)}},getTypedArrayConstructor:f2,isView:function(e){if(!M1(e))return!1;var t=D1(e);return"DataView"===t||Q1(m2,t)||Q1(p2,t)},isTypedArray:b2,TypedArray:a2,TypedArrayPrototype:g2};lL({target:"ArrayBuffer",stat:!0,forced:!B2.NATIVE_ARRAY_BUFFER_VIEWS},{isView:B2.isView});var y2=lL,w2=ZT,Z2=IH,S2=TJ,v2=hU,G2=fU,R2=F1.ArrayBuffer,V2=F1.DataView,N2=V2.prototype,k2=w2(R2.prototype.slice),W2=w2(N2.getUint8),F2=w2(N2.setUint8);y2({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Z2((function(){return!new R2(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(k2&&void 0===t)return k2(S2(this),e);for(var n=S2(this).byteLength,A=v2(e,n),r=v2(void 0===t?n:t,n),i=new R2(G2(r-A)),o=new V2(this),s=new V2(i),a=0;A<r;)F2(s,a++,W2(o,A++));return i}}),lL({global:!0,constructor:!0,forced:!o0},{DataView:F1.DataView});var E2=lL,X2=VH,H2=Math.pow,x2=H2(2,-24),J2=.0009765625,Y2=X2(DataView.prototype.getUint16);E2({target:"DataView",proto:!0},{getFloat16:function(e){var t,n,A,r,i=Y2(this,e,arguments.length>1&&arguments[1]);return n=(t=i)>>>15,r=1023&t,31===(A=t>>>10&31)?0===r?0===n?1/0:-1/0:NaN:0===A?r*(0===n?x2:-x2):H2(2,A-15)*(0===n?1+r*J2:-1-r*J2)}});var U2=fL,L2=TypeError,T2=Math.log,K2=Math.LN2,M2=Math.log2||function(e){return T2(e)/K2},Q2=lL,D2=VH,z2=function(e){if("DataView"===U2(e))return e;throw new L2("Argument is not a DataView")},O2=d0,P2=M2,_2=p0,j2=Math.pow,q2=1024,$2=D2(DataView.prototype.setUint16);Q2({target:"DataView",proto:!0},{setFloat16:function(e,t){z2(this);var n=O2(e),A=function(e){if(e!=e)return 32256;if(0===e)return(1/e==-1/0)<<15;var t=e<0;if(t&&(e=-e),e>=65520)return t<<15|31744;if(e<61005353927612305e-21)return t<<15|_2(16777216*e);var n=0|P2(e);if(-15===n)return t<<15|q2;var A=_2((e*j2(2,-n)-1)*q2);return A===q2?t<<15|n+16<<10:t<<15|n+15<<10|A}(+t);return $2(this,n,A,arguments.length>2&&arguments[2])}});var e5=lH,t5=xQ,n5=FH,A5=e5.ArrayBuffer,r5=e5.TypeError,i5=A5&&t5(A5.prototype,"byteLength","get")||function(e){if("ArrayBuffer"!==n5(e))throw new r5("ArrayBuffer expected");return e.byteLength},o5=o0,s5=i5,a5=lH.DataView,g5=function(e){if(!o5||0!==s5(e))return!1;try{return new a5(e),!1}catch(PWe){return!0}},l5=CH,c5=rT,I5=g5,C5=ArrayBuffer.prototype;l5&&!("detached"in C5)&&c5(C5,"detached",{configurable:!0,get:function(){return I5(this)}});var u5,d5,h5,m5,p5=g5,f5=TypeError,b5=lH,B5=oq,y5=function(e){if(B5){try{return b5.process.getBuiltinModule(e)}catch(PWe){}try{return Function('return require("'+e+'")')()}catch(PWe){}}},w5=IH,Z5=gx,S5=iq,v5=lH.structuredClone,G5=!!v5&&!w5((function(){if("DENO"===S5&&Z5>92||"NODE"===S5&&Z5>94||"BROWSER"===S5&&Z5>97)return!1;var e=new ArrayBuffer(8),t=v5(e,{transfer:[e]});return 0!==e.byteLength||8!==t.byteLength})),R5=lH,V5=y5,N5=G5,k5=R5.structuredClone,W5=R5.ArrayBuffer,F5=R5.MessageChannel,E5=!1;if(N5)E5=function(e){k5(e,{transfer:[e]})};else if(W5)try{F5||(u5=V5("worker_threads"))&&(F5=u5.MessageChannel),F5&&(d5=new F5,h5=new W5(2),m5=function(e){d5.port1.postMessage(null,[e])},2===h5.byteLength&&(m5(h5),0===h5.byteLength&&(E5=m5)))}catch(PWe){}var X5=E5,H5=lH,x5=VH,J5=xQ,Y5=d0,U5=function(e){if(p5(e))throw new f5("ArrayBuffer is detached");return e},L5=i5,T5=X5,K5=G5,M5=H5.structuredClone,Q5=H5.ArrayBuffer,D5=H5.DataView,z5=Math.min,O5=Q5.prototype,P5=D5.prototype,_5=x5(O5.slice),j5=J5(O5,"resizable","get"),q5=J5(O5,"maxByteLength","get"),$5=x5(P5.getInt8),e3=x5(P5.setInt8),t3=(K5||T5)&&function(e,t,n){var A,r=L5(e),i=void 0===t?r:Y5(t),o=!j5||!j5(e);if(U5(e),K5&&(e=M5(e,{transfer:[e]}),r===i&&(n||o)))return e;if(r>=i&&(!n||o))A=_5(e,0,i);else{var s=n&&!o&&q5?{maxByteLength:q5(e)}:void 0;A=new Q5(i,s);for(var a=new D5(e),g=new D5(A),l=z5(i,r),c=0;c<l;c++)e3(g,c,$5(a,c))}return K5||T5(e),A},n3=t3;n3&&lL({target:"ArrayBuffer",proto:!0},{transfer:function(){return n3(this,arguments.length?arguments[0]:void 0,!0)}});var A3=t3;A3&&lL({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return A3(this,arguments.length?arguments[0]:void 0,!1)}});var r3=lL,i3=VH,o3=IH((function(){return 120!==new Date(16e11).getYear()})),s3=i3(Date.prototype.getFullYear);r3({target:"Date",proto:!0,forced:o3},{getYear:function(){return s3(this)-1900}});var a3=lL,g3=Date,l3=VH(g3.prototype.getTime);a3({target:"Date",stat:!0},{now:function(){return l3(new g3)}});var c3=lL,I3=VH,C3=IU,u3=Date.prototype,d3=I3(u3.getTime),h3=I3(u3.setFullYear);c3({target:"Date",proto:!0},{setYear:function(e){d3(this);var t=C3(e);return h3(this,t>=0&&t<=99?t+1900:t)}}),lL({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var m3=IU,p3=yL,f3=TH,b3=RangeError,B3=function(e){var t=p3(f3(this)),n="",A=m3(e);if(A<0||A===1/0)throw new b3("Wrong number of repetitions");for(;A>0;(A>>>=1)&&(t+=t))1&A&&(n+=t);return n},y3=VH,w3=fU,Z3=yL,S3=TH,v3=y3(B3),G3=y3("".slice),R3=Math.ceil,V3=function(e){return function(t,n,A){var r,i,o=Z3(S3(t)),s=w3(n),a=o.length,g=void 0===A?" ":Z3(A);return s<=a||""===g?o:((i=v3(g,R3((r=s-a)/g.length))).length>r&&(i=G3(i,0,r)),e?o+i:i+o)}},N3={start:V3(!1),end:V3(!0)},k3=VH,W3=IH,F3=N3.start,E3=RangeError,X3=isFinite,H3=Math.abs,x3=Date.prototype,J3=x3.toISOString,Y3=k3(x3.getTime),U3=k3(x3.getUTCDate),L3=k3(x3.getUTCFullYear),T3=k3(x3.getUTCHours),K3=k3(x3.getUTCMilliseconds),M3=k3(x3.getUTCMinutes),Q3=k3(x3.getUTCMonth),D3=k3(x3.getUTCSeconds),z3=W3((function(){return"0385-07-25T07:06:39.999Z"!==J3.call(new Date(-50000000000001))}))||!W3((function(){J3.call(new Date(NaN))}))?function(){if(!X3(Y3(this)))throw new E3("Invalid time value");var e=this,t=L3(e),n=K3(e),A=t<0?"-":t>9999?"+":"";return A+F3(H3(t),A?6:4,0)+"-"+F3(Q3(e)+1,2,0)+"-"+F3(U3(e),2,0)+"T"+F3(T3(e),2,0)+":"+F3(M3(e),2,0)+":"+F3(D3(e),2,0)+"."+F3(n,3,0)+"Z"}:J3;lL({target:"Date",proto:!0,forced:Date.prototype.toISOString!==z3},{toISOString:z3});var O3=zx,P3=pJ;lL({target:"Date",proto:!0,arity:1,forced:IH((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}))},{toJSON:function(e){var t=O3(this),n=P3(t,"number");return"number"!=typeof n||isFinite(n)?t.toISOString():null}});var _3=TJ,j3=Fx,q3=TypeError,$3=_x,e4=oU,t4=function(e){if(_3(this),"string"===e||"default"===e)e="string";else if("number"!==e)throw new q3("Incorrect hint");return j3(this,e)},n4=lJ("toPrimitive"),A4=Date.prototype;$3(A4,n4)||e4(A4,n4,t4);var r4=VH,i4=oU,o4=Date.prototype,s4="Invalid Date",a4="toString",g4=r4(o4[a4]),l4=r4(o4.getTime);String(new Date(NaN))!==s4&&i4(o4,a4,(function(){var e=l4(this);return e==e?g4(this):s4}));var c4=lL,I4=VH,C4=yL,u4=I4("".charAt),d4=I4("".charCodeAt),h4=I4(/./.exec),m4=I4(1..toString),p4=I4("".toUpperCase),f4=/[\w*+\-./@]/,b4=function(e,t){for(var n=m4(e,16);n.length<t;)n="0"+n;return n};c4({global:!0},{escape:function(e){for(var t,n,A=C4(e),r="",i=A.length,o=0;o<i;)t=u4(A,o++),h4(f4,t)?r+=t:r+=(n=d4(t,0))<256?"%"+b4(n,2):"%u"+p4(b4(n,4));return r}});var B4=VH,y4=Sx,w4=PH,Z4=_x,S4=_L,v4=uH,G4=Function,R4=B4([].concat),V4=B4([].join),N4={},k4=v4?G4.bind:function(e){var t=y4(this),n=t.prototype,A=S4(arguments,1),r=function(){var n=R4(A,S4(arguments));return this instanceof r?function(e,t,n){if(!Z4(N4,t)){for(var A=[],r=0;r<t;r++)A[r]="a["+r+"]";N4[t]=G4("C,a","return new C("+V4(A,",")+")")}return N4[t](e,n)}(t,n.length,n):t.apply(e,n)};return w4(n)&&(r.prototype=n),r},W4=k4;lL({target:"Function",proto:!0,forced:Function.bind!==W4},{bind:W4});var F4=zH,E4=PH,X4=xJ,H4=$H,x4=tU,J4=lJ("hasInstance"),Y4=Function.prototype;J4 in Y4||X4.f(Y4,J4,{value:x4((function(e){if(!F4(this)||!E4(e))return!1;var t=this.prototype;return E4(t)?H4(t,e):e instanceof this}),J4)});var U4=CH,L4=gY.EXISTS,T4=VH,K4=rT,M4=Function.prototype,Q4=T4(M4.toString),D4=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,z4=T4(D4.exec);U4&&!L4&&K4(M4,"name",{configurable:!0,get:function(){try{return z4(D4,Q4(this))[1]}catch(PWe){return""}}});var O4=lH;lL({global:!0,forced:O4.globalThis!==O4},{globalThis:O4});var P4=lL,_4=lH,j4=c0,q4=TJ,$4=zH,e9=Az,t9=rT,n9=SO,A9=IH,r9=_x,i9=k_.IteratorPrototype,o9=CH,s9="constructor",a9="Iterator",g9=lJ("toStringTag"),l9=TypeError,c9=_4[a9],I9=!$4(c9)||c9.prototype!==i9||!A9((function(){c9({})})),C9=function(){if(j4(this,i9),e9(this)===i9)throw new l9("Abstract class Iterator not directly constructable")},u9=function(e,t){o9?t9(i9,e,{configurable:!0,get:function(){return t},set:function(t){if(q4(this),this===i9)throw new l9("You can't redefine this property");r9(this,e)?this[e]=t:n9(this,e,t)}}):i9[e]=t};r9(i9,g9)||u9(g9,a9),!I9&&r9(i9,s9)&&i9[s9]!==Object||u9(s9,C9),C9.prototype=i9,P4({global:!0,constructor:!0,forced:I9},{Iterator:C9});var d9=function(e){return{iterator:e,next:e.next,done:!1}},h9=RangeError,m9=function(e){if(e==e)return e;throw new h9("NaN is not allowed")},p9=IU,f9=RangeError,b9=function(e){var t=p9(e);if(t<0)throw new f9("The argument can't be less than 0");return t},B9=mH,y9=OL,w9=nY,Z9=a0,S9=xY,v9=Rx,G9=k_.IteratorPrototype,R9=ij,V9=Sz,N9=lJ("toStringTag"),k9="IteratorHelper",W9="WrapForValidIterator",F9=S9.set,E9=function(e){var t=S9.getterFor(e?W9:k9);return Z9(y9(G9),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return R9(void 0,!0);try{var A=n.nextHandler();return n.returnHandlerResult?A:R9(A,n.done)}catch(PWe){throw n.done=!0,PWe}},return:function(){var n=t(this),A=n.iterator;if(n.done=!0,e){var r=v9(A,"return");return r?B9(r,A):R9(void 0,!0)}if(n.inner)try{V9(n.inner.iterator,"normal")}catch(PWe){return V9(A,"throw",PWe)}return A&&V9(A,"normal"),R9(void 0,!0)}})},X9=E9(!0),H9=E9(!1);w9(H9,N9,"Iterator Helper");var x9=function(e,t,n){var A=function(A,r){r?(r.iterator=A.iterator,r.next=A.next):r=A,r.type=t?W9:k9,r.returnHandlerResult=!!n,r.nextHandler=e,r.counter=0,r.done=!1,F9(this,r)};return A.prototype=t?X9:H9,A},J9=lH,Y9=function(e,t){var n=J9.Iterator,A=n&&n.prototype,r=A&&A[e],i=!1;if(r)try{r.call({next:function(){return{done:!0}},return:function(){i=!0}},-1)}catch(PWe){PWe instanceof t||(i=!1)}if(!i)return r},U9=lL,L9=mH,T9=TJ,K9=d9,M9=m9,Q9=b9,D9=Sz,z9=x9,O9=Y9("drop",RangeError),P9=z9((function(){for(var e,t=this.iterator,n=this.next;this.remaining;)if(this.remaining--,e=T9(L9(n,t)),this.done=!!e.done)return;if(e=T9(L9(n,t)),!(this.done=!!e.done))return e.value}));U9({target:"Iterator",proto:!0,real:!0,forced:O9},{drop:function(e){var t;T9(this);try{t=Q9(M9(+e))}catch(PWe){D9(this,"throw",PWe)}return O9?L9(O9,this,t):new P9(K9(this),{remaining:t})}});var _9=lL,j9=mH,q9=Yz,$9=Sx,e8=TJ,t8=d9,n8=Sz,A8=Y9("every",TypeError);_9({target:"Iterator",proto:!0,real:!0,forced:A8},{every:function(e){e8(this);try{$9(e)}catch(PWe){n8(this,"throw",PWe)}if(A8)return j9(A8,this,e);var t=t8(this),n=0;return!q9(t,(function(t,A){if(!e(t,n++))return A()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});var r8=lL,i8=mH,o8=Sx,s8=TJ,a8=d9,g8=x9,l8=PP,c8=Sz,I8=Y9("filter",TypeError),C8=g8((function(){for(var e,t,n=this.iterator,A=this.predicate,r=this.next;;){if(e=s8(i8(r,n)),this.done=!!e.done)return;if(t=e.value,l8(n,A,[t,this.counter++],!0))return t}}));r8({target:"Iterator",proto:!0,real:!0,forced:I8},{filter:function(e){s8(this);try{o8(e)}catch(PWe){c8(this,"throw",PWe)}return I8?i8(I8,this,e):new C8(a8(this),{predicate:e})}});var u8=lL,d8=mH,h8=Yz,m8=Sx,p8=TJ,f8=d9,b8=Sz,B8=Y9("find",TypeError);u8({target:"Iterator",proto:!0,real:!0,forced:B8},{find:function(e){p8(this);try{m8(e)}catch(PWe){b8(this,"throw",PWe)}if(B8)return d8(B8,this,e);var t=f8(this),n=0;return h8(t,(function(t,A){if(e(t,n++))return A(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var y8=mH,w8=TJ,Z8=d9,S8=uz,v8=function(e,t){t&&"string"==typeof e||w8(e);var n=S8(e);return Z8(w8(void 0!==n?y8(n,e):e))},G8=lL,R8=mH,V8=Sx,N8=TJ,k8=d9,W8=v8,F8=x9,E8=Sz,X8=Y9("flatMap",TypeError),H8=F8((function(){for(var e,t,n=this.iterator,A=this.mapper;;){if(t=this.inner)try{if(!(e=N8(R8(t.next,t.iterator))).done)return e.value;this.inner=null}catch(PWe){E8(n,"throw",PWe)}if(e=N8(R8(this.next,n)),this.done=!!e.done)return;try{this.inner=W8(A(e.value,this.counter++),!1)}catch(PWe){E8(n,"throw",PWe)}}}));G8({target:"Iterator",proto:!0,real:!0,forced:X8},{flatMap:function(e){N8(this);try{V8(e)}catch(PWe){E8(this,"throw",PWe)}return X8?R8(X8,this,e):new H8(k8(this),{mapper:e,inner:null})}});var x8=lL,J8=mH,Y8=Yz,U8=Sx,L8=TJ,T8=d9,K8=Sz,M8=Y9("forEach",TypeError);x8({target:"Iterator",proto:!0,real:!0,forced:M8},{forEach:function(e){L8(this);try{U8(e)}catch(PWe){K8(this,"throw",PWe)}if(M8)return J8(M8,this,e);var t=T8(this),n=0;Y8(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}});var Q8=lL,D8=mH,z8=zx,O8=$H,P8=k_.IteratorPrototype,_8=v8,j8=x9((function(){return D8(this.next,this.iterator)}),!0);Q8({target:"Iterator",stat:!0,forced:false},{from:function(e){var t=_8("string"==typeof e?z8(e):e,!0);return O8(P8,t.iterator)?t.iterator:new j8(t)}});var q8=lL,$8=mH,e6=Sx,t6=TJ,n6=d9,A6=x9,r6=PP,i6=Sz,o6=Y9("map",TypeError),s6=A6((function(){var e=this.iterator,t=t6($8(this.next,e));if(!(this.done=!!t.done))return r6(e,this.mapper,[t.value,this.counter++],!0)}));q8({target:"Iterator",proto:!0,real:!0,forced:o6},{map:function(e){t6(this);try{e6(e)}catch(PWe){i6(this,"throw",PWe)}return o6?$8(o6,this,e):new s6(n6(this),{mapper:e})}});var a6=lL,g6=Yz,l6=Sx,c6=TJ,I6=d9,C6=Sz,u6=Y9,d6=EM,h6=TypeError,m6=IH((function(){[].keys().reduce((function(){}),void 0)})),p6=!m6&&u6("reduce",h6);a6({target:"Iterator",proto:!0,real:!0,forced:m6||p6},{reduce:function(e){c6(this);try{l6(e)}catch(PWe){C6(this,"throw",PWe)}var t=arguments.length<2,n=t?void 0:arguments[1];if(p6)return d6(p6,this,t?[e]:[e,n]);var A=I6(this),r=0;if(g6(A,(function(A){t?(t=!1,n=A):n=e(n,A,r),r++}),{IS_RECORD:!0}),t)throw new h6("Reduce of empty iterator with no initial value");return n}});var f6=lL,b6=mH,B6=Yz,y6=Sx,w6=TJ,Z6=d9,S6=Sz,v6=Y9("some",TypeError);f6({target:"Iterator",proto:!0,real:!0,forced:v6},{some:function(e){w6(this);try{y6(e)}catch(PWe){S6(this,"throw",PWe)}if(v6)return b6(v6,this,e);var t=Z6(this),n=0;return B6(t,(function(t,A){if(e(t,n++))return A()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});var G6=lL,R6=mH,V6=TJ,N6=d9,k6=m9,W6=b9,F6=x9,E6=Sz,X6=Y9("take",RangeError),H6=F6((function(){var e=this.iterator;if(!this.remaining--)return this.done=!0,E6(e,"normal",void 0);var t=V6(R6(this.next,e));return(this.done=!!t.done)?void 0:t.value}));G6({target:"Iterator",proto:!0,real:!0,forced:X6},{take:function(e){var t;V6(this);try{t=W6(k6(+e))}catch(PWe){E6(this,"throw",PWe)}return X6?R6(X6,this,t):new H6(N6(this),{remaining:t})}});var x6=TJ,J6=Yz,Y6=d9,U6=[].push;lL({target:"Iterator",proto:!0,real:!0},{toArray:function(){var e=[];return J6(Y6(x6(this)),U6,{that:e,IS_RECORD:!0}),e}}),BT(lH.JSON,"JSON",!0);var L6={exports:{}},T6=IH((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),K6=IH,M6=PH,Q6=FH,D6=T6,z6=Object.isExtensible,O6=K6((function(){z6(1)}))||D6?function(e){return!!M6(e)&&((!D6||"ArrayBuffer"!==Q6(e))&&(!z6||z6(e)))}:z6,P6=!IH((function(){return Object.isExtensible(Object.preventExtensions({}))})),_6=lL,j6=VH,q6=wY,$6=PH,e7=_x,t7=xJ.f,n7=sU,A7=PL,r7=O6,i7=P6,o7=!1,s7=tJ("meta"),a7=0,g7=function(e){t7(e,s7,{value:{objectID:"O"+a7++,weakData:{}}})},l7=L6.exports={enable:function(){l7.enable=function(){},o7=!0;var e=n7.f,t=j6([].splice),n={};n[s7]=1,e(n).length&&(n7.f=function(n){for(var A=e(n),r=0,i=A.length;r<i;r++)if(A[r]===s7){t(A,r,1);break}return A},_6({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:A7.f}))},fastKey:function(e,t){if(!$6(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!e7(e,s7)){if(!r7(e))return"F";if(!t)return"E";g7(e)}return e[s7].objectID},getWeakData:function(e,t){if(!e7(e,s7)){if(!r7(e))return!0;if(!t)return!1;g7(e)}return e[s7].weakData},onFreeze:function(e){return i7&&o7&&r7(e)&&!e7(e,s7)&&g7(e),e}};q6[s7]=!0;var c7=L6.exports,I7=lL,C7=lH,u7=VH,d7=nL,h7=oU,m7=c7,p7=Yz,f7=c0,b7=zH,B7=YH,y7=PH,w7=IH,Z7=I_,S7=BT,v7=eD,G7=function(e,t,n){var A=-1!==e.indexOf("Map"),r=-1!==e.indexOf("Weak"),i=A?"set":"add",o=C7[e],s=o&&o.prototype,a=o,g={},l=function(e){var t=u7(s[e]);h7(s,e,"add"===e?function(e){return t(this,0===e?0:e),this}:"delete"===e?function(e){return!(r&&!y7(e))&&t(this,0===e?0:e)}:"get"===e?function(e){return r&&!y7(e)?void 0:t(this,0===e?0:e)}:"has"===e?function(e){return!(r&&!y7(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(d7(e,!b7(o)||!(r||s.forEach&&!w7((function(){(new o).entries().next()})))))a=n.getConstructor(t,e,A,i),m7.enable();else if(d7(e,!0)){var c=new a,I=c[i](r?{}:-0,1)!==c,C=w7((function(){c.has(1)})),u=Z7((function(e){new o(e)})),d=!r&&w7((function(){for(var e=new o,t=5;t--;)e[i](t,t);return!e.has(-0)}));u||((a=t((function(e,t){f7(e,s);var n=v7(new o,e,a);return B7(t)||p7(t,n[i],{that:n,AS_ENTRIES:A}),n}))).prototype=s,s.constructor=a),(C||d)&&(l("delete"),l("has"),A&&l("get")),(d||I)&&l(i),r&&s.clear&&delete s.clear}return g[e]=a,I7({global:!0,constructor:!0,forced:a!==o},g),S7(a,e),r||n.setStrong(a,e,A),a},R7=OL,V7=rT,N7=a0,k7=RT,W7=c0,F7=YH,E7=Yz,X7=rj,H7=ij,x7=a$,J7=CH,Y7=c7.fastKey,U7=xY.set,L7=xY.getterFor,T7={getConstructor:function(e,t,n,A){var r=e((function(e,r){W7(e,i),U7(e,{type:t,index:R7(null),first:null,last:null,size:0}),J7||(e.size=0),F7(r)||E7(r,e[A],{that:e,AS_ENTRIES:n})})),i=r.prototype,o=L7(t),s=function(e,t,n){var A,r,i=o(e),s=a(e,t);return s?s.value=n:(i.last=s={index:r=Y7(t,!0),key:t,value:n,previous:A=i.last,next:null,removed:!1},i.first||(i.first=s),A&&(A.next=s),J7?i.size++:e.size++,"F"!==r&&(i.index[r]=s)),e},a=function(e,t){var n,A=o(e),r=Y7(t);if("F"!==r)return A.index[r];for(n=A.first;n;n=n.next)if(n.key===t)return n};return N7(i,{clear:function(){for(var e=o(this),t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=null),t=t.next;e.first=e.last=null,e.index=R7(null),J7?e.size=0:this.size=0},delete:function(e){var t=this,n=o(t),A=a(t,e);if(A){var r=A.next,i=A.previous;delete n.index[A.index],A.removed=!0,i&&(i.next=r),r&&(r.previous=i),n.first===A&&(n.first=r),n.last===A&&(n.last=i),J7?n.size--:t.size--}return!!A},forEach:function(e){for(var t,n=o(this),A=k7(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(A(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!a(this,e)}}),N7(i,n?{get:function(e){var t=a(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),J7&&V7(i,"size",{configurable:!0,get:function(){return o(this).size}}),r},setStrong:function(e,t,n){var A=t+" Iterator",r=L7(t),i=L7(A);X7(e,t,(function(e,t){U7(this,{type:A,target:e,state:r(e),kind:t,last:null})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?H7("keys"===t?n.key:"values"===t?n.value:[n.key,n.value],!1):(e.target=null,H7(void 0,!0))}),n?"entries":"values",!n,!0),x7(t)}};G7("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),T7);var K7=VH,M7=Map.prototype,Q7={Map:Map,set:K7(M7.set),get:K7(M7.get),has:K7(M7.has),remove:K7(M7.delete)},D7=lL,z7=Sx,O7=TH,P7=Yz,_7=IH,j7=Q7.Map,q7=Q7.has,$7=Q7.get,eee=Q7.set,tee=VH([].push);D7({target:"Map",stat:!0,forced:_7((function(){return 1!==j7.groupBy("ab",(function(e){return e})).get("a").length}))},{groupBy:function(e,t){O7(e),z7(t);var n=new j7,A=0;return P7(e,(function(e){var r=t(e,A++);q7(n,r)?tee($7(n,r),e):eee(n,r,[e])})),n}});var nee=Math.log,Aee=Math.log1p||function(e){var t=+e;return t>-1e-8&&t<1e-8?t-t*t/2:nee(1+t)},ree=lL,iee=Aee,oee=Math.acosh,see=Math.log,aee=Math.sqrt,gee=Math.LN2;ree({target:"Math",stat:!0,forced:!oee||710!==Math.floor(oee(Number.MAX_VALUE))||oee(1/0)!==1/0},{acosh:function(e){var t=+e;return t<1?NaN:t>94906265.62425156?see(t)+gee:iee(t-1+aee(t-1)*aee(t+1))}});var lee=lL,cee=Math.asinh,Iee=Math.log,Cee=Math.sqrt;lee({target:"Math",stat:!0,forced:!(cee&&1/cee(0)>0)},{asinh:function e(t){var n=+t;return isFinite(n)&&0!==n?n<0?-e(-n):Iee(n+Cee(n*n+1)):n}});var uee=lL,dee=Math.atanh,hee=Math.log;uee({target:"Math",stat:!0,forced:!(dee&&1/dee(-0)<0)},{atanh:function(e){var t=+e;return 0===t?t:hee((1+t)/(1-t))/2}});var mee=lL,pee=h0,fee=Math.abs,bee=Math.pow;mee({target:"Math",stat:!0},{cbrt:function(e){var t=+e;return pee(t)*bee(fee(t),1/3)}});var Bee=lL,yee=Math.floor,wee=Math.log,Zee=Math.LOG2E;Bee({target:"Math",stat:!0},{clz32:function(e){var t=e>>>0;return t?31-yee(wee(t+.5)*Zee):32}});var See=Math.expm1,vee=Math.exp,Gee=!See||See(10)>22025.465794806718||See(10)<22025.465794806718||-2e-17!==See(-2e-17)?function(e){var t=+e;return 0===t?t:t>-1e-6&&t<1e-6?t+t*t/2:vee(t)-1}:See,Ree=lL,Vee=Gee,Nee=Math.cosh,kee=Math.abs,Wee=Math.E;Ree({target:"Math",stat:!0,forced:!Nee||Nee(710)===1/0},{cosh:function(e){var t=Vee(kee(e)-1)+1;return(t+1/(t*Wee*Wee))*(Wee/2)}});var Fee=Gee;lL({target:"Math",stat:!0,forced:Fee!==Math.expm1},{expm1:Fee}),lL({target:"Math",stat:!0},{fround:Z0});var Eee=y0;lL({target:"Math",stat:!0},{f16round:function(e){return Eee(e,.0009765625,65504,6103515625e-14)}});var Xee=lL,Hee=Math.hypot,xee=Math.abs,Jee=Math.sqrt;Xee({target:"Math",stat:!0,arity:2,forced:!!Hee&&Hee(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,A,r=0,i=0,o=arguments.length,s=0;i<o;)s<(n=xee(arguments[i++]))?(r=r*(A=s/n)*A+1,s=n):r+=n>0?(A=n/s)*A:n;return s===1/0?1/0:s*Jee(r)}});var Yee=lL,Uee=IH,Lee=Math.imul;Yee({target:"Math",stat:!0,forced:Uee((function(){return-5!==Lee(4294967295,5)||2!==Lee.length}))},{imul:function(e,t){var n=65535,A=+e,r=+t,i=n&A,o=n&r;return 0|i*o+((n&A>>>16)*o+i*(n&r>>>16)<<16>>>0)}});var Tee=Math.log,Kee=Math.LOG10E,Mee=Math.log10||function(e){return Tee(e)*Kee};lL({target:"Math",stat:!0},{log10:Mee}),lL({target:"Math",stat:!0},{log1p:Aee}),lL({target:"Math",stat:!0},{log2:M2}),lL({target:"Math",stat:!0},{sign:h0});var Qee=lL,Dee=IH,zee=Gee,Oee=Math.abs,Pee=Math.exp,_ee=Math.E;Qee({target:"Math",stat:!0,forced:Dee((function(){return-2e-17!==Math.sinh(-2e-17)}))},{sinh:function(e){var t=+e;return Oee(t)<1?(zee(t)-zee(-t))/2:(Pee(t-1)-Pee(-t-1))*(_ee/2)}});var jee=lL,qee=Gee,$ee=Math.exp;jee({target:"Math",stat:!0},{tanh:function(e){var t=+e,n=qee(t),A=qee(-t);return n===1/0?1:A===1/0?-1:(n-A)/($ee(t)+$ee(-t))}}),BT(Math,"Math",!0),lL({target:"Math",stat:!0},{trunc:lU});var ete=VH(1..valueOf),tte="\t\n\v\f\r                　\u2028\u2029\ufeff",nte=TH,Ate=yL,rte=tte,ite=VH("".replace),ote=RegExp("^["+rte+"]+"),ste=RegExp("(^|[^"+rte+"])["+rte+"]+$"),ate=function(e){return function(t){var n=Ate(nte(t));return 1&e&&(n=ite(n,ote,"")),2&e&&(n=ite(n,ste,"$1")),n}},gte={start:ate(1),end:ate(2),trim:ate(3)},lte=lL,cte=CH,Ite=lH,Cte=sT,ute=VH,dte=nL,hte=_x,mte=eD,pte=$H,fte=fx,bte=pJ,Bte=IH,yte=sU.f,wte=cH.f,Zte=xJ.f,Ste=ete,vte=gte.trim,Gte="Number",Rte=Ite[Gte];Cte[Gte];var Vte=Rte.prototype,Nte=Ite.TypeError,kte=ute("".slice),Wte=ute("".charCodeAt),Fte=function(e){var t,n,A,r,i,o,s,a,g=bte(e,"number");if(fte(g))throw new Nte("Cannot convert a Symbol value to a number");if("string"==typeof g&&g.length>2)if(g=vte(g),43===(t=Wte(g,0))||45===t){if(88===(n=Wte(g,2))||120===n)return NaN}else if(48===t){switch(Wte(g,1)){case 66:case 98:A=2,r=49;break;case 79:case 111:A=8,r=55;break;default:return+g}for(o=(i=kte(g,2)).length,s=0;s<o;s++)if((a=Wte(i,s))<48||a>r)return NaN;return parseInt(i,A)}return+g},Ete=dte(Gte,!Rte(" 0o1")||!Rte("0b1")||Rte("+0x1")),Xte=function(e){var t,n=arguments.length<1?0:Rte(function(e){var t=bte(e,"number");return"bigint"==typeof t?t:Fte(t)}(e));return pte(Vte,t=this)&&Bte((function(){Ste(t)}))?mte(Object(n),this,Xte):n};Xte.prototype=Vte,Ete&&(Vte.constructor=Xte),lte({global:!0,constructor:!0,wrap:!0,forced:Ete},{Number:Xte});Ete&&function(e,t){for(var n,A=cte?yte(t):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),r=0;A.length>r;r++)hte(t,n=A[r])&&!hte(e,n)&&Zte(e,n,wte(t,n))}(Cte[Gte],Rte),lL({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)});var Hte=lH.isFinite;lL({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&Hte(e)}});var xte=PH,Jte=Math.floor,Yte=Number.isInteger||function(e){return!xte(e)&&isFinite(e)&&Jte(e)===e};lL({target:"Number",stat:!0},{isInteger:Yte}),lL({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var Ute=lL,Lte=Yte,Tte=Math.abs;Ute({target:"Number",stat:!0},{isSafeInteger:function(e){return Lte(e)&&Tte(e)<=9007199254740991}}),lL({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),lL({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991});var Kte=lH,Mte=IH,Qte=yL,Dte=gte.trim,zte=tte,Ote=VH("".charAt),Pte=Kte.parseFloat,_te=Kte.Symbol,jte=_te&&_te.iterator,qte=1/Pte(zte+"-0")!=-1/0||jte&&!Mte((function(){Pte(Object(jte))}))?function(e){var t=Dte(Qte(e)),n=Pte(t);return 0===n&&"-"===Ote(t,0)?-0:n}:Pte,$te=qte;lL({target:"Number",stat:!0,forced:Number.parseFloat!==$te},{parseFloat:$te});var ene=lH,tne=IH,nne=VH,Ane=yL,rne=gte.trim,ine=tte,one=ene.parseInt,sne=ene.Symbol,ane=sne&&sne.iterator,gne=/^[+-]?0x/i,lne=nne(gne.exec),cne=8!==one(ine+"08")||22!==one(ine+"0x16")||ane&&!tne((function(){one(Object(ane))}))?function(e,t){var n=rne(Ane(e));return one(n,t>>>0||(lne(gne,n)?16:10))}:one,Ine=cne;lL({target:"Number",stat:!0,forced:Number.parseInt!==Ine},{parseInt:Ine});var Cne=lL,une=VH,dne=IU,hne=ete,mne=B3,pne=Mee,fne=IH,bne=RangeError,Bne=String,yne=isFinite,wne=Math.abs,Zne=Math.floor,Sne=Math.pow,vne=Math.round,Gne=une(1..toExponential),Rne=une(mne),Vne=une("".slice),Nne="-6.9000e-11"===Gne(-69e-12,4)&&"1.25e+0"===Gne(1.255,2)&&"1.235e+4"===Gne(12345,3)&&"3e+1"===Gne(25,0);Cne({target:"Number",proto:!0,forced:!Nne||!(fne((function(){Gne(1,1/0)}))&&fne((function(){Gne(1,-1/0)})))||!!fne((function(){Gne(1/0,1/0),Gne(NaN,1/0)}))},{toExponential:function(e){var t=hne(this);if(void 0===e)return Gne(t);var n=dne(e);if(!yne(t))return String(t);if(n<0||n>20)throw new bne("Incorrect fraction digits");if(Nne)return Gne(t,n);var A,r,i,o,s="";if(t<0&&(s="-",t=-t),0===t)r=0,A=Rne("0",n+1);else{var a=pne(t);r=Zne(a);var g=Sne(10,r-n),l=vne(t/g);2*t>=(2*l+1)*g&&(l+=1),l>=Sne(10,n+1)&&(l/=10,r+=1),A=Bne(l)}return 0!==n&&(A=Vne(A,0,1)+"."+Vne(A,1)),0===r?(i="+",o="0"):(i=r>0?"+":"-",o=Bne(wne(r))),s+(A+="e"+i+o)}});var kne=lL,Wne=VH,Fne=IU,Ene=ete,Xne=B3,Hne=IH,xne=RangeError,Jne=String,Yne=Math.floor,Une=Wne(Xne),Lne=Wne("".slice),Tne=Wne(1..toFixed),Kne=function(e,t,n){return 0===t?n:t%2==1?Kne(e,t-1,n*e):Kne(e*e,t/2,n)},Mne=function(e,t,n){for(var A=-1,r=n;++A<6;)r+=t*e[A],e[A]=r%1e7,r=Yne(r/1e7)},Qne=function(e,t){for(var n=6,A=0;--n>=0;)A+=e[n],e[n]=Yne(A/t),A=A%t*1e7},Dne=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var A=Jne(e[t]);n=""===n?A:n+Une("0",7-A.length)+A}return n};kne({target:"Number",proto:!0,forced:Hne((function(){return"0.000"!==Tne(8e-5,3)||"1"!==Tne(.9,0)||"1.25"!==Tne(1.255,2)||"1000000000000000128"!==Tne(0xde0b6b3a7640080,0)}))||!Hne((function(){Tne({})}))},{toFixed:function(e){var t,n,A,r,i=Ene(this),o=Fne(e),s=[0,0,0,0,0,0],a="",g="0";if(o<0||o>20)throw new xne("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return Jne(i);if(i<0&&(a="-",i=-i),i>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(i*Kne(2,69,1))-69)<0?i*Kne(2,-t,1):i/Kne(2,t,1),n*=4503599627370496,(t=52-t)>0){for(Mne(s,0,n),A=o;A>=7;)Mne(s,1e7,0),A-=7;for(Mne(s,Kne(10,A,1),0),A=t-1;A>=23;)Qne(s,1<<23),A-=23;Qne(s,1<<A),Mne(s,1,1),Qne(s,2),g=Dne(s)}else Mne(s,0,n),Mne(s,1<<-t,0),g=Dne(s)+Une("0",o);return g=o>0?a+((r=g.length)<=o?"0."+Une("0",o-r)+g:Lne(g,0,r-o)+"."+Lne(g,r-o)):a+g}});var zne=lL,One=IH,Pne=ete,_ne=VH(1..toPrecision);zne({target:"Number",proto:!0,forced:One((function(){return"1"!==_ne(1,void 0)}))||!One((function(){_ne({})}))},{toPrecision:function(e){return void 0===e?_ne(Pne(this)):_ne(Pne(this),e)}});var jne=CH,qne=VH,$ne=mH,eAe=IH,tAe=vL,nAe=HU,AAe=pH,rAe=zx,iAe=JH,oAe=Object.assign,sAe=Object.defineProperty,aAe=qne([].concat),gAe=!oAe||eAe((function(){if(jne&&1!==oAe({b:1},oAe(sAe({},"a",{enumerable:!0,get:function(){sAe(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol("assign detection"),A="abcdefghijklmnopqrst";return e[n]=7,A.split("").forEach((function(e){t[e]=e})),7!==oAe({},e)[n]||tAe(oAe({},t)).join("")!==A}))?function(e,t){for(var n=rAe(e),A=arguments.length,r=1,i=nAe.f,o=AAe.f;A>r;)for(var s,a=iAe(arguments[r++]),g=i?aAe(tAe(a),i(a)):tAe(a),l=g.length,c=0;l>c;)s=g[c++],jne&&!$ne(o,a,s)||(n[s]=a[s]);return n}:oAe,lAe=gAe;lL({target:"Object",stat:!0,arity:2,forced:Object.assign!==lAe},{assign:lAe}),lL({target:"Object",stat:!0,sham:!CH},{create:OL});var cAe=lH,IAe=Hq,CAe=!IH((function(){if(!(IAe&&IAe<535)){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete cAe[e]}})),uAe=Sx,dAe=zx,hAe=xJ;CH&&lL({target:"Object",proto:!0,forced:CAe},{__defineGetter__:function(e,t){hAe.f(dAe(this),e,{get:uAe(t),enumerable:!0,configurable:!0})}});var mAe=lL,pAe=CH,fAe=wL.f;mAe({target:"Object",stat:!0,forced:Object.defineProperties!==fAe,sham:!pAe},{defineProperties:fAe});var bAe=lL,BAe=CH,yAe=xJ.f;bAe({target:"Object",stat:!0,forced:Object.defineProperty!==yAe,sham:!BAe},{defineProperty:yAe});var wAe=Sx,ZAe=zx,SAe=xJ;CH&&lL({target:"Object",proto:!0,forced:CAe},{__defineSetter__:function(e,t){SAe.f(ZAe(this),e,{set:wAe(t),enumerable:!0,configurable:!0})}});var vAe=CH,GAe=IH,RAe=VH,VAe=Az,NAe=vL,kAe=QH,WAe=RAe(pH.f),FAe=RAe([].push),EAe=vAe&&GAe((function(){var e=Object.create(null);return e[2]=2,!WAe(e,2)})),XAe=function(e){return function(t){for(var n,A=kAe(t),r=NAe(A),i=EAe&&null===VAe(A),o=r.length,s=0,a=[];o>s;)n=r[s++],vAe&&!(i?n in A:WAe(A,n))||FAe(a,e?[n,A[n]]:A[n]);return a}},HAe={entries:XAe(!0),values:XAe(!1)},xAe=HAe.entries;lL({target:"Object",stat:!0},{entries:function(e){return xAe(e)}});var JAe=lL,YAe=P6,UAe=IH,LAe=PH,TAe=c7.onFreeze,KAe=Object.freeze;JAe({target:"Object",stat:!0,forced:UAe((function(){KAe(1)})),sham:!YAe},{freeze:function(e){return KAe&&LAe(e)?KAe(TAe(e)):e}});var MAe=Yz,QAe=SO;lL({target:"Object",stat:!0},{fromEntries:function(e){var t={};return MAe(e,(function(e,n){QAe(t,e,n)}),{AS_ENTRIES:!0}),t}});var DAe=lL,zAe=IH,OAe=QH,PAe=cH.f,_Ae=CH;DAe({target:"Object",stat:!0,forced:!_Ae||zAe((function(){PAe(1)})),sham:!_Ae},{getOwnPropertyDescriptor:function(e,t){return PAe(OAe(e),t)}});var jAe=TU,qAe=QH,$Ae=cH,ere=SO;lL({target:"Object",stat:!0,sham:!CH},{getOwnPropertyDescriptors:function(e){for(var t,n,A=qAe(e),r=$Ae.f,i=jAe(A),o={},s=0;i.length>s;)void 0!==(n=r(A,t=i[s++]))&&ere(o,t,n);return o}});var tre=lL,nre=IH,Are=PL.f;tre({target:"Object",stat:!0,forced:nre((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:Are});var rre=zx,ire=Az,ore=PD;lL({target:"Object",stat:!0,forced:IH((function(){ire(1)})),sham:!ore},{getPrototypeOf:function(e){return ire(rre(e))}});var sre=lL,are=qH,gre=VH,lre=Sx,cre=TH,Ire=BJ,Cre=Yz,ure=IH,dre=Object.groupBy,hre=are("Object","create"),mre=gre([].push);sre({target:"Object",stat:!0,forced:!dre||ure((function(){return 1!==dre("ab",(function(e){return e})).a.length}))},{groupBy:function(e,t){cre(e),lre(t);var n=hre(null),A=0;return Cre(e,(function(e){var r=Ire(t(e,A++));r in n?mre(n[r],e):n[r]=[e]})),n}}),lL({target:"Object",stat:!0},{hasOwn:_x});var pre=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};lL({target:"Object",stat:!0},{is:pre});var fre=O6;lL({target:"Object",stat:!0,forced:Object.isExtensible!==fre},{isExtensible:fre});var bre=lL,Bre=IH,yre=PH,wre=FH,Zre=T6,Sre=Object.isFrozen;bre({target:"Object",stat:!0,forced:Zre||Bre((function(){Sre(1)}))},{isFrozen:function(e){return!yre(e)||(!(!Zre||"ArrayBuffer"!==wre(e))||!!Sre&&Sre(e))}});var vre=lL,Gre=IH,Rre=PH,Vre=FH,Nre=T6,kre=Object.isSealed;vre({target:"Object",stat:!0,forced:Nre||Gre((function(){kre(1)}))},{isSealed:function(e){return!Rre(e)||(!(!Nre||"ArrayBuffer"!==Vre(e))||!!kre&&kre(e))}});var Wre=zx,Fre=vL;lL({target:"Object",stat:!0,forced:IH((function(){Fre(1)}))},{keys:function(e){return Fre(Wre(e))}});var Ere=lL,Xre=CH,Hre=CAe,xre=zx,Jre=BJ,Yre=Az,Ure=cH.f;Xre&&Ere({target:"Object",proto:!0,forced:Hre},{__lookupGetter__:function(e){var t,n=xre(this),A=Jre(e);do{if(t=Ure(n,A))return t.get}while(n=Yre(n))}});var Lre=lL,Tre=CH,Kre=CAe,Mre=zx,Qre=BJ,Dre=Az,zre=cH.f;Tre&&Lre({target:"Object",proto:!0,forced:Kre},{__lookupSetter__:function(e){var t,n=Mre(this),A=Qre(e);do{if(t=zre(n,A))return t.set}while(n=Dre(n))}});var Ore=lL,Pre=PH,_re=c7.onFreeze,jre=P6,qre=IH,$re=Object.preventExtensions;Ore({target:"Object",stat:!0,forced:qre((function(){$re(1)})),sham:!jre},{preventExtensions:function(e){return $re&&Pre(e)?$re(_re(e)):e}});var eie=CH,tie=rT,nie=PH,Aie=YQ,rie=zx,iie=TH,oie=Object.getPrototypeOf,sie=Object.setPrototypeOf,aie=Object.prototype,gie="__proto__";if(eie&&oie&&sie&&!(gie in aie))try{tie(aie,gie,{configurable:!0,get:function(){return oie(rie(this))},set:function(e){var t=iie(this);Aie(e)&&nie(t)&&sie(t,e)}})}catch(PWe){}var lie=lL,cie=PH,Iie=c7.onFreeze,Cie=P6,uie=IH,die=Object.seal;lie({target:"Object",stat:!0,forced:uie((function(){die(1)})),sham:!Cie},{seal:function(e){return die&&cie(e)?die(Iie(e)):e}}),lL({target:"Object",stat:!0},{setPrototypeOf:OQ});var hie=fL,mie=IL?{}.toString:function(){return"[object "+hie(this)+"]"};IL||oU(Object.prototype,"toString",mie,{unsafe:!0});var pie=HAe.values;lL({target:"Object",stat:!0},{values:function(e){return pie(e)}});lL({global:!0,forced:parseFloat!==qte},{parseFloat:qte});lL({global:!0,forced:parseInt!==cne},{parseInt:cne});var fie,bie,Bie,yie,wie=KT,Zie=Bx,Sie=TypeError,vie=function(e){if(wie(e))return e;throw new Sie(Zie(e)+" is not a constructor")},Gie=TJ,Rie=vie,Vie=YH,Nie=lJ("species"),kie=function(e,t){var n,A=Gie(e).constructor;return void 0===A||Vie(n=Gie(A)[Nie])?t:Rie(n)},Wie=TypeError,Fie=function(e,t){if(e<t)throw new Wie("Not enough arguments");return e},Eie=/(?:ipad|iphone|ipod).*applewebkit/i.test(nx),Xie=lH,Hie=EM,xie=RT,Jie=zH,Yie=_x,Uie=IH,Lie=EL,Tie=_L,Kie=SJ,Mie=Fie,Qie=Eie,Die=oq,zie=Xie.setImmediate,Oie=Xie.clearImmediate,Pie=Xie.process,_ie=Xie.Dispatch,jie=Xie.Function,qie=Xie.MessageChannel,$ie=Xie.String,eoe=0,toe={},noe="onreadystatechange";Uie((function(){fie=Xie.location}));var Aoe=function(e){if(Yie(toe,e)){var t=toe[e];delete toe[e],t()}},roe=function(e){return function(){Aoe(e)}},ioe=function(e){Aoe(e.data)},ooe=function(e){Xie.postMessage($ie(e),fie.protocol+"//"+fie.host)};zie&&Oie||(zie=function(e){Mie(arguments.length,1);var t=Jie(e)?e:jie(e),n=Tie(arguments,1);return toe[++eoe]=function(){Hie(t,void 0,n)},bie(eoe),eoe},Oie=function(e){delete toe[e]},Die?bie=function(e){Pie.nextTick(roe(e))}:_ie&&_ie.now?bie=function(e){_ie.now(roe(e))}:qie&&!Qie?(yie=(Bie=new qie).port2,Bie.port1.onmessage=ioe,bie=xie(yie.postMessage,yie)):Xie.addEventListener&&Jie(Xie.postMessage)&&!Xie.importScripts&&fie&&"file:"!==fie.protocol&&!Uie(ooe)?(bie=ooe,Xie.addEventListener("message",ioe,!1)):bie=noe in Kie("script")?function(e){Lie.appendChild(Kie("script"))[noe]=function(){Lie.removeChild(this),Aoe(e)}}:function(e){setTimeout(roe(e),0)});var soe={set:zie,clear:Oie},aoe=lH,goe=CH,loe=Object.getOwnPropertyDescriptor,coe=function(e){if(!goe)return aoe[e];var t=loe(aoe,e);return t&&t.value},Ioe=function(){this.head=null,this.tail=null};Ioe.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Coe,uoe,doe,hoe,moe,poe=Ioe,foe=/ipad|iphone|ipod/i.test(nx)&&"undefined"!=typeof Pebble,boe=/web0s(?!.*chrome)/i.test(nx),Boe=lH,yoe=coe,woe=RT,Zoe=soe.set,Soe=poe,voe=Eie,Goe=foe,Roe=boe,Voe=oq,Noe=Boe.MutationObserver||Boe.WebKitMutationObserver,koe=Boe.document,Woe=Boe.process,Foe=Boe.Promise,Eoe=yoe("queueMicrotask");if(!Eoe){var Xoe=new Soe,Hoe=function(){var e,t;for(Voe&&(e=Woe.domain)&&e.exit();t=Xoe.get();)try{t()}catch(PWe){throw Xoe.head&&Coe(),PWe}e&&e.enter()};voe||Voe||Roe||!Noe||!koe?!Goe&&Foe&&Foe.resolve?((hoe=Foe.resolve(void 0)).constructor=Foe,moe=woe(hoe.then,hoe),Coe=function(){moe(Hoe)}):Voe?Coe=function(){Woe.nextTick(Hoe)}:(Zoe=woe(Zoe,Boe),Coe=function(){Zoe(Hoe)}):(uoe=!0,doe=koe.createTextNode(""),new Noe(Hoe).observe(doe,{characterData:!0}),Coe=function(){doe.data=uoe=!uoe}),Eoe=function(e){Xoe.head||Coe(),Xoe.add(e)}}var xoe=Eoe,Joe=function(e){try{return{error:!1,value:e()}}catch(PWe){return{error:!0,value:PWe}}},Yoe=lH.Promise,Uoe=lH,Loe=Yoe,Toe=zH,Koe=nL,Moe=hY,Qoe=lJ,Doe=iq,zoe=gx;Loe&&Loe.prototype;var Ooe=Qoe("species"),Poe=!1,_oe=Toe(Uoe.PromiseRejectionEvent),joe={CONSTRUCTOR:Koe("Promise",(function(){var e=Moe(Loe),t=e!==String(Loe);if(!t&&66===zoe)return!0;if(!zoe||zoe<51||!/native code/.test(e)){var n=new Loe((function(e){e(1)})),A=function(e){e((function(){}),(function(){}))};if((n.constructor={})[Ooe]=A,!(Poe=n.then((function(){}))instanceof A))return!0}return!(t||"BROWSER"!==Doe&&"DENO"!==Doe||_oe)})),REJECTION_EVENT:_oe,SUBCLASSING:Poe},qoe={},$oe=Sx,ese=TypeError,tse=function(e){var t,n;this.promise=new e((function(e,A){if(void 0!==t||void 0!==n)throw new ese("Bad Promise constructor");t=e,n=A})),this.resolve=$oe(t),this.reject=$oe(n)};qoe.f=function(e){return new tse(e)};var nse,Ase,rse,ise=lL,ose=oq,sse=lH,ase=mH,gse=oU,lse=OQ,cse=BT,Ise=a$,Cse=Sx,use=zH,dse=PH,hse=c0,mse=kie,pse=soe.set,fse=xoe,bse=function(e,t){},Bse=Joe,yse=poe,wse=xY,Zse=Yoe,Sse=qoe,vse="Promise",Gse=joe.CONSTRUCTOR,Rse=joe.REJECTION_EVENT,Vse=joe.SUBCLASSING,Nse=wse.getterFor(vse),kse=wse.set,Wse=Zse&&Zse.prototype,Fse=Zse,Ese=Wse,Xse=sse.TypeError,Hse=sse.document,xse=sse.process,Jse=Sse.f,Yse=Jse,Use=!!(Hse&&Hse.createEvent&&sse.dispatchEvent),Lse="unhandledrejection",Tse=function(e){var t;return!(!dse(e)||!use(t=e.then))&&t},Kse=function(e,t){var n,A,r,i=t.value,o=1===t.state,s=o?e.ok:e.fail,a=e.resolve,g=e.reject,l=e.domain;try{s?(o||(2===t.rejection&&Ose(t),t.rejection=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),r=!0)),n===e.promise?g(new Xse("Promise-chain cycle")):(A=Tse(n))?ase(A,n,a,g):a(n)):g(i)}catch(PWe){l&&!r&&l.exit(),g(PWe)}},Mse=function(e,t){e.notified||(e.notified=!0,fse((function(){for(var n,A=e.reactions;n=A.get();)Kse(n,e);e.notified=!1,t&&!e.rejection&&Dse(e)})))},Qse=function(e,t,n){var A,r;Use?((A=Hse.createEvent("Event")).promise=t,A.reason=n,A.initEvent(e,!1,!0),sse.dispatchEvent(A)):A={promise:t,reason:n},!Rse&&(r=sse["on"+e])?r(A):e===Lse&&bse("Unhandled promise rejection",n)},Dse=function(e){ase(pse,sse,(function(){var t,n=e.facade,A=e.value;if(zse(e)&&(t=Bse((function(){ose?xse.emit("unhandledRejection",A,n):Qse(Lse,n,A)})),e.rejection=ose||zse(e)?2:1,t.error))throw t.value}))},zse=function(e){return 1!==e.rejection&&!e.parent},Ose=function(e){ase(pse,sse,(function(){var t=e.facade;ose?xse.emit("rejectionHandled",t):Qse("rejectionhandled",t,e.value)}))},Pse=function(e,t,n){return function(A){e(t,A,n)}},_se=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Mse(e,!0))},jse=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw new Xse("Promise can't be resolved itself");var A=Tse(t);A?fse((function(){var n={done:!1};try{ase(A,t,Pse(jse,n,e),Pse(_se,n,e))}catch(PWe){_se(n,PWe,e)}})):(e.value=t,e.state=1,Mse(e,!1))}catch(PWe){_se({done:!1},PWe,e)}}};if(Gse&&(Ese=(Fse=function(e){hse(this,Ese),Cse(e),ase(nse,this);var t=Nse(this);try{e(Pse(jse,t),Pse(_se,t))}catch(PWe){_se(t,PWe)}}).prototype,(nse=function(e){kse(this,{type:vse,done:!1,notified:!1,parent:!1,reactions:new yse,rejection:!1,state:0,value:null})}).prototype=gse(Ese,"then",(function(e,t){var n=Nse(this),A=Jse(mse(this,Fse));return n.parent=!0,A.ok=!use(e)||e,A.fail=use(t)&&t,A.domain=ose?xse.domain:void 0,0===n.state?n.reactions.add(A):fse((function(){Kse(A,n)})),A.promise})),Ase=function(){var e=new nse,t=Nse(e);this.promise=e,this.resolve=Pse(jse,t),this.reject=Pse(_se,t)},Sse.f=Jse=function(e){return e===Fse||undefined===e?new Ase(e):Yse(e)},use(Zse)&&Wse!==Object.prototype)){rse=Wse.then,Vse||gse(Wse,"then",(function(e,t){var n=this;return new Fse((function(e,t){ase(rse,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete Wse.constructor}catch(PWe){}lse&&lse(Wse,Ese)}ise({global:!0,constructor:!0,wrap:!0,forced:Gse},{Promise:Fse}),cse(Fse,vse,!1),Ise(vse);var qse=Yoe,$se=joe.CONSTRUCTOR||!I_((function(e){qse.all(e).then(void 0,(function(){}))})),eae=mH,tae=Sx,nae=qoe,Aae=Joe,rae=Yz;lL({target:"Promise",stat:!0,forced:$se},{all:function(e){var t=this,n=nae.f(t),A=n.resolve,r=n.reject,i=Aae((function(){var n=tae(t.resolve),i=[],o=0,s=1;rae(e,(function(e){var a=o++,g=!1;s++,eae(n,t,e).then((function(e){g||(g=!0,i[a]=e,--s||A(i))}),r)})),--s||A(i)}));return i.error&&r(i.value),n.promise}});var iae=lL,oae=joe.CONSTRUCTOR,sae=Yoe,aae=qH,gae=zH,lae=oU,cae=sae&&sae.prototype;if(iae({target:"Promise",proto:!0,forced:oae,real:!0},{catch:function(e){return this.then(void 0,e)}}),gae(sae)){var Iae=aae("Promise").prototype.catch;cae.catch!==Iae&&lae(cae,"catch",Iae,{unsafe:!0})}var Cae=mH,uae=Sx,dae=qoe,hae=Joe,mae=Yz;lL({target:"Promise",stat:!0,forced:$se},{race:function(e){var t=this,n=dae.f(t),A=n.reject,r=hae((function(){var r=uae(t.resolve);mae(e,(function(e){Cae(r,t,e).then(n.resolve,A)}))}));return r.error&&A(r.value),n.promise}});var pae=qoe;lL({target:"Promise",stat:!0,forced:joe.CONSTRUCTOR},{reject:function(e){var t=pae.f(this);return(0,t.reject)(e),t.promise}});var fae=TJ,bae=PH,Bae=qoe,yae=function(e,t){if(fae(e),bae(t)&&t.constructor===e)return t;var n=Bae.f(e);return(0,n.resolve)(t),n.promise},wae=lL,Zae=joe.CONSTRUCTOR,Sae=yae;qH("Promise"),wae({target:"Promise",stat:!0,forced:Zae},{resolve:function(e){return Sae(this,e)}});var vae=mH,Gae=Sx,Rae=qoe,Vae=Joe,Nae=Yz;lL({target:"Promise",stat:!0,forced:$se},{allSettled:function(e){var t=this,n=Rae.f(t),A=n.resolve,r=n.reject,i=Vae((function(){var n=Gae(t.resolve),r=[],i=0,o=1;Nae(e,(function(e){var s=i++,a=!1;o++,vae(n,t,e).then((function(e){a||(a=!0,r[s]={status:"fulfilled",value:e},--o||A(r))}),(function(e){a||(a=!0,r[s]={status:"rejected",reason:e},--o||A(r))}))})),--o||A(r)}));return i.error&&r(i.value),n.promise}});var kae=mH,Wae=Sx,Fae=qH,Eae=qoe,Xae=Joe,Hae=Yz,xae="No one promise resolved";lL({target:"Promise",stat:!0,forced:$se},{any:function(e){var t=this,n=Fae("AggregateError"),A=Eae.f(t),r=A.resolve,i=A.reject,o=Xae((function(){var A=Wae(t.resolve),o=[],s=0,a=1,g=!1;Hae(e,(function(e){var l=s++,c=!1;a++,kae(A,t,e).then((function(e){c||g||(g=!0,r(e))}),(function(e){c||g||(c=!0,o[l]=e,--a||i(new n(o,xae)))}))})),--a||i(new n(o,xae))}));return o.error&&i(o.value),A.promise}});var Jae=lL,Yae=Yoe,Uae=IH,Lae=qH,Tae=zH,Kae=kie,Mae=yae,Qae=oU,Dae=Yae&&Yae.prototype;if(Jae({target:"Promise",proto:!0,real:!0,forced:!!Yae&&Uae((function(){Dae.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=Kae(this,Lae("Promise")),n=Tae(e);return this.then(n?function(n){return Mae(t,e()).then((function(){return n}))}:e,n?function(n){return Mae(t,e()).then((function(){throw n}))}:e)}}),Tae(Yae)){var zae=Lae("Promise").prototype.finally;Dae.finally!==zae&&Qae(Dae,"finally",zae,{unsafe:!0})}var Oae=lL,Pae=EM,_ae=_L,jae=qoe,qae=Sx,$ae=Joe,ege=lH.Promise,tge=!1;Oae({target:"Promise",stat:!0,forced:!ege||!ege.try||$ae((function(){ege.try((function(e){tge=8===e}),8)})).error||!tge},{try:function(e){var t=arguments.length>1?_ae(arguments,1):[],n=jae.f(this),A=$ae((function(){return Pae(qae(e),void 0,t)}));return(A.error?n.reject:n.resolve)(A.value),n.promise}});var nge=qoe;lL({target:"Promise",stat:!0},{withResolvers:function(){var e=nge.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Age=EM,rge=Sx,ige=TJ;lL({target:"Reflect",stat:!0,forced:!IH((function(){Reflect.apply((function(){}))}))},{apply:function(e,t,n){return Age(rge(e),t,ige(n))}});var oge=lL,sge=EM,age=k4,gge=vie,lge=TJ,cge=PH,Ige=OL,Cge=IH,uge=qH("Reflect","construct"),dge=Object.prototype,hge=[].push,mge=Cge((function(){function e(){}return!(uge((function(){}),[],e)instanceof e)})),pge=!Cge((function(){uge((function(){}))})),fge=mge||pge;oge({target:"Reflect",stat:!0,forced:fge,sham:fge},{construct:function(e,t){gge(e),lge(t);var n=arguments.length<3?e:gge(arguments[2]);if(pge&&!mge)return uge(e,t,n);if(e===n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var A=[null];return sge(hge,A,t),new(sge(age,e,A))}var r=n.prototype,i=Ige(cge(r)?r:dge),o=sge(e,i,t);return cge(o)?o:i}});var bge=CH,Bge=TJ,yge=BJ,wge=xJ;lL({target:"Reflect",stat:!0,forced:IH((function(){Reflect.defineProperty(wge.f({},1,{value:1}),1,{value:2})})),sham:!bge},{defineProperty:function(e,t,n){Bge(e);var A=yge(t);Bge(n);try{return wge.f(e,A,n),!0}catch(PWe){return!1}}});var Zge=lL,Sge=TJ,vge=cH.f;Zge({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=vge(Sge(e),t);return!(n&&!n.configurable)&&delete e[t]}});var Gge=_x,Rge=function(e){return void 0!==e&&(Gge(e,"value")||Gge(e,"writable"))},Vge=mH,Nge=PH,kge=TJ,Wge=Rge,Fge=cH,Ege=Az;lL({target:"Reflect",stat:!0},{get:function e(t,n){var A,r,i=arguments.length<3?t:arguments[2];return kge(t)===i?t[n]:(A=Fge.f(t,n))?Wge(A)?A.value:void 0===A.get?void 0:Vge(A.get,i):Nge(r=Ege(t))?e(r,n,i):void 0}});var Xge=TJ,Hge=cH;lL({target:"Reflect",stat:!0,sham:!CH},{getOwnPropertyDescriptor:function(e,t){return Hge.f(Xge(e),t)}});var xge=TJ,Jge=Az;lL({target:"Reflect",stat:!0,sham:!PD},{getPrototypeOf:function(e){return Jge(xge(e))}}),lL({target:"Reflect",stat:!0},{has:function(e,t){return t in e}});var Yge=TJ,Uge=O6;lL({target:"Reflect",stat:!0},{isExtensible:function(e){return Yge(e),Uge(e)}}),lL({target:"Reflect",stat:!0},{ownKeys:TU});var Lge=qH,Tge=TJ;lL({target:"Reflect",stat:!0,sham:!P6},{preventExtensions:function(e){Tge(e);try{var t=Lge("Object","preventExtensions");return t&&t(e),!0}catch(PWe){return!1}}});var Kge=mH,Mge=TJ,Qge=PH,Dge=Rge,zge=xJ,Oge=cH,Pge=Az,_ge=ZH;lL({target:"Reflect",stat:!0,forced:IH((function(){var e=function(){},t=zge.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,n,A){var r,i,o,s=arguments.length<4?t:arguments[3],a=Oge.f(Mge(t),n);if(!a){if(Qge(i=Pge(t)))return e(i,n,A,s);a=_ge(0)}if(Dge(a)){if(!1===a.writable||!Qge(s))return!1;if(r=Oge.f(s,n)){if(r.get||r.set||!1===r.writable)return!1;r.value=A,zge.f(s,n,r)}else zge.f(s,n,_ge(0,A))}else{if(void 0===(o=a.set))return!1;Kge(o,s,A)}return!0}});var jge=TJ,qge=KQ,$ge=OQ;$ge&&lL({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){jge(e),qge(t);try{return $ge(e,t),!0}catch(PWe){return!1}}});var ele=lH,tle=BT;lL({global:!0},{Reflect:{}}),tle(ele.Reflect,"Reflect",!0);var nle=PH,Ale=FH,rle=lJ("match"),ile=function(e){var t;return nle(e)&&(void 0!==(t=e[rle])?!!t:"RegExp"===Ale(e))},ole=TJ,sle=function(){var e=ole(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ale=mH,gle=_x,lle=$H,cle=sle,Ile=RegExp.prototype,Cle=function(e){var t=e.flags;return void 0!==t||"flags"in Ile||gle(e,"flags")||!lle(Ile,e)?t:ale(cle,e)},ule=IH,dle=lH.RegExp,hle=ule((function(){var e=dle("a","y");return e.lastIndex=2,null!==e.exec("abcd")})),mle=hle||ule((function(){return!dle("a","y").sticky})),ple=hle||ule((function(){var e=dle("^r","gy");return e.lastIndex=2,null!==e.exec("str")})),fle={BROKEN_CARET:ple,MISSED_STICKY:mle,UNSUPPORTED_Y:hle},ble=IH,Ble=lH.RegExp,yle=ble((function(){var e=Ble(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)})),wle=IH,Zle=lH.RegExp,Sle=wle((function(){var e=Zle("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),vle=CH,Gle=lH,Rle=VH,Vle=nL,Nle=eD,kle=nY,Wle=OL,Fle=sU.f,Ele=$H,Xle=ile,Hle=yL,xle=Cle,Jle=fle,Yle=_Q,Ule=oU,Lle=IH,Tle=_x,Kle=xY.enforce,Mle=a$,Qle=yle,Dle=Sle,zle=lJ("match"),Ole=Gle.RegExp,Ple=Ole.prototype,_le=Gle.SyntaxError,jle=Rle(Ple.exec),qle=Rle("".charAt),$le=Rle("".replace),ece=Rle("".indexOf),tce=Rle("".slice),nce=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Ace=/a/g,rce=/a/g,ice=new Ole(Ace)!==Ace,oce=Jle.MISSED_STICKY,sce=Jle.UNSUPPORTED_Y,ace=vle&&(!ice||oce||Qle||Dle||Lle((function(){return rce[zle]=!1,Ole(Ace)!==Ace||Ole(rce)===rce||"/a/i"!==String(Ole(Ace,"i"))})));if(Vle("RegExp",ace)){for(var gce=function(e,t){var n,A,r,i,o,s,a=Ele(Ple,this),g=Xle(e),l=void 0===t,c=[],I=e;if(!a&&g&&l&&e.constructor===gce)return e;if((g||Ele(Ple,e))&&(e=e.source,l&&(t=xle(I))),e=void 0===e?"":Hle(e),t=void 0===t?"":Hle(t),I=e,Qle&&"dotAll"in Ace&&(A=!!t&&ece(t,"s")>-1)&&(t=$le(t,/s/g,"")),n=t,oce&&"sticky"in Ace&&(r=!!t&&ece(t,"y")>-1)&&sce&&(t=$le(t,/y/g,"")),Dle&&(i=function(e){for(var t,n=e.length,A=0,r="",i=[],o=Wle(null),s=!1,a=!1,g=0,l="";A<=n;A++){if("\\"===(t=qle(e,A)))t+=qle(e,++A);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:if(r+=t,"?:"===tce(e,A+1,A+3))continue;jle(nce,tce(e,A+1))&&(A+=2,a=!0),g++;continue;case">"===t&&a:if(""===l||Tle(o,l))throw new _le("Invalid capture group name");o[l]=!0,i[i.length]=[l,g],a=!1,l="";continue}a?l+=t:r+=t}return[r,i]}(e),e=i[0],c=i[1]),o=Nle(Ole(e,t),a?this:Ple,gce),(A||r||c.length)&&(s=Kle(o),A&&(s.dotAll=!0,s.raw=gce(function(e){for(var t,n=e.length,A=0,r="",i=!1;A<=n;A++)"\\"!==(t=qle(e,A))?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),r+=t):r+="[\\s\\S]":r+=t+qle(e,++A);return r}(e),n)),r&&(s.sticky=!0),c.length&&(s.groups=c)),e!==I)try{kle(o,"source",""===I?"(?:)":I)}catch(PWe){}return o},lce=Fle(Ole),cce=0;lce.length>cce;)Yle(gce,Ole,lce[cce++]);Ple.constructor=gce,gce.prototype=Ple,Ule(Gle,"RegExp",gce,{constructor:!0})}Mle("RegExp");var Ice=TypeError,Cce=lL,uce=VH,dce=function(e){if("string"==typeof e)return e;throw new Ice("Argument is not a string")},hce=_x,mce=N3.start,pce=tte,fce=Array,bce=RegExp.escape,Bce=uce("".charAt),yce=uce("".charCodeAt),wce=uce(1.1.toString),Zce=uce([].join),Sce=/^[0-9a-z]/i,vce=/^[$()*+./?[\\\]^{|}]/,Gce=RegExp("^[!\"#%&',\\-:;<=>@`~"+pce+"]"),Rce=uce(Sce.exec),Vce={"\t":"t","\n":"n","\v":"v","\f":"f","\r":"r"},Nce=function(e){var t=wce(yce(e,0),16);return t.length<3?"\\x"+mce(t,2,"0"):"\\u"+mce(t,4,"0")};Cce({target:"RegExp",stat:!0,forced:!bce||"\\x61b"!==bce("ab")},{escape:function(e){dce(e);for(var t=e.length,n=fce(t),A=0;A<t;A++){var r=Bce(e,A);if(0===A&&Rce(Sce,r))n[A]=Nce(r);else if(hce(Vce,r))n[A]="\\"+Vce[r];else if(Rce(vce,r))n[A]="\\"+r;else if(Rce(Gce,r))n[A]=Nce(r);else{var i=yce(r,0);55296!=(63488&i)?n[A]=r:i>=56320||A+1>=t||56320!=(64512&yce(e,A+1))?n[A]=Nce(r):(n[A]=r,n[++A]=Bce(e,A))}}return Zce(n,"")}});var kce=CH,Wce=yle,Fce=FH,Ece=rT,Xce=xY.get,Hce=RegExp.prototype,xce=TypeError;kce&&Wce&&Ece(Hce,"dotAll",{configurable:!0,get:function(){if(this!==Hce){if("RegExp"===Fce(this))return!!Xce(this).dotAll;throw new xce("Incompatible receiver, RegExp required")}}});var Jce,Yce,Uce=mH,Lce=VH,Tce=yL,Kce=sle,Mce=fle,Qce=OL,Dce=xY.get,zce=yle,Oce=Sle,Pce=Mx("native-string-replace",String.prototype.replace),_ce=RegExp.prototype.exec,jce=_ce,qce=Lce("".charAt),$ce=Lce("".indexOf),eIe=Lce("".replace),tIe=Lce("".slice),nIe=(Yce=/b*/g,Uce(_ce,Jce=/a/,"a"),Uce(_ce,Yce,"a"),0!==Jce.lastIndex||0!==Yce.lastIndex),AIe=Mce.BROKEN_CARET,rIe=void 0!==/()??/.exec("")[1];(nIe||rIe||AIe||zce||Oce)&&(jce=function(e){var t,n,A,r,i,o,s,a=this,g=Dce(a),l=Tce(e),c=g.raw;if(c)return c.lastIndex=a.lastIndex,t=Uce(jce,c,l),a.lastIndex=c.lastIndex,t;var I=g.groups,C=AIe&&a.sticky,u=Uce(Kce,a),d=a.source,h=0,m=l;if(C&&(u=eIe(u,"y",""),-1===$ce(u,"g")&&(u+="g"),m=tIe(l,a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==qce(l,a.lastIndex-1))&&(d="(?: "+d+")",m=" "+m,h++),n=new RegExp("^(?:"+d+")",u)),rIe&&(n=new RegExp("^"+d+"$(?!\\s)",u)),nIe&&(A=a.lastIndex),r=Uce(_ce,C?n:a,m),C?r?(r.input=tIe(r.input,h),r[0]=tIe(r[0],h),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:nIe&&r&&(a.lastIndex=a.global?r.index+r[0].length:A),rIe&&r&&r.length>1&&Uce(Pce,r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r&&I)for(r.groups=o=Qce(null),i=0;i<I.length;i++)o[(s=I[i])[0]]=r[s[1]];return r});var iIe=jce;lL({target:"RegExp",proto:!0,forced:/./.exec!==iIe},{exec:iIe});var oIe=CH,sIe=rT,aIe=sle,gIe=IH,lIe=lH.RegExp,cIe=lIe.prototype,IIe=oIe&&gIe((function(){var e=!0;try{lIe(".","d")}catch(PWe){e=!1}var t={},n="",A=e?"dgimsy":"gimsy",r=function(e,A){Object.defineProperty(t,e,{get:function(){return n+=A,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in e&&(i.hasIndices="d"),i)r(o,i[o]);return Object.getOwnPropertyDescriptor(cIe,"flags").get.call(t)!==A||n!==A}));IIe&&sIe(cIe,"flags",{configurable:!0,get:aIe});var CIe=CH,uIe=fle.MISSED_STICKY,dIe=FH,hIe=rT,mIe=xY.get,pIe=RegExp.prototype,fIe=TypeError;CIe&&uIe&&hIe(pIe,"sticky",{configurable:!0,get:function(){if(this!==pIe){if("RegExp"===dIe(this))return!!mIe(this).sticky;throw new fIe("Incompatible receiver, RegExp required")}}});var bIe,BIe,yIe=lL,wIe=mH,ZIe=zH,SIe=TJ,vIe=yL,GIe=(bIe=!1,(BIe=/[ac]/).exec=function(){return bIe=!0,/./.exec.apply(this,arguments)},!0===BIe.test("abc")&&bIe),RIe=/./.test;yIe({target:"RegExp",proto:!0,forced:!GIe},{test:function(e){var t=SIe(this),n=vIe(e),A=t.exec;if(!ZIe(A))return wIe(RIe,t,n);var r=wIe(A,t,n);return null!==r&&(SIe(r),!0)}});var VIe=gY.PROPER,NIe=oU,kIe=TJ,WIe=yL,FIe=IH,EIe=Cle,XIe="toString",HIe=RegExp.prototype,xIe=HIe[XIe],JIe=FIe((function(){return"/a/b"!==xIe.call({source:"a",flags:"b"})})),YIe=VIe&&xIe.name!==XIe;(JIe||YIe)&&NIe(HIe,XIe,(function(){var e=kIe(this);return"/"+WIe(e.source)+"/"+WIe(EIe(e))}),{unsafe:!0}),G7("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),T7);var UIe=VH,LIe=Set.prototype,TIe={Set:Set,add:UIe(LIe.add),has:UIe(LIe.has),remove:UIe(LIe.delete),proto:LIe},KIe=TIe.has,MIe=function(e){return KIe(e),e},QIe=mH,DIe=function(e,t,n){for(var A,r,i=n?e:e.iterator,o=e.next;!(A=QIe(o,i)).done;)if(void 0!==(r=t(A.value)))return r},zIe=VH,OIe=DIe,PIe=TIe.Set,_Ie=TIe.proto,jIe=zIe(_Ie.forEach),qIe=zIe(_Ie.keys),$Ie=qIe(new PIe).next,eCe=function(e,t,n){return n?OIe({iterator:qIe(e),next:$Ie},t):jIe(e,t)},tCe=eCe,nCe=TIe.Set,ACe=TIe.add,rCe=function(e){var t=new nCe;return tCe(e,(function(e){ACe(t,e)})),t},iCe=xQ(TIe.proto,"size","get")||function(e){return e.size},oCe=Sx,sCe=TJ,aCe=mH,gCe=IU,lCe=d9,cCe="Invalid size",ICe=RangeError,CCe=TypeError,uCe=Math.max,dCe=function(e,t){this.set=e,this.size=uCe(t,0),this.has=oCe(e.has),this.keys=oCe(e.keys)};dCe.prototype={getIterator:function(){return lCe(sCe(aCe(this.keys,this.set)))},includes:function(e){return aCe(this.has,this.set,e)}};var hCe=function(e){sCe(e);var t=+e.size;if(t!=t)throw new CCe(cCe);var n=gCe(t);if(n<0)throw new ICe(cCe);return new dCe(e,n)},mCe=MIe,pCe=rCe,fCe=iCe,bCe=hCe,BCe=eCe,yCe=DIe,wCe=TIe.has,ZCe=TIe.remove,SCe=qH,vCe=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},GCe=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}},RCe=function(e,t){var n=SCe("Set");try{(new n)[e](vCe(0));try{return(new n)[e](vCe(-1)),!1}catch(r){if(!t)return!0;try{return(new n)[e](GCe(-1/0)),!1}catch(PWe){var A=new n;return A.add(1),A.add(2),t(A[e](GCe(1/0)))}}}catch(PWe){return!1}},VCe=function(e){var t=mCe(this),n=bCe(e),A=pCe(t);return fCe(t)<=n.size?BCe(t,(function(e){n.includes(e)&&ZCe(A,e)})):yCe(n.getIterator(),(function(e){wCe(t,e)&&ZCe(A,e)})),A};lL({target:"Set",proto:!0,real:!0,forced:!RCe("difference",(function(e){return 0===e.size}))},{difference:VCe});var NCe=MIe,kCe=iCe,WCe=hCe,FCe=eCe,ECe=DIe,XCe=TIe.Set,HCe=TIe.add,xCe=TIe.has,JCe=IH,YCe=function(e){var t=NCe(this),n=WCe(e),A=new XCe;return kCe(t)>n.size?ECe(n.getIterator(),(function(e){xCe(t,e)&&HCe(A,e)})):FCe(t,(function(e){n.includes(e)&&HCe(A,e)})),A};lL({target:"Set",proto:!0,real:!0,forced:!RCe("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||JCe((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:YCe});var UCe=MIe,LCe=TIe.has,TCe=iCe,KCe=hCe,MCe=eCe,QCe=DIe,DCe=Sz,zCe=function(e){var t=UCe(this),n=KCe(e);if(TCe(t)<=n.size)return!1!==MCe(t,(function(e){if(n.includes(e))return!1}),!0);var A=n.getIterator();return!1!==QCe(A,(function(e){if(LCe(t,e))return DCe(A,"normal",!1)}))};lL({target:"Set",proto:!0,real:!0,forced:!RCe("isDisjointFrom",(function(e){return!e}))},{isDisjointFrom:zCe});var OCe=MIe,PCe=iCe,_Ce=eCe,jCe=hCe,qCe=function(e){var t=OCe(this),n=jCe(e);return!(PCe(t)>n.size)&&!1!==_Ce(t,(function(e){if(!n.includes(e))return!1}),!0)};lL({target:"Set",proto:!0,real:!0,forced:!RCe("isSubsetOf",(function(e){return e}))},{isSubsetOf:qCe});var $Ce=MIe,eue=TIe.has,tue=iCe,nue=hCe,Aue=DIe,rue=Sz,iue=function(e){var t=$Ce(this),n=nue(e);if(tue(t)<n.size)return!1;var A=n.getIterator();return!1!==Aue(A,(function(e){if(!eue(t,e))return rue(A,"normal",!1)}))};lL({target:"Set",proto:!0,real:!0,forced:!RCe("isSupersetOf",(function(e){return!e}))},{isSupersetOf:iue});var oue=MIe,sue=rCe,aue=hCe,gue=DIe,lue=TIe.add,cue=TIe.has,Iue=TIe.remove,Cue=function(e){var t=oue(this),n=aue(e).getIterator(),A=sue(t);return gue(n,(function(e){cue(t,e)?Iue(A,e):lue(A,e)})),A};lL({target:"Set",proto:!0,real:!0,forced:!RCe("symmetricDifference")},{symmetricDifference:Cue});var uue=MIe,due=TIe.add,hue=rCe,mue=hCe,pue=DIe,fue=function(e){var t=uue(this),n=mue(e).getIterator(),A=hue(t);return pue(n,(function(e){due(A,e)})),A};lL({target:"Set",proto:!0,real:!0,forced:!RCe("union")},{union:fue});var bue=lL,Bue=TH,yue=IU,wue=yL,Zue=IH,Sue=VH("".charAt);bue({target:"String",proto:!0,forced:Zue((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(e){var t=wue(Bue(this)),n=t.length,A=yue(e),r=A>=0?A:n+A;return r<0||r>=n?void 0:Sue(t,r)}});var vue=VH,Gue=IU,Rue=yL,Vue=TH,Nue=vue("".charAt),kue=vue("".charCodeAt),Wue=vue("".slice),Fue=function(e){return function(t,n){var A,r,i=Rue(Vue(t)),o=Gue(n),s=i.length;return o<0||o>=s?e?"":void 0:(A=kue(i,o))<55296||A>56319||o+1===s||(r=kue(i,o+1))<56320||r>57343?e?Nue(i,o):A:e?Wue(i,o,o+2):r-56320+(A-55296<<10)+65536}},Eue={codeAt:Fue(!1),charAt:Fue(!0)},Xue=Eue.codeAt;lL({target:"String",proto:!0},{codePointAt:function(e){return Xue(this,e)}});var Hue=ile,xue=TypeError,Jue=function(e){if(Hue(e))throw new xue("The method doesn't accept regular expressions");return e},Yue=lJ("match"),Uue=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Yue]=!1,"/./"[e](t)}catch(A){}}return!1},Lue=lL,Tue=ZT,Kue=cH.f,Mue=fU,Que=yL,Due=Jue,zue=TH,Oue=Uue,Pue=Tue("".slice),_ue=Math.min,jue=Oue("endsWith"),que=!jue&&!!function(){var e=Kue(String.prototype,"endsWith");return e&&!e.writable}();Lue({target:"String",proto:!0,forced:!que&&!jue},{endsWith:function(e){var t=Que(zue(this));Due(e);var n=arguments.length>1?arguments[1]:void 0,A=t.length,r=void 0===n?A:_ue(Mue(n),A),i=Que(e);return Pue(t,r-i.length,r)===i}});var $ue=lL,ede=VH,tde=hU,nde=RangeError,Ade=String.fromCharCode,rde=String.fromCodePoint,ide=ede([].join);$ue({target:"String",stat:!0,arity:1,forced:!!rde&&1!==rde.length},{fromCodePoint:function(e){for(var t,n=[],A=arguments.length,r=0;A>r;){if(t=+arguments[r++],tde(t,1114111)!==t)throw new nde(t+" is not a valid code point");n[r]=t<65536?Ade(t):Ade(55296+((t-=65536)>>10),t%1024+56320)}return ide(n,"")}});var ode=lL,sde=Jue,ade=TH,gde=yL,lde=Uue,cde=VH("".indexOf);ode({target:"String",proto:!0,forced:!lde("includes")},{includes:function(e){return!!~cde(gde(ade(this)),gde(sde(e)),arguments.length>1?arguments[1]:void 0)}});var Ide=lL,Cde=TH,ude=yL,dde=VH("".charCodeAt);Ide({target:"String",proto:!0},{isWellFormed:function(){for(var e=ude(Cde(this)),t=e.length,n=0;n<t;n++){var A=dde(e,n);if(55296==(63488&A)&&(A>=56320||++n>=t||56320!=(64512&dde(e,n))))return!1}return!0}});var hde=Eue.charAt,mde=yL,pde=xY,fde=rj,bde=ij,Bde="String Iterator",yde=pde.set,wde=pde.getterFor(Bde);fde(String,"String",(function(e){yde(this,{type:Bde,string:mde(e),index:0})}),(function(){var e,t=wde(this),n=t.string,A=t.index;return A>=n.length?bde(void 0,!0):(e=hde(n,A),t.index+=e.length,bde(e,!1))}));var Zde=mH,Sde=oU,vde=iIe,Gde=IH,Rde=lJ,Vde=nY,Nde=Rde("species"),kde=RegExp.prototype,Wde=function(e,t,n,A){var r=Rde(e),i=!Gde((function(){var t={};return t[r]=function(){return 7},7!==""[e](t)})),o=i&&!Gde((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Nde]=function(){return n},n.flags="",n[r]=/./[r]),n.exec=function(){return t=!0,null},n[r](""),!t}));if(!i||!o||n){var s=/./[r],a=t(r,""[e],(function(e,t,n,A,r){var o=t.exec;return o===vde||o===kde.exec?i&&!r?{done:!0,value:Zde(s,t,n,A)}:{done:!0,value:Zde(e,n,t,A)}:{done:!1}}));Sde(String.prototype,e,a[0]),Sde(kde,r,a[1])}A&&Vde(kde[r],"sham",!0)},Fde=Eue.charAt,Ede=function(e,t,n){return t+(n?Fde(e,t).length:1)},Xde=mH,Hde=TJ,xde=zH,Jde=FH,Yde=iIe,Ude=TypeError,Lde=function(e,t){var n=e.exec;if(xde(n)){var A=Xde(n,e,t);return null!==A&&Hde(A),A}if("RegExp"===Jde(e))return Xde(Yde,e,t);throw new Ude("RegExp#exec called on incompatible receiver")},Tde=mH,Kde=TJ,Mde=PH,Qde=fU,Dde=yL,zde=TH,Ode=Rx,Pde=Ede,_de=Lde;Wde("match",(function(e,t,n){return[function(t){var n=zde(this),A=Mde(t)?Ode(t,e):void 0;return A?Tde(A,t,n):new RegExp(t)[e](Dde(n))},function(e){var A=Kde(this),r=Dde(e),i=n(t,A,r);if(i.done)return i.value;if(!A.global)return _de(A,r);var o=A.unicode;A.lastIndex=0;for(var s,a=[],g=0;null!==(s=_de(A,r));){var l=Dde(s[0]);a[g]=l,""===l&&(A.lastIndex=Pde(r,Qde(A.lastIndex),o)),g++}return 0===g?null:a}]}));var jde=lL,qde=mH,$de=ZT,ehe=J_,the=ij,nhe=TH,Ahe=fU,rhe=yL,ihe=TJ,ohe=PH,she=ile,ahe=Cle,ghe=Rx,lhe=oU,che=IH,Ihe=kie,Che=Ede,uhe=Lde,dhe=xY,hhe=lJ("matchAll"),mhe="RegExp String",phe=mhe+" Iterator",fhe=dhe.set,bhe=dhe.getterFor(phe),Bhe=RegExp.prototype,yhe=TypeError,whe=$de("".indexOf),Zhe=$de("".matchAll),She=!!Zhe&&!che((function(){Zhe("a",/./)})),vhe=ehe((function(e,t,n,A){fhe(this,{type:phe,regexp:e,string:t,global:n,unicode:A,done:!1})}),mhe,(function(){var e=bhe(this);if(e.done)return the(void 0,!0);var t=e.regexp,n=e.string,A=uhe(t,n);return null===A?(e.done=!0,the(void 0,!0)):e.global?(""===rhe(A[0])&&(t.lastIndex=Che(n,Ahe(t.lastIndex),e.unicode)),the(A,!1)):(e.done=!0,the(A,!1))}));jde({target:"String",proto:!0,forced:She},{matchAll:function(e){var t,n,A,r=nhe(this);if(ohe(e)){if(she(e)&&(t=rhe(nhe(ahe(e))),!~whe(t,"g")))throw new yhe("`.matchAll` does not allow non-global regexes");if(She)return Zhe(r,e);if(A=ghe(e,hhe))return qde(A,e,r)}else if(She)return Zhe(r,e);return n=rhe(r),new RegExp(e,"g")[hhe](n)}}),hhe in Bhe||lhe(Bhe,hhe,(function(e){var t,n,A,r=ihe(this),i=rhe(e),o=Ihe(r,RegExp),s=rhe(ahe(r));return t=new o(o===RegExp?r.source:r,s),n=!!~whe(s,"g"),A=!!~whe(s,"u"),t.lastIndex=Ahe(r.lastIndex),new vhe(t,i,n,A)}));var Ghe=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(nx),Rhe=N3.end;lL({target:"String",proto:!0,forced:Ghe},{padEnd:function(e){return Rhe(this,e,arguments.length>1?arguments[1]:void 0)}});var Vhe=N3.start;lL({target:"String",proto:!0,forced:Ghe},{padStart:function(e){return Vhe(this,e,arguments.length>1?arguments[1]:void 0)}});var Nhe=lL,khe=VH,Whe=QH,Fhe=zx,Ehe=yL,Xhe=BU,Hhe=khe([].push),xhe=khe([].join);Nhe({target:"String",stat:!0},{raw:function(e){var t=Whe(Fhe(e).raw),n=Xhe(t);if(!n)return"";for(var A=arguments.length,r=[],i=0;;){if(Hhe(r,Ehe(t[i++])),i===n)return xhe(r,"");i<A&&Hhe(r,Ehe(arguments[i]))}}}),lL({target:"String",proto:!0},{repeat:B3});var Jhe=VH,Yhe=zx,Uhe=Math.floor,Lhe=Jhe("".charAt),The=Jhe("".replace),Khe=Jhe("".slice),Mhe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Qhe=/\$([$&'`]|\d{1,2})/g,Dhe=function(e,t,n,A,r,i){var o=n+e.length,s=A.length,a=Qhe;return void 0!==r&&(r=Yhe(r),a=Mhe),The(i,a,(function(i,a){var g;switch(Lhe(a,0)){case"$":return"$";case"&":return e;case"`":return Khe(t,0,n);case"'":return Khe(t,o);case"<":g=r[Khe(a,1,-1)];break;default:var l=+a;if(0===l)return i;if(l>s){var c=Uhe(l/10);return 0===c?i:c<=s?void 0===A[c-1]?Lhe(a,1):A[c-1]+Lhe(a,1):i}g=A[l-1]}return void 0===g?"":g}))},zhe=EM,Ohe=mH,Phe=VH,_he=Wde,jhe=IH,qhe=TJ,$he=zH,eme=PH,tme=IU,nme=fU,Ame=yL,rme=TH,ime=Ede,ome=Rx,sme=Dhe,ame=Lde,gme=lJ("replace"),lme=Math.max,cme=Math.min,Ime=Phe([].concat),Cme=Phe([].push),ume=Phe("".indexOf),dme=Phe("".slice),hme="$0"==="a".replace(/./,"$0"),mme=!!/./[gme]&&""===/./[gme]("a","$0"),pme=!jhe((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));_he("replace",(function(e,t,n){var A=mme?"$":"$0";return[function(e,n){var A=rme(this),r=eme(e)?ome(e,gme):void 0;return r?Ohe(r,e,A,n):Ohe(t,Ame(A),e,n)},function(e,r){var i=qhe(this),o=Ame(e);if("string"==typeof r&&-1===ume(r,A)&&-1===ume(r,"$<")){var s=n(t,i,o,r);if(s.done)return s.value}var a=$he(r);a||(r=Ame(r));var g,l=i.global;l&&(g=i.unicode,i.lastIndex=0);for(var c,I=[];null!==(c=ame(i,o))&&(Cme(I,c),l);){""===Ame(c[0])&&(i.lastIndex=ime(o,nme(i.lastIndex),g))}for(var C,u="",d=0,h=0;h<I.length;h++){for(var m,p=Ame((c=I[h])[0]),f=lme(cme(tme(c.index),o.length),0),b=[],B=1;B<c.length;B++)Cme(b,void 0===(C=c[B])?C:String(C));var y=c.groups;if(a){var w=Ime([p],b,f,o);void 0!==y&&Cme(w,y),m=Ame(zhe(r,void 0,w))}else m=sme(p,o,f,b,y,r);f>=d&&(u+=dme(o,d,f)+m,d=f+p.length)}return u+dme(o,d)}]}),!pme||!hme||mme);var fme=lL,bme=mH,Bme=VH,yme=TH,wme=zH,Zme=PH,Sme=ile,vme=yL,Gme=Rx,Rme=Cle,Vme=Dhe,Nme=lJ("replace"),kme=TypeError,Wme=Bme("".indexOf);Bme("".replace);var Fme=Bme("".slice),Eme=Math.max;fme({target:"String",proto:!0},{replaceAll:function(e,t){var n,A,r,i,o,s,a,g,l,c=yme(this),I=0,C="";if(Zme(e)){if(Sme(e)&&(n=vme(yme(Rme(e))),!~Wme(n,"g")))throw new kme("`.replaceAll` does not allow non-global regexes");if(A=Gme(e,Nme))return bme(A,e,c,t)}for(r=vme(c),i=vme(e),(o=wme(t))||(t=vme(t)),s=i.length,a=Eme(1,s),g=Wme(r,i);-1!==g;)l=o?vme(t(i,g,r)):Vme(i,r,g,[],void 0,t),C+=Fme(r,I,g)+l,I=g+s,g=g+a>r.length?-1:Wme(r,i,g+a);return I<r.length&&(C+=Fme(r,I)),C}});var Xme=mH,Hme=TJ,xme=PH,Jme=TH,Yme=pre,Ume=yL,Lme=Rx,Tme=Lde;Wde("search",(function(e,t,n){return[function(t){var n=Jme(this),A=xme(t)?Lme(t,e):void 0;return A?Xme(A,t,n):new RegExp(t)[e](Ume(n))},function(e){var A=Hme(this),r=Ume(e),i=n(t,A,r);if(i.done)return i.value;var o=A.lastIndex;Yme(o,0)||(A.lastIndex=0);var s=Tme(A,r);return Yme(A.lastIndex,o)||(A.lastIndex=o),null===s?-1:s.index}]}));var Kme=mH,Mme=VH,Qme=Wde,Dme=TJ,zme=PH,Ome=TH,Pme=kie,_me=Ede,jme=fU,qme=yL,$me=Rx,epe=Lde,tpe=IH,npe=fle.UNSUPPORTED_Y,Ape=Math.min,rpe=Mme([].push),ipe=Mme("".slice),ope=!tpe((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),spe="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length;Qme("split",(function(e,t,n){var A="0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:Kme(t,this,e,n)}:t;return[function(t,n){var r=Ome(this),i=zme(t)?$me(t,e):void 0;return i?Kme(i,t,r,n):Kme(A,qme(r),t,n)},function(e,r){var i=Dme(this),o=qme(e);if(!spe){var s=n(A,i,o,r,A!==t);if(s.done)return s.value}var a=Pme(i,RegExp),g=i.unicode,l=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(npe?"g":"y"),c=new a(npe?"^(?:"+i.source+")":i,l),I=void 0===r?4294967295:r>>>0;if(0===I)return[];if(0===o.length)return null===epe(c,o)?[o]:[];for(var C=0,u=0,d=[];u<o.length;){c.lastIndex=npe?0:u;var h,m=epe(c,npe?ipe(o,u):o);if(null===m||(h=Ape(jme(c.lastIndex+(npe?u:0)),o.length))===C)u=_me(o,u,g);else{if(rpe(d,ipe(o,C,u)),d.length===I)return d;for(var p=1;p<=m.length-1;p++)if(rpe(d,m[p]),d.length===I)return d;u=C=h}}return rpe(d,ipe(o,C)),d}]}),spe||!ope,npe);var ape=lL,gpe=ZT,lpe=cH.f,cpe=fU,Ipe=yL,Cpe=Jue,upe=TH,dpe=Uue,hpe=gpe("".slice),mpe=Math.min,ppe=dpe("startsWith"),fpe=!ppe&&!!function(){var e=lpe(String.prototype,"startsWith");return e&&!e.writable}();ape({target:"String",proto:!0,forced:!fpe&&!ppe},{startsWith:function(e){var t=Ipe(upe(this));Cpe(e);var n=cpe(mpe(arguments.length>1?arguments[1]:void 0,t.length)),A=Ipe(e);return hpe(t,n,n+A.length)===A}});var bpe=lL,Bpe=TH,ype=IU,wpe=yL,Zpe=VH("".slice),Spe=Math.max,vpe=Math.min;bpe({target:"String",proto:!0,forced:!"".substr||"b"!=="ab".substr(-1)},{substr:function(e,t){var n,A,r=wpe(Bpe(this)),i=r.length,o=ype(e);return o===1/0&&(o=0),o<0&&(o=Spe(i+o,0)),(n=void 0===t?i:ype(t))<=0||n===1/0||o>=(A=vpe(o+n,i))?"":Zpe(r,o,A)}});var Gpe=lL,Rpe=mH,Vpe=VH,Npe=TH,kpe=yL,Wpe=IH,Fpe=Array,Epe=Vpe("".charAt),Xpe=Vpe("".charCodeAt),Hpe=Vpe([].join),xpe="".toWellFormed,Jpe=xpe&&Wpe((function(){return"1"!==Rpe(xpe,1)}));Gpe({target:"String",proto:!0,forced:Jpe},{toWellFormed:function(){var e=kpe(Npe(this));if(Jpe)return Rpe(xpe,e);for(var t=e.length,n=Fpe(t),A=0;A<t;A++){var r=Xpe(e,A);55296!=(63488&r)?n[A]=Epe(e,A):r>=56320||A+1>=t||56320!=(64512&Xpe(e,A+1))?n[A]="�":(n[A]=Epe(e,A),n[++A]=Epe(e,A))}return Hpe(n,"")}});var Ype=gY.PROPER,Upe=IH,Lpe=tte,Tpe=function(e){return Upe((function(){return!!Lpe[e]()||"​᠎"!=="​᠎"[e]()||Ype&&Lpe[e].name!==e}))},Kpe=gte.trim;lL({target:"String",proto:!0,forced:Tpe("trim")},{trim:function(){return Kpe(this)}});var Mpe=gte.end,Qpe=Tpe("trimEnd")?function(){return Mpe(this)}:"".trimEnd;lL({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==Qpe},{trimRight:Qpe});lL({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==Qpe},{trimEnd:Qpe});var Dpe=gte.start,zpe=Tpe("trimStart")?function(){return Dpe(this)}:"".trimStart;lL({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==zpe},{trimLeft:zpe});lL({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==zpe},{trimStart:zpe});var Ope=TH,Ppe=yL,_pe=/"/g,jpe=VH("".replace),qpe=function(e,t,n,A){var r=Ppe(Ope(e)),i="<"+t;return""!==n&&(i+=" "+n+'="'+jpe(Ppe(A),_pe,"&quot;")+'"'),i+">"+r+"</"+t+">"},$pe=IH,efe=function(e){return $pe((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))},tfe=qpe;lL({target:"String",proto:!0,forced:efe("anchor")},{anchor:function(e){return tfe(this,"a","name",e)}});var nfe=qpe;lL({target:"String",proto:!0,forced:efe("big")},{big:function(){return nfe(this,"big","","")}});var Afe=qpe;lL({target:"String",proto:!0,forced:efe("blink")},{blink:function(){return Afe(this,"blink","","")}});var rfe=qpe;lL({target:"String",proto:!0,forced:efe("bold")},{bold:function(){return rfe(this,"b","","")}});var ife=qpe;lL({target:"String",proto:!0,forced:efe("fixed")},{fixed:function(){return ife(this,"tt","","")}});var ofe=qpe;lL({target:"String",proto:!0,forced:efe("fontcolor")},{fontcolor:function(e){return ofe(this,"font","color",e)}});var sfe=qpe;lL({target:"String",proto:!0,forced:efe("fontsize")},{fontsize:function(e){return sfe(this,"font","size",e)}});var afe=qpe;lL({target:"String",proto:!0,forced:efe("italics")},{italics:function(){return afe(this,"i","","")}});var gfe=qpe;lL({target:"String",proto:!0,forced:efe("link")},{link:function(e){return gfe(this,"a","href",e)}});var lfe=qpe;lL({target:"String",proto:!0,forced:efe("small")},{small:function(){return lfe(this,"small","","")}});var cfe=qpe;lL({target:"String",proto:!0,forced:efe("strike")},{strike:function(){return cfe(this,"strike","","")}});var Ife=qpe;lL({target:"String",proto:!0,forced:efe("sub")},{sub:function(){return Ife(this,"sub","","")}});var Cfe=qpe;lL({target:"String",proto:!0,forced:efe("sup")},{sup:function(){return Cfe(this,"sup","","")}});var ufe={exports:{}},dfe=lH,hfe=IH,mfe=I_,pfe=B2.NATIVE_ARRAY_BUFFER_VIEWS,ffe=dfe.ArrayBuffer,bfe=dfe.Int8Array,Bfe=!pfe||!hfe((function(){bfe(1)}))||!hfe((function(){new bfe(-1)}))||!mfe((function(e){new bfe,new bfe(null),new bfe(1.5),new bfe(e)}),!0)||hfe((function(){return 1!==new bfe(new ffe(2),1,void 0).length})),yfe=b9,wfe=RangeError,Zfe=function(e,t){var n=yfe(e);if(n%t)throw new wfe("Wrong offset");return n},Sfe=Math.round,vfe=fL,Gfe=function(e){var t=vfe(e);return"BigInt64Array"===t||"BigUint64Array"===t},Rfe=pJ,Vfe=TypeError,Nfe=function(e){var t=Rfe(e,"number");if("number"==typeof t)throw new Vfe("Can't convert number to bigint");return BigInt(t)},kfe=RT,Wfe=mH,Ffe=vie,Efe=zx,Xfe=BU,Hfe=Bz,xfe=uz,Jfe=az,Yfe=Gfe,Ufe=B2.aTypedArrayConstructor,Lfe=Nfe,Tfe=function(e){var t,n,A,r,i,o,s,a,g=Ffe(this),l=Efe(e),c=arguments.length,I=c>1?arguments[1]:void 0,C=void 0!==I,u=xfe(l);if(u&&!Jfe(u))for(a=(s=Hfe(l,u)).next,l=[];!(o=Wfe(a,s)).done;)l.push(o.value);for(C&&c>2&&(I=kfe(I,arguments[2])),n=Xfe(l),A=new(Ufe(g))(n),r=Yfe(A),t=0;n>t;t++)i=C?I(l[t],t):l[t],A[t]=r?Lfe(i):+i;return A},Kfe=lL,Mfe=lH,Qfe=mH,Dfe=CH,zfe=Bfe,Ofe=B2,Pfe=F1,_fe=c0,jfe=ZH,qfe=nY,$fe=Yte,ebe=fU,tbe=d0,nbe=Zfe,Abe=function(e){var t=Sfe(e);return t<0?0:t>255?255:255&t},rbe=BJ,ibe=_x,obe=fL,sbe=PH,abe=fx,gbe=OL,lbe=$H,cbe=OQ,Ibe=sU.f,Cbe=Tfe,ube=rK.forEach,dbe=a$,hbe=rT,mbe=xJ,pbe=cH,fbe=V$,bbe=eD,Bbe=xY.get,ybe=xY.set,wbe=xY.enforce,Zbe=mbe.f,Sbe=pbe.f,vbe=Mfe.RangeError,Gbe=Pfe.ArrayBuffer,Rbe=Gbe.prototype,Vbe=Pfe.DataView,Nbe=Ofe.NATIVE_ARRAY_BUFFER_VIEWS,kbe=Ofe.TYPED_ARRAY_TAG,Wbe=Ofe.TypedArray,Fbe=Ofe.TypedArrayPrototype,Ebe=Ofe.isTypedArray,Xbe="BYTES_PER_ELEMENT",Hbe="Wrong length",xbe=function(e,t){hbe(e,t,{configurable:!0,get:function(){return Bbe(this)[t]}})},Jbe=function(e){var t;return lbe(Rbe,e)||"ArrayBuffer"===(t=obe(e))||"SharedArrayBuffer"===t},Ybe=function(e,t){return Ebe(e)&&!abe(t)&&t in e&&$fe(+t)&&t>=0},Ube=function(e,t){return t=rbe(t),Ybe(e,t)?jfe(2,e[t]):Sbe(e,t)},Lbe=function(e,t,n){return t=rbe(t),!(Ybe(e,t)&&sbe(n)&&ibe(n,"value"))||ibe(n,"get")||ibe(n,"set")||n.configurable||ibe(n,"writable")&&!n.writable||ibe(n,"enumerable")&&!n.enumerable?Zbe(e,t,n):(e[t]=n.value,e)};Dfe?(Nbe||(pbe.f=Ube,mbe.f=Lbe,xbe(Fbe,"buffer"),xbe(Fbe,"byteOffset"),xbe(Fbe,"byteLength"),xbe(Fbe,"length")),Kfe({target:"Object",stat:!0,forced:!Nbe},{getOwnPropertyDescriptor:Ube,defineProperty:Lbe}),ufe.exports=function(e,t,n){var A=e.match(/\d+/)[0]/8,r=e+(n?"Clamped":"")+"Array",i="get"+e,o="set"+e,s=Mfe[r],a=s,g=a&&a.prototype,l={},c=function(e,t){Zbe(e,t,{get:function(){return function(e,t){var n=Bbe(e);return n.view[i](t*A+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var i=Bbe(e);i.view[o](t*A+i.byteOffset,n?Abe(r):r,!0)}(this,t,e)},enumerable:!0})};Nbe?zfe&&(a=t((function(e,t,n,r){return _fe(e,g),bbe(sbe(t)?Jbe(t)?void 0!==r?new s(t,nbe(n,A),r):void 0!==n?new s(t,nbe(n,A)):new s(t):Ebe(t)?fbe(a,t):Qfe(Cbe,a,t):new s(tbe(t)),e,a)})),cbe&&cbe(a,Wbe),ube(Ibe(s),(function(e){e in a||qfe(a,e,s[e])})),a.prototype=g):(a=t((function(e,t,n,r){_fe(e,g);var i,o,s,l=0,I=0;if(sbe(t)){if(!Jbe(t))return Ebe(t)?fbe(a,t):Qfe(Cbe,a,t);i=t,I=nbe(n,A);var C=t.byteLength;if(void 0===r){if(C%A)throw new vbe(Hbe);if((o=C-I)<0)throw new vbe(Hbe)}else if((o=ebe(r)*A)+I>C)throw new vbe(Hbe);s=o/A}else s=tbe(t),i=new Gbe(o=s*A);for(ybe(e,{buffer:i,byteOffset:I,byteLength:o,length:s,view:new Vbe(i)});l<s;)c(e,l++)})),cbe&&cbe(a,Wbe),g=a.prototype=gbe(Fbe)),g.constructor!==a&&qfe(g,"constructor",a),wbe(g).TypedArrayConstructor=a,kbe&&qfe(g,kbe,r);var I=a!==s;l[r]=a,Kfe({global:!0,constructor:!0,forced:I,sham:!Nbe},l),Xbe in a||qfe(a,Xbe,A),Xbe in g||qfe(g,Xbe,A),dbe(r)}):ufe.exports=function(){};var Tbe=ufe.exports;Tbe("Float32",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Float64",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Int8",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Int16",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Int32",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Uint8",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Uint8",(function(e){return function(t,n,A){return e(this,t,n,A)}}),!0),Tbe("Uint16",(function(e){return function(t,n,A){return e(this,t,n,A)}})),Tbe("Uint32",(function(e){return function(t,n,A){return e(this,t,n,A)}}));var Kbe=BU,Mbe=IU,Qbe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("at",(function(e){var t=Qbe(this),n=Kbe(t),A=Mbe(e),r=A>=0?A:n+A;return r<0||r>=n?void 0:t[r]}));var Dbe=B2,zbe=VH(qO),Obe=Dbe.aTypedArray;(0,Dbe.exportTypedArrayMethod)("copyWithin",(function(e,t){return zbe(Obe(this),e,t,arguments.length>2?arguments[2]:void 0)}));var Pbe=rK.every,_be=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("every",(function(e){return Pbe(_be(this),e,arguments.length>1?arguments[1]:void 0)}));var jbe=oP,qbe=Nfe,$be=fL,eBe=mH,tBe=IH,nBe=B2.aTypedArray,ABe=B2.exportTypedArrayMethod,rBe=VH("".slice);ABe("fill",(function(e){var t=arguments.length;nBe(this);var n="Big"===rBe($be(this),0,3)?qbe(e):+e;return eBe(jbe,this,n,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),tBe((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})));var iBe=V$,oBe=B2.getTypedArrayConstructor,sBe=rK.filter,aBe=function(e,t){return iBe(oBe(e),t)},gBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("filter",(function(e){var t=sBe(gBe(this),e,arguments.length>1?arguments[1]:void 0);return aBe(this,t)}));var lBe=rK.find,cBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("find",(function(e){return lBe(cBe(this),e,arguments.length>1?arguments[1]:void 0)}));var IBe=rK.findIndex,CBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("findIndex",(function(e){return IBe(CBe(this),e,arguments.length>1?arguments[1]:void 0)}));var uBe=ZP.findLast,dBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("findLast",(function(e){return uBe(dBe(this),e,arguments.length>1?arguments[1]:void 0)}));var hBe=ZP.findLastIndex,mBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("findLastIndex",(function(e){return hBe(mBe(this),e,arguments.length>1?arguments[1]:void 0)}));var pBe=rK.forEach,fBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("forEach",(function(e){pBe(fBe(this),e,arguments.length>1?arguments[1]:void 0)})),(0,B2.exportTypedArrayStaticMethod)("from",Tfe,Bfe);var bBe=vU.includes,BBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("includes",(function(e){return bBe(BBe(this),e,arguments.length>1?arguments[1]:void 0)}));var yBe=vU.indexOf,wBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("indexOf",(function(e){return yBe(wBe(this),e,arguments.length>1?arguments[1]:void 0)}));var ZBe=lH,SBe=IH,vBe=VH,GBe=B2,RBe=mj,VBe=lJ("iterator"),NBe=ZBe.Uint8Array,kBe=vBe(RBe.values),WBe=vBe(RBe.keys),FBe=vBe(RBe.entries),EBe=GBe.aTypedArray,XBe=GBe.exportTypedArrayMethod,HBe=NBe&&NBe.prototype,xBe=!SBe((function(){HBe[VBe].call([1])})),JBe=!!HBe&&HBe.values&&HBe[VBe]===HBe.values&&"values"===HBe.values.name,YBe=function(){return kBe(EBe(this))};XBe("entries",(function(){return FBe(EBe(this))}),xBe),XBe("keys",(function(){return WBe(EBe(this))}),xBe),XBe("values",YBe,xBe||!JBe,{name:"values"}),XBe(VBe,YBe,xBe||!JBe,{name:"values"});var UBe=B2.aTypedArray,LBe=B2.exportTypedArrayMethod,TBe=VH([].join);LBe("join",(function(e){return TBe(UBe(this),e)}));var KBe=EM,MBe=Fj,QBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return KBe(MBe,QBe(this),t>1?[e,arguments[1]]:[e])}));var DBe=rK.map,zBe=B2.aTypedArray,OBe=B2.getTypedArrayConstructor;(0,B2.exportTypedArrayMethod)("map",(function(e){return DBe(zBe(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(OBe(e))(t)}))}));var PBe=B2.aTypedArrayConstructor;(0,B2.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,n=new(PBe(this))(t);t>e;)n[e]=arguments[e++];return n}),Bfe);var _Be=eq.left,jBe=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return _Be(jBe(this),e,t,t>1?arguments[1]:void 0)}));var qBe=eq.right,$Be=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return qBe($Be(this),e,t,t>1?arguments[1]:void 0)}));var eye=B2.aTypedArray,tye=B2.exportTypedArrayMethod,nye=Math.floor;tye("reverse",(function(){for(var e,t=this,n=eye(t).length,A=nye(n/2),r=0;r<A;)e=t[r],t[r++]=t[--n],t[n]=e;return t}));var Aye=lH,rye=mH,iye=B2,oye=BU,sye=Zfe,aye=zx,gye=IH,lye=Aye.RangeError,cye=Aye.Int8Array,Iye=cye&&cye.prototype,Cye=Iye&&Iye.set,uye=iye.aTypedArray,dye=iye.exportTypedArrayMethod,hye=!gye((function(){var e=new Uint8ClampedArray(2);return rye(Cye,e,{length:1,0:3},1),3!==e[1]})),mye=hye&&iye.NATIVE_ARRAY_BUFFER_VIEWS&&gye((function(){var e=new cye(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));dye("set",(function(e){uye(this);var t=sye(arguments.length>1?arguments[1]:void 0,1),n=aye(e);if(hye)return rye(Cye,this,n,t);var A=this.length,r=oye(n),i=0;if(r+t>A)throw new lye("Wrong length");for(;i<r;)this[t+i]=n[i++]}),!hye||mye);var pye=_L,fye=B2.aTypedArray,bye=B2.getTypedArrayConstructor;(0,B2.exportTypedArrayMethod)("slice",(function(e,t){for(var n=pye(fye(this),e,t),A=bye(this),r=0,i=n.length,o=new A(i);i>r;)o[r]=n[r++];return o}),IH((function(){new Int8Array(1).slice()})));var Bye=rK.some,yye=B2.aTypedArray;(0,B2.exportTypedArrayMethod)("some",(function(e){return Bye(yye(this),e,arguments.length>1?arguments[1]:void 0)}));var wye=ZT,Zye=IH,Sye=Sx,vye=kq,Gye=Fq,Rye=Eq,Vye=gx,Nye=Hq,kye=B2.aTypedArray,Wye=B2.exportTypedArrayMethod,Fye=lH.Uint16Array,Eye=Fye&&wye(Fye.prototype.sort),Xye=!(!Eye||Zye((function(){Eye(new Fye(2),null)}))&&Zye((function(){Eye(new Fye(2),{})}))),Hye=!!Eye&&!Zye((function(){if(Vye)return Vye<74;if(Gye)return Gye<67;if(Rye)return!0;if(Nye)return Nye<602;var e,t,n=new Fye(516),A=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,A[e]=e-2*t+3;for(Eye(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==A[e])return!0}));Wye("sort",(function(e){return void 0!==e&&Sye(e),Hye?Eye(this,e):vye(kye(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!Hye||Xye);var xye=fU,Jye=hU,Yye=B2.aTypedArray,Uye=B2.getTypedArrayConstructor;(0,B2.exportTypedArrayMethod)("subarray",(function(e,t){var n=Yye(this),A=n.length,r=Jye(e,A);return new(Uye(n))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,xye((void 0===t?A:Jye(t,A))-r))}));var Lye=EM,Tye=B2,Kye=IH,Mye=_L,Qye=lH.Int8Array,Dye=Tye.aTypedArray,zye=Tye.exportTypedArrayMethod,Oye=[].toLocaleString,Pye=!!Qye&&Kye((function(){Oye.call(new Qye(1))}));zye("toLocaleString",(function(){return Lye(Oye,Pye?Mye(Dye(this)):Dye(this),Mye(arguments))}),Kye((function(){return[1,2].toLocaleString()!==new Qye([1,2]).toLocaleString()}))||!Kye((function(){Qye.prototype.toLocaleString.call([1,2])})));var _ye=w$,jye=B2.aTypedArray,qye=B2.getTypedArrayConstructor;(0,B2.exportTypedArrayMethod)("toReversed",(function(){return _ye(jye(this),qye(this))}));var $ye=Sx,ewe=V$,twe=B2.aTypedArray,nwe=B2.getTypedArrayConstructor,Awe=B2.exportTypedArrayMethod,rwe=VH(B2.TypedArrayPrototype.sort);Awe("toSorted",(function(e){void 0!==e&&$ye(e);var t=twe(this),n=ewe(nwe(t),t);return rwe(n,e)}));var iwe=B2.exportTypedArrayMethod,owe=IH,swe=VH,awe=lH.Uint8Array,gwe=awe&&awe.prototype||{},lwe=[].toString,cwe=swe([].join);owe((function(){lwe.call({})}))&&(lwe=function(){return cwe(this)});var Iwe=gwe.toString!==lwe;iwe("toString",lwe,Iwe);var Cwe=n0,uwe=Gfe,dwe=IU,hwe=Nfe,mwe=B2.aTypedArray,pwe=B2.getTypedArrayConstructor,fwe=B2.exportTypedArrayMethod,bwe=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(PWe){return 8===PWe}}();fwe("with",{with:function(e,t){var n=mwe(this),A=dwe(e),r=uwe(n)?hwe(t):+t;return Cwe(n,pwe(n),A,r)}}.with,!bwe);var Bwe=lL,ywe=VH,wwe=yL,Zwe=String.fromCharCode,Swe=ywe("".charAt),vwe=ywe(/./.exec),Gwe=ywe("".slice),Rwe=/^[\da-f]{2}$/i,Vwe=/^[\da-f]{4}$/i;Bwe({global:!0},{unescape:function(e){for(var t,n,A=wwe(e),r="",i=A.length,o=0;o<i;){if("%"===(t=Swe(A,o++)))if("u"===Swe(A,o)){if(n=Gwe(A,o+1,o+5),vwe(Vwe,n)){r+=Zwe(parseInt(n,16)),o+=5;continue}}else if(n=Gwe(A,o,o+2),vwe(Rwe,n)){r+=Zwe(parseInt(n,16)),o+=2;continue}r+=t}return r}});var Nwe=VH,kwe=a0,Wwe=c7.getWeakData,Fwe=c0,Ewe=TJ,Xwe=YH,Hwe=PH,xwe=Yz,Jwe=_x,Ywe=xY.set,Uwe=xY.getterFor,Lwe=rK.find,Twe=rK.findIndex,Kwe=Nwe([].splice),Mwe=0,Qwe=function(e){return e.frozen||(e.frozen=new Dwe)},Dwe=function(){this.entries=[]},zwe=function(e,t){return Lwe(e.entries,(function(e){return e[0]===t}))};Dwe.prototype={get:function(e){var t=zwe(this,e);if(t)return t[1]},has:function(e){return!!zwe(this,e)},set:function(e,t){var n=zwe(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=Twe(this.entries,(function(t){return t[0]===e}));return~t&&Kwe(this.entries,t,1),!!~t}};var Owe,Pwe={getConstructor:function(e,t,n,A){var r=e((function(e,r){Fwe(e,i),Ywe(e,{type:t,id:Mwe++,frozen:null}),Xwe(r)||xwe(r,e[A],{that:e,AS_ENTRIES:n})})),i=r.prototype,o=Uwe(t),s=function(e,t,n){var A=o(e),r=Wwe(Ewe(t),!0);return!0===r?Qwe(A).set(t,n):r[A.id]=n,e};return kwe(i,{delete:function(e){var t=o(this);if(!Hwe(e))return!1;var n=Wwe(e);return!0===n?Qwe(t).delete(e):n&&Jwe(n,t.id)&&delete n[t.id]},has:function(e){var t=o(this);if(!Hwe(e))return!1;var n=Wwe(e);return!0===n?Qwe(t).has(e):n&&Jwe(n,t.id)}}),kwe(i,n?{get:function(e){var t=o(this);if(Hwe(e)){var n=Wwe(e);if(!0===n)return Qwe(t).get(e);if(n)return n[t.id]}},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),r}},_we=P6,jwe=lH,qwe=VH,$we=a0,eZe=c7,tZe=G7,nZe=Pwe,AZe=PH,rZe=xY.enforce,iZe=IH,oZe=fY,sZe=Object,aZe=Array.isArray,gZe=sZe.isExtensible,lZe=sZe.isFrozen,cZe=sZe.isSealed,IZe=sZe.freeze,CZe=sZe.seal,uZe=!jwe.ActiveXObject&&"ActiveXObject"in jwe,dZe=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},hZe=tZe("WeakMap",dZe,nZe),mZe=hZe.prototype,pZe=qwe(mZe.set);if(oZe)if(uZe){Owe=nZe.getConstructor(dZe,"WeakMap",!0),eZe.enable();var fZe=qwe(mZe.delete),bZe=qwe(mZe.has),BZe=qwe(mZe.get);$we(mZe,{delete:function(e){if(AZe(e)&&!gZe(e)){var t=rZe(this);return t.frozen||(t.frozen=new Owe),fZe(this,e)||t.frozen.delete(e)}return fZe(this,e)},has:function(e){if(AZe(e)&&!gZe(e)){var t=rZe(this);return t.frozen||(t.frozen=new Owe),bZe(this,e)||t.frozen.has(e)}return bZe(this,e)},get:function(e){if(AZe(e)&&!gZe(e)){var t=rZe(this);return t.frozen||(t.frozen=new Owe),bZe(this,e)?BZe(this,e):t.frozen.get(e)}return BZe(this,e)},set:function(e,t){if(AZe(e)&&!gZe(e)){var n=rZe(this);n.frozen||(n.frozen=new Owe),bZe(this,e)?pZe(this,e,t):n.frozen.set(e,t)}else pZe(this,e,t);return this}})}else _we&&iZe((function(){var e=IZe([]);return pZe(new hZe,e,1),!lZe(e)}))&&$we(mZe,{set:function(e,t){var n;return aZe(e)&&(lZe(e)?n=IZe:cZe(e)&&(n=CZe)),pZe(this,e,t),n&&n(e),this}});G7("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),Pwe);var yZe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",wZe=yZe+"+/",ZZe=yZe+"-_",SZe=function(e){for(var t={},n=0;n<64;n++)t[e.charAt(n)]=n;return t},vZe={i2c:wZe,c2i:SZe(wZe),c2iUrl:SZe(ZZe)},GZe=lL,RZe=lH,VZe=qH,NZe=VH,kZe=mH,WZe=IH,FZe=yL,EZe=Fie,XZe=vZe.c2i,HZe=/[^\d+/a-z]/i,xZe=/[\t\n\f\r ]+/g,JZe=/[=]{1,2}$/,YZe=VZe("atob"),UZe=String.fromCharCode,LZe=NZe("".charAt),TZe=NZe("".replace),KZe=NZe(HZe.exec),MZe=!!YZe&&!WZe((function(){return"hi"!==YZe("aGk=")})),QZe=MZe&&WZe((function(){return""!==YZe(" ")})),DZe=MZe&&!WZe((function(){YZe("a")})),zZe=MZe&&!WZe((function(){YZe()})),OZe=MZe&&1!==YZe.length;GZe({global:!0,bind:!0,enumerable:!0,forced:!MZe||QZe||DZe||zZe||OZe},{atob:function(e){if(EZe(arguments.length,1),MZe&&!QZe&&!DZe)return kZe(YZe,RZe,e);var t,n,A,r=TZe(FZe(e),xZe,""),i="",o=0,s=0;if(r.length%4==0&&(r=TZe(r,JZe,"")),(t=r.length)%4==1||KZe(HZe,r))throw new(VZe("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;o<t;)n=LZe(r,o++),A=s%4?64*A+XZe[n]:XZe[n],s++%4&&(i+=UZe(255&A>>(-2*s&6)));return i}});var PZe=lL,_Ze=lH,jZe=qH,qZe=VH,$Ze=mH,eSe=IH,tSe=yL,nSe=Fie,ASe=vZe.i2c,rSe=jZe("btoa"),iSe=qZe("".charAt),oSe=qZe("".charCodeAt),sSe=!!rSe&&!eSe((function(){return"aGk="!==rSe("hi")})),aSe=sSe&&!eSe((function(){rSe()})),gSe=sSe&&eSe((function(){return"bnVsbA=="!==rSe(null)})),lSe=sSe&&1!==rSe.length;PZe({global:!0,bind:!0,enumerable:!0,forced:!sSe||aSe||gSe||lSe},{btoa:function(e){if(nSe(arguments.length,1),sSe)return $Ze(rSe,_Ze,tSe(e));for(var t,n,A=tSe(e),r="",i=0,o=ASe;iSe(A,i)||(o="=",i%1);){if((n=oSe(A,i+=3/4))>255)throw new(jZe("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");r+=iSe(o,63&(t=t<<8|n)>>8-i%1*8)}return r}});var cSe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ISe=SJ("span").classList,CSe=ISe&&ISe.constructor&&ISe.constructor.prototype,uSe=CSe===Object.prototype?void 0:CSe,dSe=lH,hSe=cSe,mSe=uSe,pSe=DP,fSe=nY,bSe=function(e){if(e&&e.forEach!==pSe)try{fSe(e,"forEach",pSe)}catch(PWe){e.forEach=pSe}};for(var BSe in hSe)hSe[BSe]&&bSe(dSe[BSe]&&dSe[BSe].prototype);bSe(mSe);var ySe=lH,wSe=cSe,ZSe=uSe,SSe=mj,vSe=nY,GSe=BT,RSe=lJ("iterator"),VSe=SSe.values,NSe=function(e,t){if(e){if(e[RSe]!==VSe)try{vSe(e,RSe,VSe)}catch(PWe){e[RSe]=VSe}if(GSe(e,t,!0),wSe[t])for(var n in SSe)if(e[n]!==SSe[n])try{vSe(e,n,SSe[n])}catch(PWe){e[n]=SSe[n]}}};for(var kSe in wSe)NSe(ySe[kSe]&&ySe[kSe].prototype,kSe);NSe(ZSe,"DOMTokenList");var WSe={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},FSe=lL,ESe=qH,XSe=y5,HSe=IH,xSe=OL,JSe=ZH,YSe=xJ.f,USe=oU,LSe=rT,TSe=_x,KSe=c0,MSe=TJ,QSe=QD,DSe=nD,zSe=WSe,OSe=cD,PSe=xY,_Se=CH,jSe="DOMException",qSe="DATA_CLONE_ERR",$Se=ESe("Error"),eve=ESe(jSe)||function(){try{(new(ESe("MessageChannel")||XSe("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(PWe){if(PWe.name===qSe&&25===PWe.code)return PWe.constructor}}(),tve=eve&&eve.prototype,nve=$Se.prototype,Ave=PSe.set,rve=PSe.getterFor(jSe),ive="stack"in new $Se(jSe),ove=function(e){return TSe(zSe,e)&&zSe[e].m?zSe[e].c:0},sve=function(){KSe(this,ave);var e=arguments.length,t=DSe(e<1?void 0:arguments[0]),n=DSe(e<2?void 0:arguments[1],"Error"),A=ove(n);if(Ave(this,{type:jSe,name:n,message:t,code:A}),_Se||(this.name=n,this.message=t,this.code=A),ive){var r=new $Se(t);r.name=jSe,YSe(this,"stack",JSe(1,OSe(r.stack,1)))}},ave=sve.prototype=xSe(nve),gve=function(e){return{enumerable:!0,configurable:!0,get:e}},lve=function(e){return gve((function(){return rve(this)[e]}))};_Se&&(LSe(ave,"code",lve("code")),LSe(ave,"message",lve("message")),LSe(ave,"name",lve("name"))),YSe(ave,"constructor",JSe(1,sve));var cve=HSe((function(){return!(new eve instanceof $Se)})),Ive=cve||HSe((function(){return nve.toString!==QSe||"2: 1"!==String(new eve(1,2))})),Cve=cve||HSe((function(){return 25!==new eve(1,"DataCloneError").code}));cve||25!==eve[qSe]||tve[qSe];FSe({global:!0,constructor:!0,forced:cve},{DOMException:cve?sve:eve});var uve=ESe(jSe),dve=uve.prototype;for(var hve in Ive&&eve===uve&&USe(dve,"toString",QSe),Cve&&_Se&&eve===uve&&LSe(dve,"code",gve((function(){return ove(MSe(this).name)}))),zSe)if(TSe(zSe,hve)){var mve=zSe[hve],pve=mve.s,fve=JSe(6,mve.c);TSe(uve,pve)||YSe(uve,pve,fve),TSe(dve,pve)||YSe(dve,pve,fve)}var bve=lL,Bve=lH,yve=qH,wve=ZH,Zve=xJ.f,Sve=_x,vve=c0,Gve=eD,Rve=nD,Vve=WSe,Nve=cD,kve=CH,Wve="DOMException",Fve=yve("Error"),Eve=yve(Wve),Xve=function(){vve(this,Hve);var e=arguments.length,t=Rve(e<1?void 0:arguments[0]),n=Rve(e<2?void 0:arguments[1],"Error"),A=new Eve(t,n),r=new Fve(t);return r.name=Wve,Zve(A,"stack",wve(1,Nve(r.stack,1))),Gve(A,this,Xve),A},Hve=Xve.prototype=Eve.prototype,xve="stack"in new Fve(Wve),Jve="stack"in new Eve(1,2),Yve=Eve&&kve&&Object.getOwnPropertyDescriptor(Bve,Wve),Uve=!(!Yve||Yve.writable&&Yve.configurable),Lve=xve&&!Uve&&!Jve;bve({global:!0,constructor:!0,forced:Lve},{DOMException:Lve?Xve:Eve});var Tve=yve(Wve),Kve=Tve.prototype;if(Kve.constructor!==Tve)for(var Mve in Zve(Kve,"constructor",wve(1,Tve)),Vve)if(Sve(Vve,Mve)){var Qve=Vve[Mve],Dve=Qve.s;Sve(Tve,Dve)||Zve(Tve,Dve,wve(6,Qve.c))}var zve="DOMException";BT(qH(zve),zve);var Ove=soe.clear;lL({global:!0,bind:!0,enumerable:!0,forced:lH.clearImmediate!==Ove},{clearImmediate:Ove});var Pve,_ve=lH,jve=EM,qve=zH,$ve=iq,eGe=nx,tGe=_L,nGe=Fie,AGe=_ve.Function,rGe=/MSIE .\./.test(eGe)||"BUN"===$ve&&((Pve=_ve.Bun.version.split(".")).length<3||"0"===Pve[0]&&(Pve[1]<3||"3"===Pve[1]&&"0"===Pve[2])),iGe=function(e,t){var n=t?2:1;return rGe?function(A,r){var i=nGe(arguments.length,1)>n,o=qve(A)?A:AGe(A),s=i?tGe(arguments,n):[],a=i?function(){jve(o,this,s)}:o;return t?e(a,r):e(a)}:e},oGe=lL,sGe=lH,aGe=soe.set,gGe=iGe,lGe=sGe.setImmediate?gGe(aGe,!1):aGe;oGe({global:!0,bind:!0,enumerable:!0,forced:sGe.setImmediate!==lGe},{setImmediate:lGe});var cGe=lH,IGe=xoe,CGe=Sx,uGe=Fie,dGe=CH;lL({global:!0,enumerable:!0,dontCallGetSet:!0,forced:IH((function(){return dGe&&1!==Object.getOwnPropertyDescriptor(cGe,"queueMicrotask").value.length}))},{queueMicrotask:function(e){uGe(arguments.length,1),IGe(CGe(e))}});var hGe=lL,mGe=lH,pGe=rT,fGe=CH,bGe=TypeError,BGe=Object.defineProperty,yGe=mGe.self!==mGe;try{if(fGe){var wGe=Object.getOwnPropertyDescriptor(mGe,"self");!yGe&&wGe&&wGe.get&&wGe.enumerable||pGe(mGe,"self",{get:function(){return mGe},set:function(e){if(this!==mGe)throw new bGe("Illegal invocation");BGe(mGe,"self",{value:e,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else hGe({global:!0,simple:!0,forced:yGe},{self:mGe})}catch(PWe){}var ZGe,SGe=lL,vGe=lH,GGe=qH,RGe=VH,VGe=IH,NGe=tJ,kGe=zH,WGe=KT,FGe=YH,EGe=PH,XGe=fx,HGe=Yz,xGe=TJ,JGe=fL,YGe=_x,UGe=SO,LGe=nY,TGe=BU,KGe=Fie,MGe=Cle,QGe=Q7,DGe=TIe,zGe=eCe,OGe=X5,PGe=CD,_Ge=G5,jGe=vGe.Object,qGe=vGe.Array,$Ge=vGe.Date,eRe=vGe.Error,tRe=vGe.TypeError,nRe=vGe.PerformanceMark,ARe=GGe("DOMException"),rRe=QGe.Map,iRe=QGe.has,oRe=QGe.get,sRe=QGe.set,aRe=DGe.Set,gRe=DGe.add,lRe=DGe.has,cRe=GGe("Object","keys"),IRe=RGe([].push),CRe=RGe((!0).valueOf),uRe=RGe(1..valueOf),dRe=RGe("".valueOf),hRe=RGe($Ge.prototype.getTime),mRe=NGe("structuredClone"),pRe="DataCloneError",fRe="Transferring",bRe=function(e){return!VGe((function(){var t=new vGe.Set([7]),n=e(t),A=e(jGe(7));return n===t||!n.has(7)||!EGe(A)||7!=+A}))&&e},BRe=function(e,t){return!VGe((function(){var n=new t,A=e({a:n,b:n});return!(A&&A.a===A.b&&A.a instanceof t&&A.a.stack===n.stack)}))},yRe=vGe.structuredClone,wRe=!BRe(yRe,eRe)||!BRe(yRe,ARe)||(ZGe=yRe,!!VGe((function(){var e=ZGe(new vGe.AggregateError([1],mRe,{cause:3}));return"AggregateError"!==e.name||1!==e.errors[0]||e.message!==mRe||3!==e.cause}))),ZRe=!yRe&&bRe((function(e){return new nRe(mRe,{detail:e}).detail})),SRe=bRe(yRe)||ZRe,vRe=function(e){throw new ARe("Uncloneable type: "+e,pRe)},GRe=function(e,t){throw new ARe((t||"Cloning")+" of "+e+" cannot be properly polyfilled in this engine",pRe)},RRe=function(e,t){return SRe||GRe(t),SRe(e)},VRe=function(e,t,n){if(iRe(t,e))return oRe(t,e);var A,r,i,o,s,a;if("SharedArrayBuffer"===(n||JGe(e)))A=SRe?SRe(e):e;else{var g=vGe.DataView;g||kGe(e.slice)||GRe("ArrayBuffer");try{if(kGe(e.slice)&&!e.resizable)A=e.slice(0);else{r=e.byteLength,i="maxByteLength"in e?{maxByteLength:e.maxByteLength}:void 0,A=new ArrayBuffer(r,i),o=new g(e),s=new g(A);for(a=0;a<r;a++)s.setUint8(a,o.getUint8(a))}}catch(PWe){throw new ARe("ArrayBuffer is detached",pRe)}}return sRe(t,e,A),A},NRe=function(e,t){if(XGe(e)&&vRe("Symbol"),!EGe(e))return e;if(t){if(iRe(t,e))return oRe(t,e)}else t=new rRe;var n,A,r,i,o,s,a,g,l=JGe(e);switch(l){case"Array":r=qGe(TGe(e));break;case"Object":r={};break;case"Map":r=new rRe;break;case"Set":r=new aRe;break;case"RegExp":r=new RegExp(e.source,MGe(e));break;case"Error":switch(A=e.name){case"AggregateError":r=new(GGe(A))([]);break;case"EvalError":case"RangeError":case"ReferenceError":case"SuppressedError":case"SyntaxError":case"TypeError":case"URIError":r=new(GGe(A));break;case"CompileError":case"LinkError":case"RuntimeError":r=new(GGe("WebAssembly",A));break;default:r=new eRe}break;case"DOMException":r=new ARe(e.message,e.name);break;case"ArrayBuffer":case"SharedArrayBuffer":r=VRe(e,t,l);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":s="DataView"===l?e.byteLength:e.length,r=function(e,t,n,A,r){var i=vGe[t];return EGe(i)||GRe(t),new i(VRe(e.buffer,r),n,A)}(e,l,e.byteOffset,s,t);break;case"DOMQuad":try{r=new DOMQuad(NRe(e.p1,t),NRe(e.p2,t),NRe(e.p3,t),NRe(e.p4,t))}catch(PWe){r=RRe(e,l)}break;case"File":if(SRe)try{r=SRe(e),JGe(r)!==l&&(r=void 0)}catch(PWe){}if(!r)try{r=new File([e],e.name,e)}catch(PWe){}r||GRe(l);break;case"FileList":if(i=function(){var e;try{e=new vGe.DataTransfer}catch(PWe){try{e=new vGe.ClipboardEvent("").clipboardData}catch(t){}}return e&&e.items&&e.files?e:null}()){for(o=0,s=TGe(e);o<s;o++)i.items.add(NRe(e[o],t));r=i.files}else r=RRe(e,l);break;case"ImageData":try{r=new ImageData(NRe(e.data,t),e.width,e.height,{colorSpace:e.colorSpace})}catch(PWe){r=RRe(e,l)}break;default:if(SRe)r=SRe(e);else switch(l){case"BigInt":r=jGe(e.valueOf());break;case"Boolean":r=jGe(CRe(e));break;case"Number":r=jGe(uRe(e));break;case"String":r=jGe(dRe(e));break;case"Date":r=new $Ge(hRe(e));break;case"Blob":try{r=e.slice(0,e.size,e.type)}catch(PWe){GRe(l)}break;case"DOMPoint":case"DOMPointReadOnly":n=vGe[l];try{r=n.fromPoint?n.fromPoint(e):new n(e.x,e.y,e.z,e.w)}catch(PWe){GRe(l)}break;case"DOMRect":case"DOMRectReadOnly":n=vGe[l];try{r=n.fromRect?n.fromRect(e):new n(e.x,e.y,e.width,e.height)}catch(PWe){GRe(l)}break;case"DOMMatrix":case"DOMMatrixReadOnly":n=vGe[l];try{r=n.fromMatrix?n.fromMatrix(e):new n(e)}catch(PWe){GRe(l)}break;case"AudioData":case"VideoFrame":kGe(e.clone)||GRe(l);try{r=e.clone()}catch(PWe){vRe(l)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":GRe(l);default:vRe(l)}}switch(sRe(t,e,r),l){case"Array":case"Object":for(a=cRe(e),o=0,s=TGe(a);o<s;o++)g=a[o],UGe(r,g,NRe(e[g],t));break;case"Map":e.forEach((function(e,n){sRe(r,NRe(n,t),NRe(e,t))}));break;case"Set":e.forEach((function(e){gRe(r,NRe(e,t))}));break;case"Error":LGe(r,"message",NRe(e.message,t)),YGe(e,"cause")&&LGe(r,"cause",NRe(e.cause,t)),"AggregateError"===A?r.errors=NRe(e.errors,t):"SuppressedError"===A&&(r.error=NRe(e.error,t),r.suppressed=NRe(e.suppressed,t));case"DOMException":PGe&&LGe(r,"stack",NRe(e.stack,t))}return r};SGe({global:!0,enumerable:!0,sham:!_Ge,forced:wRe},{structuredClone:function(e){var t,n,A=KGe(arguments.length,1)>1&&!FGe(arguments[1])?xGe(arguments[1]):void 0,r=A?A.transfer:void 0;void 0!==r&&(n=function(e,t){if(!EGe(e))throw new tRe("Transfer option cannot be converted to a sequence");var n=[];HGe(e,(function(e){IRe(n,xGe(e))}));for(var A,r,i,o,s,a=0,g=TGe(n),l=new aRe;a<g;){if(A=n[a++],"ArrayBuffer"===(r=JGe(A))?lRe(l,A):iRe(t,A))throw new ARe("Duplicate transferable",pRe);if("ArrayBuffer"!==r){if(_Ge)o=yRe(A,{transfer:[A]});else switch(r){case"ImageBitmap":i=vGe.OffscreenCanvas,WGe(i)||GRe(r,fRe);try{(s=new i(A.width,A.height)).getContext("bitmaprenderer").transferFromImageBitmap(A),o=s.transferToImageBitmap()}catch(PWe){}break;case"AudioData":case"VideoFrame":kGe(A.clone)&&kGe(A.close)||GRe(r,fRe);try{o=A.clone(),A.close()}catch(PWe){}break;case"MediaSourceHandle":case"MessagePort":case"MIDIAccess":case"OffscreenCanvas":case"ReadableStream":case"RTCDataChannel":case"TransformStream":case"WebTransportReceiveStream":case"WebTransportSendStream":case"WritableStream":GRe(r,fRe)}if(void 0===o)throw new ARe("This object cannot be transferred: "+r,pRe);sRe(t,A,o)}else gRe(l,A)}return l}(r,t=new rRe));var i=NRe(e,t);return n&&function(e){zGe(e,(function(e){_Ge?SRe(e,{transfer:[e]}):kGe(e.transfer)?e.transfer():OGe?OGe(e):GRe("ArrayBuffer",fRe)}))}(n),i}});var kRe=lL,WRe=lH,FRe=iGe(WRe.setInterval,!0);kRe({global:!0,bind:!0,forced:WRe.setInterval!==FRe},{setInterval:FRe});var ERe=lL,XRe=lH,HRe=iGe(XRe.setTimeout,!0);ERe({global:!0,bind:!0,forced:XRe.setTimeout!==HRe},{setTimeout:HRe});var xRe=IH,JRe=CH,YRe=lJ("iterator"),URe=!xRe((function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),A="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),A+=n+e})),n.delete("a",2),n.delete("b",void 0),!t.size&&!JRe||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[YRe]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==A||"x"!==new URL("https://x",void 0).host})),LRe=VH,TRe=2147483647,KRe=/[^\0-\u007E]/,MRe=/[.\u3002\uFF0E\uFF61]/g,QRe="Overflow: input needs wider integers to process",DRe=RangeError,zRe=LRe(MRe.exec),ORe=Math.floor,PRe=String.fromCharCode,_Re=LRe("".charCodeAt),jRe=LRe([].join),qRe=LRe([].push),$Re=LRe("".replace),eVe=LRe("".split),tVe=LRe("".toLowerCase),nVe=function(e){return e+22+75*(e<26)},AVe=function(e,t,n){var A=0;for(e=n?ORe(e/700):e>>1,e+=ORe(e/t);e>455;)e=ORe(e/35),A+=36;return ORe(A+36*e/(e+38))},rVe=function(e){var t=[];e=function(e){for(var t=[],n=0,A=e.length;n<A;){var r=_Re(e,n++);if(r>=55296&&r<=56319&&n<A){var i=_Re(e,n++);56320==(64512&i)?qRe(t,((1023&r)<<10)+(1023&i)+65536):(qRe(t,r),n--)}else qRe(t,r)}return t}(e);var n,A,r=e.length,i=128,o=0,s=72;for(n=0;n<e.length;n++)(A=e[n])<128&&qRe(t,PRe(A));var a=t.length,g=a;for(a&&qRe(t,"-");g<r;){var l=TRe;for(n=0;n<e.length;n++)(A=e[n])>=i&&A<l&&(l=A);var c=g+1;if(l-i>ORe((TRe-o)/c))throw new DRe(QRe);for(o+=(l-i)*c,i=l,n=0;n<e.length;n++){if((A=e[n])<i&&++o>TRe)throw new DRe(QRe);if(A===i){for(var I=o,C=36;;){var u=C<=s?1:C>=s+26?26:C-s;if(I<u)break;var d=I-u,h=36-u;qRe(t,PRe(nVe(u+d%h))),I=ORe(d/h),C+=36}qRe(t,PRe(nVe(I))),s=AVe(o,c,g===a),o=0,g++}}o++,i++}return jRe(t,"")},iVe=lL,oVe=lH,sVe=coe,aVe=qH,gVe=mH,lVe=VH,cVe=CH,IVe=URe,CVe=oU,uVe=rT,dVe=a0,hVe=BT,mVe=J_,pVe=xY,fVe=c0,bVe=zH,BVe=_x,yVe=RT,wVe=fL,ZVe=TJ,SVe=PH,vVe=yL,GVe=OL,RVe=ZH,VVe=Bz,NVe=uz,kVe=ij,WVe=Fie,FVe=kq,EVe=lJ("iterator"),XVe="URLSearchParams",HVe=XVe+"Iterator",xVe=pVe.set,JVe=pVe.getterFor(XVe),YVe=pVe.getterFor(HVe),UVe=sVe("fetch"),LVe=sVe("Request"),TVe=sVe("Headers"),KVe=LVe&&LVe.prototype,MVe=TVe&&TVe.prototype,QVe=oVe.TypeError,DVe=oVe.encodeURIComponent,zVe=String.fromCharCode,OVe=aVe("String","fromCodePoint"),PVe=parseInt,_Ve=lVe("".charAt),jVe=lVe([].join),qVe=lVe([].push),$Ve=lVe("".replace),eNe=lVe([].shift),tNe=lVe([].splice),nNe=lVe("".split),ANe=lVe("".slice),rNe=lVe(/./.exec),iNe=/\+/g,oNe=/^[0-9a-f]+$/i,sNe=function(e,t){var n=ANe(e,t,t+2);return rNe(oNe,n)?PVe(n,16):NaN},aNe=function(e){for(var t=0,n=128;n>0&&e&n;n>>=1)t++;return t},gNe=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},lNe=function(e){for(var t=(e=$Ve(e,iNe," ")).length,n="",A=0;A<t;){var r=_Ve(e,A);if("%"===r){if("%"===_Ve(e,A+1)||A+3>t){n+="%",A++;continue}var i=sNe(e,A+1);if(i!=i){n+=r,A++;continue}A+=2;var o=aNe(i);if(0===o)r=zVe(i);else{if(1===o||o>4){n+="�",A++;continue}for(var s=[i],a=1;a<o&&!(++A+3>t||"%"!==_Ve(e,A));){var g=sNe(e,A+1);if(g!=g){A+=3;break}if(g>191||g<128)break;qVe(s,g),A+=2,a++}if(s.length!==o){n+="�";continue}var l=gNe(s);null===l?n+="�":r=OVe(l)}}n+=r,A++}return n},cNe=/[!'()~]|%20/g,INe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},CNe=function(e){return INe[e]},uNe=function(e){return $Ve(DVe(e),cNe,CNe)},dNe=mVe((function(e,t){xVe(this,{type:HVe,target:JVe(e).entries,index:0,kind:t})}),XVe,(function(){var e=YVe(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=null,kVe(void 0,!0);var A=t[n];switch(e.kind){case"keys":return kVe(A.key,!1);case"values":return kVe(A.value,!1)}return kVe([A.key,A.value],!1)}),!0),hNe=function(e){this.entries=[],this.url=null,void 0!==e&&(SVe(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===_Ve(e,0)?ANe(e,1):e:vVe(e)))};hNe.prototype={type:XVe,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,A,r,i,o,s,a=this.entries,g=NVe(e);if(g)for(n=(t=VVe(e,g)).next;!(A=gVe(n,t)).done;){if(i=(r=VVe(ZVe(A.value))).next,(o=gVe(i,r)).done||(s=gVe(i,r)).done||!gVe(i,r).done)throw new QVe("Expected sequence with length 2");qVe(a,{key:vVe(o.value),value:vVe(s.value)})}else for(var l in e)BVe(e,l)&&qVe(a,{key:l,value:vVe(e[l])})},parseQuery:function(e){if(e)for(var t,n,A=this.entries,r=nNe(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=nNe(t,"="),qVe(A,{key:lNe(eNe(n)),value:lNe(jVe(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],A=0;A<t.length;)e=t[A++],qVe(n,uNe(e.key)+"="+uNe(e.value));return jVe(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var mNe=function(){fVe(this,pNe);var e=xVe(this,new hNe(arguments.length>0?arguments[0]:void 0));cVe||(this.size=e.entries.length)},pNe=mNe.prototype;if(dVe(pNe,{append:function(e,t){var n=JVe(this);WVe(arguments.length,2),qVe(n.entries,{key:vVe(e),value:vVe(t)}),cVe||this.length++,n.updateURL()},delete:function(e){for(var t=JVe(this),n=WVe(arguments.length,1),A=t.entries,r=vVe(e),i=n<2?void 0:arguments[1],o=void 0===i?i:vVe(i),s=0;s<A.length;){var a=A[s];if(a.key!==r||void 0!==o&&a.value!==o)s++;else if(tNe(A,s,1),void 0!==o)break}cVe||(this.size=A.length),t.updateURL()},get:function(e){var t=JVe(this).entries;WVe(arguments.length,1);for(var n=vVe(e),A=0;A<t.length;A++)if(t[A].key===n)return t[A].value;return null},getAll:function(e){var t=JVe(this).entries;WVe(arguments.length,1);for(var n=vVe(e),A=[],r=0;r<t.length;r++)t[r].key===n&&qVe(A,t[r].value);return A},has:function(e){for(var t=JVe(this).entries,n=WVe(arguments.length,1),A=vVe(e),r=n<2?void 0:arguments[1],i=void 0===r?r:vVe(r),o=0;o<t.length;){var s=t[o++];if(s.key===A&&(void 0===i||s.value===i))return!0}return!1},set:function(e,t){var n=JVe(this);WVe(arguments.length,1);for(var A,r=n.entries,i=!1,o=vVe(e),s=vVe(t),a=0;a<r.length;a++)(A=r[a]).key===o&&(i?tNe(r,a--,1):(i=!0,A.value=s));i||qVe(r,{key:o,value:s}),cVe||(this.size=r.length),n.updateURL()},sort:function(){var e=JVe(this);FVe(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=JVe(this).entries,A=yVe(e,arguments.length>1?arguments[1]:void 0),r=0;r<n.length;)A((t=n[r++]).value,t.key,this)},keys:function(){return new dNe(this,"keys")},values:function(){return new dNe(this,"values")},entries:function(){return new dNe(this,"entries")}},{enumerable:!0}),CVe(pNe,EVe,pNe.entries,{name:"entries"}),CVe(pNe,"toString",(function(){return JVe(this).serialize()}),{enumerable:!0}),cVe&&uVe(pNe,"size",{get:function(){return JVe(this).entries.length},configurable:!0,enumerable:!0}),hVe(mNe,XVe),iVe({global:!0,constructor:!0,forced:!IVe},{URLSearchParams:mNe}),!IVe&&bVe(TVe)){var fNe=lVe(MVe.has),bNe=lVe(MVe.set),BNe=function(e){if(SVe(e)){var t,n=e.body;if(wVe(n)===XVe)return t=e.headers?new TVe(e.headers):new TVe,fNe(t,"content-type")||bNe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),GVe(e,{body:RVe(0,vVe(n)),headers:RVe(0,t)})}return e};if(bVe(UVe)&&iVe({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return UVe(e,arguments.length>1?BNe(arguments[1]):{})}}),bVe(LVe)){var yNe=function(e){return fVe(this,KVe),new LVe(e,arguments.length>1?BNe(arguments[1]):{})};KVe.constructor=yNe,yNe.prototype=KVe,iVe({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:yNe})}}var wNe,ZNe=lL,SNe=CH,vNe=URe,GNe=lH,RNe=RT,VNe=VH,NNe=oU,kNe=rT,WNe=c0,FNe=_x,ENe=gAe,XNe=s_,HNe=_L,xNe=Eue.codeAt,JNe=function(e){var t,n,A=[],r=eVe($Re(tVe(e),MRe,"."),".");for(t=0;t<r.length;t++)n=r[t],qRe(A,zRe(KRe,n)?"xn--"+rVe(n):n);return jRe(A,".")},YNe=yL,UNe=BT,LNe=Fie,TNe={URLSearchParams:mNe,getState:JVe},KNe=xY,MNe=KNe.set,QNe=KNe.getterFor("URL"),DNe=TNe.URLSearchParams,zNe=TNe.getState,ONe=GNe.URL,PNe=GNe.TypeError,_Ne=GNe.parseInt,jNe=Math.floor,qNe=Math.pow,$Ne=VNe("".charAt),eke=VNe(/./.exec),tke=VNe([].join),nke=VNe(1..toString),Ake=VNe([].pop),rke=VNe([].push),ike=VNe("".replace),oke=VNe([].shift),ske=VNe("".split),ake=VNe("".slice),gke=VNe("".toLowerCase),lke=VNe([].unshift),cke="Invalid scheme",Ike="Invalid host",Cke="Invalid port",uke=/[a-z]/i,dke=/[\d+-.a-z]/i,hke=/\d/,mke=/^0x/i,pke=/^[0-7]+$/,fke=/^\d+$/,bke=/^[\da-f]+$/i,Bke=/[\0\t\n\r #%/:<>?@[\\\]^|]/,yke=/[\0\t\n\r #/:<>?@[\\\]^|]/,wke=/^[\u0000-\u0020]+/,Zke=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Ske=/[\t\n\r]/g,vke=function(e){var t,n,A,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)lke(t,e%256),e=jNe(e/256);return tke(t,".")}if("object"==typeof e){for(t="",A=function(e){for(var t=null,n=1,A=null,r=0,i=0;i<8;i++)0!==e[i]?(r>n&&(t=A,n=r),A=null,r=0):(null===A&&(A=i),++r);return r>n?A:t}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),A===n?(t+=n?":":"::",r=!0):(t+=nke(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},Gke={},Rke=ENe({},Gke,{" ":1,'"':1,"<":1,">":1,"`":1}),Vke=ENe({},Rke,{"#":1,"?":1,"{":1,"}":1}),Nke=ENe({},Vke,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),kke=function(e,t){var n=xNe(e,0);return n>32&&n<127&&!FNe(t,e)?e:encodeURIComponent(e)},Wke={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Fke=function(e,t){var n;return 2===e.length&&eke(uke,$Ne(e,0))&&(":"===(n=$Ne(e,1))||!t&&"|"===n)},Eke=function(e){var t;return e.length>1&&Fke(ake(e,0,2))&&(2===e.length||"/"===(t=$Ne(e,2))||"\\"===t||"?"===t||"#"===t)},Xke=function(e){return"."===e||"%2e"===gke(e)},Hke={},xke={},Jke={},Yke={},Uke={},Lke={},Tke={},Kke={},Mke={},Qke={},Dke={},zke={},Oke={},Pke={},_ke={},jke={},qke={},$ke={},eWe={},tWe={},nWe={},AWe=function(e,t,n){var A,r,i,o=YNe(e);if(t){if(r=this.parse(o))throw new PNe(r);this.searchParams=null}else{if(void 0!==n&&(A=new AWe(n,!0)),r=this.parse(o,null,A))throw new PNe(r);(i=zNe(new DNe)).bindURL(this),this.searchParams=i}};AWe.prototype={type:"URL",parse:function(e,t,n){var A,r,i,o,s,a=this,g=t||Hke,l=0,c="",I=!1,C=!1,u=!1;for(e=YNe(e),t||(a.scheme="",a.username="",a.password="",a.host=null,a.port=null,a.path=[],a.query=null,a.fragment=null,a.cannotBeABaseURL=!1,e=ike(e,wke,""),e=ike(e,Zke,"$1")),e=ike(e,Ske,""),A=XNe(e);l<=A.length;){switch(r=A[l],g){case Hke:if(!r||!eke(uke,r)){if(t)return cke;g=Jke;continue}c+=gke(r),g=xke;break;case xke:if(r&&(eke(dke,r)||"+"===r||"-"===r||"."===r))c+=gke(r);else{if(":"!==r){if(t)return cke;c="",g=Jke,l=0;continue}if(t&&(a.isSpecial()!==FNe(Wke,c)||"file"===c&&(a.includesCredentials()||null!==a.port)||"file"===a.scheme&&!a.host))return;if(a.scheme=c,t)return void(a.isSpecial()&&Wke[a.scheme]===a.port&&(a.port=null));c="","file"===a.scheme?g=Pke:a.isSpecial()&&n&&n.scheme===a.scheme?g=Yke:a.isSpecial()?g=Kke:"/"===A[l+1]?(g=Uke,l++):(a.cannotBeABaseURL=!0,rke(a.path,""),g=eWe)}break;case Jke:if(!n||n.cannotBeABaseURL&&"#"!==r)return cke;if(n.cannotBeABaseURL&&"#"===r){a.scheme=n.scheme,a.path=HNe(n.path),a.query=n.query,a.fragment="",a.cannotBeABaseURL=!0,g=nWe;break}g="file"===n.scheme?Pke:Lke;continue;case Yke:if("/"!==r||"/"!==A[l+1]){g=Lke;continue}g=Mke,l++;break;case Uke:if("/"===r){g=Qke;break}g=$ke;continue;case Lke:if(a.scheme=n.scheme,r===wNe)a.username=n.username,a.password=n.password,a.host=n.host,a.port=n.port,a.path=HNe(n.path),a.query=n.query;else if("/"===r||"\\"===r&&a.isSpecial())g=Tke;else if("?"===r)a.username=n.username,a.password=n.password,a.host=n.host,a.port=n.port,a.path=HNe(n.path),a.query="",g=tWe;else{if("#"!==r){a.username=n.username,a.password=n.password,a.host=n.host,a.port=n.port,a.path=HNe(n.path),a.path.length--,g=$ke;continue}a.username=n.username,a.password=n.password,a.host=n.host,a.port=n.port,a.path=HNe(n.path),a.query=n.query,a.fragment="",g=nWe}break;case Tke:if(!a.isSpecial()||"/"!==r&&"\\"!==r){if("/"!==r){a.username=n.username,a.password=n.password,a.host=n.host,a.port=n.port,g=$ke;continue}g=Qke}else g=Mke;break;case Kke:if(g=Mke,"/"!==r||"/"!==$Ne(c,l+1))continue;l++;break;case Mke:if("/"!==r&&"\\"!==r){g=Qke;continue}break;case Qke:if("@"===r){I&&(c="%40"+c),I=!0,i=XNe(c);for(var d=0;d<i.length;d++){var h=i[d];if(":"!==h||u){var m=kke(h,Nke);u?a.password+=m:a.username+=m}else u=!0}c=""}else if(r===wNe||"/"===r||"?"===r||"#"===r||"\\"===r&&a.isSpecial()){if(I&&""===c)return"Invalid authority";l-=XNe(c).length+1,c="",g=Dke}else c+=r;break;case Dke:case zke:if(t&&"file"===a.scheme){g=jke;continue}if(":"!==r||C){if(r===wNe||"/"===r||"?"===r||"#"===r||"\\"===r&&a.isSpecial()){if(a.isSpecial()&&""===c)return Ike;if(t&&""===c&&(a.includesCredentials()||null!==a.port))return;if(o=a.parseHost(c))return o;if(c="",g=qke,t)return;continue}"["===r?C=!0:"]"===r&&(C=!1),c+=r}else{if(""===c)return Ike;if(o=a.parseHost(c))return o;if(c="",g=Oke,t===zke)return}break;case Oke:if(!eke(hke,r)){if(r===wNe||"/"===r||"?"===r||"#"===r||"\\"===r&&a.isSpecial()||t){if(""!==c){var p=_Ne(c,10);if(p>65535)return Cke;a.port=a.isSpecial()&&p===Wke[a.scheme]?null:p,c=""}if(t)return;g=qke;continue}return Cke}c+=r;break;case Pke:if(a.scheme="file","/"===r||"\\"===r)g=_ke;else{if(!n||"file"!==n.scheme){g=$ke;continue}switch(r){case wNe:a.host=n.host,a.path=HNe(n.path),a.query=n.query;break;case"?":a.host=n.host,a.path=HNe(n.path),a.query="",g=tWe;break;case"#":a.host=n.host,a.path=HNe(n.path),a.query=n.query,a.fragment="",g=nWe;break;default:Eke(tke(HNe(A,l),""))||(a.host=n.host,a.path=HNe(n.path),a.shortenPath()),g=$ke;continue}}break;case _ke:if("/"===r||"\\"===r){g=jke;break}n&&"file"===n.scheme&&!Eke(tke(HNe(A,l),""))&&(Fke(n.path[0],!0)?rke(a.path,n.path[0]):a.host=n.host),g=$ke;continue;case jke:if(r===wNe||"/"===r||"\\"===r||"?"===r||"#"===r){if(!t&&Fke(c))g=$ke;else if(""===c){if(a.host="",t)return;g=qke}else{if(o=a.parseHost(c))return o;if("localhost"===a.host&&(a.host=""),t)return;c="",g=qke}continue}c+=r;break;case qke:if(a.isSpecial()){if(g=$ke,"/"!==r&&"\\"!==r)continue}else if(t||"?"!==r)if(t||"#"!==r){if(r!==wNe&&(g=$ke,"/"!==r))continue}else a.fragment="",g=nWe;else a.query="",g=tWe;break;case $ke:if(r===wNe||"/"===r||"\\"===r&&a.isSpecial()||!t&&("?"===r||"#"===r)){if(".."===(s=gke(s=c))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(a.shortenPath(),"/"===r||"\\"===r&&a.isSpecial()||rke(a.path,"")):Xke(c)?"/"===r||"\\"===r&&a.isSpecial()||rke(a.path,""):("file"===a.scheme&&!a.path.length&&Fke(c)&&(a.host&&(a.host=""),c=$Ne(c,0)+":"),rke(a.path,c)),c="","file"===a.scheme&&(r===wNe||"?"===r||"#"===r))for(;a.path.length>1&&""===a.path[0];)oke(a.path);"?"===r?(a.query="",g=tWe):"#"===r&&(a.fragment="",g=nWe)}else c+=kke(r,Vke);break;case eWe:"?"===r?(a.query="",g=tWe):"#"===r?(a.fragment="",g=nWe):r!==wNe&&(a.path[0]+=kke(r,Gke));break;case tWe:t||"#"!==r?r!==wNe&&("'"===r&&a.isSpecial()?a.query+="%27":a.query+="#"===r?"%23":kke(r,Gke)):(a.fragment="",g=nWe);break;case nWe:r!==wNe&&(a.fragment+=kke(r,Rke))}l++}},parseHost:function(e){var t,n,A;if("["===$Ne(e,0)){if("]"!==$Ne(e,e.length-1))return Ike;if(t=function(e){var t,n,A,r,i,o,s,a=[0,0,0,0,0,0,0,0],g=0,l=null,c=0,I=function(){return $Ne(e,c)};if(":"===I()){if(":"!==$Ne(e,1))return;c+=2,l=++g}for(;I();){if(8===g)return;if(":"!==I()){for(t=n=0;n<4&&eke(bke,I());)t=16*t+_Ne(I(),16),c++,n++;if("."===I()){if(0===n)return;if(c-=n,g>6)return;for(A=0;I();){if(r=null,A>0){if(!("."===I()&&A<4))return;c++}if(!eke(hke,I()))return;for(;eke(hke,I());){if(i=_Ne(I(),10),null===r)r=i;else{if(0===r)return;r=10*r+i}if(r>255)return;c++}a[g]=256*a[g]+r,2!=++A&&4!==A||g++}if(4!==A)return;break}if(":"===I()){if(c++,!I())return}else if(I())return;a[g++]=t}else{if(null!==l)return;c++,l=++g}}if(null!==l)for(o=g-l,g=7;0!==g&&o>0;)s=a[g],a[g--]=a[l+o-1],a[l+--o]=s;else if(8!==g)return;return a}(ake(e,1,-1)),!t)return Ike;this.host=t}else if(this.isSpecial()){if(e=JNe(e),eke(Bke,e))return Ike;if(t=function(e){var t,n,A,r,i,o,s,a=ske(e,".");if(a.length&&""===a[a.length-1]&&a.length--,(t=a.length)>4)return e;for(n=[],A=0;A<t;A++){if(""===(r=a[A]))return e;if(i=10,r.length>1&&"0"===$Ne(r,0)&&(i=eke(mke,r)?16:8,r=ake(r,8===i?1:2)),""===r)o=0;else{if(!eke(10===i?fke:8===i?pke:bke,r))return e;o=_Ne(r,i)}rke(n,o)}for(A=0;A<t;A++)if(o=n[A],A===t-1){if(o>=qNe(256,5-t))return null}else if(o>255)return null;for(s=Ake(n),A=0;A<n.length;A++)s+=n[A]*qNe(256,3-A);return s}(e),null===t)return Ike;this.host=t}else{if(eke(yke,e))return Ike;for(t="",n=XNe(e),A=0;A<n.length;A++)t+=kke(n[A],Gke);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return FNe(Wke,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&Fke(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,A=e.password,r=e.host,i=e.port,o=e.path,s=e.query,a=e.fragment,g=t+":";return null!==r?(g+="//",e.includesCredentials()&&(g+=n+(A?":"+A:"")+"@"),g+=vke(r),null!==i&&(g+=":"+i)):"file"===t&&(g+="//"),g+=e.cannotBeABaseURL?o[0]:o.length?"/"+tke(o,"/"):"",null!==s&&(g+="?"+s),null!==a&&(g+="#"+a),g},setHref:function(e){var t=this.parse(e);if(t)throw new PNe(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new rWe(e.path[0]).origin}catch(PWe){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+vke(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(YNe(e)+":",Hke)},getUsername:function(){return this.username},setUsername:function(e){var t=XNe(YNe(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=kke(t[n],Nke)}},getPassword:function(){return this.password},setPassword:function(e){var t=XNe(YNe(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=kke(t[n],Nke)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?vke(e):vke(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Dke)},getHostname:function(){var e=this.host;return null===e?"":vke(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,zke)},getPort:function(){var e=this.port;return null===e?"":YNe(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=YNe(e))?this.port=null:this.parse(e,Oke))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+tke(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,qke))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=YNe(e))?this.query=null:("?"===$Ne(e,0)&&(e=ake(e,1)),this.query="",this.parse(e,tWe)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=YNe(e))?("#"===$Ne(e,0)&&(e=ake(e,1)),this.fragment="",this.parse(e,nWe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var rWe=function(e){var t=WNe(this,iWe),n=LNe(arguments.length,1)>1?arguments[1]:void 0,A=MNe(t,new AWe(e,!1,n));SNe||(t.href=A.serialize(),t.origin=A.getOrigin(),t.protocol=A.getProtocol(),t.username=A.getUsername(),t.password=A.getPassword(),t.host=A.getHost(),t.hostname=A.getHostname(),t.port=A.getPort(),t.pathname=A.getPathname(),t.search=A.getSearch(),t.searchParams=A.getSearchParams(),t.hash=A.getHash())},iWe=rWe.prototype,oWe=function(e,t){return{get:function(){return QNe(this)[e]()},set:t&&function(e){return QNe(this)[t](e)},configurable:!0,enumerable:!0}};if(SNe&&(kNe(iWe,"href",oWe("serialize","setHref")),kNe(iWe,"origin",oWe("getOrigin")),kNe(iWe,"protocol",oWe("getProtocol","setProtocol")),kNe(iWe,"username",oWe("getUsername","setUsername")),kNe(iWe,"password",oWe("getPassword","setPassword")),kNe(iWe,"host",oWe("getHost","setHost")),kNe(iWe,"hostname",oWe("getHostname","setHostname")),kNe(iWe,"port",oWe("getPort","setPort")),kNe(iWe,"pathname",oWe("getPathname","setPathname")),kNe(iWe,"search",oWe("getSearch","setSearch")),kNe(iWe,"searchParams",oWe("getSearchParams")),kNe(iWe,"hash",oWe("getHash","setHash"))),NNe(iWe,"toJSON",(function(){return QNe(this).serialize()}),{enumerable:!0}),NNe(iWe,"toString",(function(){return QNe(this).serialize()}),{enumerable:!0}),ONe){var sWe=ONe.createObjectURL,aWe=ONe.revokeObjectURL;sWe&&NNe(rWe,"createObjectURL",RNe(sWe,ONe)),aWe&&NNe(rWe,"revokeObjectURL",RNe(aWe,ONe))}UNe(rWe,"URL"),ZNe({global:!0,constructor:!0,forced:!vNe,sham:!SNe},{URL:rWe});var gWe=lL,lWe=IH,cWe=Fie,IWe=yL,CWe=URe,uWe=qH("URL"),dWe=CWe&&lWe((function(){uWe.canParse()})),hWe=lWe((function(){return 1!==uWe.canParse.length}));gWe({target:"URL",stat:!0,forced:!dWe||hWe},{canParse:function(e){var t=cWe(arguments.length,1),n=IWe(e),A=t<2||void 0===arguments[1]?void 0:IWe(arguments[1]);try{return!!new uWe(n,A)}catch(PWe){return!1}}});var mWe=lL,pWe=Fie,fWe=yL,bWe=URe,BWe=qH("URL");mWe({target:"URL",stat:!0,forced:!bWe},{parse:function(e){var t=pWe(arguments.length,1),n=fWe(e),A=t<2||void 0===arguments[1]?void 0:fWe(arguments[1]);try{return new BWe(n,A)}catch(PWe){return null}}});var yWe=mH;lL({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return yWe(URL.prototype.toString,this)}});var wWe=oU,ZWe=VH,SWe=yL,vWe=Fie,GWe=URLSearchParams,RWe=GWe.prototype,VWe=ZWe(RWe.append),NWe=ZWe(RWe.delete),kWe=ZWe(RWe.forEach),WWe=ZWe([].push),FWe=new GWe("a=1&a=2&b=3");FWe.delete("a",1),FWe.delete("b",void 0),FWe+""!="a=2"&&wWe(RWe,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return NWe(this,e);var A=[];kWe(this,(function(e,t){WWe(A,{key:t,value:e})})),vWe(t,1);for(var r,i=SWe(e),o=SWe(n),s=0,a=0,g=!1,l=A.length;s<l;)r=A[s++],g||r.key===i?(g=!0,NWe(this,r.key)):a++;for(;a<l;)(r=A[a++]).key===i&&r.value===o||VWe(this,r.key,r.value)}),{enumerable:!0,unsafe:!0});var EWe=oU,XWe=VH,HWe=yL,xWe=Fie,JWe=URLSearchParams,YWe=JWe.prototype,UWe=XWe(YWe.getAll),LWe=XWe(YWe.has),TWe=new JWe("a=1");!TWe.has("a",2)&&TWe.has("a",void 0)||EWe(YWe,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return LWe(this,e);var A=UWe(this,e);xWe(t,1);for(var r=HWe(n),i=0;i<A.length;)if(A[i++]===r)return!0;return!1}),{enumerable:!0,unsafe:!0});var KWe=CH,MWe=VH,QWe=rT,DWe=URLSearchParams.prototype,zWe=MWe(DWe.forEach);KWe&&!("size"in DWe)&&QWe(DWe,"size",{get:function(){var e=0;return zWe(this,(function(){e++})),e},configurable:!0,enumerable:!0});var OWe={exports:{}};!function(){var e=function(e){var t,n=Object.prototype,A=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function g(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{g({},"")}catch(W){g=function(e,t,n){return e[t]=n}}function l(e,t,n,A){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new N(A||[]);return r(o,"_invoke",{value:v(e,n,s)}),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(W){return{type:"throw",arg:W}}}e.wrap=l;var I="suspendedStart",C="suspendedYield",u="executing",d="completed",h={};function m(){}function p(){}function f(){}var b={};g(b,o,(function(){return this}));var B=Object.getPrototypeOf,y=B&&B(B(k([])));y&&y!==n&&A.call(y,o)&&(b=y);var w=f.prototype=m.prototype=Object.create(b);function Z(e){["next","throw","return"].forEach((function(t){g(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(r,i,o,s){var a=c(e[r],e,i);if("throw"!==a.type){var g=a.arg,l=g.value;return l&&"object"==typeof l&&A.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(l).then((function(e){g.value=e,o(g)}),(function(e){return n("throw",e,o,s)}))}s(a.arg)}var i;r(this,"_invoke",{value:function(e,A){function r(){return new t((function(t,r){n(e,A,t,r)}))}return i=i?i.then(r,r):r()}})}function v(e,n,A){var r=I;return function(i,o){if(r===u)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return{value:t,done:!0}}for(A.method=i,A.arg=o;;){var s=A.delegate;if(s){var a=G(s,A);if(a){if(a===h)continue;return a}}if("next"===A.method)A.sent=A._sent=A.arg;else if("throw"===A.method){if(r===I)throw r=d,A.arg;A.dispatchException(A.arg)}else"return"===A.method&&A.abrupt("return",A.arg);r=u;var g=c(e,n,A);if("normal"===g.type){if(r=A.done?d:C,g.arg===h)continue;return{value:g.arg,done:A.done}}"throw"===g.type&&(r=d,A.method="throw",A.arg=g.arg)}}}function G(e,n){var A=n.method,r=e.iterator[A];if(r===t)return n.delegate=null,"throw"===A&&e.iterator.return&&(n.method="return",n.arg=t,G(e,n),"throw"===n.method)||"return"!==A&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+A+"' method")),h;var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function V(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function k(e){if(null!=e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(A.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return p.prototype=f,r(w,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:p,configurable:!0}),p.displayName=g(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,g(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},Z(S.prototype),g(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,A,r,i){void 0===i&&(i=Promise);var o=new S(l(t,n,A,r),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},Z(w),g(w,a,"Generator"),g(w,o,(function(){return this})),g(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var A in t)n.push(A);return n.reverse(),function e(){for(;n.length;){var A=n.pop();if(A in t)return e.value=A,e.done=!1,e}return e.done=!0,e}},e.values=k,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(V),!e)for(var n in this)"t"===n.charAt(0)&&A.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(A,r){return s.type="throw",s.arg=e,n.next=A,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=A.call(o,"catchLoc"),g=A.call(o,"finallyLoc");if(a&&g){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!g)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&A.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),V(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var A=n.completion;if("throw"===A.type){var r=A.arg;V(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,A){return this.delegate={iterator:k(e),resultName:n,nextLoc:A},"next"===this.method&&(this.arg=t),h}},e}(OWe.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(),b.createRoot(document.getElementById("root")).render(f.jsx(r.StrictMode,{children:f.jsx(aH,{})}));export{zF as _};
